<div class="contact-list-container contact-list-container-{{contacts.length}}">
    <ng-container *ngIf="loading; else elseTemplate">
        <div class="loading">
            <mat-spinner></mat-spinner>
        </div>
    </ng-container>
    <ng-template #elseTemplate>
        <mat-card class="contact-card" *ngFor="let contact of contacts">
            <mat-card-header>
                <div mat-card-avatar class="contact-header-image fa" [class.fa-address-card]="contact.type === 'contact'" [class.fa-users]="contact.type ==='contactGroup'"
                    [class.fa-sitemap]="contact.type ==='entity'" [class.fa-user]="contact.type ==='user'"
                    [title]="lang['contact_'+contact.type]">
                </div>
                <mat-card-title *ngIf="!empty(contact.firstname) || !empty(contact.lastname)" [title]="contact.civility.label + ' ' + contact.firstname + ' ' + contact.lastname">
                    <sup style="color: #666;" *ngIf="!empty(contact.civility)">{{contact.civility.abbreviation}}&nbsp;</sup>{{contact.firstname}}
                    {{contact.lastname}}
                </mat-card-title>
                <mat-card-title *ngIf="empty(contact.firstname) && empty(contact.lastname)" [title]="contact.company">{{contact.company}}</mat-card-title>
                <mat-card-subtitle [title]="contact.function" *ngIf="!empty(contact.function)">
                    {{contact.function}}&nbsp;
                </mat-card-subtitle>
                <i class="contact-filling fa fa-circle"
                    *ngIf="contact.type === 'contact' && !empty(contact.fillingRate.color)"
                    [style.color]="contact.fillingRate.color"
                    [title]="lang.contactsFillingRate"></i>
            </mat-card-header>
            <mat-card-content>
                <mat-list>
                    <h3 mat-subheader>{{lang.contactDetails}}</h3>
                    <mat-list-item class="contact-item" *ngIf="(!empty(contact.firstname) || !empty(contact.lastname)) && !empty(contact.company)">
                        <mat-icon mat-list-icon class="contact-group far fa-building"
                            [title]="lang.contactsParameters_company"></mat-icon>
                        <p mat-line class="contact-content"> {{contact.company}} </p>
                    </mat-list-item>
                    <mat-list-item class="contact-item" *ngIf="!empty(contact.department)">
                        <mat-icon mat-list-icon class="contact-group fa fa-sitemap"
                            [title]="lang.contactsParameters_department"></mat-icon>
                        <p mat-line class="contact-content"> {{contact.department}} </p>
                    </mat-list-item>
                    <mat-list-item class="contact-item" *ngIf="!empty(contact.email)">
                        <mat-icon mat-list-icon class="contact-group far fa-envelope" [title]="lang.email"></mat-icon>
                        <a matLine href="mailto:{{contact.email}}" class="contact-content"> {{contact.email}} </a>
                    </mat-list-item>
                    <mat-list-item class="contact-item" *ngIf="!empty(contact.phone)">
                        <mat-icon mat-list-icon class="contact-group fas fa-phone" [title]="lang.phoneNumber">
                        </mat-icon>
                        <p mat-line class="contact-content"> {{contact.phone}} </p>
                    </mat-list-item>
                    <mat-list-item class="contact-address" (click)="goTo(contact)" [title]="lang.address" *ngIf="!empty(contact.addressNumber) || !empty(contact.addressStreet) || !empty(contact.addressAdditional2) || !empty(contact.addressPostcode) || !empty(contact.addressTown) || !empty(contact.addressCountry)">
                        <mat-icon mat-list-icon class="contact-group fas fa-map-marker-alt"></mat-icon>
                        <p mat-line class="contact-content" *ngIf="!empty(contact.addressNumber) || !empty(contact.addressStreet)"> {{contact.addressNumber}} {{contact.addressStreet}} </p>
                        <p mat-line class="contact-content" *ngIf="!empty(contact.addressAdditional1) || !empty(contact.addressAdditional2)">{{contact.addressAdditional1}} {{contact.addressAdditional2}} </p>
                        <p mat-line class="contact-content" *ngIf="!empty(contact.addressPostcode) || !empty(contact.addressTown)"> {{contact.addressPostcode}} {{contact.addressTown}} </p>
                        <p mat-line class="contact-content" *ngIf="!empty(contact.addressCountry)"> {{contact.addressCountry}} </p>
                    </mat-list-item>
                </mat-list>
                <mat-expansion-panel *ngIf="!emptyOtherInfo(contact)">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            {{lang.othersInfos}}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-list>
                        <mat-list-item class="contact-item" *ngIf="!empty(contact.communicationMeans)" [title]="lang.communicationMean">
                            <mat-icon mat-list-icon class="contact-group fas fa-hashtag"></mat-icon>
                            <p mat-line class="contact-content" [title]="contact.communicationMeans.url !== undefined ? contact.communicationMeans.url : contact.communicationMeans.email"> {{contact.communicationMeans.url !== undefined ? contact.communicationMeans.url : contact.communicationMeans.email}} </p>
                        </mat-list-item>
                        <ng-container *ngFor="let keyVal of contact.customFields | keyvalue" >
                            <mat-list-item class="contact-item" *ngIf="keyVal.value.value !== null">
                                <mat-icon mat-list-icon class="contact-group fas fa-hashtag"
                                    [title]="keyVal.value.label">
                                </mat-icon>
                                <p mat-line class="contact-content" [title]="keyVal.value.value"> {{keyVal.value.value}} </p>
                            </mat-list-item>
                        </ng-container>
                    </mat-list>
                </mat-expansion-panel>
            </mat-card-content>
        </mat-card>
    </ng-template>
</div>
