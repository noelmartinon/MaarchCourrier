(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/JYr":function(t,e,i){"use strict";var a=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),n=i("q3Kh"),s=i("gTqA"),c=i("wjEo");e.exhaustMap=function t(e,i){return i?function(a){return a.pipe(t((function(t,a){return s.from(e(t,a)).pipe(n.map((function(e,n){return i(t,e,a,n)})))})))}:function(t){return t.lift(new o(e))}};var o=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new r(t,this.project))},t}(),r=function(t){function e(e,i){var a=t.call(this,e)||this;return a.project=i,a.hasSubscription=!1,a.hasCompleted=!1,a.index=0,a}return a(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e,i=this.index++;try{e=this.project(t,i)}catch(a){return void this.destination.error(a)}this.hasSubscription=!0,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new c.SimpleInnerSubscriber(this),i=this.destination;i.add(e);var a=c.innerSubscribe(t,e);a!==e&&i.add(a)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(c.SimpleOuterSubscriber)},Dxa7:function(t,e,i){"use strict";var a=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),n=i("FWf1"),s=i("IKal"),c=i("aJGj");e.take=function(t){return function(e){return 0===t?c.empty():e.lift(new o(t))}};var o=function(){function t(t){if(this.total=t,this.total<0)throw new s.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new r(t,this.total))},t}(),r=function(t){function e(e,i){var a=t.call(this,e)||this;return a.total=i,a.count=0,a}return a(e,t),e.prototype._next=function(t){var e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))},e}(n.Subscriber)},IKal:function(t,e,i){"use strict";e.ArgumentOutOfRangeError=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}()},NpuA:function(t,e,i){var a,n;void 0===(n="function"==typeof(a=function t(){"use strict";var e="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{},i=!e.document&&!!e.postMessage,a=i&&/blob:/i.test((e.location||{}).protocol),n={},s=0,c={parse:function(i,a){var o=(a=a||{}).dynamicTyping||!1;if(E(o)&&(a.dynamicTypingFunction=o,o={}),a.dynamicTyping=o,a.transform=!!E(a.transform)&&a.transform,a.worker&&c.WORKERS_SUPPORTED){var r=function(){if(!c.WORKERS_SUPPORTED)return!1;var i,a,o=(i=e.URL||e.webkitURL||null,a=t.toString(),c.BLOB_URL||(c.BLOB_URL=i.createObjectURL(new Blob(["(",a,")();"],{type:"text/javascript"})))),r=new e.Worker(o);return r.onmessage=f,r.id=s++,n[r.id]=r}();return r.userStep=a.step,r.userChunk=a.chunk,r.userComplete=a.complete,r.userError=a.error,a.step=E(a.step),a.chunk=E(a.chunk),a.complete=E(a.complete),a.error=E(a.error),delete a.worker,void r.postMessage({input:i,config:a,workerId:r.id})}var p=null;return"string"==typeof i?p=a.download?new l(a):new b(a):!0===i.readable&&E(i.read)&&E(i.on)?p=new m(a):(e.File&&i instanceof File||i instanceof Object)&&(p=new d(a)),p.stream(i)},unparse:function(t,e){var i=!1,a=!0,n=",",s="\r\n",o='"',r=o+o,l=!1,d=null,b=!1;!function(){if("object"==typeof e){if("string"!=typeof e.delimiter||c.BAD_DELIMITERS.filter((function(t){return-1!==e.delimiter.indexOf(t)})).length||(n=e.delimiter),("boolean"==typeof e.quotes||"function"==typeof e.quotes||Array.isArray(e.quotes))&&(i=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(l=e.skipEmptyLines),"string"==typeof e.newline&&(s=e.newline),"string"==typeof e.quoteChar&&(o=e.quoteChar),"boolean"==typeof e.header&&(a=e.header),Array.isArray(e.columns)){if(0===e.columns.length)throw new Error("Option columns is empty");d=e.columns}void 0!==e.escapeChar&&(r=e.escapeChar+o),"boolean"==typeof e.escapeFormulae&&(b=e.escapeFormulae)}}();var m=new RegExp(u(o),"g");if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return h(null,t,l);if("object"==typeof t[0])return h(d||p(t[0]),t,l)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:p(t.data[0])),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),h(t.fields||[],t.data||[],l);throw new Error("Unable to serialize unrecognized input");function p(t){if("object"!=typeof t)return[];var e=[];for(var i in t)e.push(i);return e}function h(t,e,i){var c="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var o=Array.isArray(t)&&0<t.length,r=!Array.isArray(e[0]);if(o&&a){for(var l=0;l<t.length;l++)0<l&&(c+=n),c+=f(t[l],l);0<e.length&&(c+=s)}for(var d=0;d<e.length;d++){var b=o?t.length:e[d].length,m=!1,p=o?0===Object.keys(e[d]).length:0===e[d].length;if(i&&!o&&(m="greedy"===i?""===e[d].join("").trim():1===e[d].length&&0===e[d][0].length),"greedy"===i&&o){for(var u=[],h=0;h<b;h++)u.push(e[d][r?t[h]:h]);m=""===u.join("").trim()}if(!m){for(var g=0;g<b;g++)0<g&&!p&&(c+=n),c+=f(e[d][o&&r?t[g]:g],g);d<e.length-1&&(!i||0<b&&!p)&&(c+=s)}}return c}function f(t,e){if(null==t)return"";if(t.constructor===Date)return JSON.stringify(t).slice(1,25);!0===b&&"string"==typeof t&&null!==t.match(/^[=+\-@].*$/)&&(t="'"+t);var a=t.toString().replace(m,r);return"boolean"==typeof i&&i||"function"==typeof i&&i(t,e)||Array.isArray(i)&&i[e]||function(t,e){for(var i=0;i<e.length;i++)if(-1<t.indexOf(e[i]))return!0;return!1}(a,c.BAD_DELIMITERS)||-1<a.indexOf(n)||" "===a.charAt(0)||" "===a.charAt(a.length-1)?o+a+o:a}}};if(c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\ufeff",c.BAD_DELIMITERS=["\r","\n",'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!e.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=h,c.ParserHandle=p,c.NetworkStreamer=l,c.FileStreamer=d,c.StringStreamer=b,c.ReadableStreamStreamer=m,e.jQuery){var o=e.jQuery;o.fn.parse=function(t){var i=t.config||{},a=[];return this.each((function(t){if("INPUT"!==o(this).prop("tagName").toUpperCase()||"file"!==o(this).attr("type").toLowerCase()||!e.FileReader||!this.files||0===this.files.length)return!0;for(var n=0;n<this.files.length;n++)a.push({file:this.files[n],inputElem:this,instanceConfig:o.extend({},i)})})),n(),this;function n(){if(0!==a.length){var e,i,n,r=a[0];if(E(t.before)){var l=t.before(r.file,r.inputElem);if("object"==typeof l){if("abort"===l.action)return e=r.file,i=r.inputElem,n=l.reason,void(E(t.error)&&t.error({name:"AbortError"},e,i,n));if("skip"===l.action)return void s();"object"==typeof l.config&&(r.instanceConfig=o.extend(r.instanceConfig,l.config))}else if("skip"===l)return void s()}var d=r.instanceConfig.complete;r.instanceConfig.complete=function(t){E(d)&&d(t,r.file,r.inputElem),s()},c.parse(r.file,r.instanceConfig)}else E(t.complete)&&t.complete()}function s(){a.splice(0,1),n()}}}function r(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var e=y(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new p(e),(this._handle.streamer=this)._config=e}).call(this,t),this.parseChunk=function(t,i){if(this.isFirstChunk&&E(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(t);void 0!==n&&(t=n)}this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t;this._partialLine="";var o=this._handle.parse(s,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var r=o.meta.cursor;this._finished||(this._partialLine=s.substring(r-this._baseIndex),this._baseIndex=r),o&&o.data&&(this._rowCount+=o.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)e.postMessage({results:o,workerId:c.WORKER_ID,finished:l});else if(E(this._config.chunk)&&!i){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);o=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!l||!E(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(t){E(this._config.error)?this._config.error(t):a&&this._config.error&&e.postMessage({workerId:c.WORKER_ID,error:t,finished:!1})}}function l(t){var e;(t=t||{}).chunkSize||(t.chunkSize=c.RemoteChunkSize),r.call(this,t),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),i||(e.onload=C(this._chunkLoaded,this),e.onerror=C(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var a in t)e.setRequestHeader(a,t[a])}this._config.chunkSize&&e.setRequestHeader("Range","bytes="+this._start+"-"+(this._start+this._config.chunkSize-1));try{e.send(this._config.downloadRequestBody)}catch(t){this._chunkError(t.message)}i&&0===e.status&&this._chunkError()}},this._chunkLoaded=function(){4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:e.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(t){var e=t.getResponseHeader("Content-Range");return null===e?-1:parseInt(e.substring(e.lastIndexOf("/")+1))}(e),this.parseChunk(e.responseText)))},this._chunkError=function(t){this._sendError(new Error(e.statusText||t))}}function d(t){var e,i;(t=t||{}).chunkSize||(t.chunkSize=c.LocalChunkSize),r.call(this,t);var a="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,i=t.slice||t.webkitSlice||t.mozSlice,a?((e=new FileReader).onload=C(this._chunkLoaded,this),e.onerror=C(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var n=Math.min(this._start+this._config.chunkSize,this._input.size);t=i.call(t,this._start,n)}var s=e.readAsText(t,this._config.encoding);a||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function b(t){var e;r.call(this,t=t||{}),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t,i=this._config.chunkSize;return i?(t=e.substring(0,i),e=e.substring(i)):(t=e,e=""),this._finished=!e,this.parseChunk(t)}}}function m(t){r.call(this,t=t||{});var e=[],i=!0,a=!1;this.pause=function(){r.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){r.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){a&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):i=!0},this._streamData=C((function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}}),this),this._streamError=C((function(t){this._streamCleanUp(),this._sendError(t)}),this),this._streamEnd=C((function(){this._streamCleanUp(),a=!0,this._streamData("")}),this),this._streamCleanUp=C((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function p(t){var e,i,a,n=Math.pow(2,53),s=-n,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,r=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,l=this,d=0,b=0,m=!1,p=!1,f=[],g={data:[],errors:[],meta:{}};if(E(t.step)){var v=t.step;t.step=function(e){if(g=e,M())S();else{if(S(),0===g.data.length)return;d+=e.data.length,t.preview&&d>t.preview?i.abort():(g.data=g.data[0],v(g,l))}}}function C(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function S(){if(g&&a&&(Z("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),a=!1),t.skipEmptyLines)for(var e=0;e<g.data.length;e++)C(g.data[e])&&g.data.splice(e--,1);return M()&&function(){if(g)if(Array.isArray(g.data[0])){for(var e=0;M()&&e<g.data.length;e++)g.data[e].forEach(i);g.data.splice(0,1)}else g.data.forEach(i);function i(e,i){E(t.transformHeader)&&(e=t.transformHeader(e,i)),f.push(e)}}(),function(){if(!g||!t.header&&!t.dynamicTyping&&!t.transform)return g;function e(e,i){var a,n=t.header?{}:[];for(a=0;a<e.length;a++){var s=a,c=e[a];t.header&&(s=a>=f.length?"__parsed_extra":f[a]),t.transform&&(c=t.transform(c,s)),c=Y(s,c),"__parsed_extra"===s?(n[s]=n[s]||[],n[s].push(c)):n[s]=c}return t.header&&(a>f.length?Z("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+a,b+i):a<f.length&&Z("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+a,b+i)),n}var i=1;return!g.data.length||Array.isArray(g.data[0])?(g.data=g.data.map(e),i=g.data.length):g.data=e(g.data,0),t.header&&g.meta&&(g.meta.fields=f),b+=i,g}()}function M(){return t.header&&0===f.length}function Y(e,i){return a=e,t.dynamicTypingFunction&&void 0===t.dynamicTyping[a]&&(t.dynamicTyping[a]=t.dynamicTypingFunction(a)),!0===(t.dynamicTyping[a]||t.dynamicTyping)?"true"===i||"TRUE"===i||"false"!==i&&"FALSE"!==i&&(function(t){if(o.test(t)){var e=parseFloat(t);if(s<e&&e<n)return!0}return!1}(i)?parseFloat(i):r.test(i)?new Date(i):""===i?null:i):i;var a}function Z(t,e,i,a){var n={type:t,code:e,message:i};void 0!==a&&(n.row=a),g.errors.push(n)}this.parse=function(n,s,o){if(t.newline||(t.newline=function(t,e){t=t.substring(0,1048576);var i=new RegExp(u(e)+"([^]*?)"+u(e),"gm"),a=(t=t.replace(i,"")).split("\r"),n=t.split("\n");if(1===a.length||1<n.length&&n[0].length<a[0].length)return"\n";for(var s=0,c=0;c<a.length;c++)"\n"===a[c][0]&&s++;return s>=a.length/2?"\r\n":"\r"}(n,t.quoteChar||'"')),a=!1,t.delimiter)E(t.delimiter)&&(t.delimiter=t.delimiter(n),g.meta.delimiter=t.delimiter);else{var r=function(e,i,a,n,s){var o,r,l,d;s=s||[",","\t","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var b=0;b<s.length;b++){var m=s[b],p=0,u=0,f=0;l=void 0;for(var g=new h({comments:n,delimiter:m,newline:i,preview:10}).parse(e),v=0;v<g.data.length;v++)if(a&&C(g.data[v]))f++;else{var y=g.data[v].length;u+=y,void 0!==l?0<y&&(p+=Math.abs(y-l),l=y):l=y}0<g.data.length&&(u/=g.data.length-f),(void 0===r||p<=r)&&(void 0===d||d<u)&&1.99<u&&(r=p,o=m,d=u)}return{successful:!!(t.delimiter=o),bestDelimiter:o}}(n,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);r.successful?t.delimiter=r.bestDelimiter:(a=!0,t.delimiter=c.DefaultDelimiter),g.meta.delimiter=t.delimiter}var l=y(t);return t.preview&&t.header&&l.preview++,e=n,i=new h(l),g=i.parse(e,s,o),S(),m?{meta:{paused:!0}}:g||{meta:{paused:!1}}},this.paused=function(){return m},this.pause=function(){m=!0,i.abort(),e=E(t.chunk)?"":e.substring(i.getCharIndex())},this.resume=function(){l.streamer._halted?(m=!1,l.streamer.parseChunk(e,!0)):setTimeout(l.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,i.abort(),g.meta.aborted=!0,E(t.complete)&&t.complete(g),e=""}}function u(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function h(t){var e,i=(t=t||{}).delimiter,a=t.newline,n=t.comments,s=t.step,o=t.preview,r=t.fastMode,l=e=void 0===t.quoteChar?'"':t.quoteChar;if(void 0!==t.escapeChar&&(l=t.escapeChar),("string"!=typeof i||-1<c.BAD_DELIMITERS.indexOf(i))&&(i=","),n===i)throw new Error("Comment character same as delimiter");!0===n?n="#":("string"!=typeof n||-1<c.BAD_DELIMITERS.indexOf(n))&&(n=!1),"\n"!==a&&"\r"!==a&&"\r\n"!==a&&(a="\n");var d=0,b=!1;this.parse=function(t,c,m){if("string"!=typeof t)throw new Error("Input must be a string");var p=t.length,h=i.length,f=a.length,g=n.length,v=E(s),y=[],C=[],S=[],M=d=0;if(!t)return L();if(r||!1!==r&&-1===t.indexOf(e)){for(var Y=t.split(a),Z=0;Z<Y.length;Z++){if(d+=(S=Y[Z]).length,Z!==Y.length-1)d+=a.length;else if(m)return L();if(!n||S.substring(0,g)!==n){if(v){if(y=[],D(S.split(i)),j(),b)return L()}else D(S.split(i));if(o&&o<=Z)return y=y.slice(0,o),L(!0)}}return L()}for(var x=t.indexOf(i,d),_=t.indexOf(a,d),w=new RegExp(u(l)+u(e),"g"),O=t.indexOf(e,d);;)if(t[d]!==e)if(n&&0===S.length&&t.substring(d,d+g)===n){if(-1===_)return L();_=t.indexOf(a,d=_+f),x=t.indexOf(i,d)}else{if(-1!==x&&(x<_||-1===_)){if(!(x<O)){S.push(t.substring(d,x)),x=t.indexOf(i,d=x+h);continue}var T=R(x,O,_);if(T&&void 0!==T.nextDelim){O=T.quoteSearch,S.push(t.substring(d,x=T.nextDelim)),x=t.indexOf(i,d=x+h);continue}}if(-1===_)break;if(S.push(t.substring(d,_)),F(_+f),v&&(j(),b))return L();if(o&&y.length>=o)return L(!0)}else for(O=d,d++;;){if(-1===(O=t.indexOf(e,O+1)))return m||C.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:d}),P();if(O===p-1)return P(t.substring(d,O).replace(w,e));if(e!==l||t[O+1]!==l){if(e===l||0===O||t[O-1]!==l){-1!==x&&x<O+1&&(x=t.indexOf(i,O+1)),-1!==_&&_<O+1&&(_=t.indexOf(a,O+1));var k=U(-1===_?x:Math.min(x,_));if(t[O+1+k]===i){S.push(t.substring(d,O).replace(w,e)),t[d=O+1+k+h]!==e&&(O=t.indexOf(e,d)),x=t.indexOf(i,d),_=t.indexOf(a,d);break}var I=U(_);if(t.substring(O+1+I,O+1+I+f)===a){if(S.push(t.substring(d,O).replace(w,e)),F(O+1+I+f),x=t.indexOf(i,d),O=t.indexOf(e,d),v&&(j(),b))return L();if(o&&y.length>=o)return L(!0);break}C.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:y.length,index:d}),O++}}else O++}return P();function D(t){y.push(t),M=d}function U(e){var i=0;if(-1!==e){var a=t.substring(O+1,e);a&&""===a.trim()&&(i=a.length)}return i}function P(e){return m||(void 0===e&&(e=t.substring(d)),S.push(e),d=p,D(S),v&&j()),L()}function F(e){d=e,D(S),S=[],_=t.indexOf(a,d)}function L(t){return{data:y,errors:C,meta:{delimiter:i,linebreak:a,aborted:b,truncated:!!t,cursor:M+(c||0)}}}function j(){s(L()),y=[],C=[]}function R(a,n,s){var c={nextDelim:void 0,quoteSearch:void 0},o=t.indexOf(e,n+1);if(n<a&&a<o&&(o<s||-1===s)){var r=t.indexOf(i,o);if(-1===r)return c;o<r&&(o=t.indexOf(e,o+1)),c=R(r,o,s)}else c={nextDelim:a,quoteSearch:n};return c}},this.abort=function(){b=!0},this.getCharIndex=function(){return d}}function f(t){var e=t.data,i=n[e.workerId],a=!1;if(e.error)i.userError(e.error,e.file);else if(e.results&&e.results.data){var s={abort:function(){a=!0,g(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(E(i.userStep)){for(var c=0;c<e.results.data.length&&(i.userStep({data:e.results.data[c],errors:e.results.errors,meta:e.results.meta},s),!a);c++);delete e.results}else E(i.userChunk)&&(i.userChunk(e.results,s,e.file),delete e.results)}e.finished&&!a&&g(e.workerId,e.results)}function g(t,e){var i=n[t];E(i.userComplete)&&i.userComplete(e),i.terminate(),delete n[t]}function v(){throw new Error("Not implemented.")}function y(t){if("object"!=typeof t||null===t)return t;var e=Array.isArray(t)?[]:{};for(var i in t)e[i]=y(t[i]);return e}function C(t,e){return function(){t.apply(e,arguments)}}function E(t){return"function"==typeof t}return a&&(e.onmessage=function(t){var i=t.data;if(void 0===c.WORKER_ID&&i&&(c.WORKER_ID=i.workerId),"string"==typeof i.input)e.postMessage({workerId:c.WORKER_ID,results:c.parse(i.input,i.config),finished:!0});else if(e.File&&i.input instanceof File||i.input instanceof Object){var a=c.parse(i.input,i.config);a&&e.postMessage({workerId:c.WORKER_ID,results:a,finished:!0})}}),(l.prototype=Object.create(r.prototype)).constructor=l,(d.prototype=Object.create(r.prototype)).constructor=d,(b.prototype=Object.create(b.prototype)).constructor=b,(m.prototype=Object.create(r.prototype)).constructor=m,c})?a.apply(e,[]):a)||(t.exports=n)},aJGj:function(t,e,i){"use strict";var a=i("Q1FS");e.EMPTY=new a.Observable((function(t){return t.complete()})),e.empty=function(t){return t?function(t){return new a.Observable((function(e){return t.schedule((function(){return e.complete()}))}))}(t):e.EMPTY}},aPMI:function(t,e,i){"use strict";i.r(e),i.d(e,"AdministrationModule",(function(){return xE}));var a=i("vWc3"),n=i("cMWS"),s=i("tyNb"),c=i("LRne"),o=i("3Pt+"),r=i("JX91"),l=i("lJxs"),d=i("vkgz"),b=i("JIr8"),m=i("fXoL"),p=i("sYmb"),u=i("tk/3"),h=i("4zkx"),f=i("A6w4"),g=i("eiH7"),v=i("aEDk"),y=i("AXEc"),C=i("rH+9"),E=i("d7/a"),S=i("XhcP"),M=i("Ro8j"),Y=i("zZ42"),Z=i("F8Z3"),x=i("ofXK"),_=i("f0Cb"),w=i("kmnG"),O=i("qFsG"),T=i("Xa2L"),k=i("Wp6s"),I=i("FKr1"),D=i("bTqV"),U=i("1YbM");const P=["snav2"],F=["searchServiceInput"];function L(t,e){1&t&&(m.Zb(0,"div",18),m.Ub(1,"mat-spinner",19),m.Yb())}function j(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",20),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().goToSpecifiedAdministration(i)})),m.Zb(1,"div",21),m.Ub(2,"i",22),m.Yb(),m.Zb(3,"span",23),m.Sc(4),m.Yb(),m.Sc(5),m.mc(6,"translate"),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(2),m.Gb(t.style),m.Eb(2),m.Tc(t.count),m.Eb(1),m.Uc("\xa0 ",m.nc(6,5,t.label)," ")}}function R(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",24),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().goToSpecifiedAdministration(i)})),m.mc(1,"translate"),m.Zb(2,"div",25),m.Zb(3,"span",26),m.Ub(4,"i"),m.Yb(),m.Zb(5,"span",27),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.sc("joyrideStep",t.id)("title",m.nc(1,6,t.comment)),m.Eb(4),m.Hb("avatarCount2 ",t.style,""),m.Eb(2),m.Uc(" ",m.nc(7,8,t.label)," ")}}const Q=function(t){return{width:t}};let A=(()=>{class t{constructor(t,e,i,a,n,s,c,r,l,d){this.translate=t,this.http=e,this.router=i,this.headerService=a,this.appService=n,this.privilegeService=s,this.latinisePipe=c,this.notify=r,this.functionService=l,this.featureTourService=d,this.loading=!1,this.shortcutsAdmin=[],this.organisationServices=[],this.productionServices=[],this.classementServices=[],this.supervisionServices=[],this.searchService=new o.h,this.administrations=[]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")),this.organisationServices=this.privilegeService.getCurrentUserAdministrationsByUnit("organisation"),this.productionServices=this.privilegeService.getCurrentUserAdministrationsByUnit("production"),this.classementServices=this.privilegeService.getCurrentUserAdministrationsByUnit("classement"),this.supervisionServices=this.privilegeService.getCurrentUserAdministrationsByUnit("supervision"),this.administrations=this.organisationServices.concat(this.productionServices).concat(this.classementServices).concat(this.supervisionServices),this.shortcutsAdmin=this.administrations.filter(t=>["admin_users","admin_groups","manage_entities"].indexOf(t.id)>-1).map(t=>Object.assign(Object.assign({},t),{count:0})),this.getNbShortcuts(),this.filteredAdministrations=this.searchService.valueChanges.pipe(Object(r.a)(""),Object(l.a)(t=>this._filter(t,"administrations"))),this.loading=!1,setTimeout(()=>{this.searchServiceInput.nativeElement.focus()},0)}ngAfterViewInit(){"root_visible"!==this.headerService.user.mode&&"root_invisible"!==this.headerService.user.mode||this.featureTourService.init()}goToSpecifiedAdministration(t){!0===t.angular?this.router.navigate([t.route]):window.location.assign(t.route)}_filter(t,e){if("string"==typeof t){const i=this.latinisePipe.transform(t.toLowerCase());return this[e].filter(t=>this.latinisePipe.transform(t.label.toLowerCase()).includes(i))}return this[e]}getNbShortcuts(){this.http.get("../rest/administration/details").pipe(Object(d.a)(t=>{this.functionService.empty(t.count.users)||(this.shortcutsAdmin.filter(t=>"admin_users"===t.id)[0].count=t.count.users),this.functionService.empty(t.count.groups)||(this.shortcutsAdmin.filter(t=>"admin_groups"===t.id)[0].count=t.count.groups),this.functionService.empty(t.count.entities)||(this.shortcutsAdmin.filter(t=>"manage_entities"===t.id)[0].count=t.count.entities)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.c),m.Tb(h.a),m.Tb(f.a),m.Tb(g.a),m.Tb(v.c),m.Tb(y.a),m.Tb(C.a),m.Tb(E.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(P,!0),m.Oc(F,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.searchServiceInput=i.first))},decls:24,vars:22,consts:[[1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],["stepNumber","1","joyrideStep","firstStep","title","demoTour","text","Hi, Welcome to demo tour",1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content",2,"display","flex","flex-direction","column"],["class","loading",4,"ngIf"],[2,"display","grid","grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))","gap","20px","padding","20px"],["class","countCard","matRipple","",3,"click",4,"ngFor","ngForOf"],[2,"padding","10px","font-size","10px","width","250px !important"],["matInput","",3,"formControl","placeholder"],["searchServiceInput",""],[2,"margin","20px","display","grid","grid-template-columns","repeat(auto-fill, minmax(300px, 1fr))","gap","20px","padding","20px","padding-top","0px","margin-top","0px"],["mat-button","","style","font-size:20px;height:80px;",3,"joyrideStep","title","click",4,"ngFor","ngForOf"],["position","end","autoFocus","false",1,"panel-right",2,"overflow-x","hidden",3,"fixedInViewport","opened","mode","ngStyle"],["snav2",""],[1,"loading"],[2,"margin","auto"],["matRipple","",1,"countCard",3,"click"],["mat-card-avatar","",1,"avatarCount",2,"margin-right","10px"],[2,"position","absolute"],[2,"font-size","40px"],["mat-button","",2,"font-size","20px","height","80px",3,"joyrideStep","title","click"],[2,"display","flex","align-items","center"],[2,"padding-right","10px"],[1,"countLabel",2,"white-space","initial","text-align","left"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,L,2,0,"div",8),m.Zb(12,"div",9),m.Qc(13,j,7,7,"mat-card",10),m.Yb(),m.Ub(14,"mat-divider"),m.Zb(15,"mat-form-field",11),m.Ub(16,"input",12,13),m.Yb(),m.Zb(18,"div",14),m.Qc(19,R,8,10,"button",15),m.mc(20,"sortBy"),m.mc(21,"async"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(22,"mat-sidenav",16,17),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(2),m.sc("ngForOf",e.shortcutsAdmin),m.Eb(3),m.sc("formControl",e.searchService)("placeholder",e.translate.instant("lang.filterBy")),m.Eb(3),m.sc("ngForOf",m.oc(20,15,m.nc(21,18,e.filteredAdministrations),"label")),m.Eb(3),m.sc("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1))("mode",e.appService.getViewMode()?"over":"side")("ngStyle",m.zc(20,Q,e.appService.getViewMode()?"80%":"30%")))},directives:[S.e,S.f,M.a,Y.a,Z.a,x.t,x.s,_.a,w.c,O.b,o.c,o.t,o.i,S.d,x.w,T.c,k.a,I.t,k.c,D.b],pipes:[U.a,x.b,p.d],styles:[".adminArea[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}.adminArea_1[_ngcontent-%COMP%]{flex:1}.adminArea_1[_ngcontent-%COMP%], .adminArea_2[_ngcontent-%COMP%], .adminArea_3[_ngcontent-%COMP%], .adminArea_4[_ngcontent-%COMP%]{overflow:hidden;padding:20px}.loading[_ngcontent-%COMP%]{display:flex;height:100%}.adminArea-label[_ngcontent-%COMP%]{font-size:20px;font-weight:bolder;opacity:.2;text-align:center}.adminArea-button[_ngcontent-%COMP%]{white-space:inherit;height:100px;line-height:20px} .autocompleteServices .mat-optgroup-label{position:-webkit-sticky;position:sticky;top:0;background:#fff;z-index:1}.countCard[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;height:100px;color:#fff;background:#135f7f;cursor:pointer}.avatarCount[_ngcontent-%COMP%]{color:#135f7f;font-size:20px;background:#fff}.avatarCount[_ngcontent-%COMP%], .avatarCount2[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;border-radius:40px;padding:10px}.avatarCount2[_ngcontent-%COMP%]{color:#fff;font-size:30px;background:#135f7f;width:55px!important;height:55px!important}.countLabel[_ngcontent-%COMP%]{color:#135f7f;font-size:16px}"]}),t})();var H=i("0IaG"),z=i("M9IT"),V=i("Dh3D"),N=i("I65S"),J=i("rNzc"),G=i("+0xr"),B=i("2c88"),W=i("pLZG"),q=i("XqQ8"),X=i("SIQe"),K=i("5cI5"),tt=i("/t3+"),et=i("1jcm"),it=i("w9N8"),at=i("d3UM");function nt(t,e){1&t&&(m.Xb(0),m.Zb(1,"div",18),m.Ub(2,"mat-spinner"),m.Yb(),m.Wb())}function st(t,e){if(1&t&&(m.Zb(0,"mat-option",32),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ","\t"===t?"TAB":t," ")}}function ct(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",28),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(1).click()}))("onFileDropped",(function(e){return m.Hc(t),m.lc(2).dndUploadFile(e)})),m.Zb(1,"div"),m.Sc(2),m.mc(3,"translate"),m.Zb(4,"mat-form-field",29),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.Zb(5,"mat-label"),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Zb(8,"mat-select",30),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).currentDelimiter=e}))("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.Qc(9,st,2,2,"mat-option",31),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Uc(" ",m.nc(3,4,"lang.dndFileCsvDesc")," "),m.Eb(4),m.Tc(m.nc(7,6,"lang.delimiter")),m.Eb(2),m.sc("ngModel",t.currentDelimiter),m.Eb(1),m.sc("ngForOf",t.delimiters)}}function ot(t,e){if(1&t&&(m.Zb(0,"mat-option",32),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function rt(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-header-cell"),m.Ub(1,"i",41),m.mc(2,"translate"),m.Sc(3,"\xa0"),m.Zb(4,"b",42),m.mc(5,"translate"),m.Sc(6),m.Yb(),m.Sc(7," \xa0"),m.Ub(8,"i",43),m.Sc(9,"\xa0 "),m.Ub(10,"i",44),m.mc(11,"translate"),m.Sc(12,"\xa0"),m.Zb(13,"mat-form-field",45),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.mc(14,"translate"),m.Zb(15,"mat-select",46),m.hc("ngModelChange",(function(e){m.Hc(t);const i=m.lc().$implicit;return m.lc(3).associatedColmuns[i]=e}))("selectionChange",(function(e){m.Hc(t);const i=m.lc().$implicit;return m.lc(3).changeColumn(i,e.value)})),m.Ub(16,"mat-option",47),m.Qc(17,ot,2,2,"mat-option",31),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(3);m.Eb(1),m.sc("title",m.nc(2,7,"lang.dbColumn")),m.Eb(3),m.sc("title",m.nc(5,9,"lang.dbColumn")),m.Eb(2),m.Tc(t),m.Eb(4),m.sc("title",m.nc(11,11,"lang.csvColumn")),m.Eb(3),m.sc("title",m.nc(14,13,"lang.csvColumn")),m.Eb(2),m.sc("ngModel",e.associatedColmuns[t]),m.Eb(2),m.sc("ngForOf",e.csvColumns)}}function lt(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc().$implicit;m.Eb(1),m.Uc(" ",t[i]," ")}}function dt(t,e){if(1&t&&(m.Xb(0),m.Xb(1,38),m.Qc(2,rt,18,15,"mat-header-cell",39),m.Qc(3,lt,2,1,"mat-cell",40),m.Wb(),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("matColumnDef",t)}}function bt(t,e){1&t&&m.Ub(0,"mat-header-row")}function mt(t,e){1&t&&m.Ub(0,"mat-row")}function pt(t,e){if(1&t&&(m.Zb(0,"mat-table",33,34),m.Qc(2,dt,4,1,"ng-container",35),m.Qc(3,bt,1,0,"mat-header-row",36),m.Qc(4,mt,1,0,"mat-row",37),m.Yb()),2&t){const t=m.lc(2);m.sc("dataSource",t.dataSource),m.Eb(2),m.sc("ngForOf",t.userColmuns),m.Eb(1),m.sc("matHeaderRowDef",t.userColmuns),m.Eb(1),m.sc("matRowDefColumns",t.userColmuns)}}function ut(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",19,20),m.hc("change",(function(e){return m.Hc(t),m.lc().uploadCsv(e)})),m.Yb(),m.Qc(2,ct,10,8,"div",21),m.Zb(3,"div",22),m.Zb(4,"div",23),m.Ub(5,"mat-paginator",24,25),m.Yb(),m.Yb(),m.Qc(7,pt,5,4,"mat-table",26),m.Ub(8,"div",27),m.mc(9,"translate"),m.Ub(10,"div",27),m.mc(11,"translate")}if(2&t){const t=m.lc();m.Eb(2),m.sc("ngIf",0===t.csvData.length),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("ngIf",t.csvData.length>0),m.Eb(1),m.sc("innerHTML",m.nc(9,7,"lang.infoImportusers"),m.Ic),m.Eb(2),m.sc("innerHTML",m.nc(11,9,"lang.infoImportusers2"),m.Ic)}}function ht(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",48),m.hc("click",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc();m.sc("disabled",t.loading),m.Eb(1),m.Tc(m.nc(2,2,"lang.validate"))}}let ft=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.functionsService=a,this.localStorage=n,this.headerService=s,this.dialog=c,this.dialogRef=o,this.data=r,this.loading=!1,this.userColmuns=["id","user_id","firstname","lastname","mail","phone"],this.csvColumns=[],this.delimiters=[";",",","\t"],this.currentDelimiter=";",this.associatedColmuns={},this.dataSource=new G.o(null),this.hasHeader=!0,this.csvData=[],this.userData=[],this.countAll=0,this.countAdd=0,this.countUp=0}ngOnInit(){this.setConfiguration()}changeColumn(t,e){this.userData=[];for(let i=this.hasHeader?1:0;i<this.csvData.length;i++){const a=this.csvData[i];this.userData.push({id:"id"===t?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns.id],user_id:"user_id"===t?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns.user_id],firstname:"firstname"===t?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns.firstname],lastname:"lastname"===t?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns.lastname],mail:"mail"===t?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns.mail],phone:"phone"===t?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns.phone]})}this.countAdd=this.csvData.filter((t,e)=>e>0&&this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>e>0&&!this.functionsService.empty(t[this.associatedColmuns.id])).length,setTimeout(()=>{this.dataSource=new G.o(this.userData),this.dataSource.paginator=this.paginator},0)}uploadCsv(t){if(t.target.files&&t.target.files[0]&&("text/csv"===t.target.files[0].type||"application/vnd.ms-excel"===t.target.files[0].type)){this.loading=!0;let e=[];const i=new FileReader;i.readAsText(t.target.files[0],"ISO-8859-1"),i.onload=t=>{if(e=t.target.result.split("\n"),e=e.filter(t=>""!==t),e[0].split(this.currentDelimiter).map(t=>t.replace(/"/gi,"").trim()).length>=this.userColmuns.length-1){let t=[],i={};this.setCsvColumns(e[0].split(this.currentDelimiter).map(t=>t.replace(/"/gi,"").trim())),this.countAll=this.hasHeader?e.length-1:e.length;for(let a=0;a<e.length;a++)i={},t=e[a].split(this.currentDelimiter).map(t=>t.replace(/"/gi,"").trim()),t.forEach((t,e)=>{i[this.csvColumns[e]]=t}),this.csvData.push(i);this.initData(),this.countAdd=this.csvData.filter((t,e)=>e>0&&this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>e>0&&!this.functionsService.empty(t[this.associatedColmuns.id])).length,this.localStorage.save("importUsersFields_"+this.headerService.user.id,this.currentDelimiter)}else this.notify.error(this.translate.instant("lang.mustAtLeastMinValues"));this.loading=!1}}else this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.notAllowedExtension")+" !",msg:this.translate.instant("lang.file")+" : <b>"+t.target.files[0].name+"</b>, "+this.translate.instant("lang.type")+" : <b>"+t.target.files[0].type+"</b><br/><br/><u>"+this.translate.instant("lang.allowedExtensions")+"</u> : <br/>text/csv"}})}setCsvColumns(t=null){this.csvColumns=t.filter(t=>this.functionsService.empty(t)).length>0?Object.keys(t).map((t,e)=>""+e):t}toggleHeader(){this.hasHeader=!this.hasHeader,this.countAll=this.hasHeader?this.csvData.length-1:this.csvData.length,this.hasHeader?(this.countAdd=this.csvData.filter((t,e)=>e>0&&this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>e>0&&!this.functionsService.empty(t[this.associatedColmuns.id])).length):(this.countAdd=this.csvData.filter((t,e)=>this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>!this.functionsService.empty(t[this.associatedColmuns.id])).length),this.initData()}initData(){this.userData=[];for(let t=this.hasHeader?1:0;t<this.csvData.length;t++){const e=this.csvData[t];this.associatedColmuns.id=this.csvColumns[0],this.associatedColmuns.user_id=this.csvColumns[1],this.associatedColmuns.firstname=this.csvColumns[2],this.associatedColmuns.lastname=this.csvColumns[3],this.associatedColmuns.mail=this.csvColumns[4],this.associatedColmuns.phone=this.csvColumns[5],this.userData.push({id:e[this.csvColumns[0]],user_id:e[this.csvColumns[1]],firstname:e[this.csvColumns[2]],lastname:e[this.csvColumns[3]],mail:e[this.csvColumns[4]],phone:e[this.csvColumns[5]]})}setTimeout(()=>{this.dataSource=new G.o(this.userData),this.dataSource.paginator=this.paginator},0)}dndUploadFile(t){this.uploadCsv({target:{files:[t[0]]}})}onSubmit(){const t=[];let e="";this.translate.get("lang.confirmImportUsers",{0:this.countAll}).subscribe(t=>{e=t+" ?<br/><br/>",e+=`<ul><li><b>${this.countAdd}</b> ${this.translate.instant("lang.additions")}</li><li><b>${this.countUp}</b> ${this.translate.instant("lang.modifications")}</li></ul>`});let i=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.import"),msg:e}});i.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(d.a)(()=>{this.loading=!0,this.csvData.forEach((e,i)=>{(this.hasHeader&&i>0||!this.hasHeader)&&t.push({id:e[this.associatedColmuns.id],user_id:e[this.associatedColmuns.user_id],firstname:e[this.associatedColmuns.firstname],lastname:e[this.associatedColmuns.lastname],mail:e[this.associatedColmuns.mail],phone:e[this.associatedColmuns.phone]})})}),Object(q.a)(()=>this.http.put("../rest/users/import",{users:t})),Object(d.a)(t=>{let e="";t.warnings.count>0&&(e=`<br/>${t.warnings.count} ${this.translate.instant("lang.withWarnings")}  : <ul>`,t.warnings.details.forEach(t=>{e+=`<li> ${this.translate.instant("lang."+t.lang)} (${this.translate.instant("lang.line")} : ${this.hasHeader?t.index+2:t.index+1})</li>`}),e+="</ul>"),t.errors.count>0&&(e+=`<br/>${t.errors.count} ${this.translate.instant("lang.withErrors")}  : <ul>`,t.errors.details.forEach(t=>{e+=`<li> ${this.translate.instant("lang."+t.lang)} (${this.translate.instant("lang.line")} : ${this.hasHeader?t.index+2:t.index+1})</li>`}),e+="</ul>"),i=this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.import"),msg:"<b>"+t.success+"</b> / <b>"+this.countAll+"</b> "+this.translate.instant("lang.importedUsers")+"."+e}})}),Object(q.a)(()=>i.afterClosed()),Object(d.a)(()=>{this.dialogRef.close("success")}),Object(b.a)(t=>(this.loading=!1,this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}setConfiguration(){null!==this.localStorage.get("importUsersFields_"+this.headerService.user.id)&&(this.currentDelimiter=this.localStorage.get("importUsersFields_"+this.headerService.user.id))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(C.a),m.Tb(K.a),m.Tb(h.a),m.Tb(H.b),m.Tb(H.h),m.Tb(H.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.ad(z.a,!0),2&t&&m.Cc(i=m.ic())&&(e.paginator=i.first)},decls:37,vars:28,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"import-tool"],[2,"flex","1"],["color","primary",3,"checked","change"],[2,"flex","1","text-align","center"],["color","primary",1,"fa","fa-users"],["color","primary"],["color","primary",1,"fa","fa-user-plus"],[2,"flex","1","text-align","right"],["color","primary",1,"fa","fa-user-edit"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","mat-button","",3,"disabled","mat-dialog-close"],[1,"loader"],["type","file","name","files[]","id","uploadFile","accept",".csv",2,"display","none",3,"change"],["uploadFile",""],["appUploadFileDragDrop","","class","dndFile",3,"click","onFileDropped",4,"ngIf"],[1,"row",2,"margin","0px"],[1,"col-md-12"],[3,"length","hidePageSize","pageSize"],["paginator",""],[3,"dataSource",4,"ngIf"],[1,"alert-message","alert-message-info",2,"min-width","100%",3,"innerHTML"],["appUploadFileDragDrop","",1,"dndFile",3,"click","onFileDropped"],["appearance","outline",2,"font-size","14px",3,"click"],[3,"ngModel","ngModelChange","click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"dataSource"],["table",""],[4,"ngFor","ngForOf"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],[4,"matHeaderCellDef"],[4,"matCellDef"],["color","primary",1,"fas","fa-database",3,"title"],["color","primary",3,"title"],[1,"fas","fa-arrows-alt-h"],[1,"fas","fa-file-csv",3,"title"],[2,"width","80px !important",3,"title","click"],[3,"ngModel","ngModelChange","selectionChange"],["value",""],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",2),m.Zb(5,"mat-toolbar",3),m.Zb(6,"span",4),m.Zb(7,"mat-slide-toggle",5),m.hc("change",(function(){return e.toggleHeader()})),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Zb(10,"span",6),m.Ub(11,"i",7),m.Sc(12),m.mc(13,"translate"),m.Zb(14,"b",8),m.Sc(15),m.Yb(),m.Yb(),m.Zb(16,"span",6),m.Ub(17,"i",9),m.Sc(18),m.mc(19,"translate"),m.Zb(20,"b",8),m.Sc(21),m.Yb(),m.Yb(),m.Zb(22,"span",10),m.Ub(23,"i",11),m.Sc(24),m.mc(25,"translate"),m.Zb(26,"b",8),m.Sc(27),m.Yb(),m.Yb(),m.Yb(),m.Qc(28,nt,3,0,"ng-container",12),m.Qc(29,ut,12,11,"ng-template",null,13,m.Rc),m.Yb(),m.Ub(31,"span",14),m.Zb(32,"div",15),m.Qc(33,ht,3,4,"button",16),m.Zb(34,"button",17),m.Sc(35),m.mc(36,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(30);m.Eb(2),m.Tc(m.nc(3,16,"lang.usersImport")),m.Eb(3),m.Jb("hide",0===e.csvData.length||e.loading),m.Eb(2),m.sc("checked",e.hasHeader),m.Eb(1),m.Tc(m.nc(9,18,"lang.csvHeader")),m.Eb(4),m.Uc("\xa0",m.nc(13,20,"lang.usersOfFile")," : "),m.Eb(3),m.Tc(e.countAll),m.Eb(3),m.Uc("\xa0",m.nc(19,22,"lang.additions")," : "),m.Eb(3),m.Tc(e.countAdd),m.Eb(3),m.Uc("\xa0",m.nc(25,24,"lang.modifications")," : "),m.Eb(3),m.Tc(e.countUp),m.Eb(1),m.sc("ngIf",e.loading)("ngIfElse",t),m.Eb(5),m.sc("ngIf",e.csvData.length>0),m.Eb(1),m.sc("disabled",e.loading),m.Eb(1),m.Tc(m.nc(36,26,"lang.cancel"))}},directives:[H.i,H.f,tt.a,et.a,x.t,H.c,D.b,H.d,T.c,z.a,it.a,w.c,w.g,at.a,o.t,o.w,x.s,I.o,G.n,G.k,G.m,G.c,G.i,G.b,G.h,G.a,G.j,G.l],pipes:[p.d],styles:[".loader[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center;justify-content:center}.hide[_ngcontent-%COMP%]{display:none}.import-tool[_ngcontent-%COMP%]{font-size:14px}.dndFile[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;margin:0;justify-content:center;font-size:30px;opacity:.5!important;cursor:pointer}"]}),t})();var gt=i("mrSG"),vt=i("nYR2");const yt=["listFilter"];function Ct(t,e){1&t&&(m.Zb(0,"div",13),m.Ub(1,"mat-spinner"),m.Yb())}function Et(t,e){if(1&t&&(m.Zb(0,"mat-option",14),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function St(t,e){if(1&t&&(m.Zb(0,"mat-option",14),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function Mt(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",15),m.Zb(1,"mat-form-field",5),m.Zb(2,"mat-label"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"mat-select",16),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().exportModel.delimiter=e})),m.mc(6,"translate"),m.Qc(7,St,2,2,"mat-option",7),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(3),m.Tc(m.nc(4,5,"lang.delimiter")),m.Eb(2),m.tc("placeholder",m.nc(6,7,"lang.delimiter")),m.sc("ngModel",t.exportModel.delimiter)("disabled","csv"!=t.exportModel.format),m.Eb(2),m.sc("ngForOf",t.delimiters)}}let Yt=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.notify=i,this.data=a,this.localStorage=n,this.headerService=s,this.loading=!1,this.loadingExport=!1,this.delimiters=[";",",","TAB"],this.formats=["csv"],this.exportModel={delimiter:";",format:"csv"}}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){this.setConfiguration()}))}exportData(){this.localStorage.save("exportUsersFields_"+this.headerService.user.id,JSON.stringify(this.exportModel)),this.loadingExport=!0,this.http.put("../rest/users/export",this.exportModel,{responseType:"blob"}).pipe(Object(d.a)(t=>{if("text/html"!==t.type){const e=document.createElement("a");let i,a,n,s;e.href=window.URL.createObjectURL(t),i=new Date,a=i.getDate(),n=i.getMonth()+1,s=i.getFullYear(),a<10&&(a="0"+a),n<10&&(n="0"+n),i=a+"-"+n+"-"+s,e.setAttribute("download","export_users_maarch_"+i+"."+this.exportModel.format.toLowerCase()),document.body.appendChild(e),e.click()}else alert(this.translate.instant("lang.tooMuchDatas"))}),Object(vt.a)(()=>this.loadingExport=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}setConfiguration(){null!==this.localStorage.get("exportUsersFields_"+this.headerService.user.id)&&(this.exportModel.delimiter=JSON.parse(this.localStorage.get("exportUsersFields_"+this.headerService.user.id)).delimiter)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.a),m.Tb(K.a),m.Tb(h.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(yt,!0),2&t&&m.Cc(i=m.ic())&&(e.listFilter=i.first)},decls:24,vars:23,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["mat-dialog-content",""],["class","loader",4,"ngIf"],[1,"row"],["appearance","outline"],[3,"placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","col-md-9",4,"ngIf"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"click"],["mat-raised-button","","mat-button","",3,"mat-dialog-close"],[1,"loader"],[3,"value"],[1,"col-md-9"],[3,"placeholder","ngModel","disabled","ngModelChange"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",2),m.Qc(5,Ct,2,0,"div",3),m.Zb(6,"div",4),m.Zb(7,"div"),m.Zb(8,"mat-form-field",5),m.Zb(9,"mat-label"),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Zb(12,"mat-select",6),m.hc("ngModelChange",(function(t){return e.exportModel.format=t})),m.mc(13,"translate"),m.Qc(14,Et,2,2,"mat-option",7),m.Yb(),m.Yb(),m.Yb(),m.Qc(15,Mt,8,9,"div",8),m.Yb(),m.Yb(),m.Ub(16,"span",9),m.Zb(17,"div",10),m.Zb(18,"button",11),m.hc("click",(function(){return e.exportData()})),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"button",12),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,13,"lang.exportDatas")),m.Eb(3),m.sc("ngIf",e.loadingExport),m.Eb(2),m.Jb("col-md-12","csv"!=e.exportModel.format)("col-md-3","csv"==e.exportModel.format),m.Eb(3),m.Tc(m.nc(11,15,"lang.format")),m.Eb(2),m.tc("placeholder",m.nc(13,17,"lang.format")),m.sc("ngModel",e.exportModel.format),m.Eb(2),m.sc("ngForOf",e.formats),m.Eb(1),m.sc("ngIf","csv"==e.exportModel.format),m.Eb(4),m.Tc(m.nc(20,19,"lang.toExport")),m.Eb(3),m.Tc(m.nc(23,21,"lang.cancel")))},directives:[H.i,H.f,x.t,w.c,w.g,at.a,o.t,o.w,x.s,H.c,D.b,H.d,T.c,I.o],pipes:[p.d],styles:[".mat-dialog-container{position:relative}.mat-dialog-content[_ngcontent-%COMP%]{min-height:150px;padding-bottom:10px;overflow-x:hidden}.actions[_ngcontent-%COMP%], .loader[_ngcontent-%COMP%]{justify-content:center}.loader[_ngcontent-%COMP%]{position:absolute;display:flex;width:100%;left:0;top:0;height:100%;background:hsla(0,0%,100%,.6);z-index:1;align-items:center}"]}),t})();var Zt=i("pWCv"),xt=i("6eB1"),_t=i("RmLz");let wt=(()=>{class t{constructor(t,e,i,a){this.notify=t,this.headerService=e,this.functionsService=i,this.localStorage=a,this.filters={},this.defaultFilters={admin_users:{sort:"user_id",sortDirection:"asc",page:0,field:""},admin_actions:{sort:"id",sortDirection:"asc",page:0,field:""},admin_baskets:{sort:"basket_id",sortDirection:"asc",page:0,field:""},admin_contacts_groups:{sort:"label",sortDirection:"asc",page:0,field:""},admin_listmodels:{sort:"title",sortDirection:"asc",page:0,field:""},admin_groups:{sort:"group_desc",sortDirection:"asc",page:0,field:""},admin_indexing_models:{sort:"label",sortDirection:"asc",page:0,field:""},admin_notif:{sort:"notification_id",sortDirection:"asc",page:0,field:""},admin_parameters:{sort:"id",sortDirection:"asc",page:0,field:""},admin_priorities:{sort:"label",sortDirection:"asc",page:0,field:""},admin_shippings:{sort:"label",sortDirection:"asc",page:0,field:""},admin_status:{sort:"label_status",sortDirection:"asc",page:0,field:""},admin_tag:{sort:"label",sortDirection:"asc",page:0,field:""},admin_templates:{sort:"template_label",sortDirection:"asc",page:0,field:""},admin_alfresco:{sort:"label",sortDirection:"asc",page:0,field:""},admin_contacts_list:{sort:"lastname",sortDirection:"asc",page:0,field:""},admin_regitered_mail_issuing_site:{sort:"accountNumber",sortDirection:"asc",page:0,field:""},admin_regitered_mail:{sort:"rangeNumber",sortDirection:"asc",page:0,field:""}},this.searchTerm=new o.h(""),this.currentAdminId="",null!==this.localStorage.get("filtersAdmin_"+this.headerService.user.id)&&(this.filters=JSON.parse(this.localStorage.get("filtersAdmin_"+this.headerService.user.id)))}setAdminId(t){this.currentAdminId=t}setDataSource(t,e,i,a,n){this.currentAdminId=t,this.searchTerm=new o.h(""),this.searchTerm.valueChanges.pipe(Object(Zt.tap)(t=>{this.setFilter("field",t),this.saveFilter(this.filters[this.currentAdminId]),t=(t=t.trim()).toLowerCase(),setTimeout(()=>{this.dataSource.filter=t},0),this.dataSource.filterPredicate=(t,e)=>this.functionsService.filterUnSensitive(t,e,this.filterColumns)})).subscribe(),this.filterColumns=n,this.dataSource=new G.o(e),this.dataSource.paginator=a,this.dataSource.sortingDataAccessor=this.functionsService.listSortingDataAccessor,this.functionsService.empty(this.getFilter())&&this.saveDefaultFilter(),a.pageIndex=this.getFilter("page"),this.dataSource.sort=i;const s=document.getElementsByClassName("mat-column-"+this.getFilter("sort"))[0];s.click(),"desc"===this.getFilter("sortDirection")&&s.click(),this.searchTerm.setValue(this.getFilter("field")),Object(xt.merge)(i.sortChange,a.page).pipe(Object(_t.startWith)({}),Object(Zt.tap)(()=>{this.saveFilter({sort:i.active,sortDirection:i.direction,page:a.pageIndex,field:this.getFilter("field")})}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}saveDefaultFilter(){this.saveFilter(this.defaultFilters[this.currentAdminId])}setFilter(t,e){this.filters[this.currentAdminId][t]=e}saveFilter(t){this.filters[this.currentAdminId]=t,this.localStorage.save("filtersAdmin_"+this.headerService.user.id,JSON.stringify(this.filters))}getFilterField(){return this.searchTerm}getDataSource(){return this.dataSource}getFilter(t=null){return this.functionsService.empty(this.filters[this.currentAdminId])?null:this.functionsService.empty(t)?this.functionsService.empty(this.filters[this.currentAdminId])?"":this.filters[this.currentAdminId]:this.functionsService.empty(this.filters[this.currentAdminId][t])?"":this.filters[this.currentAdminId][t]}}return t.\u0275fac=function(e){return new(e||t)(m.dc(y.a),m.dc(h.a),m.dc(C.a),m.dc(K.a))},t.\u0275prov=m.Pb({token:t,factory:t.\u0275fac}),t})();var Ot=i("MutI"),Tt=i("NFeN"),kt=i("jaxi"),It=i("Qu3c"),Dt=i("63qU");const Ut=["adminMenuTemplate"];function Pt(t,e){1&t&&m.Ub(0,"mat-divider")}function Ft(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"p",19),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Zb(7,"p",19),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Zb(10,"p",19),m.Sc(11),m.mc(12,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc(2);m.Eb(2),m.Tc(m.nc(3,7,"lang.quota")),m.Eb(3),m.Vc("",m.nc(6,9,"lang.actives")," : ",t.quota.actives,""),m.Eb(3),m.Vc("",m.nc(9,11,"lang.inactives")," : ",t.quota.inactives,""),m.Eb(3),m.Vc("",m.nc(12,13,"lang.quota")," : ",t.quota.userQuota,"")}}function Lt(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Zb(9,"a",15),m.hc("click",(function(){return m.Hc(t),m.lc().openUsersExportModal()})),m.Ub(10,"mat-icon",16),m.Zb(11,"p",14),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Zb(14,"a",15),m.hc("click",(function(){return m.Hc(t),m.lc().openUsersImportModal()})),m.Ub(15,"mat-icon",17),m.Zb(16,"p",14),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Ub(19,"mat-divider"),m.Qc(20,Pt,1,0,"mat-divider",18),m.Qc(21,Ft,13,15,"mat-nav-list",18)}if(2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,6,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,8,"lang.add")," "),m.Eb(5),m.Uc(" ",m.nc(13,10,"lang.usersExport")," "),m.Eb(5),m.Uc(" ",m.nc(18,12,"lang.usersImport")," "),m.Eb(3),m.sc("ngIf",t.quota.userQuota),m.Eb(1),m.sc("ngIf",t.quota.userQuota)}}function jt(t,e){1&t&&(m.Zb(0,"div",20),m.Ub(1,"mat-spinner",21),m.Yb())}function Rt(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.technicalId")," ")}}function Qt(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.id," ")}}function At(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.id"))}}function Ht(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.user_id," ")}}function $t(t,e){1&t&&(m.Zb(0,"mat-header-cell",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.lastname")))}function zt(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.lastname," ")}}function Vt(t,e){1&t&&(m.Zb(0,"mat-header-cell",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.firstname")))}function Nt(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.firstname," ")}}function Jt(t,e){1&t&&(m.Zb(0,"mat-header-cell",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.status")))}const Gt=function(){return["SPD","ABS"]},Bt=function(t,e){return{statusUserLabelWarn:t,statusUserLabelPrimary:e}};function Wt(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Zb(1,"span",49),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngClass",m.Ac(6,Bt,m.yc(4,Gt).indexOf(t.status)>-1,-1==m.yc(5,Gt).indexOf(t.status))),m.Eb(1),m.Tc(m.nc(3,2,"lang.user"+t.status))}}function qt(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.email"))}}function Xt(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.mail," ")}}function Kt(t,e){1&t&&m.Ub(0,"mat-header-cell")}const te=function(){return["root_visible","root_invisible"]};function ee(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",55),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2);return e.stopPropagation(),a.deleteUser(i,"suspend")})),m.mc(1,"translate"),m.Ub(2,"mat-icon",56),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(2);m.tc("matTooltip",m.nc(1,2,"lang.suspend")),m.sc("disabled",t.id===e.user.id||m.yc(4,te).indexOf(t.mode)>-1&&"standard"===e.headerService.user.mode)}}function ie(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",57),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2);return e.stopPropagation(),a.activateUser(i)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",58),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(2);m.tc("matTooltip",m.nc(1,2,"lang.authorize")),m.sc("disabled",m.yc(4,te).indexOf(t.mode)>-1&&"standard"===e.headerService.user.mode)}}function ae(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",50),m.Qc(1,ee,3,5,"button",51),m.Qc(2,ie,3,5,"button",52),m.Zb(3,"button",53),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteUser(a,"delete")})),m.mc(4,"translate"),m.Ub(5,"mat-icon",54),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.sc("ngIf","SPD"!=t.status),m.Eb(1),m.sc("ngIf","SPD"==t.status),m.Eb(1),m.tc("matTooltip",m.nc(4,4,"lang.delete")),m.sc("disabled",t.id===i.user.id||m.yc(6,te).indexOf(t.mode)>-1)}}function ne(t,e){1&t&&m.Ub(0,"mat-header-row")}function se(t,e){if(1&t&&(m.Ub(0,"mat-row",59),m.mc(1,"translate")),2&t){const t=e.$implicit;m.Jb("admin",m.yc(6,te).indexOf(t.mode)>-1),m.uc("routerLink","/administration/users/",t.id,""),m.tc("matTooltip",m.nc(1,4,"lang.view"))}}function ce(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",22),m.Zb(1,"div",23),m.Zb(2,"div",24),m.Zb(3,"mat-form-field"),m.Ub(4,"input",25),m.mc(5,"translate"),m.Zb(6,"mat-button-toggle",26),m.hc("click",(function(e){m.Hc(t);const i=m.lc();return e.stopPropagation(),i.toggleWebserviceAccount()})),m.mc(7,"translate"),m.Ub(8,"mat-icon",27),m.Yb(),m.Yb(),m.Yb(),m.Zb(9,"div",24),m.Ub(10,"mat-paginator",28,29),m.Yb(),m.Yb(),m.Zb(12,"mat-table",30,31),m.Xb(14,32),m.Qc(15,Rt,3,5,"mat-header-cell",33),m.Qc(16,Qt,2,3,"mat-cell",34),m.Wb(),m.Xb(17,35),m.Qc(18,At,3,5,"mat-header-cell",33),m.Qc(19,Ht,2,3,"mat-cell",34),m.Wb(),m.Xb(20,36),m.Qc(21,$t,3,3,"mat-header-cell",37),m.Qc(22,zt,2,1,"mat-cell",38),m.Wb(),m.Xb(23,39),m.Qc(24,Vt,3,3,"mat-header-cell",37),m.Qc(25,Nt,2,1,"mat-cell",38),m.Wb(),m.Xb(26,40),m.Qc(27,Jt,3,3,"mat-header-cell",37),m.Qc(28,Wt,4,9,"mat-cell",38),m.Wb(),m.Xb(29,41),m.Qc(30,qt,3,5,"mat-header-cell",33),m.Qc(31,Xt,2,3,"mat-cell",34),m.Wb(),m.Xb(32,42),m.Qc(33,Kt,1,0,"mat-header-cell",43),m.Qc(34,ae,6,7,"mat-cell",44),m.Wb(),m.Qc(35,ne,1,0,"mat-header-row",45),m.Qc(36,se,2,7,"mat-row",46),m.Yb(),m.Zb(37,"div",47),m.Sc(38),m.mc(39,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,12,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(2),m.tc("title",m.nc(7,14,"lang.displayWebserviceAccount")),m.sc("checked",t.withWebserviceAccount),m.Eb(4),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(23),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.data.length," ",m.nc(39,16,"lang.usersAlt"),"")}}const oe=function(){return["/rest/autocomplete/users"]};function re(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",10),m.Zb(1,"plugin-autocomplete",11),m.hc("triggerEvent",(function(i){m.Hc(t);const a=e.index;return m.lc(3).setRedirectUserListModels(a,i)})),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(3);m.tc("id",t.object_id),m.Eb(1),m.sc("labelPlaceholder",i.translate.instant("lang.newDest")+" : "+t.title)("labelList",i.translate.instant("lang.availableUsers"))("routeDatas",m.yc(6,oe))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay")}}function le(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"h2"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",7),m.Zb(5,"b"),m.Sc(6),m.Yb(),m.Sc(7,"\xa0"),m.Ub(8,"span",8),m.Sc(9," : "),m.Yb(),m.Qc(10,re,2,7,"div",9),m.Wb()),2&t){const t=m.lc(2);m.Eb(2),m.Tc(m.nc(3,5,"lang.redirectUserListDiff")),m.Eb(4),m.Vc("",t.data.userDestRedirect.firstname," ",t.data.userDestRedirect.lastname,""),m.Eb(2),m.sc("innerHTML",t.translate.instant("lang.chooseNewDest"),m.Ic),m.Eb(2),m.sc("ngForOf",t.data.redirectListModels)}}function de(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"h2"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",7),m.Zb(5,"b"),m.Sc(6),m.Yb(),m.Sc(7,"\xa0"),m.Ub(8,"span",8),m.Sc(9," : "),m.Yb(),m.Zb(10,"div",10),m.Zb(11,"plugin-autocomplete",11),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc(2).setRedirectUserRes(e)})),m.Yb(),m.Yb(),m.Wb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Tc(m.nc(3,10,"lang.redirectUserListInstances")),m.Eb(4),m.Vc("",t.data.userDestRedirect.firstname," ",t.data.userDestRedirect.lastname,""),m.Eb(2),m.sc("innerHTML",t.translate.instant("lang.chooseNewDestUser"),m.Ic),m.Eb(2),m.tc("id",t.data.userDestRedirect.user_id),m.Eb(1),m.sc("labelPlaceholder",t.translate.instant("lang.newDestRes"))("labelList",t.translate.instant("lang.availableUsers"))("routeDatas",m.yc(12,oe))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay")}}function be(t,e){if(1&t&&(m.Zb(0,"b"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(3);m.Eb(1),m.Wc("",m.nc(2,3,"lang.delete")," ",t.data.userDestRedirect.firstname," ",t.data.userDestRedirect.lastname,"")}}function me(t,e){if(1&t&&(m.Zb(0,"b"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(3);m.Eb(1),m.Wc("",m.nc(2,3,"lang.suspend")," ",t.data.userDestRedirect.firstname," ",t.data.userDestRedirect.lastname,"")}}function pe(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"div",12),m.Qc(2,be,3,5,"b",2),m.Sc(3,"\xa0 "),m.Qc(4,me,3,5,"b",2),m.Sc(5,"\xa0 "),m.Yb(),m.Wb()),2&t){const t=m.lc(2);m.Eb(2),m.sc("ngIf","delete"==t.data.userDestRedirect.actionMode),m.Eb(2),m.sc("ngIf","suspend"==t.data.userDestRedirect.actionMode)}}function ue(t,e){if(1&t&&(m.Xb(0),m.Qc(1,le,11,7,"ng-container",2),m.Qc(2,de,12,13,"ng-container",2),m.Qc(3,pe,6,2,"ng-container",2),m.Wb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngIf",t.data.inDiffListDest),m.Eb(1),m.sc("ngIf",t.data.isResDestUser),m.Eb(1),m.sc("ngIf",!t.data.inDiffListDest&&!t.data.isResDestUser)}}function he(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Zb(1,"mat-icon",17),m.Ub(2,"i",18),m.Yb(),m.Zb(3,"p",15),m.Zb(4,"span"),m.Sc(5),m.Yb(),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(5),m.Uc(" ",t," ")}}function fe(t,e){if(1&t&&(m.Zb(0,"div",14),m.Zb(1,"mat-list"),m.Zb(2,"p",15),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Qc(5,he,6,1,"mat-list-item",16),m.Yb(),m.Yb()),2&t){const t=m.lc(2);m.Eb(3),m.Tc(m.nc(4,2,"lang.diffusionList")),m.Eb(2),m.sc("ngForOf",t.data.listTemplateEntities)}}function ge(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Zb(1,"mat-icon",17),m.Ub(2,"i",19),m.Yb(),m.Zb(3,"p",15),m.Zb(4,"span"),m.Sc(5),m.Yb(),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(5),m.Uc(" ",t," ")}}function ve(t,e){if(1&t&&(m.Zb(0,"div",14),m.Zb(1,"mat-list"),m.Zb(2,"p",15),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Qc(5,ge,6,1,"mat-list-item",16),m.Yb(),m.Yb()),2&t){const t=m.lc(2);m.Eb(3),m.Tc(m.nc(4,2,"lang.mailEntitiesList")),m.Eb(2),m.sc("ngForOf",t.data.listInstanceEntities)}}function ye(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"div",7),m.Zb(2,"p"),m.Ub(3,"span",8),m.Zb(4,"b"),m.Sc(5),m.Yb(),m.Sc(6,"\xa0"),m.Yb(),m.Zb(7,"p"),m.Ub(8,"span",8),m.Yb(),m.Yb(),m.Qc(9,fe,6,4,"div",13),m.Qc(10,ve,6,4,"div",13),m.Wb()),2&t){const t=m.lc();m.Eb(3),m.sc("innerHTML",t.translate.instant("lang.userIsNotDeletable"),m.Ic),m.Eb(2),m.Vc("",t.data.userDestRedirect.firstname," ",t.data.userDestRedirect.lastname,""),m.Eb(3),m.sc("innerHTML",t.translate.instant("lang.userIsDeletableBy"),m.Ic),m.Eb(1),m.sc("ngIf",t.data.inTemplateList),m.Eb(1),m.sc("ngIf",t.data.inInstanceList)}}function Ce(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",20),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.dialogRef.close(e.data)})),m.Sc(1),m.mc(2,"translate"),m.mc(3,"translate"),m.Yb()}if(2&t){const t=m.lc();m.sc("disabled",!t.sendFunction()),m.Eb(1),m.Vc("",m.nc(2,3,"lang.delete")," ",m.nc(3,5,"lang.user"),"")}}function Ee(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",21),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.dialogRef.close(e.data)})),m.Sc(1),m.mc(2,"translate"),m.mc(3,"translate"),m.Yb()}if(2&t){const t=m.lc();m.sc("disabled",!t.sendFunction()),m.Eb(1),m.Vc("",m.nc(2,3,"lang.suspend")," ",m.nc(3,5,"lang.user"),"")}}function Se(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",22),m.hc("click",(function(){return m.Hc(t),m.lc().dialogRef.close()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.close")))}let Me=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.appService=s,this.functions=c,this.adminService=o,this.viewContainerRef=r,this.loading=!0,this.updateListModel=!0,this.updateListInstance=!0,this.data=[],this.config={},this.userDestRedirect={},this.userDestRedirectModels=[],this.listinstances=[],this.quota={},this.user={},this.withWebserviceAccount=!1,this.webserviceAccounts=[],this.noWebserviceAccounts=[],this.displayedColumns=["id","user_id","lastname","firstname","status","mail","actions"],this.filterColumns=["id","user_id","lastname","firstname","mail"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.users")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.user=this.headerService.user,this.getData()}getData(){this.webserviceAccounts=[],this.noWebserviceAccounts=[],this.data=[],this.http.get("../rest/users").pipe(Object(Zt.tap)(t=>{this.data=t.users,this.data.forEach(t=>{t.statusLabel=this.translate.instant("lang.user"+t.status),"rest"===t.mode?this.webserviceAccounts.push(t):this.noWebserviceAccounts.push(t)}),this.data=this.noWebserviceAccounts,this.quota=t.quota,this.quota.actives>this.quota.userQuota&&this.notify.error(this.translate.instant("lang.quotaExceeded")),this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_users",this.data,this.sort,this.paginator,this.filterColumns)},0)}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}activateUser(t){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.authorize")+" \xab "+t.user_id+" \xbb")&&(t.status="OK",this.http.put("../rest/users/"+t.id,t).subscribe(()=>{this.notify.success(this.translate.instant("lang.userAuthorized")),this.quota.userQuota&&(this.quota.inactives--,this.quota.actives++,this.quota.actives>this.quota.userQuota&&this.notify.error(this.translate.instant("lang.quotaExceeded")))},e=>{t.status="SPD",this.notify.error(e.error.errors)}))}deleteUser(t,e){t.actionMode=e,this.http.get("../rest/users/"+t.id+"/isDeletable").subscribe(e=>{e&&e.hasOwnProperty("errors")?this.notify.error(e.errors):(t.isDeletable=e.isDeletable,this.config=e.isDeletable?{panelClass:"maarch-modal",data:{userDestRedirect:t,isDeletable:e.isDeletable,redirectListInstances:e.listInstances,redirectListModels:e.listTemplates}}:{panelClass:"maarch-modal",data:{userDestRedirect:t,isDeletable:e.isDeletable,listInstanceEntities:e.listInstanceEntities,listTemplateEntities:e.listTemplateEntities}},this.dialogRef=this.dialog.open(Ye,this.config),this.dialogRef.afterClosed().subscribe(e=>{e&&t.isDeletable&&(t.inDiffListDest=e.inDiffListDest,t.isResDestUser=e.isResDestUser,e.inDiffListDest&&(t.redirectListModels=e.redirectListModels),e.isResDestUser&&(t.redirectDestResUserId=e.redirectDestResUserId,e.redirectListInstances.forEach(e=>{e.listInstances.forEach(e=>{"dest"===e.item_mode&&e.item_id===t.user_id&&(e.item_id=t.redirectDestResUserId)})}),t.redirectListInstances=e.redirectListInstances),t.inDiffListDest&&t.isResDestUser?this.http.put("../rest/listTemplates/entityDest/itemId/"+t.id,t).subscribe(()=>{this.http.put("../rest/listinstances",t.redirectListInstances).subscribe(e=>{null!=e&&e.errors?this.notify.error(e.errors):"delete"===t.actionMode?this.http.delete("../rest/users/"+t.id).subscribe(()=>{for(const e in this.data)this.data[e].id==t.id&&this.data.splice(Number(e),1);this.adminService.setDataSource("admin_users",this.data,this.sort,this.paginator,this.filterColumns),this.quota.userQuota&&"SPD"!==t.status?this.quota.actives--:this.quota.userQuota&&"SPD"===t.status&&this.quota.inactives--,this.notify.success(this.translate.instant("lang.userDeleted")+" \xab "+t.user_id+" \xbb")},t=>{this.notify.error(t.error.errors)}):"suspend"===t.actionMode&&this.http.put("../rest/users/"+t.id+"/suspend",t).subscribe(()=>{t.status="SPD",this.notify.success(this.translate.instant("lang.userSuspended")),this.quota.userQuota&&(this.quota.inactives++,this.quota.actives--)},e=>{t.status="OK",this.notify.error(e.error.errors)})},t=>{this.notify.error(t.error.errors)})},t=>{this.notify.error(t.error.errors)}):t.inDiffListDest&&!t.isResDestUser?this.http.put("../rest/listTemplates/entityDest/itemId/"+t.id,t).subscribe(()=>{"delete"===t.actionMode?this.http.delete("../rest/users/"+t.id).subscribe(()=>{for(const e in this.data)this.data[e].id==t.id&&this.data.splice(Number(e),1);this.adminService.setDataSource("admin_users",this.data,this.sort,this.paginator,this.filterColumns),this.quota.userQuota&&"OK"===t.status?this.quota.actives--:this.quota.userQuota&&"SPD"===t.status&&this.quota.inactives--,this.notify.success(this.translate.instant("lang.userDeleted")+" \xab "+t.user_id+" \xbb")},t=>{this.notify.error(t.error.errors)}):"suspend"===t.actionMode&&this.http.put("../rest/users/"+t.id+"/suspend",t).subscribe(()=>{t.status="SPD",this.notify.success(this.translate.instant("lang.userSuspended")),this.quota.userQuota&&(this.quota.inactives++,this.quota.actives--)},e=>{t.status="OK",this.notify.error(e.error.errors)})},t=>{this.notify.error(t.error.errors)}):!t.inDiffListDest&&t.isResDestUser?this.http.put("../rest/listinstances",t.redirectListInstances).subscribe(e=>{e&&e.hasOwnProperty("errors")?this.notify.error(e.errors):"delete"===t.actionMode?this.http.delete("../rest/users/"+t.id).subscribe(()=>{for(const e in this.data)this.data[e].id===t.id&&this.data.splice(Number(e),1);this.adminService.setDataSource("admin_users",this.data,this.sort,this.paginator,this.filterColumns),this.quota.userQuota&&"OK"===t.status?this.quota.actives--:this.quota.userQuota&&"SPD"===t.status&&this.quota.inactives--,this.notify.success(this.translate.instant("lang.userDeleted")+" \xab "+t.user_id+" \xbb")},t=>{this.notify.error(t.error.errors)}):"suspend"===t.actionMode&&this.http.put("../rest/users/"+t.id+"/suspend",t).subscribe(()=>{t.status="SPD",this.notify.success(this.translate.instant("lang.userSuspended")),this.quota.userQuota&&(this.quota.inactives++,this.quota.actives--)},e=>{t.status="OK",this.notify.error(e.error.errors)})},t=>{this.notify.error(t.error.errors)}):t.inDiffListDest||t.isResDestUser||("delete"===t.actionMode?this.http.delete("../rest/users/"+t.id).subscribe(()=>{for(const e in this.data)this.data[e].id==t.id&&this.data.splice(Number(e),1);this.adminService.setDataSource("admin_users",this.data,this.sort,this.paginator,this.filterColumns),this.quota.userQuota&&"OK"===t.status?this.quota.actives--:this.quota.userQuota&&"SPD"===t.status&&this.quota.inactives--,this.notify.success(this.translate.instant("lang.userDeleted")+" \xab "+t.user_id+" \xbb")},t=>{this.notify.error(t.error.errors)}):"suspend"===t.actionMode&&this.http.put("../rest/users/"+t.id+"/suspend",t).subscribe(()=>{t.status="SPD",this.notify.success(this.translate.instant("lang.userSuspended")),this.quota.userQuota&&(this.quota.inactives++,this.quota.actives--)},e=>{t.status="OK",this.notify.error(e.error.errors)})))}))},t=>{this.notify.error(t.error.errors)})}toggleWebserviceAccount(){this.withWebserviceAccount=!this.withWebserviceAccount,this.data=this.withWebserviceAccount?this.webserviceAccounts:this.noWebserviceAccounts,this.adminService.setDataSource("admin_users",this.data,this.sort,this.paginator,this.filterColumns)}openUsersImportModal(){this.dialog.open(ft,{disableClose:!0,width:"99vw",maxWidth:"99vw",panelClass:"maarch-full-height-modal"}).afterClosed().pipe(Object(W.a)(t=>"success"===t),Object(Zt.tap)(()=>{this.getData()}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}openUsersExportModal(){this.dialog.open(Yt,{panelClass:"maarch-modal",width:"800px",autoFocus:!1})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Ut,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/users/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fas","fa-file-export"],["color","primary","mat-list-icon","",1,"fas","fa-file-import"],[4,"ngIf"],["mat-line","",2,"margin-left","20px"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],["matSuffix","",1,"webserviceAccount",3,"checked","title","click"],["fontSet","fas","fontIcon","fa-user-shield fa-2x",2,"margin-left","-2px","margin-top","-4px"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","id"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","user_id"],["matColumnDef","lastname"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","firstname"],["matColumnDef","status"],["matColumnDef","mail"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip","admin",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],[1,"label",3,"ngClass"],[2,"justify-content","flex-end"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click",4,"ngIf"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click",4,"ngIf"],["mat-icon-button","","color","warn","data-toggle","modal","data-target","#changeDiffListDest",3,"disabled","matTooltip","click"],[1,"fa","fa-trash-alt","fa-2x"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],["aria-hidden","true",1,"fa","fa-pause","fa-2x"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click"],["aria-hidden","true",1,"fa","fa-check","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Lt,22,14,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,jt,2,0,"div",9),m.Qc(14,ce,40,18,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,_.a,T.c,k.a,w.c,O.b,o.c,o.t,o.i,kt.a,w.j,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,x.q,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],styles:["button[_ngcontent-%COMP%]:disabled{opacity:.3!important}.statusUserLabelWarn[_ngcontent-%COMP%]{color:#8e3e52}.statusUserLabelPrimary[_ngcontent-%COMP%]{color:#135f7f}.webserviceAccount[_ngcontent-%COMP%]{color:#666;width:37px;height:37px;font-size:x-small;border-radius:18px!important}.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#f99830!important;color:#fff}.admin[_ngcontent-%COMP%]{font-weight:700}"]}),t})(),Ye=(()=>{class t{constructor(t,e,i,a,n){this.translate=t,this.http=e,this.data=i,this.dialogRef=a,this.notify=n,this.loadModel=!1,this.loadInstance=!1,this.modalTitle=this.translate.instant("lang.confirmAction")}ngOnInit(){this.data.isDeletable?(this.data.redirectListModels.length>0&&(this.data.inDiffListDest=!0),this.data.redirectListInstances.length>0&&(this.data.isResDestUser=!0)):(this.modalTitle=this.translate.instant("delete"===this.data.userDestRedirect.actionMode?"lang.unableToDelete":"lang.unableToSuspend"),this.data.listTemplateEntities.length>0&&(this.data.inTemplateList=!0),this.data.listInstanceEntities.length>0&&(this.data.inInstanceList=!0))}setRedirectUserListModels(t,e){this.data.userDestRedirect.user_id!=e.id?this.data.redirectListModels[t].redirectUserId=e.id:(this.data.redirectListModels[t].redirectUserId=null,this.notify.error(this.translate.instant("lang.userUnauthorized")))}setRedirectUserRes(t){this.data.userDestRedirect.user_id!=t.id?this.data.redirectDestResUserId=t.id:(this.data.redirectDestResUserId=null,this.notify.error(this.translate.instant("lang.userUnauthorized")))}sendFunction(){let t=!0;return this.data.inDiffListDest&&this.data.redirectListModels.forEach(e=>{e.redirectUserId||(t=!1)}),this.data.isResDestUser&&(this.data.redirectDestResUserId||(t=!1)),t}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(H.a),m.Tb(H.h),m.Tb(y.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:11,vars:6,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],[4,"ngIf"],[1,"divider-modal"],["mat-raised-button","","color","warn","type","submit","class","btn btn-danger",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"click",4,"ngIf"],["role","alert",1,"alert-message","alert-message-info"],[3,"innerHTML"],["class","form-group",3,"id",4,"ngFor","ngForOf"],[1,"form-group",3,"id"],["singleMode","","required","",3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","subInfoKey","triggerEvent"],["role","alert",1,"alert"],["class","modal-body","class","col-md-6",4,"ngIf"],[1,"col-md-6"],["mat-line",""],[4,"ngFor","ngForOf"],["mat-list-icon",""],["color","primary",1,"fa","fa-share-alt"],["color","primary",1,"fa","fa-inbox"],["mat-raised-button","","color","warn","type","submit",1,"btn","btn-danger",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"click"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.Yb(),m.Zb(3,"mat-dialog-content"),m.Qc(4,ue,4,3,"ng-container",2),m.Qc(5,ye,11,6,"ng-container",2),m.Yb(),m.Ub(6,"span",3),m.Zb(7,"mat-dialog-actions"),m.Qc(8,Ce,4,7,"button",4),m.Qc(9,Ee,4,7,"button",5),m.Qc(10,Se,3,3,"button",6),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(e.modalTitle),m.Eb(2),m.sc("ngIf",e.data.isDeletable),m.Eb(1),m.sc("ngIf",!e.data.isDeletable),m.Eb(3),m.sc("ngIf","delete"==e.data.userDestRedirect.actionMode&&e.data.isDeletable),m.Eb(1),m.sc("ngIf","suspend"==e.data.userDestRedirect.actionMode&&e.data.isDeletable),m.Eb(1),m.sc("ngIf",!e.data.isDeletable))},directives:[H.i,H.f,x.t,H.c,x.s,Dt.a,Ot.a,I.k,Ot.d,Tt.a,Ot.c,D.b],pipes:[p.d],styles:["mat-icon[_ngcontent-%COMP%]{height:auto!important}.alert-message[_ngcontent-%COMP%]{max-width:100%}"]}),t})();var Ze=i("0EQZ");function xe(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list"),m.Zb(1,"mat-list-item"),m.Ub(2,"mat-icon",8),m.Zb(3,"h4",9),m.Sc(4),m.Yb(),m.Zb(5,"p",10),m.Sc(6),m.Yb(),m.Zb(7,"button",11),m.hc("click",(function(){return m.Hc(t),m.lc().unlinkMaarchParapheurAccount()})),m.Ub(8,"mat-icon",12),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.Pc("background-image","url("+t.externalUser.picture+")",m.Mb),m.Eb(2),m.Vc("",t.externalUser.firstname," ",t.externalUser.lastname,""),m.Eb(2),m.Tc(t.externalUser.email),m.Eb(1),m.sc("title",t.translate.instant("lang.unlinkAccount"))}}function _e(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"input",13),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().externalUser.login=e})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(1),m.tc("placeholder",m.nc(2,2,"lang.newLoginInMaarchParapheur")),m.sc("ngModel",t.externalUser.login)}}function we(t,e){if(1&t&&m.Ub(0,"div",14),2&t){const t=m.lc();m.sc("innerHTML",t.translate.instant("lang.maarchParapheurAccountMsg")+" <b>"+t.externalUser.login+"</b> "+t.translate.instant("lang.maarchParapheurAccountMsg2"),m.Ic)}}const Oe=function(){return["/rest/autocomplete/maarchParapheurUsers?exludeAlreadyConnected=true"]};let Te=(()=>{class t{constructor(t,e,i,a,n){this.translate=t,this.http=e,this.data=i,this.dialogRef=a,this.notify=n,this.externalUser={inMaarchParapheur:!1,login:"",firstname:"",lastname:"",email:"",picture:""}}ngOnInit(){this.http.get("../rest/autocomplete/maarchParapheurUsers",{params:{search:this.data.user.mail,exludeAlreadyConnected:"true"}}).subscribe(t=>{t.length>0?(this.externalUser=t[0],this.externalUser.inMaarchParapheur=!0,this.http.get("../rest/maarchParapheur/user/"+this.externalUser.id+"/picture").subscribe(t=>{this.externalUser.picture=t.picture},t=>{this.notify.handleErrors(t)})):(this.externalUser.inMaarchParapheur=!1,this.externalUser=this.data.user,this.externalUser.login=this.data.user.user_id,this.externalUser.email=this.data.user.mail)},t=>{this.notify.handleErrors(t)})}selectUser(t){this.externalUser=t,this.externalUser.inMaarchParapheur=!0,this.http.get("../rest/maarchParapheur/user/"+this.externalUser.id+"/picture").subscribe(t=>{this.externalUser.picture=t.picture},t=>{this.notify.handleErrors(t)})}unlinkMaarchParapheurAccount(){this.externalUser.inMaarchParapheur=!1,this.externalUser=this.data.user,this.externalUser.login=this.data.user.user_id,this.externalUser.email=this.data.user.mail}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(H.a),m.Tb(H.h),m.Tb(y.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:17,vars:18,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["appearance","outline",3,"labelPlaceholder","routeDatas","targetSearchKey","subInfoKey","triggerEvent"],[4,"ngIf"],["class","alert-message alert-message-danger","role","alert","style","margin-top: 30px;",3,"innerHTML",4,"ngIf"],[1,"divider-modal"],["color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","",3,"click"],["color","primary","mat-list-icon","",1,"avatarAccount"],["mat-line",""],["mat-line","",2,"color","#666"],["mat-icon-button","","color","warn",3,"title","click"],[1,"fas","fa-unlink"],["type","text","matInput","",3,"placeholder","ngModel","ngModelChange"],["role","alert",1,"alert-message","alert-message-danger",2,"margin-top","30px",3,"innerHTML"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"plugin-autocomplete",2),m.hc("triggerEvent",(function(t){return e.selectUser(t)})),m.Yb(),m.Qc(6,xe,9,6,"mat-list",3),m.Qc(7,_e,3,4,"mat-form-field",3),m.Qc(8,we,1,1,"div",4),m.Yb(),m.Ub(9,"span",5),m.Zb(10,"mat-dialog-actions"),m.Zb(11,"button",6),m.hc("click",(function(){return e.dialogRef.close(e.externalUser)})),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Zb(14,"button",7),m.hc("click",(function(){return e.dialogRef.close("")})),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,11,"lang.linkAccount")),m.Eb(3),m.sc("labelPlaceholder",e.translate.instant("lang.searchUserInMaarchParapheur"))("routeDatas",m.yc(17,Oe))("targetSearchKey","idToDisplay")("subInfoKey","email"),m.Eb(1),m.sc("ngIf",e.externalUser.inMaarchParapheur),m.Eb(1),m.sc("ngIf",!e.externalUser.inMaarchParapheur),m.Eb(1),m.sc("ngIf",!e.externalUser.inMaarchParapheur),m.Eb(3),m.sc("disabled",""===e.externalUser.login),m.Eb(1),m.Tc(m.nc(13,13,"lang.validate")),m.Eb(3),m.Tc(m.nc(16,15,"lang.cancel")))},directives:[H.i,H.f,Dt.a,x.t,H.c,D.b,Ot.a,Ot.d,Tt.a,Ot.c,I.k,w.c,O.b,o.c,o.t,o.w],pipes:[p.d],styles:[".avatarAccount[_ngcontent-%COMP%]{border:3px solid #f99830;height:45px!important;width:45px!important;background-size:cover;background-repeat:no-repeat;background-position:50%}"]}),t})();var ke=i("MJ5r"),Ie=i("wZkO"),De=i("7EHt"),Ue=i("/kMP"),Pe=i("bSwM"),Fe=i("STbY"),Le=i("lJEt"),je=i("iadO"),Re=i("wQTr"),Qe=i("QibW");const Ae=["snav2"],He=["adminMenuTemplate"],$e=["maarchTree"];function ze(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",18),m.hc("click",(function(){return m.Hc(t),m.lc(3).activateAbsence()})),m.Ub(1,"mat-icon",19),m.Zb(2,"p",20),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.activateAbsence")," "))}function Ve(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",18),m.hc("click",(function(){return m.Hc(t),m.lc(3).desactivateAbsence()})),m.Ub(1,"mat-icon",21),m.Zb(2,"p",20),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.desactivateAbsence")," "))}function Ne(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",18),m.hc("click",(function(){return m.Hc(t),m.lc(3).resendActivationNotification()})),m.Ub(1,"mat-icon",22),m.Zb(2,"p",20),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.sendActivationNotification")," "))}function Je(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",18),m.hc("click",(function(){return m.Hc(t),m.lc(3).changePasswd()})),m.Ub(1,"mat-icon",23),m.Zb(2,"p",20),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.changePassword")," "))}function Ge(t,e){1&t&&(m.Zb(0,"p",27),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.maarchParapheurLinkbroken")," "))}function Be(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",24),m.hc("click",(function(){return m.Hc(t),m.lc(3).linkMaarchParapheurAccount()})),m.mc(1,"translate"),m.Ub(2,"mat-icon",25),m.Zb(3,"p",20),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Qc(6,Ge,3,3,"p",26),m.Yb()}if(2&t){const t=m.lc(3);m.tc("title",m.nc(1,3,"lang.createUserInMaarchParapheur")),m.Eb(4),m.Uc(" ",m.nc(5,5,"lang.linkAccount")," "),m.Eb(2),m.sc("ngIf",!t.maarchParapheurConnectionStatus)}}function We(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",13),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Qc(4,ze,5,3,"a",16),m.Qc(5,Ve,5,3,"a",16),m.Qc(6,Ne,5,3,"a",16),m.Qc(7,Je,5,3,"a",16),m.Qc(8,Be,7,7,"a",17),m.Yb()),2&t){const t=m.lc(2);m.Eb(2),m.Tc(m.nc(3,6,"lang.actions")),m.Eb(2),m.sc("ngIf","ABS"!=t.user.status),m.Eb(1),m.sc("ngIf","ABS"==t.user.status),m.Eb(1),m.sc("ngIf",t.user.canSendActivationNotification),m.Eb(1),m.sc("ngIf",t.user.canModifyPassword),m.Eb(1),m.sc("ngIf",t.user.canCreateMaarchParapheurUser||""===t.maarchParapheurLink.login)}}function qe(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list"),m.Zb(1,"h3",13),m.Sc(2,"Compte Maarch Parapheur"),m.Yb(),m.Zb(3,"mat-list-item"),m.Ub(4,"mat-icon",28),m.Zb(5,"p",29),m.Zb(6,"span"),m.Sc(7),m.Yb(),m.Zb(8,"button",30),m.hc("click",(function(){return m.Hc(t),m.lc(2).unlinkMaarchParapheurAccount()})),m.mc(9,"translate"),m.Ub(10,"mat-icon",31),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(4),m.Pc("background-image","url("+t.maarchParapheurLink.picture+")",m.Mb),m.Eb(3),m.Uc(" ",t.maarchParapheurLink.login," "),m.Eb(1),m.tc("title",m.nc(9,4,"lang.unlinkAccount"))}}function Xe(t,e){if(1&t&&(m.Qc(0,We,9,8,"mat-nav-list",15),m.Ub(1,"mat-divider"),m.Qc(2,qe,11,6,"mat-list",15)),2&t){const t=m.lc();m.sc("ngIf",!t.creationMode&&!t.loading),m.Eb(2),m.sc("ngIf",""!==t.maarchParapheurLink.login)}}function Ke(t,e){1&t&&(m.Zb(0,"div",32),m.Ub(1,"mat-spinner",33),m.Yb())}function ti(t,e){1&t&&(m.Zb(0,"mat-error"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.requiredField"),""))}function ei(t,e){1&t&&(m.Zb(0,"mat-hint"),m.Ub(1,"i",58),m.Zb(2,"span",59),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Tc(m.nc(4,1,"lang.passwordValid")))}function ii(t,e){1&t&&(m.Zb(0,"mat-hint"),m.Ub(1,"i",58),m.Zb(2,"span",59),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Tc(m.nc(4,1,"lang.passwordMatch")))}function ai(t,e){if(1&t&&(m.Zb(0,"div",44),m.Zb(1,"div",60),m.Ub(2,"div",61),m.Yb(),m.Yb()),2&t){const t=m.lc(3);m.Eb(2),m.sc("innerHTML",t.otherRuleText,m.Ic)}}const ni=function(t){return[t]};function si(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",42),m.Zb(1,"form",43),m.Zb(2,"div",44),m.Zb(3,"mat-form-field",45),m.Ub(4,"input",46),m.mc(5,"translate"),m.Zb(6,"mat-icon",47),m.hc("click",(function(){m.Hc(t);const e=m.lc(2);return e.hidePassword=!e.hidePassword})),m.Yb(),m.Qc(7,ti,3,3,"mat-error",15),m.Yb(),m.Yb(),m.Zb(8,"div",44),m.Zb(9,"div",48),m.Sc(10),m.Yb(),m.Zb(11,"div",49),m.Zb(12,"mat-form-field",45),m.Ub(13,"input",50,51),m.mc(15,"translate"),m.Zb(16,"mat-icon",47),m.hc("click",(function(){m.Hc(t);const e=m.lc(2);return e.hidePassword=!e.hidePassword})),m.Yb(),m.Qc(17,ei,5,3,"mat-hint",15),m.Zb(18,"mat-error"),m.Sc(19),m.Yb(),m.Yb(),m.Yb(),m.Zb(20,"div",49),m.Zb(21,"mat-form-field",45),m.Ub(22,"input",52,53),m.mc(24,"translate"),m.Zb(25,"mat-icon",47),m.hc("click",(function(){m.Hc(t);const e=m.lc(2);return e.hidePassword=!e.hidePassword})),m.Yb(),m.Qc(26,ii,5,3,"mat-hint",15),m.Zb(27,"mat-error"),m.Sc(28),m.mc(29,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(30,ai,3,1,"div",54),m.Zb(31,"div",44),m.Zb(32,"div",55),m.Zb(33,"button",56),m.hc("click",(function(){return m.Hc(t),m.lc(2).updatePassword()})),m.Sc(34),m.mc(35,"translate"),m.Yb(),m.Zb(36,"button",57),m.hc("click",(function(){return m.Hc(t),m.lc(2).showPassword=!1})),m.Sc(37),m.mc(38,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.sc("formGroup",t.firstFormGroup),m.Eb(3),m.tc("placeholder",m.nc(5,20,"lang.typeCurrentPassword")),m.sc("type",t.hidePassword?"password":"text"),m.Eb(2),m.sc("ngClass",m.zc(32,ni,t.hidePassword?"fa-eye-slash":"fa-eye")),m.Eb(1),m.sc("ngIf",t.firstFormGroup.controls.currentPasswordCtrl.hasError("required")),m.Eb(3),m.Uc(" ",t.ruleText,""),m.Eb(3),m.tc("placeholder",m.nc(15,22,"lang.typeNewPassword")),m.sc("type",t.hidePassword?"password":"text"),m.Eb(3),m.sc("ngClass",m.zc(34,ni,t.hidePassword?"fa-eye-slash":"fa-eye")),m.Eb(1),m.sc("ngIf",t.validPassword),m.Eb(2),m.Tc(t.getErrorMessage()),m.Eb(3),m.tc("placeholder",m.nc(24,24,"lang.retypeNewPassword")),m.sc("type",t.hidePassword?"password":"text"),m.Eb(3),m.sc("ngClass",m.zc(36,ni,t.hidePassword?"fa-eye-slash":"fa-eye")),m.Eb(1),m.sc("ngIf",!t.firstFormGroup.controls.retypePasswordCtrl.hasError("mismatch")&&""!=t.firstFormGroup.controls.retypePasswordCtrl.value),m.Eb(2),m.Uc("",m.nc(29,26,"lang.passwordNotMatch")," !"),m.Eb(2),m.sc("ngIf",t.passwordRules.renewal.enabled||t.passwordRules.historyLastUse.enabled),m.Eb(3),m.sc("disabled",!t.firstFormGroup.valid),m.Eb(1),m.Tc(m.nc(35,28,"lang.update")),m.Eb(3),m.Tc(m.nc(38,30,"lang.cancel"))}}function ci(t,e){if(1&t&&(m.Zb(0,"div",62),m.Sc(1),m.Yb()),2&t){const t=m.lc(2);m.Eb(1),m.Uc(" ",t.user.status,"")}}function oi(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",84),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(3).user.userId=e}))("keyup",(function(){return m.Hc(t),m.lc(3).setLowerUserId()})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(3);m.tc("title",m.nc(1,3,"lang.id")),m.tc("placeholder",m.nc(2,5,"lang.id")),m.sc("ngModel",t.user.userId)}}function ri(t,e){if(1&t&&(m.Ub(0,"input",85),m.mc(1,"translate"),m.mc(2,"translate")),2&t){const t=m.lc(3);m.tc("title",m.nc(1,3,"lang.id")),m.tc("value",t.user.user_id),m.tc("placeholder",m.nc(2,5,"lang.id"))}}const li=function(){return["root_visible","root_invisible"]};function di(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-option",86),m.Sc(2),m.Yb(),m.Wb()),2&t){const t=e.$implicit,i=m.lc(3);m.Eb(1),m.sc("value",t.id)("disabled","standard"===i.headerService.user.mode&&m.yc(4,li).indexOf(t.id)>-1)("title","standard"===i.headerService.user.mode&&m.yc(5,li).indexOf(t.id)>-1?i.translate.instant("lang.mustSuperadmin"):""),m.Eb(1),m.Uc(" ",t.label," ")}}function bi(t,e){if(1&t){const t=m.ac();m.Zb(0,"div"),m.Zb(1,"mat-form-field"),m.Zb(2,"mat-label"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"textarea",87),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(3).user.authorizedApi=e})),m.Yb(),m.Zb(6,"mat-hint"),m.Sc(7),m.mc(8,"translate"),m.Zb(9,"a",88),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(3);m.Eb(3),m.Tc(m.nc(4,5,"lang.authorizedRoutes")),m.Eb(2),m.sc("ngModel",t.user.authorizedApi),m.Eb(2),m.Uc("",m.nc(8,7,"lang.authorizedRoutesInformations")," "),m.Eb(2),m.uc("href","https://docs.maarch.org/gitbook/html/MaarchCourrier/",t.appVersion,"/guat/guat_architecture/API_REST/home.html",m.Kc),m.Eb(1),m.Tc(m.nc(11,9,"lang.here"))}}function mi(t,e){if(1&t&&(m.Zb(0,"button",89),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){m.lc();const t=m.Dc(1);m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(2,2,"lang.save"))}}function pi(t,e){if(1&t&&(m.Zb(0,"button",89),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){m.lc();const t=m.Dc(1);m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(2,2,"lang.update"))}}function ui(t,e){if(1&t){const t=m.ac();m.Zb(0,"form",63,64),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc(2).onSubmit()})),m.Zb(2,"div",44),m.Zb(3,"div",65),m.Zb(4,"div",66),m.Zb(5,"div",67),m.Ub(6,"i",68),m.Yb(),m.Yb(),m.Zb(7,"div",69),m.Zb(8,"mat-form-field"),m.Qc(9,oi,3,7,"input",70),m.Qc(10,ri,3,7,"input",71),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(11,"div",44),m.Zb(12,"div",72),m.Zb(13,"mat-form-field"),m.Zb(14,"input",73),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).user.lastname=e})),m.mc(15,"translate"),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(17,"div",72),m.Zb(18,"mat-form-field"),m.Zb(19,"input",74),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).user.firstname=e})),m.mc(20,"translate"),m.mc(21,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(22,"div",75),m.Zb(23,"mat-form-field"),m.Zb(24,"input",76),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).user.initials=e})),m.mc(25,"translate"),m.mc(26,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(27,"div",44),m.Zb(28,"div",65),m.Zb(29,"mat-form-field"),m.Zb(30,"input",77),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).user.phone=e})),m.mc(31,"translate"),m.mc(32,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(33,"div",44),m.Zb(34,"div",65),m.Zb(35,"mat-form-field"),m.Zb(36,"input",78),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).user.mail=e})),m.mc(37,"translate"),m.mc(38,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(39,"mat-accordion"),m.Zb(40,"mat-expansion-panel",79),m.Zb(41,"mat-expansion-panel-header"),m.Zb(42,"mat-panel-title",80),m.Sc(43),m.mc(44,"translate"),m.Yb(),m.Yb(),m.Zb(45,"div"),m.Zb(46,"mat-form-field"),m.Zb(47,"mat-label"),m.Sc(48),m.mc(49,"translate"),m.Yb(),m.Zb(50,"mat-select",81),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).user.mode=e})),m.Qc(51,di,3,6,"ng-container",14),m.mc(52,"sortBy"),m.Yb(),m.Yb(),m.Yb(),m.Qc(53,bi,12,11,"div",15),m.Yb(),m.Yb(),m.Zb(54,"div",82),m.Zb(55,"div",55),m.Qc(56,mi,3,4,"button",83),m.Qc(57,pi,3,4,"button",83),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(9),m.sc("ngIf",t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode),m.Eb(4),m.tc("title",m.nc(15,27,"lang.lastname")),m.tc("placeholder",m.nc(16,29,"lang.lastname")),m.sc("ngModel",t.user.lastname),m.Eb(5),m.tc("title",m.nc(20,31,"lang.firstname")),m.tc("placeholder",m.nc(21,33,"lang.firstname")),m.sc("ngModel",t.user.firstname),m.Eb(5),m.tc("title",m.nc(25,35,"lang.initials")),m.tc("placeholder",m.nc(26,37,"lang.initials")),m.sc("ngModel",t.user.initials),m.Eb(6),m.tc("title",m.nc(31,39,"lang.phoneNumber")),m.tc("placeholder",m.nc(32,41,"lang.phoneNumber")),m.sc("ngModel",t.user.phone)("disabled",t.creationMode&&!t.canManagePersonalDatas||!t.creationMode&&(!t.canManagePersonalDatas||!t.canViewPersonalDatas)),m.Eb(6),m.tc("title",m.nc(37,43,"lang.email")),m.tc("placeholder",m.nc(38,45,"lang.email")),m.sc("ngModel",t.user.mail),m.Eb(4),m.sc("expanded",t.creationMode),m.Eb(3),m.Uc(" ",m.nc(44,47,"lang.otherInformations")," "),m.Eb(5),m.Tc(m.nc(49,49,"lang.accountType")),m.Eb(2),m.sc("ngModel",t.user.mode)("disabled","standard"===t.headerService.user.mode&&m.yc(54,li).indexOf(t.user.mode)>-1),m.Eb(1),m.sc("ngForOf",m.oc(52,51,t.adminModes,"label")),m.Eb(2),m.sc("ngIf","rest"===t.user.mode),m.Eb(3),m.sc("ngIf",t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode)}}function hi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",91),m.Zb(1,"mat-slide-toggle",92),m.hc("change",(function(){m.Hc(t);const i=e.$implicit;return m.lc(3).toggleGroup(i)})),m.Sc(2),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("id",t.group_id),m.sc("checked",1==t.checked)("disabled",!t.enabled),m.Eb(1),m.Uc(" ",t.group_desc,"")}}function fi(t,e){if(1&t&&(m.Zb(0,"mat-tab",36),m.mc(1,"translate"),m.Zb(2,"mat-nav-list"),m.Qc(3,hi,3,4,"mat-list-item",90),m.Yb(),m.Yb()),2&t){const t=m.lc(2);m.tc("label",m.nc(1,2,"lang.groups")),m.Eb(3),m.sc("ngForOf",t.user.allGroups)}}function gi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",36),m.mc(1,"translate"),m.Zb(2,"app-maarch-flat-tree",93,94),m.hc("afterSelectNode",(function(e){return m.Hc(t),m.lc(2).addEntity(e)}))("afterDeselectNode",(function(e){return m.Hc(t),m.lc(2).deleteEntity(e)})),m.Yb(),m.Yb()}2&t&&(m.tc("label",m.nc(1,3,"lang.entities")),m.Eb(2),m.sc("selectionPropagation",!1)("openState","all"))}function vi(t,e){1&t&&(m.Zb(0,"p",100),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.selectAll")," "))}const yi=function(){return["/rest/autocomplete/users"]};function Ci(t,e){if(1&t){const t=m.ac();m.Zb(0,"p",101),m.Zb(1,"button",102),m.mc(2,"translate"),m.Ub(3,"mat-icon",103),m.Ub(4,"mat-divider",104),m.Yb(),m.Zb(5,"button",105),m.hc("click",(function(){return m.Hc(t),m.lc(3).toggleBasket(!1)})),m.mc(6,"translate"),m.Ub(7,"mat-icon",106),m.Yb(),m.Zb(8,"button",107),m.hc("click",(function(){return m.Hc(t),m.lc(3).toggleBasket(!0)})),m.mc(9,"translate"),m.Ub(10,"mat-icon",108),m.Yb(),m.Zb(11,"mat-menu",109,110),m.Zb(13,"plugin-autocomplete",111),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc(3).addBasketRedirection(e)})),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(12),e=m.lc(3);m.Eb(1),m.tc("matTooltip",m.nc(2,9,"lang.redirectBaskets")),m.sc("matMenuTriggerFor",t),m.Eb(3),m.sc("vertical",!0),m.Eb(1),m.tc("matTooltip",m.nc(6,11,"lang.disableBasket")),m.Eb(3),m.tc("matTooltip",m.nc(9,13,"lang.enableBasket")),m.Eb(5),m.sc("labelPlaceholder",e.translate.instant("lang.redirectBaskets"))("routeDatas",m.yc(15,yi))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay")}}function Ei(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-icon",96),m.Zb(1,"mat-checkbox",118),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()}))("change",(function(e){m.Hc(t);const i=m.lc(2).$implicit,a=m.lc(3);return e?a.selectionBaskets.toggle(i):null})),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2).$implicit,e=m.lc(3);m.Eb(1),m.sc("checked",e.selectionBaskets.isSelected(t))}}const Si=function(t){return{opacity:t}};function Mi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",113),m.Qc(1,Ei,2,1,"mat-icon",114),m.Zb(2,"h4",115),m.Zb(3,"span",116),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(3).selectionBaskets.toggle(e)})),m.Sc(4),m.Zb(5,"span",117),m.Sc(6),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(1),m.sc("ngIf",t.enabled),m.Eb(2),m.vc("matTooltip","",t.basket_name," [",t.group_desc,"]"),m.sc("ngStyle",m.zc(6,Si,t.allowed?"1":"0.5")),m.Eb(1),m.Uc(" ",t.basket_name," "),m.Eb(2),m.Tc(t.group_desc)}}function Yi(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Mi,7,8,"mat-list-item",112),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",null==t.userToDisplay)}}function Zi(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-list-item"),m.Ub(2,"mat-icon",119),m.Zb(3,"h4",120),m.Sc(4),m.Zb(5,"span",117),m.Sc(6),m.Yb(),m.Yb(),m.Zb(7,"p",20),m.Zb(8,"mat-form-field"),m.Ub(9,"input",121),m.mc(10,"translate"),m.Zb(11,"button",122),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=e.index;return m.lc(3).delBasketRedirection(i,a)})),m.mc(12,"translate"),m.Ub(13,"mat-icon",123),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Wb()}if(2&t){const t=e.$implicit;m.Eb(4),m.Uc("",t.basket_name," "),m.Eb(2),m.Tc(t.group_desc),m.Eb(3),m.vc("value","",m.nc(10,5,"lang.redirectedTo")," ",t.userToDisplay,""),m.Eb(2),m.tc("matTooltip",m.nc(12,7,"lang.deleteRedirection"))}}function xi(t,e){if(1&t){const t=m.ac();m.Zb(0,"plugin-autocomplete",111),m.hc("triggerEvent",(function(e){m.Hc(t);const i=m.lc(),a=i.$implicit,n=i.index;return m.lc(3).reassignBasketRedirection(e,a,n)})),m.Yb()}if(2&t){const t=m.lc(4);m.sc("labelPlaceholder",t.translate.instant("lang.redirectBaskets"))("routeDatas",m.yc(4,yi))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay")}}function _i(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-list-item"),m.Ub(2,"mat-icon",124),m.Zb(3,"h4",120),m.Sc(4),m.Zb(5,"span",117),m.Sc(6),m.Yb(),m.Yb(),m.Zb(7,"p",20),m.Qc(8,xi,1,5,"plugin-autocomplete",125),m.Zb(9,"mat-form-field"),m.Ub(10,"input",121),m.mc(11,"translate"),m.Zb(12,"button",122),m.hc("click",(function(){return e.$implicit.userToDisplay=null})),m.mc(13,"translate"),m.Ub(14,"mat-icon",126),m.Yb(),m.Zb(15,"button",122),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=e.index;return m.lc(3).delBasketAssignRedirection(i,a)})),m.mc(16,"translate"),m.Ub(17,"mat-icon",123),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Wb()}if(2&t){const t=e.$implicit;m.Eb(4),m.Uc("",t.basket_name," "),m.Eb(2),m.Tc(t.group_desc),m.Eb(2),m.sc("ngIf",null==t.userToDisplay),m.Eb(2),m.vc("value","",m.nc(11,7,"lang.assignBy")," ",t.userToDisplay,""),m.Eb(2),m.tc("matTooltip",m.nc(13,9,"lang.reassign")),m.Eb(3),m.tc("matTooltip",m.nc(16,11,"lang.deleteAssignation"))}}function wi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",36),m.mc(1,"translate"),m.Zb(2,"div",95),m.Zb(3,"mat-list"),m.Zb(4,"mat-list-item"),m.Zb(5,"mat-icon",96),m.Zb(6,"mat-checkbox",97),m.hc("change",(function(e){m.Hc(t);const i=m.lc(2);return e?i.masterToggleBaskets(e):null})),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Qc(8,vi,3,3,"p",98),m.Qc(9,Ci,14,16,"p",99),m.Yb(),m.Ub(10,"mat-divider"),m.Qc(11,Yi,2,1,"ng-container",14),m.Yb(),m.Yb(),m.Zb(12,"div",95),m.Zb(13,"mat-tab-group"),m.Zb(14,"mat-tab",36),m.mc(15,"translate"),m.Zb(16,"mat-list"),m.Qc(17,Zi,14,9,"ng-container",14),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"mat-tab-group"),m.Zb(19,"mat-tab",36),m.mc(20,"translate"),m.Zb(21,"mat-list"),m.Qc(22,_i,18,13,"ng-container",14),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.tc("label",m.nc(1,10,"lang.baskets")),m.Eb(6),m.tc("matTooltip",m.nc(7,12,"lang.selectAll")),m.sc("checked",t.selectionBaskets.hasValue()),m.Eb(2),m.sc("ngIf",!t.selectionBaskets.hasValue()),m.Eb(1),m.sc("ngIf",t.selectionBaskets.hasValue()),m.Eb(2),m.sc("ngForOf",t.user.baskets),m.Eb(3),m.tc("label",m.nc(15,14,"lang.basketsRedirected")),m.Eb(3),m.sc("ngForOf",t.user.redirectedBaskets),m.Eb(2),m.tc("label",m.nc(20,16,"lang.basketsAssigned")),m.Eb(3),m.sc("ngForOf",t.user.assignedBaskets)}}function Oi(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",146),m.hc("click",(function(){return m.Hc(t),m.lc(3).clickOnUploader("uploadSignFile")}))("dragover",(function(){return m.Hc(t),m.lc(3).highlightMe=!0}))("dragleave",(function(){return m.Hc(t),m.lc(3).highlightMe=!1}))("onDropSuccess",(function(e){m.Hc(t);const i=m.lc(3);return i.test(e),i.highlightMe=!1})),m.mc(1,"translate"),m.Sc(2),m.mc(3,"translate"),m.Yb()}if(2&t){const t=m.lc(3);m.Jb("dndFileHighlighted",t.highlightMe),m.tc("matTooltip",m.nc(1,4,"lang.uploadSignFileInfo")),m.Eb(2),m.Uc(" ",m.nc(3,6,"lang.uploadSignFile")," ")}}function Ti(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",147),m.Zb(1,"mat-card",148),m.Zb(2,"mat-card-content",55),m.Zb(3,"mat-form-field",149),m.Zb(4,"input",150),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.signature_label=i}))("change",(function(){m.Hc(t);const i=e.index;return m.lc(3).updateSignature(i)})),m.mc(5,"translate"),m.Yb(),m.Zb(6,"button",151),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(3).deleteSignature(i)})),m.mc(7,"translate"),m.Ub(8,"mat-icon",152),m.Yb(),m.Yb(),m.Ub(9,"img",153),m.mc(10,"async"),m.mc(11,"secureUrl"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(3);m.Eb(4),m.tc("placeholder",m.nc(5,6,"lang.label")),m.sc("ngModel",t.signature_label)("disabled",!i.canManagePersonalDatas),m.Eb(2),m.tc("matTooltip",m.nc(7,8,"lang.delete")),m.sc("disabled",!i.canManagePersonalDatas),m.Eb(3),m.sc("src",m.nc(10,10,m.nc(11,12,"../rest/users/"+i.user.id+"/signatures/"+t.id+"/content")),m.Kc)}}function ki(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",154),m.hc("click",(function(){return m.Hc(t),m.lc(3).syncMP()})),m.mc(1,"translate"),m.Ub(2,"mat-icon",155),m.Yb()}if(2&t){const t=m.lc(3);m.tc("matTooltip",m.nc(1,4,"lang.syncSignsToMaarchParapheur")),m.sc("disabled",!t.user.external_id.maarchParapheur||t.loadingSign),m.Eb(2),m.Jb("fa-spin",t.loadingSign)}}function Ii(t,e){if(1&t&&(m.Zb(0,"div",156),m.Ub(1,"img",157),m.Yb()),2&t){const t=m.lc(3);m.Eb(1),m.tc("src",t.signatureModel.base64ForJs,m.Kc)}}function Di(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",127),m.mc(1,"translate"),m.Qc(2,Oi,4,8,"div",128),m.Zb(3,"div",129),m.Zb(4,"div",130),m.Qc(5,Ti,12,14,"div",131),m.Yb(),m.Zb(6,"div"),m.Qc(7,ki,3,6,"button",132),m.Yb(),m.Yb(),m.Zb(8,"form",133,134),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc(2).submitSignature()})),m.Zb(10,"div",135),m.Zb(11,"input",136),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).signatureModel.label=e})),m.mc(12,"translate"),m.Yb(),m.Zb(13,"div",137),m.Zb(14,"div",44),m.Zb(15,"input",138),m.hc("change",(function(e){return m.Hc(t),m.lc(2).uploadSignatureTrigger(e)})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(16,"div",139),m.Zb(17,"button",140),m.Ub(18,"i",141),m.Yb(),m.Yb(),m.Zb(19,"div",142),m.Zb(20,"div",143),m.hc("click",(function(){return m.Hc(t),m.lc(2).clickOnUploader("uploadSignFile")})),m.Sc(21),m.mc(22,"translate"),m.Ub(23,"i",144),m.Sc(24," ( < 2MB ) "),m.Yb(),m.Yb(),m.Qc(25,Ii,2,1,"div",145),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(9),e=m.lc(2);m.tc("label",m.nc(1,11,"lang.signatures")),m.sc("disabled",!e.canViewPersonalDatas),m.Eb(2),m.sc("ngIf",e.canManagePersonalDatas),m.Eb(3),m.sc("ngForOf",e.user.signatures),m.Eb(2),m.sc("ngIf",e.user.signatures.length>0&&e.canManagePersonalDatas),m.Eb(4),m.tc("placeholder",m.nc(12,13,"lang.label")),m.sc("ngModel",e.signatureModel.label),m.Eb(6),m.sc("disabled",!t.form.valid||!e.signatureModel.size),m.Eb(2),m.sc("ngClass",m.zc(17,ni,""!=e.signatureModel.size?"col-md-10":"col-md-12")),m.Eb(2),m.Uc(" ",m.nc(22,15,"lang.clickOn")," "),m.Eb(4),m.sc("ngIf",e.signatureModel.size)}}function Ui(t,e){1&t&&(m.Zb(0,"mat-header-cell",182),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.date")," "))}function Pi(t,e){if(1&t&&(m.Zb(0,"mat-cell",130),m.Sc(1),m.mc(2,"date"),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",m.oc(2,1,t.event_date,"dd/MM/y HH:mm"),"")}}function Fi(t,e){1&t&&(m.Zb(0,"mat-header-cell",130),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.technicalId")," "))}function Li(t,e){if(1&t&&(m.Zb(0,"mat-cell",130),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc("",t.record_id," ")}}function ji(t,e){1&t&&(m.Zb(0,"mat-header-cell",183),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.description"),""))}function Ri(t,e){if(1&t&&(m.Zb(0,"mat-cell",184),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.info," ")}}function Qi(t,e){1&t&&(m.Zb(0,"mat-header-cell",182),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.ip")," "))}function Ai(t,e){if(1&t&&(m.Zb(0,"mat-cell",130),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.remote_ip," ")}}function Hi(t,e){1&t&&m.Ub(0,"mat-header-row")}function $i(t,e){1&t&&m.Ub(0,"mat-row")}function zi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",36),m.mc(1,"translate"),m.Zb(2,"div",158),m.Zb(3,"div"),m.Zb(4,"div",159),m.Zb(5,"div",160),m.Zb(6,"mat-form-field"),m.Zb(7,"input",161),m.hc("keyup",(function(e){return m.Hc(t),m.lc(2).applyFilter(e.target.value)})),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(9,"div",160),m.Ub(10,"mat-paginator",162,163),m.Yb(),m.Yb(),m.Zb(12,"mat-table",164,165),m.Xb(14,166),m.Qc(15,Ui,3,3,"mat-header-cell",167),m.Qc(16,Pi,3,4,"mat-cell",168),m.Wb(),m.Xb(17,169),m.Qc(18,Fi,3,3,"mat-header-cell",170),m.Qc(19,Li,2,1,"mat-cell",168),m.Wb(),m.Xb(20,171),m.Qc(21,ji,3,3,"mat-header-cell",172),m.Qc(22,Ri,2,1,"mat-cell",173),m.Wb(),m.Xb(23,174),m.Qc(24,Qi,3,3,"mat-header-cell",167),m.Qc(25,Ai,2,1,"mat-cell",168),m.Wb(),m.Qc(26,Hi,1,0,"mat-header-row",175),m.Qc(27,$i,1,0,"mat-row",176),m.Yb(),m.Zb(28,"div",159),m.Zb(29,"div",177),m.Zb(30,"mat-form-field"),m.Zb(31,"input",178),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).minDate=e})),m.mc(32,"translate"),m.Yb(),m.Ub(33,"mat-datepicker-toggle",179),m.Ub(34,"mat-datepicker",180,181),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(35),e=m.lc(2);m.tc("label",m.nc(1,13,"lang.history")),m.Eb(7),m.tc("placeholder",m.nc(8,15,"lang.filterBy")),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",e.dataSource),m.Eb(14),m.sc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",e.displayedColumns),m.Eb(4),m.tc("placeholder",m.nc(32,17,"lang.since")),m.sc("ngModel",e.minDate)("matDatepicker",t),m.Eb(2),m.sc("for",t),m.Eb(1),m.sc("startAt",e.minDate)}}function Vi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",34),m.Zb(1,"mat-tab-group",35),m.hc("selectedIndexChange",(function(e){return m.Hc(t),m.lc().selectedTabIndex=e}))("selectedTabChange",(function(){return m.Hc(t),m.lc().initService()})),m.Zb(2,"mat-tab",36),m.mc(3,"translate"),m.Qc(4,si,39,38,"div",37),m.Qc(5,ci,2,1,"div",38),m.Qc(6,ui,58,55,"form",39),m.Yb(),m.Qc(7,fi,4,4,"mat-tab",40),m.Qc(8,gi,4,5,"mat-tab",40),m.Qc(9,wi,23,18,"mat-tab",40),m.Qc(10,Di,26,19,"mat-tab",41),m.Qc(11,zi,36,19,"mat-tab",40),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(1),m.sc("selectedIndex",t.selectedTabIndex),m.Eb(1),m.tc("label",m.nc(3,10,"lang.informations")),m.Eb(2),m.sc("ngIf",t.showPassword),m.Eb(1),m.sc("ngIf","ABS"==t.user.status&&!t.showPassword),m.Eb(1),m.sc("ngIf",!t.showPassword),m.Eb(1),m.sc("ngIf",!t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode)}}function Ni(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item"),m.Ub(1,"mat-icon",185),m.Zb(2,"h4",20),m.Sc(3),m.Yb(),m.Zb(4,"p",20),m.Zb(5,"mat-form-field",186),m.Zb(6,"input",187),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.role=i}))("change",(function(){m.Hc(t);const i=e.$implicit;return m.lc().updateGroup(i)})),m.mc(7,"translate"),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-hint",188),m.mc(10,"translate"),m.Sc(11),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(3),m.Tc(t.group_desc),m.Eb(3),m.tc("title",m.nc(7,6,"lang.role")),m.tc("placeholder",m.nc(8,8,"lang.role")),m.sc("ngModel",t.role),m.Eb(3),m.tc("matTooltip",m.nc(10,10,"lang.perimeter")),m.Eb(2),m.Tc(t.maarch_comment)}}function Ji(t,e){1&t&&m.Ub(0,"mat-icon",193)}function Gi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-icon",194),m.Zb(1,"button",195),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc().updatePrimaryEntity(e)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",196),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.entityTooglePrimary")))}function Bi(t,e){1&t&&(m.Zb(0,"span",117),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.primary")))}const Wi=function(t){return{"font-weight":t}};function qi(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item"),m.Qc(1,Ji,1,0,"mat-icon",189),m.Qc(2,Gi,4,3,"mat-icon",190),m.Zb(3,"h4",191),m.Sc(4),m.Qc(5,Bi,3,3,"span",192),m.Yb(),m.Zb(6,"p",20),m.Zb(7,"mat-form-field",186),m.Zb(8,"input",187),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.user_role=i}))("change",(function(){m.Hc(t);const i=e.$implicit;return m.lc().updateEntity(i)})),m.mc(9,"translate"),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","Y"==t.primary_entity),m.Eb(1),m.sc("ngIf","Y"!=t.primary_entity),m.Eb(1),m.tc("matTooltip",t.entity_label),m.sc("ngStyle",m.zc(13,Wi,"Y"==t.primary_entity?"bold":"normal")),m.Eb(1),m.Uc(" ",t.entity_label," "),m.Eb(1),m.sc("ngIf","Y"==t.primary_entity),m.Eb(3),m.tc("title",m.nc(9,9,"lang.role")),m.tc("placeholder",m.nc(10,11,"lang.role")),m.sc("ngModel",t.user_role)}}function Xi(t,e){1&t&&(m.Ub(0,"div",15),m.mc(1,"translate")),2&t&&m.sc("innerHTML",m.nc(1,1,"lang.redirectConfidentialInfo"),m.Ic)}function Ki(t,e){1&t&&(m.Ub(0,"div",15),m.mc(1,"translate")),2&t&&m.sc("innerHTML",m.nc(1,1,"lang.redirectModelInfo"),m.Ic)}function ta(t,e){if(1&t){const t=m.ac();m.Zb(0,"plugin-autocomplete",16),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc().setRedirectUser(e)})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}2&t&&m.sc("labelPlaceholder",m.nc(1,5,"lang.userReplacement"))("labelList",m.nc(2,7,"lang.availableUsers"))("routeDatas",m.yc(9,yi))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay")}function ea(t,e){1&t&&(m.Zb(0,"span"),m.Zb(1,"em"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,1,"lang.doNothingRedirectInformations")))}function ia(t,e){1&t&&(m.Ub(0,"span",17),m.mc(1,"translate")),2&t&&m.sc("innerHTML",m.nc(1,1,"lang.removeUserRedirectInformations"),m.Ic)}function aa(t,e){1&t&&(m.Zb(0,"span"),m.Zb(1,"em"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,1,"lang.reaffectUserRedirectInformations")))}let na=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r,l,d,b){this.translate=t,this.http=e,this.route=i,this.router=a,this.zone=n,this.notify=s,this.dialog=c,this.headerService=o,this._formBuilder=r,this.appService=l,this.privilegeService=d,this.viewContainerRef=b,this.loading=!1,this.highlightMe=!1,this.config={},this.mode="",this.user={mode:"standard",authorizedApi:""},this._search="",this.signatureModel={base64:"",base64ForJs:"",name:"",type:"",size:0,label:""},this.userAbsenceModel=[],this.userList=[],this.maarchParapheurLink={login:"",picture:""},this.selectedSignature=-1,this.selectedSignatureLabel="",this.loadingSign=!1,this.data=[],this.CurrentYear=(new Date).getFullYear(),this.currentMonth=(new Date).getMonth()+1,this.minDate=new Date,this.ruleText="",this.validPassword=!1,this.showPassword=!1,this.hidePassword=!0,this.passwordModel={currentPassword:"",newPassword:"",reNewPassword:""},this.passwordRules={minLength:{enabled:!1,value:0},complexityUpper:{enabled:!1,value:0},complexityNumber:{enabled:!1,value:0},complexitySpecial:{enabled:!1,value:0},renewal:{enabled:!1,value:0},historyLastUse:{enabled:!1,value:0}},this.displayedColumns=["event_date","record_id","info","remote_ip"],this.dataSource=new G.o(this.data),this.selectedTabIndex=0,this.maarchParapheurConnectionStatus=!0,this.canViewPersonalDatas=!1,this.canManagePersonalDatas=!1,this.adminModes=[{id:"standard",label:this.translate.instant("lang.standard")},{id:"root_visible",label:this.translate.instant("lang.root_visible")},{id:"root_invisible",label:this.translate.instant("lang.root_invisible")},{id:"rest",label:this.translate.instant("lang.rest")}],this.appVersion=ke.a.VERSION.split(".")[0]+"."+ke.a.VERSION.split(".")[1],this.selectionBaskets=new Ze.c(!0,[]),window.angularUserAdministrationComponent={componentAfterUpload:t=>this.processAfterUpload(t)}}applyFilter(t){t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t}masterToggleBaskets(t){t.checked?this.user.baskets.forEach(t=>{t.userToDisplay||this.selectionBaskets.select(t)}):this.selectionBaskets.clear()}ngOnInit(){this.loading=!0,this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.userCreation")),this.creationMode=!0,this.canViewPersonalDatas=!1,this.canManagePersonalDatas=this.privilegeService.hasCurrentUserPrivilege("manage_personal_data"),this.loading=!1):(this.creationMode=!1,this.serialId=t.id,this.http.get("../rest/users/"+this.serialId+"/details").subscribe(t=>{this.user=t,"rest"===this.user.mode&&(this.user.authorizedApi=this.user.authorizedApi.join("\n")),this.headerService.user.id===this.user.id?(this.canViewPersonalDatas=!0,this.canManagePersonalDatas=!0):(this.canViewPersonalDatas=this.privilegeService.hasCurrentUserPrivilege("view_personal_data"),this.canManagePersonalDatas=this.privilegeService.hasCurrentUserPrivilege("manage_personal_data")),this.canManagePersonalDatas&&(this.canViewPersonalDatas=!0),this.canViewPersonalDatas||(this.user.phone="****"),this.data=t.history,this.userId=t.user_id,this.minDate=new Date(this.CurrentYear+"-"+this.currentMonth+"-01"),this.headerService.setHeader(this.translate.instant("lang.userModification"),t.firstname+" "+t.lastname),void 0!==this.user.external_id.maarchParapheur&&this.checkInfoMaarchParapheurAccount(),this.loading=!1,setTimeout(()=>{this.dataSource=new G.o(this.data),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},0)},t=>{this.notify.handleErrors(t)}))})}checkInfoMaarchParapheurAccount(){this.http.get("../rest/users/"+this.serialId+"/statusInMaarchParapheur").subscribe(t=>{this.maarchParapheurLink.login=t.link,this.loading=!1,""!==this.maarchParapheurLink.login?this.loadAvatarMaarchParapheur(this.user.external_id.maarchParapheur):this.maarchParapheurConnectionStatus=!1})}linkMaarchParapheurAccount(){this.dialog.open(Te,{panelClass:"maarch-modal",autoFocus:!1,data:{user:this.user}}).afterClosed().subscribe(t=>{t&&(t.inMaarchParapheur?this.linkAccountToMaarchParahpeur(t.id):this.createAccountToMaarchParahpeur(t.id,t.login))})}linkAccountToMaarchParahpeur(t){this.http.put("../rest/users/"+this.serialId+"/linkToMaarchParapheur",{maarchParapheurUserId:t}).subscribe(()=>{this.user.canCreateMaarchParapheurUser=!1,this.user.external_id.maarchParapheur=t,this.checkInfoMaarchParapheurAccount(),this.notify.success(this.translate.instant("lang.accountLinked"))},t=>{this.notify.error(t.error.errors)})}createAccountToMaarchParahpeur(t,e){this.http.put("../rest/users/"+t+"/createInMaarchParapheur",{login:e}).subscribe(t=>{this.user.canCreateMaarchParapheurUser=!1,this.user.external_id.maarchParapheur=t.externalId,this.checkInfoMaarchParapheurAccount(),this.notify.success(this.translate.instant("lang.accountAdded"))},t=>{"Login already exists"===t.error.errors&&(t.error.errors=this.translate.instant("lang.loginAlreadyExistsInMaarchParapheur")),this.notify.error(t.error.errors)})}loadAvatarMaarchParapheur(t){this.http.get("../rest/maarchParapheur/user/"+t+"/picture").subscribe(t=>{this.maarchParapheurLink.picture=t.picture},t=>{this.notify.handleErrors(t)})}unlinkMaarchParapheurAccount(){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.unlinkAccount"))&&this.http.put("../rest/users/"+this.serialId+"/unlinkToMaarchParapheur",{}).subscribe(()=>{this.user.canCreateMaarchParapheurUser=!0,this.maarchParapheurLink.login="",this.maarchParapheurLink.picture="",this.notify.success(this.translate.instant("lang.accountUnlinked")),this.maarchParapheurConnectionStatus=!0},t=>{this.notify.error(t.error.errors)})}toogleRedirect(t){$("#redirectUser_"+t.group_id+"_"+t.basket_id).toggle(),this.http.get("../rest/users").subscribe(t=>{},t=>{this.notify.handleErrors(t)})}initService(){0===this.maarchTree.rawData.length&&this.maarchTree.initData(this.user.allEntities.map(t=>Object.assign(Object.assign({},t),{parent_id:t.parent})))}processAfterUpload(t){this.zone.run(()=>this.resfreshUpload(t))}resfreshUpload(t){this.signatureModel.size<=2e6?(this.signatureModel.base64=t.replace(/^data:.*?;base64,/,""),this.signatureModel.base64ForJs=t):(this.signatureModel.name="",this.signatureModel.size=0,this.signatureModel.type="",this.signatureModel.base64="",this.signatureModel.base64ForJs="",this.notify.error("Taille maximum de fichier d\xe9pass\xe9e (2 MB)"))}clickOnUploader(t){$("#"+t).click()}uploadSignatureTrigger(t){if(t.target.files&&t.target.files[0]){const e=new FileReader;this.signatureModel.name=t.target.files[0].name,this.signatureModel.size=t.target.files[0].size,this.signatureModel.type=t.target.files[0].type,""===this.signatureModel.label&&(this.signatureModel.label=this.signatureModel.name),e.readAsDataURL(t.target.files[0]),e.onload=t=>{window.angularUserAdministrationComponent.componentAfterUpload(t.target.result),this.submitSignature()}}}displaySignatureEditionForm(t){this.selectedSignature=t,this.selectedSignatureLabel=this.user.signatures[t].signature_label}resendActivationNotification(){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.sendActivationNotification"))&&this.http.put("../rest/users/"+this.serialId+"/accountActivationNotification",{}).subscribe(t=>{this.notify.success(this.translate.instant("lang.activationNotificationSend"))},t=>{this.notify.error(t.error.errors)})}toggleGroup(t){!0===$("#"+t.group_id+"-input").is(":checked")?this.http.post("../rest/users/"+this.serialId+"/groups",{groupId:t.group_id,role:t.role}).subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){this.user.groups=t.groups,this.user.baskets=t.baskets,this.headerService.user.id==this.serialId&&(yield this.headerService.resfreshCurrentUser(),this.privilegeService.resfreshUserShortcuts()),this.notify.success(this.translate.instant("lang.groupAdded"))})),t=>{this.notify.error(t.error.errors)}):this.http.delete("../rest/users/"+this.serialId+"/groups/"+t.group_id).subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){this.user.groups=t.groups,this.user.baskets=t.baskets,this.user.redirectedBaskets=t.redirectedBaskets,this.headerService.user.id==this.serialId&&(yield this.headerService.resfreshCurrentUser(),this.privilegeService.resfreshUserShortcuts()),this.notify.success(this.translate.instant("lang.groupDeleted"))})),t=>{this.notify.error(t.error.errors)})}updateGroup(t){this.http.put("../rest/users/"+this.serialId+"/groups/"+t.group_id,t).subscribe(t=>{this.notify.success(this.translate.instant("lang.groupUpdated"))},t=>{this.notify.error(t.error.errors)})}addEntity(t){t.forEach(t=>{this.http.post("../rest/users/"+this.serialId+"/entities",{entityId:t.entity_id,role:""}).subscribe(t=>{this.user.entities=t.entities,this.user.allEntities=t.allEntities,this.headerService.user.id==this.serialId&&this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.entityAdded"))},t=>{this.notify.error(t.error.errors)})})}updateEntity(t){this.http.put("../rest/users/"+this.serialId+"/entities/"+t.entity_id,t).subscribe(()=>{this.notify.success(this.translate.instant("lang.entityUpdated"))},t=>{this.notify.error(t.error.errors)})}updatePrimaryEntity(t){this.http.put("../rest/users/"+this.serialId+"/entities/"+t.entity_id+"/primaryEntity",{}).subscribe(e=>{this.user.entities=e.entities,this.notify.success(this.translate.instant("lang.entityTooglePrimary")+" \xab "+t.entity_id+" \xbb")},t=>{this.notify.error(t.error.errors)})}deleteEntity(t){t.forEach(t=>{const e=t.entity_id;this.http.get("../rest/users/"+this.serialId+"/entities/"+e).subscribe(i=>{i.hasConfidentialityInstances||i.hasListTemplates?(this.config={panelClass:"maarch-modal",data:{hasConfidentialityInstances:i.hasConfidentialityInstances,hasListTemplates:i.hasListTemplates}},this.dialogRef=this.dialog.open(sa,this.config),this.dialogRef.afterClosed().subscribe(i=>{this.mode="delete",i?(this.mode=i.processMode,this.http.request("DELETE","../rest/users/"+this.serialId+"/entities/"+e,{body:{mode:this.mode,newUser:i.newUser}}).subscribe(t=>{this.user.entities=t.entities,this.user.allEntities=t.allEntities,this.headerService.user.id==this.serialId&&this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.entityDeleted"))},t=>{this.notify.error(t.error.errors)})):(this.maarchTree.toggleNode(this.maarchTree.dataSource.data,{selected:!0,opened:!0},[t.id]),this.mode=""),this.dialogRef=null})):this.http.delete("../rest/users/"+this.serialId+"/entities/"+e).subscribe(t=>{this.user.entities=t.entities,this.user.allEntities=t.allEntities,this.headerService.user.id==this.serialId&&this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.entityDeleted"))},t=>{this.notify.error(t.error.errors)})},t=>{this.notify.error(t.error.errors)})})}submitSignature(){this.http.post("../rest/users/"+this.serialId+"/signatures",this.signatureModel).subscribe(t=>{this.user.signatures=t.signatures,this.notify.success(this.translate.instant("lang.signAdded")),this.signatureModel={base64:"",base64ForJs:"",name:"",type:"",size:0,label:""}},t=>{this.notify.error(t.error.errors)})}updateSignature(t){this.http.put("../rest/users/"+this.serialId+"/signatures/"+this.user.signatures[t].id,{label:this.user.signatures[t].signature_label}).subscribe(e=>{this.user.signatures[t].signature_label=e.signature.signature_label,this.notify.success(this.translate.instant("lang.signUpdated"))},t=>{this.notify.error(t.error.errors)})}deleteSignature(t){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+t.signature_label+" \xbb")&&this.http.delete("../rest/users/"+this.serialId+"/signatures/"+t.id).subscribe(t=>{this.user.signatures=t.signatures,this.notify.success(this.translate.instant("lang.signDeleted"))},t=>{this.notify.error(t.error.errors)})}test(t){if(t.mouseEvent.dataTransfer.files&&t.mouseEvent.dataTransfer.files[0]){const e=new FileReader;this.signatureModel.name=t.mouseEvent.dataTransfer.files[0].name,this.signatureModel.size=t.mouseEvent.dataTransfer.files[0].size,this.signatureModel.type=t.mouseEvent.dataTransfer.files[0].type,""===this.signatureModel.label&&(this.signatureModel.label=this.signatureModel.name),e.readAsDataURL(t.mouseEvent.dataTransfer.files[0]),e.onload=t=>{window.angularUserAdministrationComponent.componentAfterUpload(t.target.result),this.submitSignature()}}}addBasketRedirection(t){const e=[];this.selectionBaskets.selected.forEach(i=>{e.push({actual_user_id:t.serialId,basket_id:i.basket_id,group_id:i.groupSerialId,originalOwner:null})}),confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.redirectBasket"))&&this.http.post("../rest/users/"+this.serialId+"/redirectedBaskets",e).subscribe(t=>{this.user.baskets=t.baskets,this.user.redirectedBaskets=t.redirectedBaskets,this.selectionBaskets.clear(),this.notify.success(this.translate.instant("lang.basketUpdated"))},t=>{this.notify.error(t.error.errors)})}reassignBasketRedirection(t,e,i){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.redirectBasket"))&&this.http.post("../rest/users/"+this.serialId+"/redirectedBaskets",[{actual_user_id:t.serialId,basket_id:e.basket_id,group_id:e.group_id,originalOwner:e.owner_user_id}]).subscribe(t=>{this.user.baskets=t.baskets,this.user.assignedBaskets.splice(i,1),this.notify.success(this.translate.instant("lang.basketUpdated"))},t=>{this.notify.error(t.error.errors)})}delBasketRedirection(t,e){confirm(this.translate.instant("lang.confirmAction"))&&this.http.delete("../rest/users/"+this.serialId+"/redirectedBaskets?redirectedBasketIds[]="+t.id).subscribe(t=>{this.user.baskets=t.baskets,this.user.redirectedBaskets.splice(e,1),this.notify.success(this.translate.instant("lang.basketUpdated"))},t=>{this.notify.error(t.error.errors)})}delBasketAssignRedirection(t,e){confirm(this.translate.instant("lang.confirmAction"))&&this.http.delete("../rest/users/"+this.serialId+"/redirectedBaskets?redirectedBasketIds[]="+t.id).subscribe(t=>{this.user.baskets=t.baskets,this.user.assignedBaskets.splice(e,1),this.notify.success(this.translate.instant("lang.basketUpdated"))},t=>{this.notify.error(t.error.errors)})}toggleBasket(t){const e=[];this.user.baskets.forEach(i=>{this.selectionBaskets.selected.forEach(a=>{i.basket_id===a.basket_id&&i.group_id===a.group_id&&i.allowed!==t&&(i.allowed=t,e.push({basketId:i.basket_id,groupSerialId:i.groupSerialId,allowed:t}))})}),e.length>0&&this.http.put("../rest/users/"+this.serialId+"/baskets",{baskets:e}).subscribe(t=>{this.selectionBaskets.clear(),this.notify.success(this.translate.instant("lang.basketsUpdated"))},t=>{this.notify.error(t.error.errors)})}activateAbsence(){this.http.put("../rest/users/"+this.serialId+"/status",{status:"ABS"}).subscribe(t=>{this.user.status=t.user.status,this.userAbsenceModel=[],this.notify.success(this.translate.instant("lang.absOn"))},t=>{this.notify.error(t.error.errors)})}desactivateAbsence(){this.http.put("../rest/users/"+this.serialId+"/status",{status:"OK"}).subscribe(t=>{this.user.status=t.user.status,this.notify.success(this.translate.instant("lang.absOff"))},t=>{this.notify.error(t.error.errors)})}getErrorMessage(){return this.firstFormGroup.controls.retypePasswordCtrl.setErrors(this.firstFormGroup.controls.newPasswordCtrl.value!==this.firstFormGroup.controls.retypePasswordCtrl.value?{mismatch:!0}:null),this.firstFormGroup.controls.newPasswordCtrl.hasError("required")?this.translate.instant("lang.requiredField")+" !":this.firstFormGroup.controls.newPasswordCtrl.hasError("minlength")&&this.passwordRules.minLength.enabled?this.passwordRules.minLength.value+" "+this.translate.instant("lang.passwordminLength")+" !":null!=this.firstFormGroup.controls.newPasswordCtrl.errors&&void 0!==this.firstFormGroup.controls.newPasswordCtrl.errors.complexityUpper&&this.passwordRules.complexityUpper.enabled?this.translate.instant("lang.passwordcomplexityUpper")+" !":null!=this.firstFormGroup.controls.newPasswordCtrl.errors&&void 0!==this.firstFormGroup.controls.newPasswordCtrl.errors.complexityNumber&&this.passwordRules.complexityNumber.enabled?this.translate.instant("lang.passwordcomplexityNumber")+" !":null!=this.firstFormGroup.controls.newPasswordCtrl.errors&&void 0!==this.firstFormGroup.controls.newPasswordCtrl.errors.complexitySpecial&&this.passwordRules.complexitySpecial.enabled?this.translate.instant("lang.passwordcomplexitySpecial")+" !":(this.firstFormGroup.controls.newPasswordCtrl.setErrors(null),this.validPassword=!0,"")}matchValidator(t){return t.controls.newPasswordCtrl.value!==t.controls.retypePasswordCtrl.value&&(t.controls.retypePasswordCtrl.setErrors({mismatch:!0}),{mismatch:!0})}regexValidator(t,e){return i=>i.value?t.test(i.value)?null:e:null}changePasswd(){this.http.get("../rest/passwordRules").subscribe(t=>{const e=[],i=[],a=[];e.push(o.H.required),t.rules.forEach(t=>{"minLength"===t.label?(this.passwordRules.minLength.enabled=t.enabled,this.passwordRules.minLength.value=t.value,t.enabled&&(e.push(o.H.minLength(this.passwordRules.minLength.value)),i.push(t.value+" "+this.translate.instant("lang.password"+t.label)))):"complexityUpper"===t.label?(this.passwordRules.complexityUpper.enabled=t.enabled,this.passwordRules.complexityUpper.value=t.value,t.enabled&&(e.push(this.regexValidator(new RegExp("[A-Z]"),{complexityUpper:""})),i.push(this.translate.instant("lang.password"+t.label)))):"complexityNumber"===t.label?(this.passwordRules.complexityNumber.enabled=t.enabled,this.passwordRules.complexityNumber.value=t.value,t.enabled&&(e.push(this.regexValidator(new RegExp("[0-9]"),{complexityNumber:""})),i.push(this.translate.instant("lang.password"+t.label)))):"complexitySpecial"===t.label?(this.passwordRules.complexitySpecial.enabled=t.enabled,this.passwordRules.complexitySpecial.value=t.value,t.enabled&&(e.push(this.regexValidator(new RegExp("[^A-Za-z0-9]"),{complexitySpecial:""})),i.push(this.translate.instant("lang.password"+t.label)))):"renewal"===t.label?(this.passwordRules.renewal.enabled=t.enabled,this.passwordRules.renewal.value=t.value,t.enabled&&a.push(this.translate.instant("lang.password"+t.label)+" <b>"+t.value+" "+this.translate.instant("lang.days")+"</b>. "+this.translate.instant("lang.password2"+t.label)+".")):"historyLastUse"===t.label&&(this.passwordRules.historyLastUse.enabled=t.enabled,this.passwordRules.historyLastUse.value=t.value,t.enabled&&a.push(this.translate.instant("lang.passwordhistoryLastUseDesc")+" <b>"+t.value+"</b> "+this.translate.instant("lang.passwordhistoryLastUseDesc2")+"."))}),this.ruleText=i.join(", "),this.otherRuleText=a.join("<br/>"),this.firstFormGroup.controls.newPasswordCtrl.setValidators(e)},t=>{this.notify.error(t.error.errors)}),this.firstFormGroup=this._formBuilder.group({newPasswordCtrl:[""],retypePasswordCtrl:["",o.H.compose([o.H.required])],currentPasswordCtrl:["",o.H.compose([o.H.required])]},{validator:this.matchValidator}),this.validPassword=!1,this.firstFormGroup.controls.currentPasswordCtrl.setErrors(null),this.firstFormGroup.controls.newPasswordCtrl.setErrors(null),this.firstFormGroup.controls.retypePasswordCtrl.setErrors(null),this.showPassword=!0,this.selectedTabIndex=0}updatePassword(){this.passwordModel.currentPassword=this.firstFormGroup.controls.currentPasswordCtrl.value,this.passwordModel.newPassword=this.firstFormGroup.controls.newPasswordCtrl.value,this.passwordModel.reNewPassword=this.firstFormGroup.controls.retypePasswordCtrl.value,this.http.put("../rest/users/"+this.serialId+"/password",this.passwordModel).subscribe(()=>{this.showPassword=!1,this.passwordModel={currentPassword:"",newPassword:"",reNewPassword:""},this.notify.success(this.translate.instant("lang.passwordUpdated"))},t=>{this.notify.error(t.error.errors)})}onSubmit(){if(this.creationMode){let t=!0;this.http.get("../rest/users/"+this.user.userId+"/status").subscribe(e=>{let i=!1;e.status&&"DEL"===e.status&&(t=confirm(this.translate.instant("lang.reactivateUserDeleted")),i=!0),t&&this.http.post("../rest/users",this.user).subscribe(t=>{this.notify.success(this.translate.instant(i?"lang.userUpdated":"lang.userAdded")),this.router.navigate(["/administration/users/"+t.id])},t=>{this.notify.error(t.error.errors)})},t=>{this.notify.error(t.error.errors)})}else{const t=Object.assign({},this.user);"rest"===this.user.mode&&(t.authorizedApi=""!==this.user.authorizedApi.split("\n")[0]?this.user.authorizedApi.split("\n"):[]),this.http.put("../rest/users/"+this.serialId,t).subscribe(t=>{this.headerService.user.id==this.serialId&&this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.userUpdated"))},t=>{this.notify.error(t.error.errors)})}}setUserModeLogin(t){this.user.mode=t.checked?"rest":"standard"}sendToMaarchParapheur(){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.createUserInMaarchParapheur"))&&this.http.put("../rest/users/"+this.serialId+"/maarchParapheur","").subscribe(t=>{this.notify.success(this.translate.instant("lang.userCreatedInMaarchParapheur")),this.user.external_id.maarchParapheur=t.externalId,this.user.canCreateMaarchParapheurUser=!1},t=>{this.notify.error(t.error.errors)})}setLowerUserId(){this.user.userId=this.user.userId.toLowerCase()}syncMP(){this.loadingSign=!0,this.http.put("../rest/users/"+this.user.id+"/externalSignatures",{}).subscribe(t=>{this.loadingSign=!1,this.notify.success(this.translate.instant("lang.signsSynchronized"))},t=>{this.loadingSign=!1,this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(m.B),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(o.g),m.Tb(f.a),m.Tb(g.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Ae,!0),m.Oc(He,!0),m.ad($e,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.maarchTree=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:27,vars:19,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","max-width","500px",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["mat-list-item","",3,"click",4,"ngIf"],["mat-list-item","",3,"title","click",4,"ngIf"],["mat-list-item","",3,"click"],["color","warn","mat-list-icon","",1,"fa","fa-plane"],["mat-line",""],["color","accent","mat-list-icon","",1,"fa","fa-check"],["color","primary","mat-list-icon","",1,"fa","fa-paper-plane"],["color","primary","mat-list-icon","",1,"fa","fa-key"],["mat-list-item","",3,"title","click"],["color","primary","mat-list-icon","",1,"fa","fa-link"],["mat-line","","style","font-size:11px;color:red",4,"ngIf"],["mat-line","",2,"font-size","11px","color","red"],["color","primary","mat-list-icon","",1,"avatarAccount"],["mat-line","",1,"accountInfo"],["mat-icon-button","","color","warn",3,"title","click"],[1,"fas","fa-unlink"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"selectedIndex","selectedIndexChange","selectedTabChange"],[3,"label"],["style","margin-bottom: 5%",4,"ngIf"],["class","text-warning","style","position: absolute;opacity: 0.25;font-size: 120px;transform: rotate(324deg);-webkit-transform: rotate(324deg);margin-left: 35%;margin-top: 90px;",4,"ngIf"],["class","form-horizontal",3,"ngSubmit",4,"ngIf"],[3,"label",4,"ngIf"],[3,"label","disabled",4,"ngIf"],[2,"margin-bottom","5%"],[3,"formGroup"],[1,"form-group"],[2,"padding","10px"],["matInput","","formControlName","currentPasswordCtrl","required","",3,"placeholder","type"],["matSuffix","",1,"fa","fa-2x",3,"ngClass","click"],[2,"text-align","center","color","rgba(0,0,0,0.54)","font-size","75%"],[1,"col-sm-6",2,"padding-left","0px","padding-right","0px"],["matInput","","formControlName","newPasswordCtrl","required","",3,"placeholder","type"],["inputPasswd",""],["matInput","","required","","formControlName","retypePasswordCtrl",3,"placeholder","type"],["inputPasswd2",""],["class","form-group",4,"ngIf"],[2,"text-align","center"],["mat-raised-button","","color","primary","type","button",3,"disabled","click"],["mat-raised-button","","color","default","type","button",3,"click"],["color","accent",1,"fa","fa-check"],["color","accent"],[1,"col-sm-12",2,"padding-left","0px","padding-right","0px"],["role","alert",1,"alert","alert-warning",2,"text-align","center",3,"innerHTML"],[1,"text-warning",2,"position","absolute","opacity","0.25","font-size","120px","transform","rotate(324deg)","-webkit-transform","rotate(324deg)","margin-left","35%","margin-top","90px"],[1,"form-horizontal",3,"ngSubmit"],["profileForm","ngForm"],[1,"col-sm-12"],[1,"pull-left"],[1,"avatar",2,"font-size","90px","text-align","center"],[1,"fa","fa-user",2,"font-size","90px","padding-top","5px"],[1,"input-group"],["matInput","","type","text","name","user_id","pattern","^[\\w.@-]*$","required","",3,"title","ngModel","placeholder","ngModelChange","keyup",4,"ngIf"],["matInput","","type","text","disabled","",3,"title","value","placeholder",4,"ngIf"],[1,"col-sm-5",2,"font-weight","bold"],["matInput","","type","text","id","lastname","name","lastname","required","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","type","text","id","firstname","name","firstname","required","",3,"title","placeholder","ngModel","ngModelChange"],[1,"col-sm-2",2,"font-style","italic"],["matInput","","type","text","id","initials","name","initials",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","type","tel","id","phone","name","phone","pattern","\\+?((|\\ |\\.|\\(|\\)|\\-)?(\\d)*)*\\d$",3,"title","placeholder","ngModel","disabled","ngModelChange"],["matInput","","type","email","id","mail","name","mail","pattern","(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$)","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"expanded"],[2,"color","rgba(0,0,0,0.54)"],["id","accountType","name","accountType","required","",3,"ngModel","disabled","ngModelChange"],[1,"form-group",2,"margin-top","10px"],["mat-raised-button","","color","primary","type","submit",3,"disabled",4,"ngIf"],["matInput","","type","text","name","user_id","pattern","^[\\w.@-]*$","required","",3,"title","ngModel","placeholder","ngModelChange","keyup"],["matInput","","type","text","disabled","",3,"title","value","placeholder"],[3,"value","disabled","title"],["matInput","","name","authorizedApi","placeholder","Ex : PUT/attachments/{id}",3,"ngModel","ngModelChange"],["target","_blank",3,"href"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["disableRipple","true",4,"ngFor","ngForOf"],["disableRipple","true"],["color","primary",3,"id","checked","disabled","change"],[3,"selectionPropagation","openState","afterSelectNode","afterDeselectNode"],["maarchTree",""],[1,"col-sm-6",2,"overflow","hidden"],["mat-list-icon","","color","primary"],["color","primary",3,"checked","matTooltip","change"],["mat-line","","style","opacity: 0.5;font-style: italic;font-size: 80%;margin-top:10px;",4,"ngIf"],["mat-line","","style","margin-top:10px;",4,"ngIf"],["mat-line","",2,"opacity","0.5","font-style","italic","font-size","80%","margin-top","10px"],["mat-line","",2,"margin-top","10px"],["mat-icon-button","",3,"matMenuTriggerFor","matTooltip"],[1,"fa","fa-reply"],[1,"vertical-divider",3,"vertical"],["color","warn","mat-icon-button","",3,"matTooltip","click"],[1,"fa","fa-ban"],["color","accent","mat-icon-button","",3,"matTooltip","click"],[1,"fa","fa-check"],[2,"width","200px !important"],["menu","matMenu"],["appearance","outline",3,"labelPlaceholder","routeDatas","targetSearchKey","subInfoKey","triggerEvent"],["style","cursor: pointer;",4,"ngIf"],[2,"cursor","pointer"],["mat-list-icon","","color","primary",4,"ngIf"],["mat-line","","color","primary",2,"display","flex","align-items","center"],[2,"flex","2","overflow","hidden","text-overflow","ellipsis",3,"matTooltip","ngStyle","click"],[1,"label","label-primary",2,"font-weight","normal"],["color","primary",3,"checked","click","change"],["mat-list-icon","","color","primary",1,"fa","fa-paper-plane",2,"margin-top","-60px"],["mat-line","","color","primary"],["type","text","color","warn","matInput","","disabled","",3,"value"],["mat-button","","color","warn","matSuffix","","mat-icon-button","","aria-label","Clear",3,"matTooltip","click"],["color","warn",1,"fa","fa-times","text-danger"],["mat-list-icon","","color","primary",1,"fa","fa-reply",2,"margin-top","-60px"],["appearance","outline",3,"labelPlaceholder","routeDatas","targetSearchKey","subInfoKey","triggerEvent",4,"ngIf"],["color","primary",1,"fa","fa-edit"],[3,"label","disabled"],["dnd-droppable","","class","dndFile",3,"matTooltip","dndFileHighlighted","click","dragover","dragleave","onDropSuccess",4,"ngIf"],[2,"display","flex","align-items","flex-start"],[2,"flex","1"],["class","col-md-3 col-sm-6 col-xm-12",4,"ngFor","ngForOf"],["mat-icon-button","","color","primary",3,"matTooltip","disabled","click",4,"ngIf"],[2,"display","none",3,"ngSubmit"],["signatureForm","ngForm"],[1,"col-md-11"],["type","text","id","signLabel","name","label","required","",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"form-inline","hide"],["type","file","name","files[]","id","uploadSignFile","accept","image/*",3,"change"],[1,"col-md-1",2,"margin-bottom","5px"],["type","submit",1,"form-control","btn","btn-sm","btn-success",3,"disabled"],[1,"fa","fa-plus"],[3,"ngClass"],[1,"upload-drop-zone",2,"cursor","pointer",3,"click"],[1,"fa","fa-upload","fa-2x"],["class","col-md-2",4,"ngIf"],["dnd-droppable","",1,"dndFile",3,"matTooltip","click","dragover","dragleave","onDropSuccess"],[1,"col-md-3","col-sm-6","col-xm-12"],[2,"margin-bottom","10px","overflow","hidden"],["floatLabel","never"],["matInput","","type","text","name","selectedSignatureLabel",3,"ngModel","placeholder","disabled","ngModelChange","change"],["mat-button","","matSuffix","","mat-icon-button","","color","warn",3,"matTooltip","disabled","click"],[1,"fa","fa-times"],["alt","Signature",2,"width","auto","height","60px",3,"src"],["mat-icon-button","","color","primary",3,"matTooltip","disabled","click"],[1,"fa","fa-sync-alt","fa-2x"],[1,"col-md-2"],["id","signaturePreview","alt","Invalid image",2,"width","100%",3,"src"],[1,"col-md-12"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"placeholder","keyup"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortActive","event_date","matSortDirection","desc",3,"dataSource"],["table",""],["matColumnDef","event_date"],["mat-sort-header","","style","flex:1;",4,"matHeaderCellDef"],["style","flex:1;",4,"matCellDef"],["matColumnDef","record_id"],["style","flex:1;",4,"matHeaderCellDef"],["matColumnDef","info"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","remote_ip"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"col-md-3","pull-right",2,"padding-top","10px"],["matInput","","disabled","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["startView","month",3,"startAt"],["picker",""],["mat-sort-header","",2,"flex","1"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],["color","primary","mat-list-icon","",1,"fa","fa-users"],[2,"font-size","10px"],["matInput","","type","text","id","role","name","role",3,"title","placeholder","ngModel","ngModelChange","change"],[3,"matTooltip"],["color","primary","mat-list-icon","","class","fa fa-sitemap",4,"ngIf"],["color","primary","mat-list-icon","","class","fa fa-sitemap","style","position:relative;",4,"ngIf"],["mat-line","",3,"ngStyle","matTooltip"],["class","label label-primary","style","font-weight:normal",4,"ngIf"],["color","primary","mat-list-icon","",1,"fa","fa-sitemap"],["color","primary","mat-list-icon","",1,"fa","fa-sitemap",2,"position","relative"],["mat-icon-button","",2,"cursor","pointer","position","absolute","right","-20px","top","-20px","font-size","10px",3,"matTooltip","click"],[1,"fa","fa-arrow-up"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Xe,3,2,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Ke,2,0,"div",9),m.Qc(14,Vi,12,12,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"mat-list"),m.Zb(18,"h3",13),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Qc(21,Ni,12,12,"mat-list-item",14),m.Ub(22,"mat-divider"),m.Zb(23,"h3",13),m.Sc(24),m.mc(25,"translate"),m.Yb(),m.Qc(26,qi,11,15,"mat-list-item",14),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()&&!e.creationMode),m.Eb(4),m.Tc(m.nc(20,15,"lang.groups")),m.Eb(2),m.sc("ngForOf",e.user.groups),m.Eb(3),m.Tc(m.nc(25,17,"lang.entities")),m.Eb(2),m.sc("ngForOf",e.user.entities))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Ot.g,x.s,_.a,Ot.h,Ot.d,Tt.a,Ot.c,I.k,D.b,T.c,k.a,Ie.c,Ie.a,o.J,o.u,o.l,w.c,O.b,o.c,o.t,o.j,o.E,w.j,x.q,w.b,w.f,o.v,o.w,o.A,De.a,De.c,De.g,De.h,w.g,at.a,I.o,et.a,Ue.a,Pe.a,It.b,Fe.d,Fe.e,Dt.a,x.w,Le.d,k.d,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,je.f,je.h,je.d,G.h,V.b,G.a,G.j,G.l],pipes:[p.d,U.a,x.b,Re.a,x.f],styles:[".avatar[_ngcontent-%COMP%]{text-decoration:none;background:#135f7f;color:#fff;width:100px;height:100px;border-radius:5px;display:block;overflow:hidden;margin:5px}.form-group[_ngcontent-%COMP%]{margin:0}.vertical-divider[_ngcontent-%COMP%]{height:80%}.avatarAccount[_ngcontent-%COMP%]{border:3px solid #f99830;height:45px!important;width:45px!important;background-size:cover;background-repeat:no-repeat;background-position:50%}.accountInfo[_ngcontent-%COMP%]{margin-left:20px!important;display:flex!important}.accountInfo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;align-items:center;display:flex}"]}),t})(),sa=(()=>{class t{constructor(t,e,i){this.http=t,this.data=e,this.dialogRef=i,this.redirectUser="",this.processMode=""}setRedirectUser(t){this.redirectUser=t}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.b),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:30,vars:23,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["redirectConfForm","ngForm"],["class","alert-message alert-message-info","role","alert",3,"innerHTML",4,"ngIf"],[1,"input-group"],["id","processMode","name","processMode","color","primary",2,"display","inline-flex","flex-direction","column",3,"ngModel","ngModelChange"],["value","","checked","true","color","primary"],["value","delete","color","primary"],["value","reaffect","color","primary"],["singleMode","","required","",3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","subInfoKey","triggerEvent",4,"ngIf"],["role","alert",1,"alert-message","alert-message-info",2,"max-width","inherit"],[4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"divider-modal"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],["role","alert",1,"alert-message","alert-message-info",3,"innerHTML"],["singleMode","","required","",3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","subInfoKey","triggerEvent"],[3,"innerHTML"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"form",null,2),m.Qc(7,Xi,2,3,"div",3),m.Qc(8,Ki,2,3,"div",3),m.Zb(9,"div",4),m.Zb(10,"mat-radio-group",5),m.hc("ngModelChange",(function(t){return e.processMode=t})),m.Zb(11,"mat-radio-button",6),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Zb(14,"mat-radio-button",7),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Zb(17,"mat-radio-button",8),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Yb(),m.Qc(20,ta,3,10,"plugin-autocomplete",9),m.Zb(21,"div",10),m.Qc(22,ea,4,3,"span",11),m.Qc(23,ia,2,3,"span",12),m.Qc(24,aa,4,3,"span",11),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(25,"span",13),m.Zb(26,"mat-dialog-actions"),m.Zb(27,"button",14),m.hc("click",(function(){return e.dialogRef.close({newUser:e.redirectUser,processMode:e.processMode})})),m.Sc(28),m.mc(29,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,13,"lang.redirects")),m.Eb(5),m.sc("ngIf",e.data.hasConfidentialityInstances),m.Eb(1),m.sc("ngIf",e.data.hasListTemplates),m.Eb(2),m.sc("ngModel",e.processMode),m.Eb(2),m.Uc(" ",m.nc(13,15,"lang.doNothingRedirect")," "),m.Eb(3),m.Uc(" ",m.nc(16,17,"lang.removeUserRedirect")," "),m.Eb(3),m.Uc(" ",m.nc(19,19,"lang.reaffectUserRedirect")," "),m.Eb(2),m.sc("ngIf","reaffect"==e.processMode),m.Eb(2),m.sc("ngIf",""==e.processMode),m.Eb(1),m.sc("ngIf","delete"==e.processMode),m.Eb(1),m.sc("ngIf","reaffect"==e.processMode),m.Eb(3),m.sc("disabled",!e.redirectUser&&"reaffect"==e.processMode),m.Eb(1),m.Tc(m.nc(29,21,"lang.validate")))},directives:[H.i,H.f,o.J,o.u,o.v,x.t,Qe.b,o.t,o.w,Qe.a,H.c,D.b,Dt.a],pipes:[p.d],styles:[".mat-dialog-content[_ngcontent-%COMP%]{max-height: 65vh;width:600px;}"]}),t})();const ca=["snav2"],oa=["adminMenuTemplate"];function ra(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function la(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function da(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",37),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.id"))}}function ba(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.group_id," ")}}function ma(t,e){1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.description")," "))}function pa(t,e){if(1&t&&(m.Zb(0,"mat-cell",39),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.group_desc," ")}}function ua(t,e){1&t&&m.Ub(0,"mat-header-cell",40)}function ha(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",41),m.Zb(1,"button",42),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.preDelete(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",43),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function fa(t,e){1&t&&m.Ub(0,"mat-header-row")}function ga(t,e){1&t&&(m.Ub(0,"mat-row",44),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/groups/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function va(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,da,3,5,"mat-header-cell",26),m.Qc(13,ba,2,3,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,ma,3,3,"mat-header-cell",29),m.Qc(16,pa,2,1,"mat-cell",30),m.Wb(),m.Xb(17,31),m.Qc(18,ua,1,0,"mat-header-cell",32),m.Qc(19,ha,4,3,"mat-cell",33),m.Wb(),m.Qc(20,fa,1,0,"mat-header-row",34),m.Qc(21,ga,2,4,"mat-row",35),m.Yb(),m.Zb(22,"div",36),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(11),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.groups.length," ",m.nc(24,12,"lang.groups"),"")}}function ya(t,e){if(1&t&&(m.Zb(0,"mat-list-item",11),m.Ub(1,"mat-icon",12),m.Ub(2,"h4",13),m.Zb(3,"p",13),m.Sc(4),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(4),m.Vc(" ",t.firstname," ",t.lastname,"")}}function Ca(t,e){if(1&t&&(m.Zb(0,"mat-option",14),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.group_desc," ")}}let Ea=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.appService=s,this.functions=c,this.adminService=o,this.viewContainerRef=r,this.loading=!1,this.config={},this.groups=[],this.groupsForAssign=[],this.displayedColumns=["group_id","group_desc","actions"],this.filterColumns=["group_id","group_desc"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.groups")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/groups").subscribe(t=>{this.groups=t.groups,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_groups",this.groups,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.handleErrors(t)})}preDelete(t){0===t.users.length?confirm(this.translate.instant("lang.reallyWantToDeleteThisGroup"))&&this.deleteGroup(t):(this.groupsForAssign=[],this.groups.forEach(e=>{t.group_id!==e.group_id&&this.groupsForAssign.push(e)}),this.config={panelClass:"maarch-modal",data:{id:t.id,group_desc:t.group_desc,groupsForAssign:this.groupsForAssign,users:t.users}},this.dialogRef=this.dialog.open(Sa,this.config),this.dialogRef.afterClosed().subscribe(e=>{e&&("_NO_REPLACEMENT"===e?this.deleteGroup(t):this.http.put("../rest/groups/"+t.id+"/reassign/"+e,{}).subscribe(e=>{this.deleteGroup(t)},t=>{this.notify.error(t.error.errors)})),this.dialogRef=null}))}deleteGroup(t){this.http.delete("../rest/groups/"+t.id).subscribe(t=>{setTimeout(()=>{this.groups=t.groups,this.adminService.setDataSource("admin_groups",this.groups,this.sort,this.paginator,this.filterColumns)},0),this.notify.success(this.translate.instant("lang.groupDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(ca,!0),m.Oc(oa,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/groups/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row",2,"margin","0px"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSortDisableClear","","matSort","",3,"dataSource"],["table",""],["matColumnDef","group_id"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","group_desc"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","actions"],["style","flex:1;",4,"matHeaderCellDef"],["style","justify-content: flex-end;flex:1;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],[2,"flex","1"],[2,"justify-content","flex-end","flex","1"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,ra,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,la,2,0,"div",9),m.Qc(14,va,25,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})(),Sa=(()=>{class t{constructor(t,e,i){this.http=t,this.data=e,this.dialogRef=i}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.b),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:34,vars:30,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["changeGroupUsersForm","ngForm"],["role","alert",1,"alert-message","alert-message-info"],["style","height:25px;",4,"ngFor","ngForOf"],["id","groups_redirect","name","groups_redirect","required","",3,"title","placeholder","ngModel","ngModelChange"],["value","_NO_REPLACEMENT"],[3,"label"],[3,"value",4,"ngFor","ngForOf"],[1,"divider-modal"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],[2,"height","25px"],["mat-list-icon","","color","primary",1,"fa","fa-user"],["mat-line",""],[3,"value"]],template:function(t,e){if(1&t&&(m.Zb(0,"div",0),m.Zb(1,"h2",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"form",null,2),m.Zb(7,"div",3),m.Sc(8," Le groupe "),m.Zb(9,"b"),m.Sc(10),m.Yb(),m.Sc(11),m.mc(12,"translate"),m.Zb(13,"b"),m.Sc(14),m.Yb(),m.Sc(15),m.mc(16,"translate"),m.Zb(17,"mat-list"),m.Qc(18,ya,5,2,"mat-list-item",4),m.Yb(),m.Yb(),m.Zb(19,"mat-form-field"),m.Zb(20,"mat-select",5),m.hc("ngModelChange",(function(t){return e.data.group_redirect=t})),m.mc(21,"translate"),m.mc(22,"translate"),m.Zb(23,"mat-option",6),m.Sc(24),m.mc(25,"translate"),m.Yb(),m.Zb(26,"mat-optgroup",7),m.mc(27,"translate"),m.Qc(28,Ca,2,2,"mat-option",8),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(29,"span",9),m.Zb(30,"mat-dialog-actions"),m.Zb(31,"button",10),m.hc("click",(function(){return e.dialogRef.close(e.data.group_redirect)})),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(6);m.Eb(2),m.Tc(m.nc(3,14,"lang.groupRedirect")),m.Eb(8),m.Tc(e.data.group_desc),m.Eb(1),m.Uc(" ",m.nc(12,16,"lang.isAssociatedTo")," "),m.Eb(3),m.Tc(e.data.users.length),m.Eb(1),m.Uc(" ",m.nc(16,18,"lang.usersAlt"),": "),m.Eb(3),m.sc("ngForOf",e.data.users),m.Eb(2),m.tc("title",m.nc(21,20,"lang.chooseRedirectGroup")),m.tc("placeholder",m.nc(22,22,"lang.chooseRedirectGroup")),m.sc("ngModel",e.data.group_redirect),m.Eb(4),m.Uc("-- ",m.nc(25,24,"lang.noReplacement")," --"),m.Eb(2),m.tc("label",m.nc(27,26,"lang.groups")),m.Eb(2),m.sc("ngForOf",e.data.groupsForAssign),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(33,28,"lang.validate"))}},directives:[H.i,H.f,o.J,o.u,o.v,Ot.a,x.s,w.c,at.a,o.E,o.t,o.w,I.o,I.n,H.c,D.b,Ot.d,Tt.a,Ot.c,I.k],pipes:[p.d],encapsulation:2}),t})();var Ma=i("5+WD");function Ya(t,e){1&t&&(m.Zb(0,"div",19),m.Ub(1,"mat-spinner",20),m.Yb())}function Za(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",21),m.Sc(1),m.mc(2,"translate"),m.Zb(3,"button",22),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.toggleIndex(!e.indexingInfo.canIndex)})),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.Uc("",m.nc(2,2,"lang.warnIndex")," "),m.Eb(3),m.Tc(m.nc(5,4,"lang.enableIndex")))}function xa(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",23),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.toggleIndex(!e.indexingInfo.canIndex)})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.disableIndex")))}function _a(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",24),m.Zb(1,"div"),m.Ub(2,"i",25),m.Yb(),m.Zb(3,"div",26),m.Sc(4),m.Yb(),m.Zb(5,"div"),m.Zb(6,"button",27),m.hc("click",(function(){m.Hc(t);const i=e.index;return m.lc().removeAction(i)})),m.Ub(7,"mat-icon",28),m.Yb(),m.Yb(),m.Ub(8,"mat-divider"),m.Yb()}if(2&t){const t=e.$implicit;m.sc("cdkDragData",t),m.Eb(4),m.Uc(" ",t.label_action,"")}}let wa=(()=>{class t{constructor(t,e,i,a){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.loading=!0,this.resfreshShortcut=new m.o,this.keywordEntities=[],this.actionList=[],this.indexingInfo={canIndex:!1,actions:[],keywords:[],entities:[]},this.keywordEntities=[{id:"ALL_ENTITIES",keyword:"ALL_ENTITIES",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.allEntities")},{id:"ENTITIES_JUST_BELOW",keyword:"ENTITIES_JUST_BELOW",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.immediatelyBelowMyPrimaryEntity")},{id:"ENTITIES_BELOW",keyword:"ENTITIES_BELOW",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.belowAllMyEntities")},{id:"ALL_ENTITIES_BELOW",keyword:"ALL_ENTITIES_BELOW",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.belowMyPrimaryEntity")},{id:"MY_ENTITIES",keyword:"MY_ENTITIES",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.myEntities")},{id:"MY_PRIMARY_ENTITY",keyword:"MY_PRIMARY_ENTITY",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.myPrimaryEntity")},{id:"SAME_LEVEL_ENTITIES",keyword:"SAME_LEVEL_ENTITIES",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.sameLevelMyPrimaryEntity")},{id:"ENTITIES_JUST_UP",keyword:"ENTITIES_JUST_UP",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.immediatelySuperiorMyPrimaryEntity")}]}ngOnInit(){this.getIndexingInformations().pipe(Object(Zt.tap)(t=>this.indexingInfo.canIndex=t.group.canIndex),Object(Zt.tap)(t=>this.getActions(t.actions)),Object(Zt.tap)(t=>this.getSelectedActions(t.group.indexationParameters.actions)),Object(l.a)(t=>this.getEntities(t)),Object(l.a)(t=>this.getSelectedEntities(t)),Object(Zt.tap)(t=>this.initEntitiesTree(t)),Object(vt.a)(()=>this.loading=!1)).subscribe()}initEntitiesTree(t){$("#jstree").jstree({checkbox:{three_state:!1},core:{force_text:!0,themes:{name:"proton",responsive:!0},data:t},plugins:["checkbox","search"]});let e=!1;$("#jstree_search").keyup((function(){e&&clearTimeout(e),e=setTimeout((function(){const t=$("#jstree_search").val();$("#jstree").jstree(!0).search(t)}),250)})),$("#jstree").on("select_node.jstree",(t,e)=>{isNaN(e.node.id)?this.addKeyword(e.node.id):this.addEntity(e.node.id)}).on("deselect_node.jstree",(t,e)=>{isNaN(e.node.id)?this.removeKeyword(e.node.id):this.removeEntity(e.node.id)}).jstree()}getEntities(t){return this.keywordEntities.forEach(e=>{e.state=t.group.indexationParameters.keywords.indexOf(e.id)>-1?{opened:!0,selected:!0}:{opened:!0,selected:!1}}),t.entities=this.keywordEntities.concat(t.entities),t}getSelectedEntities(t){return this.indexingInfo.entities=[...t.group.indexationParameters.entities],this.indexingInfo.keywords=[...t.group.indexationParameters.keywords],t.entities}getActions(t){this.actionList=t}getIndexingInformations(){return this.http.get("../rest/groups/"+this.groupId+"/indexing")}getSelectedActions(t){let e=-1;t.forEach(t=>{e=this.actionList.findIndex(e=>e.id==t),e>-1&&(this.indexingInfo.actions.push(this.actionList[e]),this.actionList.splice(e,1))})}addEntity(t){const e=this.indexingInfo.entities.concat([t]);this.http.put("../rest/groups/"+this.groupId+"/indexing",{entities:e}).pipe(Object(Zt.tap)(()=>{this.indexingInfo.entities.push(t)}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.entityAdded"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}removeEntity(t){const e=this.indexingInfo.entities.indexOf(t),i=[...this.indexingInfo.entities];i.splice(e,1),this.http.put("../rest/groups/"+this.groupId+"/indexing",{entities:i}).pipe(Object(Zt.tap)(()=>{this.indexingInfo.entities.splice(e,1)}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.entityDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addKeyword(t){const e=this.indexingInfo.keywords.concat([t]);this.http.put("../rest/groups/"+this.groupId+"/indexing",{keywords:e}).pipe(Object(Zt.tap)(()=>{this.indexingInfo.keywords.push(t)}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.keywordAdded"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}removeKeyword(t){const e=this.indexingInfo.keywords.indexOf(t),i=[...this.indexingInfo.keywords];i.splice(e,1),this.http.put("../rest/groups/"+this.groupId+"/indexing",{keywords:i}).pipe(Object(Zt.tap)(()=>{this.indexingInfo.keywords.splice(e,1)}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.keywordDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addAction(t){const e=this.indexingInfo.actions.map(t=>t.id).concat([t].map(t=>t.id));this.http.put("../rest/groups/"+this.groupId+"/indexing",{actions:e}).pipe(Object(Zt.tap)(()=>{const e=this.actionList.findIndex(e=>e.id===t.id),i=Object.assign({},this.actionList[e]);this.indexingInfo.actions.push(i),this.actionList.splice(e,1)}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.actionAdded"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}removeAction(t){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(l.a)(()=>{this.dialogRef=null;const e=[...this.indexingInfo.actions];return e.splice(t,1),e.map(t=>t.id)}),Object(q.a)(t=>this.http.put("../rest/groups/"+this.groupId+"/indexing",{actions:t})),Object(Zt.tap)(()=>{this.actionList.push(this.indexingInfo.actions[t]),this.indexingInfo.actions.splice(t,1)}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.actionDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}toggleIndex(t){this.http.put("../rest/groups/"+this.groupId+"/indexing",{canIndex:t}).pipe(Object(Zt.tap)(()=>{this.indexingInfo.canIndex=t,this.resfreshShortcut.emit()}),Object(Zt.tap)(()=>{this.notify.success(this.translate.instant(this.indexingInfo.canIndex?"lang.indexEnabled":"lang.indexDisabled"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}drop(t){if(t.previousContainer===t.container){Object(Ma.h)(t.container.data,t.previousIndex,t.currentIndex);const e=this.indexingInfo.actions.map(t=>t.id);this.http.put("../rest/groups/"+this.groupId+"/indexing",{actions:e}).pipe(Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.actionAdded"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-indexing-administration"]],inputs:{groupId:"groupId"},outputs:{resfreshShortcut:"resfreshShortcut"},decls:25,vars:18,consts:[["class","loading",4,"ngIf"],[1,"row",2,"margin","0px"],[1,"col-md-12"],["class","alert-message alert-message-danger","role","alert","style","margin-top: 30px;",4,"ngIf"],["color","warn","mat-raised-button","",3,"click",4,"ngIf"],[1,"col-md-8",2,"margin-top","20px"],[1,"formType"],[1,"formType-title"],[1,"infoActions",3,"innerHTML"],["appearance","outline",3,"labelPlaceholder","datas","targetSearchKey","triggerEvent"],["cdkDropList","","role","list",1,"selectedActionList",3,"cdkDropListData","cdkDropListDropped"],["class","selectedAction","role","listitem","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragData",4,"ngFor","ngForOf"],[1,"col-md-4",2,"margin-top","20px"],[1,"formType","jstreeEntities"],["appearance","outline"],["color","primary","matPrefix","",1,"fa","fa-search"],["matInput","","id","jstree_search","name","jstree_search","type","text",3,"placeholder"],["id","jstree"],["jstree",""],[1,"loading"],[2,"margin","auto"],["role","alert",1,"alert-message","alert-message-danger",2,"margin-top","30px"],["mat-raised-button","",3,"click"],["color","warn","mat-raised-button","",3,"click"],["role","listitem","cdkDrag","","cdkDragLockAxis","y",1,"selectedAction",3,"cdkDragData"],["color","primary","cdkDragHandle","",1,"fas","fa-bars","fa-2x",2,"cursor","move"],[1,"actionLabel"],["mat-icon-button","","color","warn",3,"click"],[1,"fa","fa-trash"]],template:function(t,e){1&t&&(m.Qc(0,Ya,2,0,"div",0),m.Zb(1,"div",1),m.Zb(2,"div",2),m.Qc(3,Za,6,6,"div",3),m.Qc(4,xa,3,3,"button",4),m.Yb(),m.Zb(5,"div",5),m.Zb(6,"div",6),m.Zb(7,"div",7),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Ub(10,"mat-hint",8),m.Zb(11,"plugin-autocomplete",9),m.hc("triggerEvent",(function(t){return e.addAction(t)})),m.Yb(),m.Zb(12,"mat-list",10),m.hc("cdkDropListDropped",(function(t){return e.drop(t)})),m.Qc(13,_a,9,2,"mat-list-item",11),m.Yb(),m.Yb(),m.Yb(),m.Zb(14,"div",12),m.Zb(15,"div",13),m.Zb(16,"div",7),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Zb(19,"mat-form-field",14),m.Ub(20,"mat-icon",15),m.Ub(21,"input",16),m.mc(22,"translate"),m.Yb(),m.Ub(23,"div",17,18),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.sc("ngIf",e.loading),m.Eb(3),m.sc("ngIf",!e.indexingInfo.canIndex),m.Eb(1),m.sc("ngIf",e.indexingInfo.canIndex),m.Eb(4),m.Uc(" ",m.nc(9,12,"lang.availableIndexingActions")," "),m.Eb(2),m.sc("innerHTML",e.translate.instant("lang.actionsInfo"),m.Ic),m.Eb(1),m.sc("labelPlaceholder",e.translate.instant("lang.linkNewAction"))("datas",e.actionList)("targetSearchKey","label_action"),m.Eb(1),m.sc("cdkDropListData",e.indexingInfo.actions),m.Eb(1),m.sc("ngForOf",e.indexingInfo.actions),m.Eb(4),m.Uc(" ",m.nc(18,14,"lang.authorizedEntities")," "),m.Eb(4),m.tc("placeholder",m.nc(22,16,"lang.searchEntities")))},directives:[x.t,w.f,Dt.a,Ot.a,Ma.e,x.s,w.c,Tt.a,w.i,O.b,T.c,D.b,Ot.d,Ma.a,Ma.b,_.a],pipes:[p.d],styles:[".loading[_ngcontent-%COMP%]{display:flex;height:100%;position:absolute;background:#fff;z-index:2}.loading[_ngcontent-%COMP%], .selectedActionList[_ngcontent-%COMP%]{width:100%}.infoActions[_ngcontent-%COMP%]{font-size:80%}.selectedAction[_ngcontent-%COMP%]{height:70px}.selectedAction[_ngcontent-%COMP%]   .actionLabel[_ngcontent-%COMP%]{padding-left:10px;flex:1}.formType[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:10px;border-radius:4px;border:1px solid #ccc;position:relative;padding:10px}.formType-title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:20px;font-weight:700;background:#fff;position:absolute;top:-18px;left:10px;padding:0;margin:0;color:#135f7f}.alert-message[_ngcontent-%COMP%]{max-width:100%}a[_ngcontent-%COMP%]{cursor:pointer}.jstreeEntities[_ngcontent-%COMP%]   .mat-form-field-appearance-outline[_ngcontent-%COMP%]{font-size:11px}.cdk-drag-preview[_ngcontent-%COMP%]{background:#fff;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-preview[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%], .cdk-drag-preview[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{visibility:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.selectedAction[_ngcontent-%COMP%]:last-child{border:none}.selectedAction.cdk-drop-list-dragging[_ngcontent-%COMP%]   .selectedAction[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),t})();var Oa=i("8N1J");const Ta=["snav2"],ka=["paginatorBaskets"],Ia=["sortBaskets"],Da=["sortUsers"];function Ua(t,e){1&t&&(m.Zb(0,"div",13),m.Ub(1,"mat-spinner",14),m.Yb())}function Pa(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",28),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).group.group_id=e})),m.mc(1,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("placeholder",m.nc(1,2,"lang.id")),m.sc("ngModel",t.group.group_id)}}function Fa(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",29),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).group.group_id=e})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("placeholder",m.nc(1,3,"lang.id")),m.tc("title",m.nc(2,5,"lang.id")),m.sc("ngModel",t.group.group_id)}}function La(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item"),m.Zb(1,"mat-slide-toggle",37),m.hc("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(4).toggleService(i,a)})),m.mc(2,"translate"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(4);m.Eb(1),m.tc("name",t.label),m.tc("matTooltip",m.nc(2,4,t.comment)),m.sc("checked",i.group.privileges.indexOf(t.id)>-1),m.Eb(2),m.Uc(" ",m.nc(4,6,t.label),"")}}function ja(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",41),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(4);return e.stopPropagation(),a.openUserParams(i.id)})),m.Ub(1,"mat-icon",42),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(4);m.Jb("active",e.panelMode===t.id),m.sc("title",e.translate.instant("lang.goToAdminParams"))("disabled",-1===e.group.privileges.indexOf(t.id))}}function Ra(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",38),m.Zb(1,"mat-slide-toggle",39),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.checked=i}))("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(4).toggleService(i,a)})),m.mc(2,"translate"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Qc(5,ja,2,4,"button",40),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("name",t.label),m.tc("matTooltip",m.nc(2,6,t.comment)),m.sc("ngModel",t.checked)("checked",t.checked),m.Eb(2),m.Uc("",m.nc(4,8,t.label)," "),m.Eb(2),m.sc("ngIf",t.hasParams)}}function Qa(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item"),m.Zb(1,"mat-slide-toggle",37),m.hc("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(6).toggleService(i,a)})),m.mc(2,"translate"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(6);m.Eb(1),m.tc("name",t.label),m.tc("matTooltip",m.nc(2,4,t.comment)),m.sc("checked",i.group.privileges.indexOf(t.id)>-1),m.Eb(2),m.Uc("",m.nc(4,6,t.label)," ")}}function Aa(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-list"),m.Qc(2,Qa,5,8,"mat-list-item",30),m.mc(3,"filterList"),m.mc(4,"sortBy"),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit;m.lc();const e=m.Dc(19);m.Eb(2),m.sc("ngForOf",m.pc(3,1,m.oc(4,5,t.services,"label"),e.value,"label"))}}function Ha(t,e){if(1&t&&(m.Zb(0,"mat-option",51),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(m.nc(2,2,t.label))}}function $a(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",45),m.Ub(1,"span",46),m.Zb(2,"mat-form-field",47),m.Zb(3,"mat-select",48),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.current=i}))("selectionChange",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(6).changeDifflistPrivilege(i,a.id)})),m.Zb(4,"mat-option",49),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Qc(7,Ha,3,4,"mat-option",50),m.Yb(),m.Yb(),m.Sc(8,". "),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.sc("innerHTML",t.label,m.Ic),m.Eb(2),m.sc("ngModel",t.current),m.Eb(2),m.Tc(m.nc(6,4,"lang.noRole")),m.Eb(2),m.sc("ngForOf",t.services)}}function za(t,e){if(1&t&&(m.Xb(0),m.Qc(1,$a,9,6,"mat-list-item",44),m.Wb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.sc("ngForOf",t.services)}}function Va(t,e){if(1&t&&(m.Zb(0,"mat-option",51),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(m.nc(2,2,t.label))}}function Na(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",45),m.Ub(1,"span",46),m.Zb(2,"mat-form-field",52),m.Zb(3,"mat-select",48),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.current=i}))("selectionChange",(function(e){return m.Hc(t),m.lc(6).changePersonalDataPrivilege(e)})),m.Zb(4,"mat-option",49),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Qc(7,Va,3,4,"mat-option",50),m.Yb(),m.Yb(),m.Sc(8,". "),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.sc("innerHTML",t.label,m.Ic),m.Eb(2),m.sc("ngModel",t.current),m.Eb(2),m.Tc(m.nc(6,4,"lang.notVisible")),m.Eb(2),m.sc("ngForOf",t.services)}}function Ja(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Na,9,6,"mat-list-item",44),m.Wb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.sc("ngForOf",t.services)}}const Ga=function(){return["diffusionList","confidentialityAndSecurity"]};function Ba(t,e){if(1&t&&(m.Zb(0,"mat-expansion-panel",43),m.mc(1,"filterList"),m.Zb(2,"mat-expansion-panel-header"),m.Zb(3,"mat-panel-title"),m.Sc(4),m.Yb(),m.Yb(),m.Qc(5,Aa,5,8,"ng-container",12),m.Qc(6,za,2,1,"ng-container",12),m.Qc(7,Ja,2,1,"ng-container",12),m.Yb()),2&t){const t=e.$implicit;m.lc();const i=m.Dc(19);m.Jb("emptyExpansionPanel",0==m.pc(1,6,t.services,i.value,"label").length),m.Eb(4),m.Uc(" ",t.label," "),m.Eb(1),m.sc("ngIf",-1===m.yc(10,Ga).indexOf(t.id)),m.Eb(1),m.sc("ngIf","diffusionList"===t.id),m.Eb(1),m.sc("ngIf","confidentialityAndSecurity"===t.id)}}function Wa(t,e){if(1&t&&(m.Zb(0,"mat-tab-group"),m.Zb(1,"mat-tab",16),m.mc(2,"translate"),m.Zb(3,"mat-list"),m.Qc(4,La,5,8,"mat-list-item",30),m.mc(5,"sortBy"),m.Yb(),m.Yb(),m.Zb(6,"mat-tab",16),m.mc(7,"translate"),m.Zb(8,"mat-form-field",31),m.Ub(9,"input",32,33),m.mc(11,"translate"),m.Yb(),m.Qc(12,Ra,6,10,"div",34),m.mc(13,"filterList"),m.mc(14,"sortBy"),m.Yb(),m.Zb(15,"mat-tab",16),m.mc(16,"translate"),m.Zb(17,"mat-form-field",31),m.Ub(18,"input",32,35),m.mc(20,"translate"),m.Yb(),m.Qc(21,Ba,8,11,"mat-expansion-panel",36),m.mc(22,"sortBy"),m.Yb(),m.Yb()),2&t){const t=m.Dc(10),e=m.lc(3);m.Eb(1),m.tc("label",m.nc(2,8,"lang.menus")),m.Eb(3),m.sc("ngForOf",m.oc(5,10,e.privilegeService.getMenus(),"label")),m.Eb(2),m.tc("label",m.nc(7,13,"lang.administrationServices")),m.Eb(3),m.tc("placeholder",m.nc(11,15,"lang.filterBy")),m.Eb(3),m.sc("ngForOf",m.pc(13,17,m.oc(14,21,e.administrationPrivileges,"label"),t.value,"label")),m.Eb(3),m.tc("label",m.nc(16,24,"lang.functionnalities")),m.Eb(3),m.tc("placeholder",m.nc(20,26,"lang.filterBy")),m.Eb(3),m.sc("ngForOf",m.oc(22,28,e.unitPrivileges,"label"))}}function qa(t,e){if(1&t&&(m.Zb(0,"mat-tab",16),m.mc(1,"translate"),m.Qc(2,Wa,23,31,"mat-tab-group",12),m.Yb()),2&t){const t=m.lc(2);m.tc("label",m.nc(1,2,"lang.privileges")),m.Eb(2),m.sc("ngIf",!t.creationMode)}}function Xa(t,e){if(1&t){const t=m.ac();m.Zb(0,"app-indexing-administration",54),m.hc("resfreshShortcut",(function(){return m.Hc(t),m.lc(3).resfreshShortcut()})),m.Yb()}if(2&t){const t=m.lc(3);m.sc("groupId",t.group.id)}}function Ka(t,e){1&t&&(m.Zb(0,"mat-tab",16),m.mc(1,"translate"),m.Qc(2,Xa,1,1,"ng-template",53),m.Yb()),2&t&&m.tc("label",m.nc(1,1,"lang.indexation"))}const tn=function(){return["/rest/autocomplete/users/administration"]};function en(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",69),m.Zb(1,"plugin-autocomplete",70),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc(3).linkUser(e)})),m.Yb(),m.Ub(2,"hr"),m.Yb()}if(2&t){const t=m.lc(3);m.Eb(1),m.sc("labelPlaceholder",t.translate.instant("lang.linkUser"))("labelList",t.translate.instant("lang.availableUsers"))("routeDatas",m.yc(4,tn))("targetSearchKey","idToDisplay")}}function an(t,e){1&t&&(m.Zb(0,"mat-header-cell",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.firstname")))}function nn(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.firstname," ")}}function sn(t,e){1&t&&(m.Zb(0,"mat-header-cell",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.lastname")))}function cn(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.lastname," ")}}function on(t,e){1&t&&m.Ub(0,"mat-header-row")}const rn=function(t,e){return{cursor:t,opacity:e}};function ln(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-row",72),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(3).goToUserAdmin(i)})),m.mc(1,"translate"),m.Yb()}if(2&t){const t=e.$implicit;m.tc("matTooltip",m.nc(1,3,"lang.view")),m.sc("matTooltipDisabled",!t.allowed)("ngStyle",m.Ac(5,rn,t.allowed?"pointer":"",t.allowed?"1":"0.6"))}}function dn(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",16),m.mc(1,"translate"),m.Zb(2,"div",55),m.Qc(3,en,3,5,"div",56),m.Zb(4,"div",57),m.Zb(5,"mat-form-field"),m.Zb(6,"input",58),m.hc("keyup",(function(e){return m.Hc(t),m.lc(2).applyFilter(e.target.value)})),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(8,"div",57),m.Ub(9,"mat-paginator",59,60),m.Yb(),m.Yb(),m.Zb(11,"mat-table",61,62),m.Xb(13,63),m.Qc(14,an,3,3,"mat-header-cell",64),m.Qc(15,nn,2,1,"mat-cell",65),m.Wb(),m.Xb(16,66),m.Qc(17,sn,3,3,"mat-header-cell",64),m.Qc(18,cn,2,1,"mat-cell",65),m.Wb(),m.Qc(19,on,1,0,"mat-header-row",67),m.Qc(20,ln,2,8,"mat-row",68),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.tc("label",m.nc(1,9,"lang.relatedUsers")),m.Eb(3),m.sc("ngIf",t.group.canAdminUsers),m.Eb(3),m.tc("placeholder",m.nc(7,11,"lang.filterBy")),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.usersDataSource),m.Eb(8),m.sc("matHeaderRowDef",t.usersDisplayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.usersDisplayedColumns)}}function bn(t,e){1&t&&(m.Zb(0,"mat-header-cell",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.label")))}function mn(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.basket_name," ")}}function pn(t,e){1&t&&(m.Zb(0,"mat-header-cell",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.description")," "))}function un(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.basket_desc," ")}}function hn(t,e){1&t&&m.Ub(0,"mat-header-row")}function fn(t,e){1&t&&(m.Ub(0,"mat-row",79),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/baskets/",e.$implicit.basket_id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function gn(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",16),m.mc(1,"translate"),m.Zb(2,"div",55),m.Zb(3,"div",57),m.Zb(4,"mat-form-field"),m.Zb(5,"input",58),m.hc("keyup",(function(e){return m.Hc(t),m.lc(2).applyBasketsFilter(e.target.value)})),m.mc(6,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(7,"div",57),m.Ub(8,"mat-paginator",59,73),m.Yb(),m.Yb(),m.Zb(10,"mat-table",74,75),m.Xb(12,76),m.Qc(13,bn,3,3,"mat-header-cell",64),m.Qc(14,mn,2,1,"mat-cell",65),m.Wb(),m.Xb(15,77),m.Qc(16,pn,3,3,"mat-header-cell",64),m.Qc(17,un,2,1,"mat-cell",65),m.Wb(),m.Qc(18,hn,1,0,"mat-header-row",67),m.Qc(19,fn,2,4,"mat-row",78),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.tc("label",m.nc(1,8,"lang.relatedBaskets")),m.Eb(5),m.tc("placeholder",m.nc(6,10,"lang.filterBy")),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.basketsDataSource),m.Eb(8),m.sc("matHeaderRowDef",t.basketsDisplayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.basketsDisplayedColumns)}}function vn(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",15),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",16),m.mc(3,"translate"),m.Zb(4,"form",17,18),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(6,"mat-form-field"),m.Qc(7,Pa,2,4,"input",19),m.Qc(8,Fa,3,7,"input",20),m.Yb(),m.Zb(9,"mat-form-field"),m.Zb(10,"input",21),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().group.group_desc=e})),m.mc(11,"translate"),m.mc(12,"translate"),m.Yb(),m.Yb(),m.Zb(13,"mat-form-field"),m.Zb(14,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().group.security.maarch_comment=e})),m.mc(15,"translate"),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Zb(17,"mat-form-field"),m.Zb(18,"textarea",23),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().group.security.where_clause=e})),m.mc(19,"translate"),m.mc(20,"translate"),m.Yb(),m.Zb(21,"mat-icon",24),m.hc("click",(function(){m.Hc(t);const e=m.lc(),i=m.Dc(14);return e.panelMode="keywordInfos",i.toggle()})),m.mc(22,"translate"),m.Yb(),m.Yb(),m.Zb(23,"div",25),m.Zb(24,"button",26),m.Sc(25),m.mc(26,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(27,qa,3,4,"mat-tab",27),m.Qc(28,Ka,3,3,"mat-tab",27),m.Qc(29,dn,21,13,"mat-tab",27),m.Qc(30,gn,20,12,"mat-tab",27),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(5),e=m.lc();m.Eb(2),m.tc("label",m.nc(3,19,"lang.informations")),m.Eb(5),m.sc("ngIf",e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(2),m.tc("title",m.nc(11,21,"lang.label")),m.tc("placeholder",m.nc(12,23,"lang.label")),m.sc("ngModel",e.group.group_desc),m.Eb(4),m.tc("title",m.nc(15,25,"lang.description")),m.tc("placeholder",m.nc(16,27,"lang.description")),m.sc("ngModel",e.group.security.maarch_comment),m.Eb(4),m.tc("title",m.nc(19,29,"lang.clauseGroup")),m.tc("placeholder",m.nc(20,31,"lang.clauseGroup")),m.sc("ngModel",e.group.security.where_clause),m.Eb(3),m.tc("matTooltip",m.nc(22,33,"lang.keywordHelper")),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(26,35,"lang.save")),m.Eb(2),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode)}}function yn(t,e){1&t&&(m.Xb(0),m.Zb(1,"mat-nav-list"),m.Zb(2,"h3",80),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Zb(5,"mat-list",81),m.Zb(6,"p",82),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"div",83),m.Zb(10,"b"),m.Sc(11,"DESTINATION = @my_primary_entity or DESTINATION in (@subentities[@my_primary_entity])"),m.Yb(),m.Yb(),m.Zb(12,"h4",84),m.Sc(13,"@user :"),m.Yb(),m.Zb(14,"p",85),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Zb(17,"h4",84),m.Sc(18,"@user_id :"),m.Yb(),m.Zb(19,"p",85),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Zb(22,"h4",84),m.Sc(23,"@email :"),m.Yb(),m.Zb(24,"p",85),m.Sc(25),m.mc(26,"translate"),m.Yb(),m.Zb(27,"h4",84),m.Sc(28,"@my_entities :"),m.Yb(),m.Zb(29,"p",85),m.Sc(30),m.mc(31,"translate"),m.Yb(),m.Zb(32,"h4",84),m.Sc(33,"@my_entities_id :"),m.Yb(),m.Zb(34,"p",85),m.Sc(35),m.mc(36,"translate"),m.Yb(),m.Zb(37,"h4",84),m.Sc(38,"@my_primary_entity :"),m.Yb(),m.Zb(39,"p",85),m.Sc(40),m.mc(41,"translate"),m.Yb(),m.Zb(42,"h4",84),m.Sc(43,"@my_primary_entity_id :"),m.Yb(),m.Zb(44,"p",85),m.Sc(45),m.mc(46,"translate"),m.Yb(),m.Zb(47,"h4",84),m.Sc(48,"@subentities[('entity_1',...,'entity_n')] : "),m.Yb(),m.Zb(49,"p",85),m.Sc(50),m.mc(51,"translate"),m.Yb(),m.Zb(52,"h4",84),m.Sc(53,"@parent_entity['entity_id'] :"),m.Yb(),m.Zb(54,"p",85),m.Sc(55),m.mc(56,"translate"),m.Yb(),m.Zb(57,"h4",84),m.Sc(58,"@sisters_entities['entity_id'] :"),m.Yb(),m.Zb(59,"p",85),m.Sc(60),m.mc(61,"translate"),m.Yb(),m.Zb(62,"h4",84),m.Sc(63,"@entity_type['type'] :"),m.Yb(),m.Zb(64,"p",85),m.Sc(65),m.mc(66,"translate"),m.Yb(),m.Zb(67,"h4",84),m.Sc(68,"@all_entities :"),m.Yb(),m.Zb(69,"p",85),m.Sc(70),m.mc(71,"translate"),m.Yb(),m.Zb(72,"h4",84),m.Sc(73,"@immediate_children['entity_1',..., 'entity_id'] : "),m.Yb(),m.Zb(74,"p",85),m.Sc(75),m.mc(76,"translate"),m.Yb(),m.Yb(),m.Wb()),2&t&&(m.Eb(3),m.Tc(m.nc(4,15,"lang.keywordHelp")),m.Eb(4),m.Tc(m.nc(8,17,"lang.keywordHelpDesc_11")),m.Eb(8),m.Tc(m.nc(16,19,"lang.keywordHelpDesc_1")),m.Eb(5),m.Tc(m.nc(21,21,"lang.keywordHelpDesc_12")),m.Eb(5),m.Tc(m.nc(26,23,"lang.keywordHelpDesc_2")),m.Eb(5),m.Tc(m.nc(31,25,"lang.keywordHelpDesc_3")),m.Eb(5),m.Tc(m.nc(36,27,"lang.keywordHelpDesc_13")),m.Eb(5),m.Tc(m.nc(41,29,"lang.keywordHelpDesc_4")),m.Eb(5),m.Tc(m.nc(46,31,"lang.keywordHelpDesc_14")),m.Eb(5),m.Tc(m.nc(51,33,"lang.keywordHelpDesc_5")),m.Eb(5),m.Tc(m.nc(56,35,"lang.keywordHelpDesc_6")),m.Eb(5),m.Tc(m.nc(61,37,"lang.keywordHelpDesc_7")),m.Eb(5),m.Tc(m.nc(66,39,"lang.keywordHelpDesc_8")),m.Eb(5),m.Tc(m.nc(71,41,"lang.keywordHelpDesc_9")),m.Eb(5),m.Tc(m.nc(76,43,"lang.keywordHelpDesc_10")))}function Cn(t,e){if(1&t&&(m.Zb(0,"mat-list-option",90),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("selected",t.checked)("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function En(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-nav-list"),m.Zb(2,"h3",80),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Zb(5,"mat-list",81),m.Zb(6,"p",86),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-selection-list",87,88),m.hc("selectionChange",(function(){m.Hc(t);const e=m.Dc(10);return m.lc().updatePrivilegeParams(e.selectedOptions.selected)})),m.Qc(11,Cn,2,3,"mat-list-option",89),m.Yb(),m.Yb(),m.Wb()}if(2&t){const t=m.lc();m.Eb(3),m.Tc(m.nc(4,3,"lang.adminParamsUsers")),m.Eb(4),m.Uc(" ",m.nc(8,5,"lang.chooseAllowedGroups")," : "),m.Eb(4),m.sc("ngForOf",t.authorizedGroupsUserParams)}}let Sn=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.privilegeService=o,this.dialog=r,this.loading=!1,this.paramsLoading=!1,this.group={security:{}},this.menus={},this.usersDisplayedColumns=["firstname","lastname"],this.basketsDisplayedColumns=["basket_name","basket_desc"],this.unitPrivileges=[],this.administrationPrivileges=[],this.authorizedGroupsUserParams=[],this.panelMode="keywordInfos"}applyFilter(t){t=(t=t.trim()).toLowerCase(),this.usersDataSource.filter=t}applyBasketsFilter(t){t=(t=t.trim()).toLowerCase(),this.basketsDataSource.filter=t}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.groupCreation")),this.creationMode=!0,this.loading=!1):(this.creationMode=!1,this.http.get("../rest/groups/"+t.id+"/details").subscribe(t=>{this.group=t.group,this.administrationPrivileges=this.privilegeService.getAdministrations(),this.administrationPrivileges=this.administrationPrivileges.map(t=>Object.assign(Object.assign({},t),{checked:this.group.privileges.indexOf(t.id)>-1})),this.privilegeService.getUnitsPrivileges().forEach(t=>{let e=this.privilegeService.getPrivilegesByUnit(t);if("diffusionList"===t)e=[{id:"indexing_diffList",label:this.translate.instant("lang.diffListPrivilegeMsgIndexing"),current:void 0!==this.group.privileges.filter(t=>["update_diffusion_indexing","update_diffusion_except_recipient_indexing"].indexOf(t)>-1)[0]?this.group.privileges.filter(t=>["update_diffusion_indexing","update_diffusion_except_recipient_indexing"].indexOf(t)>-1)[0]:"",services:this.privilegeService.getPrivileges(["update_diffusion_indexing","update_diffusion_except_recipient_indexing"])},{id:"process_diffList",label:this.translate.instant("lang.diffListPrivilegeMsgProcess"),current:void 0!==this.group.privileges.filter(t=>["update_diffusion_process","update_diffusion_except_recipient_process"].indexOf(t)>-1)[0]?this.group.privileges.filter(t=>["update_diffusion_process","update_diffusion_except_recipient_process"].indexOf(t)>-1)[0]:"",services:this.privilegeService.getPrivileges(["update_diffusion_process","update_diffusion_except_recipient_process"])},{id:"details_diffList",label:this.translate.instant("lang.diffListPrivilegeMsgDetails"),current:void 0!==this.group.privileges.filter(t=>["update_diffusion_details","update_diffusion_except_recipient_details"].indexOf(t)>-1)[0]?this.group.privileges.filter(t=>["update_diffusion_details","update_diffusion_except_recipient_details"].indexOf(t)>-1)[0]:"",services:this.privilegeService.getPrivileges(["update_diffusion_details","update_diffusion_except_recipient_details"])}];else if("confidentialityAndSecurity"===t){let t="";this.group.privileges.filter(t=>"manage_personal_data"===t)[0]?t="manage_personal_data":this.group.privileges.filter(t=>"view_personal_data"===t)[0]&&(t="view_personal_data"),e=[{id:"confidentialityAndSecurity_personal_data",label:this.translate.instant("lang.personalDataMsg"),current:t,services:this.privilegeService.getPrivileges(["view_personal_data","manage_personal_data"])}]}this.unitPrivileges.push({id:t,label:this.translate.instant("lang."+t),services:e})}),this.headerService.setHeader(this.translate.instant("lang.groupModification"),this.group.group_desc),this.loading=!1,setTimeout(()=>{this.usersDataSource=new G.o(this.group.users),this.usersDataSource.paginator=this.paginator,this.usersDataSource.sort=this.sortUsers,this.basketsDataSource=new G.o(this.group.baskets),this.basketsDataSource.paginator=this.paginatorBaskets,this.basketsDataSource.sort=this.sortBaskets},0)},t=>{this.notify.handleErrors(t)}))})}changeDifflistPrivilege(t,e){"indexing_diffList"===e?"update_diffusion_indexing"===t.value?this.manageServices(["update_diffusion_indexing","update_diffusion_except_recipient_indexing"]):"update_diffusion_except_recipient_indexing"===t.value?this.manageServices(["update_diffusion_except_recipient_indexing","update_diffusion_indexing"]):this.manageServices(["update_diffusion_indexing","update_diffusion_except_recipient_indexing"],"deleteAll"):"process_diffList"===e?"update_diffusion_process"===t.value?this.manageServices(["update_diffusion_process","update_diffusion_except_recipient_process"]):"update_diffusion_except_recipient_process"===t.value?this.manageServices(["update_diffusion_except_recipient_process","update_diffusion_process"]):this.manageServices(["update_diffusion_process","update_diffusion_except_recipient_process"],"deleteAll"):"update_diffusion_details"===t.value?this.manageServices(["update_diffusion_details","update_diffusion_except_recipient_details"]):"update_diffusion_except_recipient_details"===t.value?this.manageServices(["update_diffusion_except_recipient_details","update_diffusion_details"]):this.manageServices(["update_diffusion_details","update_diffusion_except_recipient_details"],"deleteAll")}manageServices(t,e=null){"deleteAll"!==e?this.http.post(`../rest/groups/${this.group.id}/privileges/${t[0]}`,{}).pipe(Object(d.a)(()=>{this.group.privileges.push(t[0])}),Object(q.a)(()=>this.http.delete(`../rest/groups/${this.group.id}/privileges/${t[1]}`)),Object(d.a)(()=>{this.group.privileges.splice(this.group.privileges.indexOf(t[1]),1),this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.groupServicesUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe():this.http.delete(`../rest/groups/${this.group.id}/privileges/${t[0]}`).pipe(Object(d.a)(()=>{this.group.privileges.splice(this.group.privileges.indexOf(t[0]),1)}),Object(q.a)(()=>this.http.delete(`../rest/groups/${this.group.id}/privileges/${t[1]}`)),Object(d.a)(()=>{this.group.privileges.splice(this.group.privileges.indexOf(t[1]),1),this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.groupServicesUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}changePersonalDataPrivilege(t){"view_personal_data"===t.value?this.manageServices(["view_personal_data","manage_personal_data"]):"manage_personal_data"===t.value?this.http.post(`../rest/groups/${this.group.id}/privileges/view_personal_data`,{}).pipe(Object(d.a)(()=>{this.group.privileges.push("view_personal_data")}),Object(q.a)(()=>this.http.post(`../rest/groups/${this.group.id}/privileges/manage_personal_data`,{})),Object(d.a)(()=>{this.group.privileges.splice(this.group.privileges.indexOf("manage_personal_data"),1),this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.groupServicesUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe():this.manageServices(["view_personal_data","manage_personal_data"],"deleteAll")}resfreshShortcut(){return Object(gt.a)(this,void 0,void 0,(function*(){yield this.headerService.resfreshCurrentUser(),this.privilegeService.resfreshUserShortcuts()}))}getCurrentPrivListDiff(t){return this.group.privileges.indexOf(t)>-1}onSubmit(){this.creationMode?this.http.post("../rest/groups",this.group).subscribe(t=>{this.notify.success(this.translate.instant("lang.groupAdded")),this.router.navigate(["/administration/groups/"+t.group])},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/groups/"+this.group.id,{description:this.group.group_desc,security:this.group.security}).subscribe(()=>{this.notify.success(this.translate.instant("lang.groupUpdated"))},t=>{this.notify.error(t.error.errors)})}toggleService(t,e){t.checked?"admin_groups"===e.id?this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.confirmAction"),msg:this.translate.instant("lang.enableGroupMsg")}}).afterClosed().pipe(Object(d.a)(t=>{"ok"!==t&&(e.checked=!1)}),Object(W.a)(t=>"ok"===t),Object(d.a)(()=>{this.addService(e)}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe():this.addService(e):(this.sidenavRight.close(),this.removeService(e))}addService(t){this.http.post(`../rest/groups/${this.group.id}/privileges/${t.id}`,{}).pipe(Object(d.a)(()=>{this.group.privileges.push(t.id),this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.groupServicesUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}removeService(t){this.http.delete(`../rest/groups/${this.group.id}/privileges/${t.id}`).pipe(Object(d.a)(()=>{this.group.privileges.splice(this.group.privileges.indexOf(t.id),1),this.headerService.resfreshCurrentUser(),this.notify.success(this.translate.instant("lang.groupServicesUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}linkUser(t){this.http.post("../rest/users/"+t.id+"/groups",{groupId:this.group.group_id,role:this.group.role}).subscribe(()=>{const e=t.idToDisplay.split(" ");this.group.users.push({id:t.id,user_id:t.otherInfo,firstname:e[0],lastname:e[1],allowed:!0}),this.usersDataSource=new G.o(this.group.users),this.usersDataSource.paginator=this.paginator,this.usersDataSource.sort=this.sortUsers,this.notify.success(this.translate.instant("lang.userAdded"))},t=>{this.notify.error(t.error.errors)})}openUserParams(t){this.sidenavRight.toggle(),this.sidenavRight.opened?(this.panelMode=t,this.paramsLoading=!0,this.http.get("../rest/groups").pipe(Object(l.a)(t=>(t.groups=t.groups.map(t=>({id:t.id,label:t.group_desc})),t)),Object(d.a)(t=>{this.authorizedGroupsUserParams=t.groups}),Object(q.a)(()=>this.http.get(`../rest/groups/${this.group.id}/privileges/${this.panelMode}/parameters?parameter=groups`)),Object(d.a)(t=>{const e=t;this.authorizedGroupsUserParams.forEach(t=>{t.checked=e.indexOf(t.id)>-1})}),Object(vt.a)(()=>this.paramsLoading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()):this.panelMode=""}updatePrivilegeParams(t){let e={};"admin_users"===this.panelMode&&(e={groups:t.map(t=>t.value)}),this.http.put(`../rest/groups/${this.group.id}/privileges/${this.panelMode}/parameters`,{parameters:e}).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.parameterUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}goToUserAdmin(t){t.allowed&&this.router.navigate(["/administration/users/"+t.id])}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(g.a),m.Tb(H.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Ta,!0),m.ad(ka,!0),m.Oc(Ia,!0),m.ad(z.a,!0),m.Oc(Da,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.paginatorBaskets=i.first),m.Cc(i=m.ic())&&(e.sortBaskets=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sortUsers=i.first))},decls:17,vars:13,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",3,"mode","fixedInViewport","opened"],["snav2",""],[4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"label"],[1,"form-horizontal",3,"ngSubmit"],["groupForm","ngForm"],["matInput","","name","identifier","pattern","^[\\w.-]*$","maxlength","32","required","",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],["matInput","","name","identifier","disabled","",3,"placeholder","title","ngModel","ngModelChange",4,"ngIf"],["matInput","","name","description","maxlength","255","required","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","name","comment",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","name","clause","required","","matTextareaAutosize","","matAutosizeMinRows","1","matAutosizeMaxRows","5",3,"title","placeholder","ngModel","ngModelChange"],["color","primary","matSuffix","",1,"fa","fa-info-circle",2,"cursor","pointer",3,"matTooltip","click"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled"],[3,"label",4,"ngIf"],["matInput","","name","identifier","pattern","^[\\w.-]*$","maxlength","32","required","",3,"placeholder","ngModel","ngModelChange"],["matInput","","name","identifier","disabled","",3,"placeholder","title","ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["floatLabel","never","appearance","outline",1,"basketsFilter",2,"padding-left","20px","padding-right","20px","font-size","11px"],["matInput","",3,"placeholder"],["listFilterAdmin",""],["class","col-md-3","style","padding:10px;",4,"ngFor","ngForOf"],["listFilter",""],["expanded","",3,"emptyExpansionPanel",4,"ngFor","ngForOf"],["color","primary",3,"name","checked","matTooltip","change"],[1,"col-md-3",2,"padding","10px"],["color","primary",3,"name","ngModel","checked","matTooltip","ngModelChange","change"],["mat-icon-button","","color","primary",3,"active","title","disabled","click",4,"ngIf"],["mat-icon-button","","color","primary",3,"title","disabled","click"],[1,"fa","fa-cogs"],["expanded",""],["color","primary","style","font-size: 16px;",4,"ngFor","ngForOf"],["color","primary",2,"font-size","16px"],[3,"innerHTML"],[2,"width","250px !important","padding-left","10px","padding-right","10px"],[3,"ngModel","ngModelChange","selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[2,"width","300px !important","padding-left","10px","padding-right","10px"],["matTabContent",""],[3,"groupId","resfreshShortcut"],[1,"row",2,"margin","0px"],["class","col-md-12","style","padding:5px;",4,"ngIf"],[1,"col-md-6","col-xs-6"],["matInput","",3,"placeholder","keyup"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortActive","lastname","matSortDirection","asc",3,"dataSource"],["sortUsers","matSort"],["matColumnDef","firstname"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","lastname"],[4,"matHeaderRowDef"],[3,"matTooltip","matTooltipDisabled","ngStyle","click",4,"matRowDef","matRowDefColumns"],[1,"col-md-12",2,"padding","5px"],[3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","triggerEvent"],["mat-sort-header",""],[3,"matTooltip","matTooltipDisabled","ngStyle","click"],["paginatorBaskets",""],["matSort","","matSortActive","basket_name","matSortDirection","asc",3,"dataSource"],["sortBaskets","matSort"],["matColumnDef","basket_name"],["matColumnDef","basket_desc"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[2,"cursor","pointer",3,"routerLink","matTooltip"],["mat-subheader",""],["role","list",2,"width","400px","padding","5px"],[2,"font-size","10px"],[2,"border","1px black solid","padding","3px","font-size","10px"],["mat-line","",2,"font-weight","bold","font-size","10px"],["mat-line","",2,"font-size","10px"],["color","primary"],[3,"selectionChange"],["paramsList",""],["color","primary","style","font-size: 13px;","checkboxPosition","before",3,"selected","value",4,"ngFor","ngForOf"],["color","primary","checkboxPosition","before",2,"font-size","13px",3,"selected","value"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,Ua,2,0,"div",8),m.Qc(12,vn,31,37,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Qc(15,yn,77,45,"ng-container",12),m.Qc(16,En,12,7,"ng-container",12),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1)),m.Eb(2),m.sc("ngIf","keywordInfos"===e.panelMode),m.Eb(1),m.sc("ngIf","admin_users"===e.panelMode))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,T.c,k.a,Ie.c,Ie.a,o.J,o.u,o.v,w.c,O.b,o.c,o.o,o.E,o.t,o.w,O.d,Tt.a,w.j,It.b,D.b,o.A,Ot.a,x.s,Ot.d,et.a,De.c,De.g,De.h,at.a,I.o,Ie.b,wa,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Dt.a,G.h,V.b,G.a,G.j,G.l,x.w,s.d,Ot.h,Ot.g,I.k,Ot.i,Ot.f],pipes:[p.d,U.a,Oa.a],styles:["textarea.mat-input-element[_ngcontent-%COMP%]{padding:0;margin:0}.active[_ngcontent-%COMP%]{color:#f99830}.emptyExpansionPanel[_ngcontent-%COMP%]{height:0}"]}),t})();const Mn=["snav2"],Yn=["adminMenuTemplate"];function Zn(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",16),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",17),m.Ub(5,"mat-icon",18),m.Zb(6,"p",19),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Zb(9,"a",20),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(16).toggle()})),m.Ub(10,"mat-icon",21),m.Zb(11,"p",19),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Yb()}2&t&&(m.Eb(2),m.Tc(m.nc(3,3,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,5,"lang.add")," "),m.Eb(5),m.Uc(" ",m.nc(13,7,"lang.basketsOrder")," "))}function xn(t,e){1&t&&(m.Zb(0,"div",22),m.Ub(1,"mat-spinner",23),m.Yb())}function _n(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.id"))}}function wn(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.basket_id," ")}}function On(t,e){1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.label")))}function Tn(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.basket_name," ")}}function kn(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.description")," ")}}function In(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.basket_desc," ")}}function Dn(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Un(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",46),m.Zb(1,"button",47),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.delete(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",48),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function Pn(t,e){1&t&&m.Ub(0,"mat-header-row")}function Fn(t,e){1&t&&(m.Ub(0,"mat-row",49),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/baskets/",e.$implicit.basket_id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Ln(t,e){if(1&t&&(m.Zb(0,"mat-card",24),m.Zb(1,"div",25),m.Zb(2,"div",26),m.Zb(3,"mat-form-field"),m.Ub(4,"input",27),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",26),m.Ub(7,"mat-paginator",28,29),m.Yb(),m.Yb(),m.Zb(9,"mat-table",30,31),m.Xb(11,32),m.Qc(12,_n,3,5,"mat-header-cell",33),m.Qc(13,wn,2,3,"mat-cell",34),m.Wb(),m.Xb(14,35),m.Qc(15,On,3,3,"mat-header-cell",36),m.Qc(16,Tn,2,1,"mat-cell",37),m.Wb(),m.Xb(17,38),m.Qc(18,kn,3,5,"mat-header-cell",33),m.Qc(19,In,2,3,"mat-cell",34),m.Wb(),m.Xb(20,39),m.Qc(21,Dn,1,0,"mat-header-cell",40),m.Qc(22,Un,4,3,"mat-cell",41),m.Wb(),m.Qc(23,Pn,1,0,"mat-header-row",42),m.Qc(24,Fn,2,4,"mat-row",43),m.Yb(),m.Zb(25,"div",44),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.baskets.length," ",m.nc(27,12,"lang.baskets"),"")}}function jn(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",50),m.hc("onDropSuccess",(function(){m.Hc(t);const i=e.$implicit;return m.lc().updateBasketOrder(i)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",51),m.Zb(3,"p",19),m.Sc(4),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=e.index;m.tc("title",m.nc(1,4,"lang.move")),m.sc("sortableIndex",i),m.Eb(4),m.Vc("",i+1," - ",t.basket_name,"")}}const Rn=function(){return["boxers-zone"]};let Qn=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.loading=!1,this.baskets=[],this.basketsOrder=[],this.displayedColumns=["basket_id","basket_name","basket_desc","actions"],this.filterColumns=["basket_id","basket_name","basket_desc"]}ngOnInit(){this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.baskets")),this.loading=!0,this.getSortedBasket(),this.http.get("../rest/baskets").subscribe(t=>{this.baskets=t.baskets,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_baskets",this.baskets,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.handleErrors(t)})}getSortedBasket(){this.http.get("../rest/sortedBaskets").pipe(Object(d.a)(t=>{this.basketsOrder=t.baskets}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}delete(t){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+t.basket_name+" \xbb")&&this.http.delete("../rest/baskets/"+t.basket_id).subscribe(t=>{this.notify.success(this.translate.instant("lang.basketDeleted")),this.baskets=t.baskets,this.adminService.setDataSource("admin_baskets",this.baskets,this.sort,this.paginator,this.filterColumns),this.getSortedBasket()},t=>{this.notify.error(t.error.errors)})}updateBasketOrder(t){this.http.put("../rest/sortedBaskets/"+t.basket_id,this.basketsOrder).subscribe(t=>{this.baskets=t.baskets,this.notify.success(this.translate.instant("lang.modificationSaved"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Mn,!0),m.Oc(Yn,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:23,vars:18,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",3,"mode","fixedInViewport","opened"],["snav2",""],[2,"font-size","15px","padding","10px"],["dnd-sortable-container","",3,"dropZones","sortableData"],["disableRipple","true","dnd-sortable","",3,"title","sortableIndex","onDropSuccess",4,"ngFor","ngForOf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/baskets/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fa","fa-list-ol"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSortDisableClear","","matSort","",3,"dataSource"],["table",""],["matColumnDef","basket_id"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","basket_name"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","basket_desc"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"],["disableRipple","true","dnd-sortable","",3,"title","sortableIndex","onDropSuccess"],["color","primary","mat-list-icon","",1,"fa","fa-inbox"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Zn,14,9,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,xn,2,0,"div",9),m.Qc(14,Ln,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"p",13),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Zb(20,"mat-list"),m.Zb(21,"span",14),m.Qc(22,jn,5,6,"mat-list-item",15),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1)),m.Eb(3),m.Uc(" ",m.nc(19,15,"lang.basketHelpDesc")," "),m.Eb(3),m.sc("dropZones",m.yc(17,Rn))("sortableData",e.basketsOrder),m.Eb(1),m.sc("ngForOf",e.basketsOrder))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Le.f,x.s,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d,Le.e],pipes:[p.d],encapsulation:2}),t})();var An=i("A5z7"),Hn=i("/1cH"),$n=i("TU8p");function zn(t,e){if(1&t&&(m.Zb(0,"mat-option",31),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",m.nc(2,2,"lang."+t.id)," ")}}function Vn(t,e){if(1&t&&(m.Zb(0,"mat-option",31),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function Nn(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",32),m.Zb(1,"div",33),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-form-field",0),m.Zb(5,"mat-label"),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Zb(8,"mat-select",34),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().selectedProcessTool.defaultTab=e})),m.Qc(9,Vn,2,2,"mat-option",2),m.mc(10,"sortBy"),m.Yb(),m.Yb(),m.Zb(11,"div",35),m.Zb(12,"mat-slide-toggle",36),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().selectedProcessTool.canUpdateData=e}))("change",(function(e){return m.Hc(t),m.lc().toggleCanUpdate(e.checked)})),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Zb(15,"div",35),m.Zb(16,"mat-slide-toggle",37),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().selectedProcessTool.canUpdateModel=e})),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.Uc(" ",m.nc(3,9,"lang.options")," "),m.Eb(4),m.Tc(m.nc(7,11,"lang.tabProcessPosition")),m.Eb(2),m.sc("ngModel",t.selectedProcessTool.defaultTab),m.Eb(1),m.sc("ngForOf",m.oc(10,13,t.processTool,"label")),m.Eb(3),m.sc("ngModel",t.selectedProcessTool.canUpdateData),m.Eb(1),m.Tc(m.nc(14,16,"lang.canUpdateData")),m.Eb(3),m.sc("ngModel",t.selectedProcessTool.canUpdateModel)("disabled",!t.selectedProcessTool.canUpdateData),m.Eb(1),m.Uc("",m.nc(18,18,"lang.canUpdateIndexingModel")," ")}}function Jn(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",32),m.Zb(1,"div",33),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",35),m.Zb(5,"mat-slide-toggle",38),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().selectedProcessTool.canUpdateDocuments=e})),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.Uc(" ",m.nc(3,3,"lang.options")," "),m.Eb(3),m.sc("ngModel",t.selectedProcessTool.canUpdateDocuments),m.Eb(1),m.Uc(" ",m.nc(7,5,"lang.canUpdateResourcesInSignatureBook"),"")}}function Gn(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",39),m.hc("click",(function(){return m.Hc(t),m.lc().toggleData()})),m.mc(1,"translate"),m.Ub(2,"mat-icon",40),m.Yb()}2&t&&m.tc("title",m.nc(1,1,"lang.preview"))}function Bn(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",39),m.hc("click",(function(){return m.Hc(t),m.lc().toggleData()})),m.mc(1,"translate"),m.Ub(2,"mat-icon",41),m.Yb()}2&t&&m.tc("title",m.nc(1,1,"lang.edition"))}function Wn(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",42),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().selectedTemplateDisplayedSecondaryData=i})),m.Sc(1),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Uc("",t," colonne(s)")}}function qn(t,e){if(1&t&&(m.Zb(0,"mat-option",43),m.Zb(1,"span",44),m.Zb(2,"span",45),m.Ub(3,"i",46),m.Yb(),m.Zb(4,"span",47),m.Sc(5),m.Yb(),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(3),m.Hb("fa ",t.icon," fa-2x"),m.Eb(2),m.Uc(" ",t.label," ")}}function Xn(t,e){if(1&t&&(m.Zb(0,"button",61),m.Ub(1,"mat-icon",62),m.Yb()),2&t){m.lc();const t=m.Dc(3);m.sc("matMenuTriggerFor",t)}}function Kn(t,e){if(1&t){const t=m.ac();m.Zb(0,"span",51),m.Qc(1,Xn,2,1,"button",52),m.Zb(2,"mat-menu",null,8),m.Zb(4,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc(),i=e.$implicit,a=e.index;return m.lc(2).removeData(i,a)})),m.Ub(5,"mat-icon",53),m.Zb(6,"span"),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Ub(9,"mat-divider"),m.Zb(10,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).setStyle(e,"boldFontData")})),m.Ub(11,"mat-icon",54),m.Zb(12,"span"),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Zb(15,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).setStyle(e,"align_leftData")})),m.Ub(16,"mat-icon",55),m.Zb(17,"span"),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Yb(),m.Zb(20,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).setStyle(e,"align_centerData")})),m.Ub(21,"mat-icon",56),m.Zb(22,"span"),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Yb(),m.Zb(25,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).setStyle(e,"align_rightData")})),m.Ub(26,"mat-icon",57),m.Zb(27,"span"),m.Sc(28),m.mc(29,"translate"),m.Yb(),m.Yb(),m.Zb(30,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).setStyle(e,"bigFontData")})),m.Ub(31,"mat-icon",58),m.Zb(32,"span"),m.Sc(33),m.mc(34,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(35,"span",59),m.Ub(36,"i"),m.Sc(37,"\xa0 "),m.Ub(38,"span",60),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(2);m.Eb(1),m.sc("ngIf","label"==e.displayMode),m.Eb(6),m.Tc(m.nc(8,23,"lang.delete")),m.Eb(3),m.Jb("isSelectedMenu",t.cssClasses.indexOf("boldFontData")>-1),m.Eb(3),m.Tc(m.nc(14,25,"lang.fontBold")),m.Eb(2),m.Jb("isSelectedMenu",t.cssClasses.indexOf("align_leftData")>-1),m.Eb(3),m.Tc(m.nc(19,27,"lang.alignLeft")),m.Eb(2),m.Jb("isSelectedMenu",t.cssClasses.indexOf("align_centerData")>-1),m.Eb(3),m.Tc(m.nc(24,29,"lang.alignCenter")),m.Eb(2),m.Jb("isSelectedMenu",t.cssClasses.indexOf("align_rightData")>-1),m.Eb(3),m.Tc(m.nc(29,31,"lang.alignRight")),m.Eb(2),m.Jb("isSelectedMenu",t.cssClasses.indexOf("bigFontData")>-1),m.Eb(3),m.Tc(m.nc(34,33,"lang.fontBig")),m.Eb(2),m.Gb(t.cssClasses.join(" ")),m.Eb(1),m.Hb("fa ",t.icon,""),m.Eb(2),m.sc("innerHTML",t[e.displayMode],m.Ic)}}function ts(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Kn,39,35,"span",50),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","getFolders"!=t.value)}}function es(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-toolbar",48),m.hc("cdkDropListDropped",(function(e){return m.Hc(t),m.lc().drop(e)})),m.Qc(2,ts,2,1,"ng-container",49),m.Yb(),m.Wb()}if(2&t){const t=m.lc();m.Eb(1),m.Hb("secondaryInformations example-list column-",t.selectedTemplateDisplayedSecondaryData,"-list"),m.sc("cdkDropListData",t.displayedSecondaryData),m.Eb(1),m.sc("ngForOf",t.displayedSecondaryData)}}function is(t,e){1&t&&m.Ub(0,"mat-icon",67)}function as(t,e){1&t&&m.Ub(0,"mat-icon",68)}function ns(t,e){if(1&t&&(m.Zb(0,"span"),m.Qc(1,is,1,0,"mat-icon",64),m.Qc(2,as,1,0,"mat-icon",65),m.Ub(3,"br"),m.Zb(4,"span",66),m.Sc(5),m.Yb(),m.Yb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(1),m.sc("ngIf","label"==e.displayMode),m.Eb(1),m.sc("ngIf","sample"==e.displayMode),m.Eb(3),m.Tc(t[e.displayMode])}}function ss(t,e){if(1&t&&(m.Zb(0,"span"),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(1),m.Uc(" ",t[e.displayMode]," ")}}function cs(t,e){if(1&t&&(m.Zb(0,"span",63),m.Qc(1,ns,6,3,"span",17),m.Qc(2,ss,2,1,"span",17),m.Yb()),2&t){const t=e.index;m.Gb(e.$implicit.cssClasses.join(" ")),m.Eb(1),m.sc("ngIf",0==t),m.Eb(1),m.sc("ngIf",1==t)}}function os(t,e){if(1&t&&(m.Zb(0,"button",61),m.Ub(1,"mat-icon",62),m.Yb()),2&t){m.lc();const t=m.Dc(3);m.sc("matMenuTriggerFor",t)}}function rs(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Qc(1,os,2,1,"button",52),m.Zb(2,"mat-menu",null,8),m.Zb(4,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc(),i=e.$implicit,a=e.index;return m.lc().removeData(i,a)})),m.Ub(5,"mat-icon",53),m.Zb(6,"span"),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(9,"span",70),m.Ub(10,"i",71),m.Sc(11),m.Yb(),m.Wb()}if(2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(1),m.sc("ngIf","label"==e.displayMode),m.Eb(6),m.Tc(m.nc(8,3,"lang.delete")),m.Eb(4),m.Uc(" ",t[e.displayMode],"")}}function ls(t,e){if(1&t&&(m.Zb(0,"div",69),m.Qc(1,rs,12,5,"ng-container",17),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","getFolders"==t.value)}}let ds=(()=>{class t{constructor(t,e,i){this.translate=t,this.http=e,this.notify=i,this.loading=!1,this.displayedMainData=[{value:"chronoNumberShort",label:this.translate.instant("lang.chronoNumberShort"),sample:"MAARCH/2019A/1",cssClasses:["align_centerData","normalData"],icon:""},{value:"object",label:this.translate.instant("lang.object"),sample:this.translate.instant("lang.objectSample"),cssClasses:["longData"],icon:""}],this.availableData=[{value:"getPriority",label:this.translate.instant("lang.getPriority"),sample:this.translate.instant("lang.getPrioritySample"),cssClasses:["align_leftData"],icon:"fa-traffic-light"},{value:"getCategory",label:this.translate.instant("lang.getCategory"),sample:this.translate.instant("lang.incoming"),cssClasses:["align_leftData"],icon:"fa-exchange-alt"},{value:"getDoctype",label:this.translate.instant("lang.getDoctype"),sample:this.translate.instant("lang.getDoctypeSample"),cssClasses:["align_leftData"],icon:"fa-suitcase"},{value:"getAssignee",label:this.translate.instant("lang.getAssignee"),sample:this.translate.instant("lang.getAssigneeSample"),cssClasses:["align_leftData"],icon:"fa-sitemap"},{value:"getRecipients",label:this.translate.instant("lang.getRecipients"),sample:"Patricia PETIT",cssClasses:["align_leftData"],icon:"fa-user"},{value:"getSenders",label:this.translate.instant("lang.getSenders"),sample:"Alain DUBOIS (MAARCH)",cssClasses:["align_leftData"],icon:"fa-book"},{value:"getCreationAndProcessLimitDates",label:this.translate.instant("lang.getCreationAndProcessLimitDates"),sample:this.translate.instant("lang.getCreationAndProcessLimitDatesSample"),cssClasses:["align_leftData"],icon:"fa-calendar"},{value:"getVisaWorkflow",label:this.translate.instant("lang.getVisaWorkflow"),sample:'<i color="accent" class="fa fa-check"></i> Barbara BAIN -> <i class="fa fa-hourglass-half"></i> <b>Bruno BOULE</b> -> <i class="fa fa-hourglass-half"></i> Patricia PETIT',cssClasses:["align_leftData"],icon:"fa-list-ol"},{value:"getSignatories",label:this.translate.instant("lang.getSignatories"),sample:"Denis DAULL, Patricia PETIT",cssClasses:["align_leftData"],icon:"fa-certificate"},{value:"getModificationDate",label:this.translate.instant("lang.getModificationDate"),sample:"01-01-2019",cssClasses:["align_leftData"],icon:"fa-calendar-check"},{value:"getOpinionLimitDate",label:this.translate.instant("lang.getOpinionLimitDate"),sample:"01-01-2019",cssClasses:["align_leftData"],icon:"fa-stopwatch"},{value:"getParallelOpinionsNumber",label:this.translate.instant("lang.getParallelOpinionsNumber"),sample:this.translate.instant("lang.getParallelOpinionsNumberSample"),cssClasses:["align_leftData"],icon:"fa-comment-alt"},{value:"getFolders",label:this.translate.instant("lang.getFolders"),sample:this.translate.instant("lang.getFoldersSample"),cssClasses:["align_leftData"],icon:"fa-folder"}],this.availableDataClone=[],this.displayedSecondaryData=[],this.displayedSecondaryDataClone=[],this.displayMode="label",this.dataControl=new o.h,this.listEvent=[{id:"detailDoc",value:"documentDetails"},{id:"eventVisaMail",value:"signatureBookAction"},{id:"eventProcessDoc",value:"processDocument"},{id:"eventViewDoc",value:"viewDoc"}],this.templateDisplayedSecondaryData=[1,2,3,4,5,6,7],this.selectedTemplateDisplayedSecondaryData=7,this.selectedTemplateDisplayedSecondaryDataClone=7,this.selectedListEvent=null,this.selectedListEventClone=null,this.processTool=[{id:"dashboard",icon:"fas fa-columns",label:this.translate.instant("lang.newsFeed")},{id:"history",icon:"fas fa-history",label:this.translate.instant("lang.history")},{id:"notes",icon:"fas fa-pen-square",label:this.translate.instant("lang.notesAlt")},{id:"attachments",icon:"fas fa-paperclip",label:this.translate.instant("lang.attachments")},{id:"linkedResources",icon:"fas fa-link",label:this.translate.instant("lang.links")},{id:"diffusionList",icon:"fas fa-share-alt",label:this.translate.instant("lang.diffusionList")},{id:"emails",icon:"fas fa-envelope",label:this.translate.instant("lang.mailsSentAlt")},{id:"visaCircuit",icon:"fas fa-list-ol",label:this.translate.instant("lang.visaWorkflow")},{id:"opinionCircuit",icon:"fas fa-comment-alt",label:this.translate.instant("lang.avis")},{id:"info",icon:"fas fa-info-circle",label:this.translate.instant("lang.informations")}],this.selectedProcessTool={defaultTab:null,canUpdateData:!1,canUpdateModel:!1,canUpdateDocuments:!1},this.selectedProcessToolClone=null,this.refreshBasketGroup=new m.o}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){yield this.initCustomFields(),this.filteredDataOptions=this.dataControl.valueChanges.pipe(Object(r.a)(""),Object(l.a)(t=>this._filterData(t))),this.availableDataClone=JSON.parse(JSON.stringify(this.availableData)),this.displayedSecondaryData=[];let t=0;this.selectedTemplateDisplayedSecondaryData=this.basketGroup.list_display.templateColumns,this.selectedTemplateDisplayedSecondaryDataClone=this.selectedTemplateDisplayedSecondaryData,this.basketGroup.list_display.subInfos.forEach(e=>{t=this.availableData.map(t=>t.value).indexOf(e.value),this.availableData[t].cssClasses=e.cssClasses,this.displayedSecondaryData.push(this.availableData[t]),this.availableData.splice(t,1)}),this.selectedListEvent=this.basketGroup.list_event,this.selectedListEventClone=this.selectedListEvent,"processDocument"===this.basketGroup.list_event?(this.selectedProcessTool.defaultTab=null===this.basketGroup.list_event_data?"dashboard":this.basketGroup.list_event_data.defaultTab,this.selectedProcessTool.canUpdateData=null!==this.basketGroup.list_event_data&&this.basketGroup.list_event_data.canUpdateData,this.selectedProcessTool.canUpdateModel=null!==this.basketGroup.list_event_data&&this.basketGroup.list_event_data.canUpdateModel):"signatureBookAction"===this.basketGroup.list_event&&(this.selectedProcessTool.canUpdateDocuments=null!==this.basketGroup.list_event_data&&this.basketGroup.list_event_data.canUpdateDocuments),this.selectedProcessToolClone=JSON.parse(JSON.stringify(this.selectedProcessTool)),this.displayedSecondaryDataClone=JSON.parse(JSON.stringify(this.displayedSecondaryData))}))}initCustomFields(){return new Promise((t,e)=>{this.http.get("../rest/customFields").pipe(Object(l.a)(t=>(t.customFields=t.customFields.map(t=>({value:"indexingCustomField_"+t.id,label:t.label,sample:this.translate.instant("lang.customField")+t.id,cssClasses:["align_leftData"],icon:"fa-hashtag"})),t.customFields)),Object(d.a)(e=>{console.log(e),this.availableData=this.availableData.concat(e),t(!0)}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()})}toggleData(){this.dataControl.disabled?this.dataControl.enable():this.dataControl.disable(),this.displayMode="label"===this.displayMode?"sample":"label"}setStyle(t,e){const i=e.split("_");2===i.length&&t.cssClasses.forEach((a,n)=>{a.includes(i[0])&&a!==e&&t.cssClasses.splice(n,1)});const a=t.cssClasses.indexOf(e);-1===a?t.cssClasses.push(e):t.cssClasses.splice(a,1)}addData(t){const e=this.availableData.map(t=>t.value).indexOf(t.option.value.value);this.displayedSecondaryData.push(t.option.value),this.availableData.splice(e,1),$("#availableData").blur(),this.dataControl.setValue("")}removeData(t,e){this.availableData.push(t),this.displayedSecondaryData.splice(e,1),this.dataControl.setValue("")}removeAllData(){this.availableData=this.availableData.concat(this.displayedSecondaryData),this.displayedSecondaryData=[],this.dataControl.setValue("")}drop(t){t.previousContainer===t.container&&Object(Ma.h)(t.container.data,t.previousIndex,t.currentIndex)}saveTemplate(){let t={};const e=[];this.displayedSecondaryData.forEach(t=>{e.push({value:t.value,cssClasses:t.cssClasses,icon:t.icon})}),t={templateColumns:this.selectedTemplateDisplayedSecondaryData,subInfos:e},this.http.put("../rest/baskets/"+this.basketGroup.basket_id+"/groups/"+this.basketGroup.group_id,{list_display:t,list_event:this.selectedListEvent,list_event_data:this.selectedProcessTool}).subscribe(()=>{this.displayedSecondaryDataClone=JSON.parse(JSON.stringify(this.displayedSecondaryData)),this.basketGroup.list_display=e,this.basketGroup.list_event=this.selectedListEvent,this.selectedListEventClone=this.selectedListEvent,this.basketGroup.list_event_data=this.selectedProcessTool,this.selectedProcessToolClone=JSON.parse(JSON.stringify(this.selectedProcessTool)),this.selectedTemplateDisplayedSecondaryDataClone=JSON.parse(JSON.stringify(this.selectedTemplateDisplayedSecondaryData)),this.notify.success(this.translate.instant("lang.modificationsProcessed")),this.refreshBasketGroup.emit(this.basketGroup)},t=>{this.notify.error(t.error.errors)})}_filterData(t){let e="";return"string"==typeof t?e=t.toLowerCase():null!==t&&(e=t.label.toLowerCase()),this.availableData.filter(t=>t.label.toLowerCase().includes(e))}checkModif(){return JSON.stringify(this.displayedSecondaryData)===JSON.stringify(this.displayedSecondaryDataClone)&&this.selectedListEvent===this.selectedListEventClone&&JSON.stringify(this.selectedProcessTool)===JSON.stringify(this.selectedProcessToolClone)&&JSON.stringify(this.selectedTemplateDisplayedSecondaryData)===JSON.stringify(this.selectedTemplateDisplayedSecondaryDataClone)}cancelModification(){this.displayedSecondaryData=JSON.parse(JSON.stringify(this.displayedSecondaryDataClone)),this.selectedListEvent=this.selectedListEventClone,this.selectedProcessTool=JSON.parse(JSON.stringify(this.selectedProcessToolClone)),this.availableData=JSON.parse(JSON.stringify(this.availableDataClone)),this.selectedTemplateDisplayedSecondaryData=JSON.parse(JSON.stringify(this.selectedTemplateDisplayedSecondaryDataClone));let t=0;this.displayedSecondaryData.forEach(e=>{t=this.availableData.map(t=>t.value).indexOf(e.value),this.availableData.splice(t,1)}),this.dataControl.setValue("")}hasFolder(){return this.displayedSecondaryData.map(t=>t.value).indexOf("getFolders")>-1}changeEventList(t){this.selectedProcessTool="processDocument"===t.value?{defaultTab:"dashboard"}:{}}toggleCanUpdate(t){t||(this.selectedProcessTool.canUpdateModel=t)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["list-administration"]],inputs:{basketGroup:["currentBasketGroup","basketGroup"]},outputs:{refreshBasketGroup:"refreshBasketGroup"},decls:59,vars:56,consts:[["appearance","outline",1,"eventList"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","formType ratio-2 col-sm-12",4,"ngIf"],[1,"editorTool"],["color","primary","mat-icon-button","",3,"title","click",4,"ngIf"],["color","primary","mat-button","",3,"title","matMenuTriggerFor"],[1,"fas","fa-columns"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],[1,"area"],["appearance","outline","floatLabel","never"],["id","availableData","name","availableData","type","text","matInput","",3,"formControl","placeholder","matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],["class","dataList",3,"value",4,"ngFor","ngForOf"],["color","warn","mat-button","",2,"float","right",3,"disabled","click"],[4,"ngIf"],[1,"resultRow","newRow"],["class","resultCol",3,"class",4,"ngFor","ngForOf"],["multiple","",1,"actions"],["color","primary","mat-icon-button","",3,"title","disabled"],["fontSet","fas","matBadge","2","fontIcon","fa-comments fa-2x",3,"matBadgeHidden"],["fontSet","fas","matBadge","7","fontIcon","fa-paperclip fa-2x",3,"matBadgeHidden"],["fontSet","fas","fontIcon","fa-sitemap fa-2x"],["fontSet","fas","fontIcon","fa-info-circle fa-2x"],["class","folder-info",4,"ngFor","ngForOf"],[1,"row"],[1,"col-md-12","text-center",2,"margin-top","30px"],["color","primary","mat-raised-button","",3,"disabled","click"],["color","default","mat-raised-button","",3,"disabled","click"],[3,"value"],[1,"formType","ratio-2","col-sm-12"],[1,"formType-title"],[3,"ngModel","ngModelChange"],[2,"padding","10px"],["color","primary",3,"ngModel","ngModelChange","change"],["color","primary",3,"ngModel","disabled","ngModelChange"],["color","primary",3,"ngModel","ngModelChange"],["color","primary","mat-icon-button","",3,"title","click"],["fontSet","fas","fontIcon","fa-eye"],["fontSet","fas","fontIcon","fa-edit"],["mat-menu-item","",3,"click"],[1,"dataList",3,"value"],[1,"optionContent"],[1,"dataIcon"],["color","primary"],[1,"dataLabel"],["cdkDropListOrientation","horizontal","cdkDropList","",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf"],["class","example-box","cdkDrag","",4,"ngIf"],["cdkDrag","",1,"example-box"],["color","primary","mat-icon-button","",3,"matMenuTriggerFor",4,"ngIf"],["color","warn","fontSet","fas","fontIcon","fa-trash fa-2x",1,"secondaryInformations_icon"],["fontSet","fas","fontIcon","fa-bold fa-2x",1,"secondaryInformations_icon"],["fontSet","fas","fontIcon","fa-align-left fa-2x",1,"secondaryInformations_icon"],["fontSet","fas","fontIcon","fa-align-center fa-2x",1,"secondaryInformations_icon"],["fontSet","fas","fontIcon","fa-align-right fa-2x",1,"secondaryInformations_icon"],["fontSet","fas","fontIcon","fa-text-height fa-2x",1,"secondaryInformations_icon"],[2,"width","100%"],[1,"secondaryInformations_label",3,"innerHTML"],["color","primary","mat-icon-button","",3,"matMenuTriggerFor"],["fontSet","fas","fontIcon","fa-ellipsis-v fa-2x"],[1,"resultCol"],["color","primary","class","fm fm-letter fm-2x",4,"ngIf"],["color","warn","class","fm fm-letter-status-inprogress fm-2x",4,"ngIf"],[1,"resultCol_chrono"],["color","primary",1,"fm","fm-letter","fm-2x"],["color","warn",1,"fm","fm-letter-status-inprogress","fm-2x"],[1,"folder-info"],[1,"badge","badge-folder"],[1,"fa","fa-folder"]],template:function(t,e){if(1&t&&(m.Zb(0,"mat-form-field",0),m.Zb(1,"mat-label"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-select",1),m.hc("ngModelChange",(function(t){return e.selectedListEvent=t}))("selectionChange",(function(t){return e.changeEventList(t)})),m.Qc(5,zn,3,4,"mat-option",2),m.Yb(),m.Yb(),m.Qc(6,Nn,19,20,"div",3),m.Qc(7,Jn,8,7,"div",3),m.Ub(8,"hr"),m.Zb(9,"mat-toolbar",4),m.Zb(10,"span"),m.Qc(11,Gn,3,3,"button",5),m.Qc(12,Bn,3,3,"button",5),m.Zb(13,"button",6),m.mc(14,"translate"),m.Sc(15),m.Ub(16,"i",7),m.Yb(),m.Zb(17,"mat-menu",null,8),m.Qc(19,Wn,2,1,"button",9),m.Yb(),m.Yb(),m.Zb(20,"span",10),m.Zb(21,"form"),m.Zb(22,"mat-form-field",11),m.Ub(23,"input",12),m.mc(24,"translate"),m.Zb(25,"mat-autocomplete",13,14),m.hc("optionSelected",(function(t){return e.addData(t)})),m.Qc(27,qn,6,5,"mat-option",15),m.mc(28,"async"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(29,"span"),m.Zb(30,"button",16),m.hc("click",(function(){return e.removeAllData()})),m.Sc(31),m.mc(32,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(33,"mat-card"),m.Qc(34,es,3,5,"ng-container",17),m.Zb(35,"div",18),m.Qc(36,cs,3,4,"span",19),m.Zb(37,"mat-button-toggle-group",20),m.Zb(38,"button",21),m.mc(39,"translate"),m.Ub(40,"mat-icon",22),m.Yb(),m.Zb(41,"button",21),m.mc(42,"translate"),m.Ub(43,"mat-icon",23),m.Yb(),m.Zb(44,"button",21),m.mc(45,"translate"),m.Ub(46,"mat-icon",24),m.Yb(),m.Zb(47,"button",21),m.mc(48,"translate"),m.Ub(49,"mat-icon",25),m.Yb(),m.Yb(),m.Yb(),m.Qc(50,ls,2,1,"div",26),m.Yb(),m.Zb(51,"div",27),m.Zb(52,"div",28),m.Zb(53,"button",29),m.hc("click",(function(){return e.saveTemplate()})),m.Sc(54),m.mc(55,"translate"),m.Yb(),m.Zb(56,"button",30),m.hc("click",(function(){return e.cancelModification()})),m.Sc(57),m.mc(58,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(18),i=m.Dc(26);m.Eb(2),m.Tc(m.nc(3,34,"lang.eventList")),m.Eb(2),m.sc("ngModel",e.selectedListEvent),m.Eb(1),m.sc("ngForOf",e.listEvent),m.Eb(1),m.sc("ngIf","processDocument"===e.selectedListEvent),m.Eb(1),m.sc("ngIf","signatureBookAction"===e.selectedListEvent),m.Eb(4),m.sc("ngIf","label"==e.displayMode),m.Eb(1),m.sc("ngIf","sample"==e.displayMode),m.Eb(1),m.sc("title",m.nc(14,36,"lang.templateUsed"))("matMenuTriggerFor",t),m.Eb(2),m.Uc(" ",e.selectedTemplateDisplayedSecondaryData," "),m.Eb(4),m.sc("ngForOf",e.templateDisplayedSecondaryData),m.Eb(4),m.tc("placeholder",m.nc(24,38,"lang.availableDatas")),m.sc("formControl",e.dataControl)("matAutocomplete",i),m.Eb(4),m.sc("ngForOf",m.nc(28,40,e.filteredDataOptions)),m.Eb(3),m.sc("disabled","sample"==e.displayMode),m.Eb(1),m.Uc(" ",m.nc(32,42,"lang.eraseAll")," "),m.Eb(3),m.sc("ngIf",e.displayedSecondaryData.length>0&&"sample"==e.displayMode||"label"==e.displayMode),m.Eb(2),m.sc("ngForOf",e.displayedMainData),m.Eb(2),m.tc("title",m.nc(39,44,"lang.notes")),m.sc("disabled","label"==e.displayMode),m.Eb(2),m.sc("matBadgeHidden","label"==e.displayMode),m.Eb(1),m.tc("title",m.nc(42,46,"lang.attachments")),m.sc("disabled","label"==e.displayMode),m.Eb(2),m.sc("matBadgeHidden","label"==e.displayMode),m.Eb(1),m.tc("title",m.nc(45,48,"lang.diffusionList")),m.sc("disabled","label"==e.displayMode),m.Eb(3),m.tc("title",m.nc(48,50,"lang.linkDetails")),m.sc("disabled","label"==e.displayMode),m.Eb(3),m.sc("ngForOf",e.displayedSecondaryData),m.Eb(3),m.sc("disabled",e.checkModif()),m.Eb(1),m.Uc(" ",m.nc(55,52,"lang.validate")," "),m.Eb(2),m.sc("disabled",e.checkModif()),m.Eb(1),m.Uc(" ",m.nc(58,54,"lang.cancel")," ")}},directives:[w.c,w.g,at.a,o.t,o.w,x.s,x.t,tt.a,D.b,Fe.d,Fe.e,o.J,o.u,o.v,O.b,o.c,Hn.d,o.i,Hn.a,k.a,kt.b,Tt.a,$n.a,I.o,et.a,Fe.b,Ma.e,Ma.a,_.a],pipes:[p.d,x.b,U.a],styles:[".availableData[_ngcontent-%COMP%]{margin:10px;display:flex}.secondaryInformations[_ngcontent-%COMP%]{border:1px solid rgba(249,152,48,.4);font-size:10px;height:30px;color:#666}.secondaryInformations_icon[_ngcontent-%COMP%]{height:auto}.secondaryInformations_label[_ngcontent-%COMP%]{width:100%}.resultRow[_ngcontent-%COMP%]{align-items:center;display:flex;padding:5px}.resultRow-mobile[_ngcontent-%COMP%]{font-size:80%}.resultCol[_ngcontent-%COMP%]{flex:1;overflow:hidden;text-overflow:ellipsis}.resultCol-mobile[_ngcontent-%COMP%]{overflow:inherit;text-overflow:inherit;word-break:break-all}.resultCol_chrono[_ngcontent-%COMP%]{color:rgba(0,0,0,.4);font-size:90%}.actions[_ngcontent-%COMP%]{text-align:right;box-shadow:none;border:none;flex:1;justify-content:flex-end;overflow:inherit}.elemToDrag[_ngcontent-%COMP%]{flex:1;border:1px dashed;padding:10px;height:10px;line-height:0;cursor:move;margin-right:5px;margin-left:5px}.columns[_ngcontent-%COMP%]{width:100%;height:90px;padding:20px 10px;border-bottom:1px solid #ccc;color:rgba(0,0,0,.87);display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;background:#fff;font-size:14px}.mat-badge-content[_ngcontent-%COMP%]{background:#f99830}.example-list[_ngcontent-%COMP%]{display:grid;gap:10px;height:auto;max-width:100%;border-radius:4px;border:1px solid rgba(249,152,48,.4);font-size:10px;background:#f5f5f5}.example-box[_ngcontent-%COMP%]{color:#666;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:#f5f5f5;flex-grow:1;flex-basis:0;height:20px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.editorTool[_ngcontent-%COMP%]{display:flex;height:44px;font-size:10px;margin-bottom:30px}.editorTool[_ngcontent-%COMP%]   .area[_ngcontent-%COMP%]{flex:1}.editorTool[_ngcontent-%COMP%]   .area[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%}.editorTool[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-left:1px solid #666;height:70%;margin-left:10px;margin-right:10px}.editorTool[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{height:35px}.editorTool[_ngcontent-%COMP%]     .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{background:inherit}.editorTool[_ngcontent-%COMP%]     .mat-form-field-outline{background:#fff}.optionContent[_ngcontent-%COMP%]{display:flex!important}.optionContent[_ngcontent-%COMP%]   .dataIcon[_ngcontent-%COMP%]{width:30px}.optionContent[_ngcontent-%COMP%]   .dataIcon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.optionContent[_ngcontent-%COMP%]   .dataLabel[_ngcontent-%COMP%]{flex:1}.isSelectedMenu[_ngcontent-%COMP%]{background:rgba(249,152,48,.14)}.align_leftData[_ngcontent-%COMP%]{text-align:left}.align_centerData[_ngcontent-%COMP%]{text-align:center}.align_rightData[_ngcontent-%COMP%]{text-align:right}.boldFontData[_ngcontent-%COMP%]{font-weight:700}.bigFontData[_ngcontent-%COMP%]{font-size:14px}.smallFontData[_ngcontent-%COMP%]{font-size:10px}.normalData[_ngcontent-%COMP%]{flex:1}.longData[_ngcontent-%COMP%]{flex:3}.eventList[_ngcontent-%COMP%]{padding-top:10px}.badge-folder[_ngcontent-%COMP%]{cursor:default;background:#135f7f;margin:5px;font-size:8px;max-width:250px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.formType[_ngcontent-%COMP%]{align-items:center;margin-bottom:10px;border-radius:4px;border:1px solid #ccc;position:relative;padding:10px}.formType-title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:10px;font-weight:700;background:#fff;position:absolute;top:-7px;left:10px;padding:0;margin:0;color:#135f7f}"]}),t})();const bs=["snav2"],ms=["adminMenuTemplate"],ps=function(t){return{opacity:t}};function us(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",13),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",20),m.hc("click",(function(){return m.Hc(t),m.lc(2).linkGroup()})),m.Ub(5,"mat-icon",21),m.Zb(6,"p",22),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Ub(9,"mat-divider"),m.Zb(10,"a",23),m.mc(11,"translate"),m.Zb(12,"mat-icon",24),m.Zb(13,"mat-slide-toggle",25),m.hc("change",(function(){m.Hc(t);const e=m.lc(2);return e.toggleIsSearchBasket(e.basket),!1})),m.Yb(),m.Yb(),m.Zb(14,"p",26),m.hc("click",(function(){m.Hc(t);const e=m.lc(2);return e.toggleIsSearchBasket(e.basket),!1})),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Zb(17,"a",23),m.mc(18,"translate"),m.Zb(19,"mat-icon",24),m.Zb(20,"mat-slide-toggle",25),m.hc("change",(function(){m.Hc(t);const e=m.lc(2);return e.toggleFlagNotif(e.basket),!1})),m.Yb(),m.Yb(),m.Zb(21,"p",26),m.hc("click",(function(){m.Hc(t);const e=m.lc(2);return e.toggleFlagNotif(e.basket),!1})),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Tc(m.nc(3,10,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,12,"lang.linkGroup")," "),m.Eb(3),m.tc("matTooltip",m.nc(11,14,"lang.isSearchBasketInfo")),m.Eb(3),m.sc("checked",t.basket.isSearchBasket),m.Eb(1),m.sc("ngStyle",m.zc(22,ps,t.basket.isSearchBasket?"":"0.3")),m.Eb(1),m.Uc(" ",m.nc(16,16,"lang.isSearchBasket")," "),m.Eb(2),m.tc("matTooltip",m.nc(18,18,"lang.basketNotification")),m.Eb(3),m.sc("checked",t.basket.flagNotif),m.Eb(1),m.sc("ngStyle",m.zc(24,ps,t.basket.flagNotif?"":"0.3")),m.Eb(1),m.Uc(" ",m.nc(23,20,"lang.activateNotification")," ")}}function hs(t,e){if(1&t&&m.Qc(0,us,24,26,"mat-nav-list",19),2&t){const t=m.lc();m.sc("ngIf",!t.creationMode)}}function fs(t,e){1&t&&(m.Zb(0,"div",27),m.Ub(1,"mat-spinner",28),m.Yb())}function gs(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",49),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).basket.id=e}))("blur",(function(){return m.Hc(t),m.lc(2).isAvailable()})),m.mc(1,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("placeholder",m.nc(1,2,"lang.id")),m.sc("ngModel",t.basket.id)}}function vs(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",50),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).basket.id=e})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("placeholder",m.nc(1,3,"lang.id")),m.tc("title",m.nc(2,5,"lang.id")),m.sc("ngModel",t.basket.id)}}function ys(t,e){if(1&t&&(m.Zb(0,"mat-option",58),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(3);m.sc("value",t),m.Eb(1),m.Uc(" ",i.langVarName[i.orderColumns.indexOf(t)],"")}}function Cs(t,e){if(1&t&&(m.Zb(0,"mat-option",58),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(3);m.sc("value",t),m.Eb(1),m.Uc(" ",i.langOrderName[i.orderByColumns.indexOf(t)],"")}}function Es(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",59),m.hc("click",(function(){return m.Hc(t),m.lc(3).addLine()})),m.Ub(1,"mat-icon",60),m.Yb()}if(2&t){const t=m.lc(3);m.sc("disabled",2==t.orderColumnsSelected.length)}}function Ss(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",36),m.Zb(1,"div",51),m.Zb(2,"mat-form-field"),m.Zb(3,"mat-select",52),m.hc("ngModelChange",(function(i){m.Hc(t);const a=e.index;return m.lc(2).orderColumnsSelected[a].column=i})),m.mc(4,"translate"),m.Qc(5,ys,2,2,"mat-option",53),m.Yb(),m.Yb(),m.Yb(),m.Zb(6,"div",51),m.Zb(7,"mat-form-field"),m.Zb(8,"mat-select",52),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.order=i})),m.mc(9,"translate"),m.Qc(10,Cs,2,2,"mat-option",53),m.Yb(),m.Yb(),m.Yb(),m.Zb(11,"div",54),m.Zb(12,"button",55),m.hc("click",(function(){m.Hc(t);const i=e.index;return m.lc(2).removeLine(i)})),m.Ub(13,"mat-icon",56),m.Yb(),m.Qc(14,Es,2,1,"button",57),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=e.index,a=m.lc(2);m.Eb(3),m.vc("placeholder","",m.nc(4,11,"lang.defaultSort")," ",i+1,""),m.uc("name","basket_res_order",i,""),m.sc("ngModel",a.orderColumnsSelected[i].column),m.Eb(2),m.sc("ngForOf",a.orderColumns),m.Eb(3),m.tc("placeholder",m.nc(9,13,"lang.orderBy")),m.uc("name","order_by_select",i,""),m.sc("ngModel",t.order),m.Eb(2),m.sc("ngForOf",a.orderByColumns),m.Eb(2),m.sc("disabled",1==a.orderColumnsSelected.length),m.Eb(2),m.sc("ngIf",a.orderColumnsSelected.length==i+1)}}function Ms(t,e){if(1&t){const t=m.ac();m.Zb(0,"span"),m.Sc(1),m.Yb(),m.Zb(2,"mat-icon",62),m.hc("click",(function(){m.Hc(t);const e=m.lc().index;return m.lc(2).unlinkGroup(e)})),m.mc(3,"translate"),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(1),m.Tc(t.group_desc),m.Eb(1),m.tc("matTooltip",m.nc(3,2,"lang.unlinkGroup"))}}function Ys(t,e){1&t&&(m.Zb(0,"small"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("(",m.nc(2,1,"lang.default"),")"))}function Zs(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-icon",85),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.mc(1,"translate"),m.Yb()}2&t&&m.tc("matTooltip",m.nc(1,1,"lang.delete"))}const xs=function(t){return{"font-weight":t}};function _s(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",81),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit,i=m.lc(2).$implicit;return m.lc(2).openSettings(i,e)}))("removed",(function(){m.Hc(t);const e=m.lc().$implicit,i=m.lc(2).$implicit;return m.lc(2).unlinkAction(i,e)})),m.Sc(1," \xa0 "),m.Zb(2,"span"),m.Sc(3),m.Yb(),m.Sc(4,"\xa0 "),m.Qc(5,Ys,3,3,"small",19),m.Ub(6,"span",82),m.Zb(7,"button",83),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2).$implicit,n=m.lc(2);return e.stopPropagation(),n.setDefaultAction(a,i)})),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Qc(10,Zs,2,3,"mat-icon",84),m.Yb()}if(2&t){const t=m.lc().$implicit;m.uc("matTooltip","id : ",t.id,""),m.sc("ngStyle",m.zc(9,xs,1==t.default_action_list?"bold":"")),m.Eb(3),m.Tc(t.label_action),m.Eb(2),m.sc("ngIf",1==t.default_action_list),m.Eb(2),m.sc("disabled",t.default_action_list),m.Eb(1),m.Tc(m.nc(9,7,"lang.setByDefault")),m.Eb(2),m.sc("ngIf",1!=t.default_action_list)}}function ws(t,e){if(1&t&&(m.Zb(0,"span",79),m.Qc(1,_s,11,11,"mat-chip",80),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",1==t.checked)}}function Os(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Ts(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",86),m.Zb(1,"mat-checkbox",87),m.hc("change",(function(){m.Hc(t);const e=m.lc(2).$implicit;return m.lc(2).addAction(e)}))("ngModelChange",(function(i){return m.Hc(t),e.$implicit.checked=i})),m.Zb(2,"span"),m.Sc(3),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.uc("matTooltip","id : ",t.id,""),m.Eb(1),m.sc("disabled",1==t.default_action_list)("ngModel",t.checked),m.Eb(2),m.Tc(t.label_action)}}function ks(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Is(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",88),m.Zb(1,"button",89),m.Ub(2,"mat-icon",90),m.Yb(),m.Zb(3,"mat-menu",null,91),m.Zb(5,"button",92),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=m.lc(2).$implicit;return m.lc(2).setDefaultAction(a,i)})),m.Ub(6,"mat-icon",93),m.Zb(7,"span"),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Zb(10,"button",94),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=m.lc(2).$implicit;return m.lc(2).openSettings(a,i)})),m.Ub(11,"mat-icon",95),m.Zb(12,"span"),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.Dc(4);m.uc("matTooltip","id : ",t.id,""),m.Eb(1),m.sc("matMenuTriggerFor",i)("disabled",!t.checked),m.Eb(4),m.sc("disabled",1==t.default_action_list),m.Eb(3),m.Tc(m.nc(9,6,"lang.defaultAction")),m.Eb(5),m.Tc(m.nc(14,8,"lang.moreOptions"))}}function Ds(t,e){1&t&&m.Ub(0,"mat-row")}function Us(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab-group"),m.Zb(1,"mat-tab",31),m.mc(2,"translate"),m.Zb(3,"div",63),m.Zb(4,"h5"),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Zb(7,"mat-chip-list",64,65),m.Qc(9,ws,2,1,"span",66),m.mc(10,"sortBy"),m.Yb(),m.Yb(),m.Zb(11,"div",63),m.Zb(12,"mat-accordion",67),m.Zb(13,"mat-expansion-panel",68),m.hc("opened",(function(){m.Hc(t);const e=m.lc().index;return m.lc(2).initAction(e)})),m.Zb(14,"mat-expansion-panel-header"),m.Zb(15,"mat-panel-title"),m.Sc(16),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Zb(18,"div"),m.Zb(19,"mat-form-field"),m.Zb(20,"input",69),m.hc("keyup",(function(e){return m.Hc(t),m.lc(3).applyFilter(e.target.value)})),m.mc(21,"translate"),m.Yb(),m.Yb(),m.Zb(22,"mat-table",70,71),m.Xb(24,72),m.Qc(25,Os,1,0,"mat-header-cell",73),m.Qc(26,Ts,4,4,"mat-cell",74),m.Wb(),m.Xb(27,75),m.Qc(28,ks,1,0,"mat-header-cell",73),m.Qc(29,Is,15,10,"mat-cell",76),m.Wb(),m.Qc(30,Ds,1,0,"mat-row",77),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(31,"mat-tab",31),m.mc(32,"translate"),m.Zb(33,"list-administration",78),m.hc("refreshBasketGroup",(function(e){m.Hc(t);const i=m.lc().$implicit;return m.lc(2).updateGroupInfo(i,e)})),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(2);m.Eb(1),m.tc("label",m.nc(2,9,"lang.actions")),m.Eb(4),m.Tc(m.nc(6,11,"lang.actionChosen")),m.Eb(4),m.sc("ngForOf",m.oc(10,13,t.groupActions,"label_action")),m.Eb(7),m.Uc(" ",m.nc(17,16,"lang.actionAvailable")," "),m.Eb(4),m.tc("placeholder",m.nc(21,18,"lang.filterBy")),m.Eb(2),m.sc("dataSource",e.dataSource),m.Eb(8),m.sc("matRowDefColumns",e.displayedColumns),m.Eb(1),m.tc("label",m.nc(32,20,"lang.resultPage")),m.Eb(2),m.sc("currentBasketGroup",t)}}function Ps(t,e){if(1&t&&(m.Zb(0,"mat-tab",31),m.Qc(1,Ms,4,4,"ng-template",61),m.Qc(2,Us,34,22,"mat-tab-group",19),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.tc("label",t.group_desc),m.Eb(2),m.sc("ngIf",i.selectedIndex>0)}}const Fs=function(t){return{color:t}};function Ls(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",29),m.Zb(1,"mat-tab-group",30),m.hc("selectedIndexChange",(function(e){return m.Hc(t),m.lc().selectedIndex=e})),m.Zb(2,"mat-tab",31),m.mc(3,"translate"),m.Zb(4,"form",32,33),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(6,"mat-form-field"),m.Qc(7,gs,2,4,"input",34),m.Qc(8,vs,3,7,"input",35),m.Yb(),m.Zb(9,"div",36),m.Zb(10,"div",37),m.Zb(11,"mat-form-field"),m.Zb(12,"input",38),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().basket.basket_name=e})),m.mc(13,"translate"),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"div",39),m.Zb(16,"mat-form-field"),m.Zb(17,"input",40),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().basket.color=e})),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(19,"mat-form-field"),m.Zb(20,"input",41),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().basket.basket_desc=e})),m.mc(21,"translate"),m.mc(22,"translate"),m.Yb(),m.Yb(),m.Zb(23,"mat-form-field"),m.Zb(24,"textarea",42),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().basket.clause=e})),m.mc(25,"translate"),m.mc(26,"translate"),m.Yb(),m.Zb(27,"mat-icon",43),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(16).toggle()})),m.mc(28,"translate"),m.Yb(),m.Yb(),m.Zb(29,"div",44),m.Qc(30,Ss,15,15,"div",45),m.Yb(),m.Zb(31,"div",46),m.Zb(32,"button",47),m.Sc(33),m.mc(34,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(35,Ps,3,2,"mat-tab",48),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(5),e=m.lc();m.Eb(1),m.sc("selectedIndex",e.selectedIndex),m.Eb(1),m.tc("label",m.nc(3,21,"lang.informations")),m.Eb(5),m.sc("ngIf",e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(13,23,"lang.label")),m.tc("placeholder",m.nc(14,25,"lang.label")),m.sc("ngModel",e.basket.basket_name)("ngStyle",m.zc(41,Fs,e.basket.color)),m.Eb(5),m.tc("matTooltip",m.nc(18,27,"lang.chooseColor")),m.sc("ngModel",e.basket.color),m.Eb(3),m.tc("title",m.nc(21,29,"lang.description")),m.tc("placeholder",m.nc(22,31,"lang.description")),m.sc("ngModel",e.basket.basket_desc),m.Eb(4),m.tc("title",m.nc(25,33,"lang.clause")),m.tc("placeholder",m.nc(26,35,"lang.clause")),m.sc("ngModel",e.basket.clause),m.Eb(3),m.tc("matTooltip",m.nc(28,37,"lang.keywordHelper")),m.Eb(3),m.sc("ngForOf",e.orderColumnsSelected),m.Eb(2),m.sc("disabled",!t.form.valid||0==e.orderColumnsSelected.length),m.Eb(1),m.Tc(m.nc(34,39,"lang.save")),m.Eb(2),m.sc("ngForOf",e.basketGroups)}}const js=["statusInput"];function Rs(t,e){1&t&&(m.Sc(0),m.mc(1,"translate")),2&t&&m.Uc(" ",m.nc(1,1,"lang.redirects")," ")}function Qs(t,e){1&t&&m.Qc(0,Rs,2,3,"ng-template",21)}function As(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-expansion-panel",17),m.hc("opened",(function(){return m.Hc(t),m.lc(2).initService2()})),m.Zb(1,"mat-expansion-panel-header"),m.Zb(2,"mat-panel-title"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Zb(5,"mat-form-field"),m.Ub(6,"input",22),m.mc(7,"translate"),m.Yb(),m.Ub(8,"div",23),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,2,"lang.toUsersEntities")," "),m.Eb(3),m.tc("placeholder",m.nc(7,4,"lang.searchEntities")))}function Hs(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab"),m.Qc(1,Qs,1,0,void 0,7),m.Zb(2,"mat-accordion"),m.Zb(3,"mat-expansion-panel",17),m.hc("opened",(function(){return m.Hc(t),m.lc().initService()})),m.Zb(4,"mat-expansion-panel-header"),m.Zb(5,"mat-panel-title"),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Zb(8,"mat-form-field"),m.Ub(9,"input",18),m.mc(10,"translate"),m.Yb(),m.Ub(11,"div",19),m.Yb(),m.Qc(12,As,9,6,"mat-expansion-panel",20),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(1),m.sc("ngIf","redirect"==t.data.action.keyword),m.Eb(5),m.Uc(" ",m.nc(7,4,"lang.toEntities")," "),m.Eb(3),m.tc("placeholder",m.nc(10,6,"lang.searchEntities")),m.Eb(3),m.sc("ngIf","redirect"==t.data.action.keyword)}}function $s(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",4),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc().validateForm(e)})),m.Sc(1),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(1),m.Uc(" ",t.group_desc," ")}}function zs(t,e){if(1&t&&(m.Zb(0,"span"),m.Qc(1,$s,2,1,"mat-list-item",3),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",0==t.isUsed)}}let Vs=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.dialog=s,this.headerService=c,this.appService=o,this.viewContainerRef=r,this.selectedIndex=0,this.loading=!1,this.config={},this.basket={},this.basketClone={},this.basketGroups=[],this.allGroups=[],this.actionsList=[],this.list_display=[],this.displayedColumns=["label_action","actions"],this.orderColumns=["alt_identifier","creation_date","process_limit_date","res_id","priority"],this.orderByColumns=["asc","desc"],this.langVarName=[this.translate.instant("lang.chrono"),this.translate.instant("lang.creationDate"),this.translate.instant("lang.processLimitDate"),this.translate.instant("lang.id"),this.translate.instant("lang.priority")],this.langOrderName=[this.translate.instant("lang.ascending"),this.translate.instant("lang.descending")],this.orderColumnsSelected=[{column:"res_id",order:"asc"}]}applyFilter(t){t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t}ngOnInit(){this.loading=!0,this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.basketCreation")),this.creationMode=!0,this.basketIdAvailable=!1,this.loading=!1):(this.orderColumnsSelected=[],this.creationMode=!1,this.basketIdAvailable=!0,this.id=t.id,this.http.get("../rest/baskets/"+this.id).subscribe(t=>{if(this.headerService.setHeader(this.translate.instant("lang.basketModification"),t.basket.basket_name),this.basket=t.basket,this.basket.id=t.basket.basket_id,this.basket.name=t.basket.basket_name,this.basket.description=t.basket.basket_desc,this.basket.clause=t.basket.basket_clause,this.basket.isSearchBasket="Y"!==t.basket.is_visible,this.basket.flagNotif="Y"===t.basket.flag_notif,""===this.basket.basket_res_order||null==this.basket.basket_res_order)this.orderColumnsSelected=[];else{const t=this.basket.basket_res_order.split(", ");for(let e=0;e<t.length;e++){const i=t[e].split(" ");i[1]||(i[1]="desc"),this.orderColumnsSelected.push({column:i[0],order:i[1]})}}this.basketClone=JSON.parse(JSON.stringify(this.basket)),this.http.get("../rest/baskets/"+this.id+"/groups").subscribe(t=>{this.allGroups=t.allGroups,this.allGroups.forEach(e=>{e.isUsed=!1,t.groups.forEach(t=>{e.group_id===t.group_id&&(e.isUsed=!0)})}),t.groups.forEach(t=>{t.groupActions.forEach(t=>{t.used_in_basketlist="Y"===t.used_in_basketlist,t.used_in_action_page="Y"===t.used_in_action_page,t.default_action_list="Y"===t.default_action_list})}),this.basketGroups=t.groups,this.loading=!1},t=>{this.notify.handleErrors(t)})},t=>{this.notify.handleErrors(t)}))})}openSettings(t,e){this.config={panelClass:"maarch-modal",data:{group:t,action:e}},this.dialogRef=this.dialog.open(Ns,this.config),this.dialogRef.afterClosed().subscribe(i=>{i&&this.http.put("../rest/baskets/"+this.id+"/groups/"+i.group.group_id+"/actions",{groupActions:i.group.groupActions}).subscribe(()=>{this.dialogRef=null,this.notify.success(this.translate.instant("lang.basketUpdated"))},i=>{this.dialogRef=null,this.openSettings(t,e),this.notify.error(i.error.errors)})})}isAvailable(){this.basket.id?this.http.get("../rest/baskets/"+this.basket.id).subscribe(()=>{this.basketIdAvailable=!1},t=>{this.basketIdAvailable=!1,t.error.errors===this.translate.instant("lang.basketNotFound")&&(this.basketIdAvailable=!0)}):this.basketIdAvailable=!1}onSubmit(){if(null!==this.orderColumnsSelected&&this.orderColumnsSelected.length>0){const t=[];for(let e=0;e<this.orderColumnsSelected.length;e++)t[e]=this.orderColumnsSelected[e].column+" "+this.orderColumnsSelected[e].order;this.basket.basket_res_order=t.join(", ")}else this.basket.basket_res_order="";this.creationMode?this.http.post("../rest/baskets",this.basket).subscribe(()=>{this.notify.success(this.translate.instant("lang.basketAdded")),this.router.navigate(["/administration/baskets/"+this.basket.id])},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/baskets/"+this.id,this.basket).subscribe(()=>{this.notify.success(this.translate.instant("lang.basketUpdated")),this.router.navigate(["/administration/baskets"])},t=>{this.notify.error(t.error.errors)})}addLine(){this.orderColumnsSelected.push(JSON.parse(JSON.stringify(this.orderColumnsSelected[0])))}removeLine(t){this.orderColumnsSelected.splice(t,1)}initAction(t){this.dataSource=new G.o(this.basketGroups[t].groupActions),this.dataSource.sort=this.sort}setDefaultAction(t,e){t.groupActions.forEach(t=>{t.default_action_list=t.id===e.id}),this.addAction(t)}unlinkGroup(t){confirm(this.translate.instant("lang.unlinkGroup")+" ?")&&this.http.delete("../rest/baskets/"+this.id+"/groups/"+this.basketGroups[t].group_id).subscribe(()=>{this.allGroups.forEach(e=>{e.group_id===this.basketGroups[t].group_id&&(e.isUsed=!1)}),this.basketGroups.splice(t,1),this.notify.success(this.translate.instant("lang.basketUpdated")),this.selectedIndex=0},t=>{this.notify.error(t.error.errors)})}linkGroup(){this.config={panelClass:"maarch-modal",data:{basketId:this.basket.id,groups:this.allGroups,linkedGroups:this.basketGroups}},this.dialogRef=this.dialog.open(Js,this.config),this.dialogRef.afterClosed().subscribe(t=>{t&&(t.list_display=this.basketGroups.length>0?this.basketGroups[this.basketGroups.length-1].list_display:{subInfos:[],templateColumns:0},this.http.post("../rest/baskets/"+this.id+"/groups",t).subscribe(()=>{this.basketGroups.push(t),this.allGroups.forEach(e=>{e.group_id===t.group_id&&(e.isUsed=!0)}),this.notify.success(this.translate.instant("lang.basketUpdated")),this.selectedIndex=this.basketGroups.length},t=>{this.notify.error(t.error.errors)})),this.dialogRef=null})}addAction(t){this.http.put("../rest/baskets/"+this.id+"/groups/"+t.group_id+"/actions",{groupActions:t.groupActions}).subscribe(()=>{this.notify.success(this.translate.instant("lang.actionsGroupBasketUpdated"))},t=>{this.notify.error(t.error.errors)})}toggleIsSearchBasket(t){t.isSearchBasket=!t.isSearchBasket,this.basketClone.isSearchBasket=t.isSearchBasket,this.http.put("../rest/baskets/"+this.id,this.basketClone).subscribe(()=>{this.notify.success(this.translate.instant("lang.basketUpdated"))},t=>{this.notify.error(t.error.errors)})}toggleFlagNotif(t){t.flagNotif=!t.flagNotif,this.basketClone.flagNotif=t.flagNotif,this.http.put("../rest/baskets/"+this.id,this.basketClone).subscribe(()=>{this.notify.success(this.translate.instant("lang.basketUpdated"))},t=>{this.notify.error(t.error.errors)})}unlinkAction(t,e){confirm(this.translate.instant("lang.unlinkAction")+" ?")&&(e.checked=!1,this.http.put("../rest/baskets/"+this.id+"/groups/"+t.group_id+"/actions",{groupActions:t.groupActions}).subscribe(()=>{this.notify.success(this.translate.instant("lang.actionsGroupBasketUpdated"))},t=>{this.notify.error(t.error.errors)}))}updateGroupInfo(t,e){}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(bs,!0),m.Oc(ms,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:93,vars:56,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],["role","list",2,"width","300px","padding","5px"],[2,"font-size","10px"],[2,"border","1px black solid","padding","3px","font-size","10px"],["mat-line","",2,"font-weight","bold","font-size","10px"],["mat-line","",2,"font-size","10px"],[4,"ngIf"],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fa","fa-link"],["mat-line",""],["mat-list-item","","disableRipple","true",3,"matTooltip"],["color","primary","mat-list-icon",""],["color","primary",3,"checked","change"],["mat-line","",3,"ngStyle","click"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"selectedIndex","selectedIndexChange"],[3,"label"],[1,"form-horizontal",3,"ngSubmit"],["basketForm","ngForm"],["matInput","","name","identifier","maxlength","32","pattern","^[\\w.-]*$","required","",3,"placeholder","ngModel","ngModelChange","blur",4,"ngIf"],["matInput","","name","identifier","required","","disabled","",3,"placeholder","title","ngModel","ngModelChange",4,"ngIf"],[1,"row"],[1,"col-md-11","col-xs-10"],["matInput","","name","label","maxlength","255","required","",3,"title","placeholder","ngModel","ngStyle","ngModelChange"],[1,"col-md-1","col-xs-2"],["matInput","","type","color","name","color",3,"matTooltip","ngModel","ngModelChange"],["matInput","","name","description","maxlength","255","required","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","name","clause","matTextareaAutosize","","matAutosizeMinRows","1","required","",3,"title","placeholder","ngModel","ngModelChange"],["color","primary","matSuffix","",1,"fa","fa-info-circle",2,"cursor","pointer",3,"matTooltip","click"],["id","listOrder"],["class","row",4,"ngFor","ngForOf"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled"],[3,"label",4,"ngFor","ngForOf"],["matInput","","name","identifier","maxlength","32","pattern","^[\\w.-]*$","required","",3,"placeholder","ngModel","ngModelChange","blur"],["matInput","","name","identifier","required","","disabled","",3,"placeholder","title","ngModel","ngModelChange"],[1,"col-md-5","col-xs-5","text-center"],["required","",3,"placeholder","ngModel","name","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2","col-xs-2","text-left"],["color","warn","mat-icon-button","","type","button",3,"disabled","click"],[1,"fa","fa-minus-square","fa-2x"],["color","primary","mat-icon-button","","type","button",3,"disabled","click",4,"ngIf"],[3,"value"],["color","primary","mat-icon-button","","type","button",3,"disabled","click"],[1,"fa","fa-plus-square","fa-2x"],["mat-tab-label",""],["color","warn",1,"fa","fa-times",3,"matTooltip","click"],[1,"col-md-6"],[1,"mat-chip-list-stacked"],["chipList",""],["style","width:100%;",4,"ngFor","ngForOf"],[1,"basketActionsList"],[3,"opened"],["matInput","",3,"placeholder","keyup"],[3,"dataSource"],["table",""],["matColumnDef","label_action"],[4,"matHeaderCellDef"],["style","flex:6;",3,"matTooltip",4,"matCellDef"],["matColumnDef","actions"],["style","text-align:right",3,"matTooltip",4,"matCellDef"],[4,"matRowDef","matRowDefColumns"],[3,"currentBasketGroup","refreshBasketGroup"],[2,"width","100%"],["color","primary","style","cursor:pointer;margin:5px;border-radius:0px;display:flex;","selectable","true","removable","true",3,"matTooltip","ngStyle","click","removed",4,"ngIf"],["color","primary","selectable","true","removable","true",2,"cursor","pointer","margin","5px","border-radius","0px","display","flex",3,"matTooltip","ngStyle","click","removed"],[2,"flex","1 1 auto"],["mat-raised-button","",3,"disabled","click"],["matChipRemove","","color","warn","class","fa fa-times",3,"matTooltip","click",4,"ngIf"],["matChipRemove","","color","warn",1,"fa","fa-times",3,"matTooltip","click"],[2,"flex","6",3,"matTooltip"],["color","primary",3,"disabled","ngModel","change","ngModelChange"],[2,"text-align","right",3,"matTooltip"],["mat-icon-button","",3,"matMenuTriggerFor","disabled"],[1,"fa","fa-bars"],["menu","matMenu"],["mat-menu-item","",3,"disabled","click"],[1,"fa","fa-check-circle"],["mat-menu-item","",3,"click"],[1,"fa","fa-cogs"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,hs,1,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,fs,2,0,"div",9),m.Qc(14,Ls,36,43,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"mat-nav-list"),m.Zb(18,"h3",13),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Yb(),m.Zb(21,"mat-list",14),m.Zb(22,"p",15),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Zb(25,"div",16),m.Zb(26,"b"),m.Sc(27,"DESTINATION = @my_primary_entity or DESTINATION in (@subentities[@my_primary_entity])"),m.Yb(),m.Yb(),m.Zb(28,"h4",17),m.Sc(29,"@user :"),m.Yb(),m.Zb(30,"p",18),m.Sc(31),m.mc(32,"translate"),m.Yb(),m.Zb(33,"h4",17),m.Sc(34,"@user_id :"),m.Yb(),m.Zb(35,"p",18),m.Sc(36),m.mc(37,"translate"),m.Yb(),m.Zb(38,"h4",17),m.Sc(39,"@email :"),m.Yb(),m.Zb(40,"p",18),m.Sc(41),m.mc(42,"translate"),m.Yb(),m.Zb(43,"h4",17),m.Sc(44,"@my_entities :"),m.Yb(),m.Zb(45,"p",18),m.Sc(46),m.mc(47,"translate"),m.Yb(),m.Zb(48,"h4",17),m.Sc(49,"@my_entities_id :"),m.Yb(),m.Zb(50,"p",18),m.Sc(51),m.mc(52,"translate"),m.Yb(),m.Zb(53,"h4",17),m.Sc(54,"@my_primary_entity :"),m.Yb(),m.Zb(55,"p",18),m.Sc(56),m.mc(57,"translate"),m.Yb(),m.Zb(58,"h4",17),m.Sc(59,"@my_primary_entity_id :"),m.Yb(),m.Zb(60,"p",18),m.Sc(61),m.mc(62,"translate"),m.Yb(),m.Zb(63,"h4",17),m.Sc(64,"@subentities[('entity_1',...,'entity_n')] :"),m.Yb(),m.Zb(65,"p",18),m.Sc(66),m.mc(67,"translate"),m.Yb(),m.Zb(68,"h4",17),m.Sc(69,"@parent_entity['entity_id'] :"),m.Yb(),m.Zb(70,"p",18),m.Sc(71),m.mc(72,"translate"),m.Yb(),m.Zb(73,"h4",17),m.Sc(74,"@sisters_entities['entity_id'] :"),m.Yb(),m.Zb(75,"p",18),m.Sc(76),m.mc(77,"translate"),m.Yb(),m.Zb(78,"h4",17),m.Sc(79,"@entity_type['type'] :"),m.Yb(),m.Zb(80,"p",18),m.Sc(81),m.mc(82,"translate"),m.Yb(),m.Zb(83,"h4",17),m.Sc(84,"@all_entities :"),m.Yb(),m.Zb(85,"p",18),m.Sc(86),m.mc(87,"translate"),m.Yb(),m.Zb(88,"h4",17),m.Sc(89,"@immediate_children['entity_1',..., 'entity_id'] :"),m.Yb(),m.Zb(90,"p",18),m.Sc(91),m.mc(92,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1)),m.Eb(4),m.Tc(m.nc(20,26,"lang.keywordHelp")),m.Eb(4),m.Tc(m.nc(24,28,"lang.keywordHelpDesc_11")),m.Eb(8),m.Tc(m.nc(32,30,"lang.keywordHelpDesc_1")),m.Eb(5),m.Tc(m.nc(37,32,"lang.keywordHelpDesc_12")),m.Eb(5),m.Tc(m.nc(42,34,"lang.keywordHelpDesc_2")),m.Eb(5),m.Tc(m.nc(47,36,"lang.keywordHelpDesc_3")),m.Eb(5),m.Tc(m.nc(52,38,"lang.keywordHelpDesc_13")),m.Eb(5),m.Tc(m.nc(57,40,"lang.keywordHelpDesc_4")),m.Eb(5),m.Tc(m.nc(62,42,"lang.keywordHelpDesc_14")),m.Eb(5),m.Tc(m.nc(67,44,"lang.keywordHelpDesc_5")),m.Eb(5),m.Tc(m.nc(72,46,"lang.keywordHelpDesc_6")),m.Eb(5),m.Tc(m.nc(77,48,"lang.keywordHelpDesc_7")),m.Eb(5),m.Tc(m.nc(82,50,"lang.keywordHelpDesc_8")),m.Eb(5),m.Tc(m.nc(87,52,"lang.keywordHelpDesc_9")),m.Eb(5),m.Tc(m.nc(92,54,"lang.keywordHelpDesc_10")))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.h,Ot.g,Ot.a,I.k,Ot.d,Tt.a,Ot.c,_.a,It.b,et.a,x.w,T.c,k.a,Ie.c,Ie.a,o.J,o.u,o.v,w.c,O.b,o.c,o.o,o.E,o.t,o.w,O.d,w.j,x.s,D.b,o.A,at.a,I.o,Ie.d,An.d,De.a,De.c,De.g,De.h,G.n,G.c,G.i,G.b,G.m,ds,An.a,An.e,G.h,G.a,Pe.a,Fe.d,Fe.e,Fe.b,G.l],pipes:[p.d,U.a],styles:[".basketActionsList[_ngcontent-%COMP%]    .mat-expansion-panel-body{height:400px;overflow:auto}.mat-chip[_ngcontent-%COMP%]{padding:25px!important}textarea.mat-input-element[_ngcontent-%COMP%]{padding:0;margin:0}"]}),t})(),Ns=(()=>{class t{constructor(t,e,i,a,n){this.translate=t,this.http=e,this.notify=i,this.data=a,this.dialogRef=n,this.allEntities=[]}ngOnInit(){this.http.get("../rest/entities").subscribe(t=>{[{id:"ALL_ENTITIES",keyword:"ALL_ENTITIES",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.allEntities")},{id:"ENTITIES_JUST_BELOW",keyword:"ENTITIES_JUST_BELOW",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.immediatelyBelowMyPrimaryEntity")},{id:"ENTITIES_BELOW",keyword:"ENTITIES_BELOW",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.belowAllMyEntities")},{id:"ALL_ENTITIES_BELOW",keyword:"ALL_ENTITIES_BELOW",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.belowMyPrimaryEntity")},{id:"MY_ENTITIES",keyword:"MY_ENTITIES",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.myEntities")},{id:"MY_PRIMARY_ENTITY",keyword:"MY_PRIMARY_ENTITY",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.myPrimaryEntity")},{id:"SAME_LEVEL_ENTITIES",keyword:"SAME_LEVEL_ENTITIES",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.sameLevelMyPrimaryEntity")},{id:"ENTITIES_JUST_UP",keyword:"ENTITIES_JUST_UP",parent:"#",icon:"fa fa-hashtag",allowed:!0,text:this.translate.instant("lang.immediatelySuperiorMyPrimaryEntity")}].forEach(t=>{this.allEntities.push(t)}),t.entities.forEach(t=>{this.allEntities.push(t)})},t=>{this.notify.handleErrors(t)})}initService(){this.allEntities.forEach(t=>{t.state={opened:!1,selected:!1},this.data.action.redirects.forEach(e=>{(t.id===e.keyword&&"ENTITY"===e.redirect_mode||t.id===e.entity_id&&"ENTITY"===e.redirect_mode)&&(t.state={opened:!0,selected:!0})})}),$("#jstree").jstree({checkbox:{three_state:!1},core:{force_text:!0,themes:{name:"proton",responsive:!0},data:this.allEntities},plugins:["checkbox","search"]}),$("#jstree").on("select_node.jstree",(t,e)=>{this.data.action.redirects.push(e.node.original.keyword?{action_id:this.data.action.id,entity_id:"",keyword:e.node.id,redirect_mode:"ENTITY"}:{action_id:this.data.action.id,entity_id:e.node.id,keyword:"",redirect_mode:"ENTITY"})}).on("deselect_node.jstree",(t,e)=>{this.data.action.redirects.forEach(t=>{if(e.node.original.keyword){if(t.keyword===e.node.original.keyword){const e=this.data.action.redirects.indexOf(t);this.data.action.redirects.splice(e,1)}}else if(t.entity_id===e.node.id){const e=this.data.action.redirects.indexOf(t);this.data.action.redirects.splice(e,1)}})}).jstree();let t=!1;$("#jstree_search").keyup((function(){t&&clearTimeout(t),t=setTimeout((function(){const t=$("#jstree_search").val();$("#jstree").jstree(!0).search(t)}),250)}))}initService2(){this.allEntities.forEach(t=>{t.state={opened:!1,selected:!1},this.data.action.redirects.forEach(e=>{(t.id===e.keyword&&"USERS"===e.redirect_mode||t.id===e.entity_id&&"USERS"===e.redirect_mode)&&(t.state={opened:!0,selected:!0})})}),$("#jstree2").jstree({checkbox:{three_state:!1},core:{force_text:!0,themes:{name:"proton",responsive:!0},data:this.allEntities},plugins:["checkbox","search"]}),$("#jstree2").on("select_node.jstree",(t,e)=>{this.data.action.redirects.push(e.node.original.keyword?{action_id:this.data.action.id,entity_id:"",keyword:e.node.id,redirect_mode:"USERS"}:{action_id:this.data.action.id,entity_id:e.node.id,keyword:"",redirect_mode:"USERS"})}).on("deselect_node.jstree",(t,e)=>{this.data.action.redirects.forEach(t=>{if(e.node.original.keyword){if(t.keyword===e.node.original.keyword){const e=this.data.action.redirects.indexOf(t);this.data.action.redirects.splice(e,1)}}else if(t.entity_id===e.node.id){const e=this.data.action.redirects.indexOf(t);this.data.action.redirects.splice(e,1)}})}).jstree();let t=!1;$("#jstree_search2").keyup((function(){t&&clearTimeout(t),t=setTimeout((function(){const t=$("#jstree_search2").val();$("#jstree2").jstree(!0).search(t)}),250)}))}saveSettings(){this.dialogRef.close(this.data)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(js,!0),2&t&&m.Cc(i=m.ic())&&(e.statusInput=i.first)},decls:109,vars:72,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["settingGroupsBasket","ngForm"],[1,"container-fluid"],[1,"col-md-6"],["id","usedInActionPage","name","usedInActionPage","color","primary",3,"ngModel","ngModelChange"],["id","usedInBasketlist","name","usedInBasketlist","color","primary",3,"ngModel","ngModelChange"],[4,"ngIf"],[3,"label"],["matInput","","name","clause","matTextareaAutosize","","matAutosizeMinRows","1",3,"title","placeholder","ngModel","ngModelChange"],["role","list",2,"width","400px","padding","5px"],[2,"font-size","10px"],[2,"border","1px black solid","padding","3px","font-size","10px"],["mat-line","",2,"font-weight","bold","font-size","10px"],["mat-line","",2,"font-size","10px"],[1,"divider-modal"],["mat-raised-button","","type","submit","color","primary",2,"margin","auto",3,"disabled","click"],[3,"opened"],["matInput","","id","jstree_search","name","jstree_search","type","text",3,"placeholder"],["id","jstree"],[3,"opened",4,"ngIf"],["mat-tab-label",""],["matInput","","id","jstree_search2","name","jstree_search2","type","text",3,"placeholder"],["id","jstree2"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h2",1),m.Sc(2),m.mc(3,"translate"),m.Zb(4,"small"),m.Sc(5),m.Yb(),m.Yb(),m.Zb(6,"mat-dialog-content"),m.Zb(7,"form",null,2),m.Zb(9,"div",3),m.Zb(10,"div",4),m.Zb(11,"mat-checkbox",5),m.hc("ngModelChange",(function(t){return e.data.action.used_in_action_page=t})),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Zb(14,"div",4),m.Zb(15,"mat-checkbox",6),m.hc("ngModelChange",(function(t){return e.data.action.used_in_basketlist=t})),m.Sc(16),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"mat-tab-group"),m.Qc(19,Hs,13,8,"mat-tab",7),m.Zb(20,"mat-tab",8),m.mc(21,"translate"),m.Zb(22,"mat-form-field"),m.Zb(23,"textarea",9),m.hc("ngModelChange",(function(t){return e.data.action.where_clause=t})),m.mc(24,"translate"),m.mc(25,"translate"),m.Yb(),m.Yb(),m.Zb(26,"mat-accordion"),m.Zb(27,"mat-expansion-panel"),m.Zb(28,"mat-expansion-panel-header"),m.Zb(29,"mat-panel-title"),m.Sc(30),m.mc(31,"translate"),m.Yb(),m.Yb(),m.Zb(32,"mat-list",10),m.Zb(33,"p",11),m.Sc(34),m.mc(35,"translate"),m.Yb(),m.Zb(36,"div",12),m.Zb(37,"b"),m.Sc(38,"DESTINATION = @my_primary_entity or DESTINATION in (@subentities[@my_primary_entity])"),m.Yb(),m.Yb(),m.Zb(39,"h4",13),m.Sc(40,"@user :"),m.Yb(),m.Zb(41,"p",14),m.Sc(42),m.mc(43,"translate"),m.Yb(),m.Zb(44,"h4",13),m.Sc(45,"@user_id :"),m.Yb(),m.Zb(46,"p",14),m.Sc(47),m.mc(48,"translate"),m.Yb(),m.Zb(49,"h4",13),m.Sc(50,"@email :"),m.Yb(),m.Zb(51,"p",14),m.Sc(52),m.mc(53,"translate"),m.Yb(),m.Zb(54,"h4",13),m.Sc(55,"@my_entities :"),m.Yb(),m.Zb(56,"p",14),m.Sc(57),m.mc(58,"translate"),m.Yb(),m.Zb(59,"h4",13),m.Sc(60,"@my_entities_id :"),m.Yb(),m.Zb(61,"p",14),m.Sc(62),m.mc(63,"translate"),m.Yb(),m.Zb(64,"h4",13),m.Sc(65,"@my_primary_entity :"),m.Yb(),m.Zb(66,"p",14),m.Sc(67),m.mc(68,"translate"),m.Yb(),m.Zb(69,"h4",13),m.Sc(70,"@my_primary_entity_id :"),m.Yb(),m.Zb(71,"p",14),m.Sc(72),m.mc(73,"translate"),m.Yb(),m.Zb(74,"h4",13),m.Sc(75," @subentities[('entity_1',...,'entity_n')] :"),m.Yb(),m.Zb(76,"p",14),m.Sc(77),m.mc(78,"translate"),m.Yb(),m.Zb(79,"h4",13),m.Sc(80,"@parent_entity['entity_id'] :"),m.Yb(),m.Zb(81,"p",14),m.Sc(82),m.mc(83,"translate"),m.Yb(),m.Zb(84,"h4",13),m.Sc(85,"@sisters_entities['entity_id'] : "),m.Yb(),m.Zb(86,"p",14),m.Sc(87),m.mc(88,"translate"),m.Yb(),m.Zb(89,"h4",13),m.Sc(90,"@entity_type['type'] :"),m.Yb(),m.Zb(91,"p",14),m.Sc(92),m.mc(93,"translate"),m.Yb(),m.Zb(94,"h4",13),m.Sc(95,"@all_entities :"),m.Yb(),m.Zb(96,"p",14),m.Sc(97),m.mc(98,"translate"),m.Yb(),m.Zb(99,"h4",13),m.Sc(100," @immediate_children['entity_1',..., 'entity_id'] :"),m.Yb(),m.Zb(101,"p",14),m.Sc(102),m.mc(103,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(104,"span",15),m.Zb(105,"mat-dialog-actions"),m.Zb(106,"button",16),m.hc("click",(function(){return e.saveSettings()})),m.Sc(107),m.mc(108,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Uc("",m.nc(3,28,"lang.actionParameters")," "),m.Eb(3),m.Tc(e.data.action.label_action),m.Eb(6),m.sc("ngModel",e.data.action.used_in_action_page),m.Eb(1),m.Uc(" ",m.nc(13,30,"lang.usedInActionPage"),""),m.Eb(3),m.sc("ngModel",e.data.action.used_in_basketlist),m.Eb(1),m.Uc(" ",m.nc(17,32,"lang.usedInBasketlist"),""),m.Eb(3),m.sc("ngIf","redirect"==e.data.action.keyword),m.Eb(1),m.tc("label",m.nc(21,34,"lang.otherParameters")),m.Eb(3),m.tc("title",m.nc(24,36,"lang.whereClauseAction")),m.tc("placeholder",m.nc(25,38,"lang.whereClauseAction")),m.sc("ngModel",e.data.action.where_clause),m.Eb(7),m.Uc(" ",m.nc(31,40,"lang.keywordHelp")," "),m.Eb(4),m.Tc(m.nc(35,42,"lang.keywordHelpDesc_11")),m.Eb(8),m.Tc(m.nc(43,44,"lang.keywordHelpDesc_1")),m.Eb(5),m.Tc(m.nc(48,46,"lang.keywordHelpDesc_12")),m.Eb(5),m.Tc(m.nc(53,48,"lang.keywordHelpDesc_2")),m.Eb(5),m.Tc(m.nc(58,50,"lang.keywordHelpDesc_3")),m.Eb(5),m.Tc(m.nc(63,52,"lang.keywordHelpDesc_13")),m.Eb(5),m.Tc(m.nc(68,54,"lang.keywordHelpDesc_4")),m.Eb(5),m.Tc(m.nc(73,56,"lang.keywordHelpDesc_14")),m.Eb(5),m.Tc(m.nc(78,58,"lang.keywordHelpDesc_5")),m.Eb(5),m.Tc(m.nc(83,60,"lang.keywordHelpDesc_6")),m.Eb(5),m.Tc(m.nc(88,62,"lang.keywordHelpDesc_7")),m.Eb(5),m.Tc(m.nc(93,64,"lang.keywordHelpDesc_8")),m.Eb(5),m.Tc(m.nc(98,66,"lang.keywordHelpDesc_9")),m.Eb(5),m.Tc(m.nc(103,68,"lang.keywordHelpDesc_10")),m.Eb(4),m.sc("disabled",!e.data.action.used_in_basketlist&&!e.data.action.used_in_action_page),m.Eb(1),m.Tc(m.nc(108,70,"lang.validate")))},directives:[H.i,H.f,o.J,o.u,o.v,Pe.a,o.t,o.w,Ie.c,x.t,Ie.a,w.c,O.b,O.d,o.c,De.a,De.c,De.g,De.h,Ot.a,I.k,H.c,D.b,Ie.d],pipes:[p.d],styles:[".mat-dialog-content[_ngcontent-%COMP%]{height: 65vh;}"]}),t})(),Js=(()=>{class t{constructor(t,e,i,a){this.http=t,this.notify=e,this.data=i,this.dialogRef=a,this.actionAll=[],this.newBasketGroup={}}ngOnInit(){this.http.get("../rest/actions").subscribe(t=>{t.actions.forEach(t=>{t.where_clause="",t.used_in_basketlist=!1,t.default_action_list=!1,t.used_in_action_page=!0,t.statuses=[],t.redirects=[],t.checked=!1,this.actionAll.push(t)})},t=>{this.notify.handleErrors(t)}),this.data.groups.forEach(t=>{this.data.linkedGroups.forEach(e=>{if(t.group_id===e.group_id){const e=this.data.groups.indexOf(t);this.data.groups.splice(e,1)}})})}validateForm(t){0===this.data.linkedGroups.length?(this.actionAll[0].used_in_action_page=!0,this.actionAll[0].default_action_list=!0,this.actionAll[0].used_in_basketlist=!0,this.actionAll[0].checked=!0,this.newBasketGroup.groupActions=this.actionAll):this.newBasketGroup=JSON.parse(JSON.stringify(this.data.linkedGroups[this.data.linkedGroups.length-1])),this.newBasketGroup.basket_id=this.data.basketId,this.newBasketGroup.group_id=t.group_id,this.newBasketGroup.group_desc=t.group_desc,this.dialogRef.close(this.newBasketGroup)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.b),m.Tb(y.a),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:7,vars:4,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title","","color","primary"],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h2",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"mat-nav-list"),m.Qc(6,zs,2,1,"span",2),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.linkGroup")),m.Eb(4),m.sc("ngForOf",e.data.groups))},directives:[H.i,H.f,Ot.h,x.s,x.t,Ot.d],pipes:[p.d],styles:[".mat-dialog-content[_ngcontent-%COMP%]{height: 65vh;}"]}),t})();const Gs=["snav2"],Bs=["adminMenuTemplate"];function Ws(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",14),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",15),m.hc("click",(function(){return m.Hc(t),m.lc().prepareDoctypeAdd("firstLevel")})),m.Zb(5,"mat-icon",16),m.Ub(6,"i",17),m.Ub(7,"i",18),m.Yb(),m.Zb(8,"p",19),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Zb(11,"a",15),m.hc("click",(function(){return m.Hc(t),m.lc().prepareDoctypeAdd("secondLevel")})),m.Zb(12,"mat-icon",16),m.Ub(13,"i",17),m.Ub(14,"i",18),m.Yb(),m.Zb(15,"p",19),m.Sc(16),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Zb(18,"a",15),m.hc("click",(function(){return m.Hc(t),m.lc().prepareDoctypeAdd("doctype")})),m.Zb(19,"mat-icon",16),m.Ub(20,"i",20),m.Ub(21,"i",18),m.Yb(),m.Zb(22,"p",19),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Yb(),m.Yb()}2&t&&(m.Eb(2),m.Tc(m.nc(3,4,"lang.actions")),m.Eb(7),m.Uc(" ",m.nc(10,6,"lang.addFirstLevel")," "),m.Eb(7),m.Uc(" ",m.nc(17,8,"lang.addSecondLevel")," "),m.Eb(7),m.Uc(" ",m.nc(24,10,"lang.addDoctype")," "))}function qs(t,e){1&t&&(m.Zb(0,"div",21),m.Ub(1,"mat-spinner",22),m.Yb())}function Xs(t,e){if(1&t&&(m.Zb(0,"mat-card",23),m.Zb(1,"mat-form-field"),m.Ub(2,"input",24),m.mc(3,"translate"),m.Yb(),m.Ub(4,"div",25),m.Zb(5,"div",26),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.tc("placeholder",m.nc(3,3,"lang.search")),m.Eb(4),m.Vc(" ",t.doctypes.length," ",m.nc(7,5,"lang.documentTypesAlt"),"")}}function Ks(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",31),m.Zb(1,"div",32),m.Zb(2,"mat-form-field"),m.Zb(3,"input",38),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).currentFirstLevel.doctypes_first_level_id=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,4,"lang.id")),m.tc("placeholder",m.nc(5,6,"lang.id")),m.sc("ngModel",t.currentFirstLevel.doctypes_first_level_id)("disabled",!t.creationMode)}}function tc(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",39),m.hc("click",(function(){return m.Hc(t),m.lc(2).removeFirstLevel()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){m.lc();const t=m.Dc(3),e=m.lc();m.sc("disabled",!t.form.valid||e.currentFirstLevel.hasChildren),m.Eb(1),m.Tc(m.nc(2,2,"lang.delete"))}}function ec(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",40),m.hc("click",(function(){return m.Hc(t),m.lc(2).readMode()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.cancel")))}function ic(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",27),m.mc(1,"translate"),m.Zb(2,"form",28,29),m.Qc(4,Ks,6,8,"div",30),m.Zb(5,"div",31),m.Zb(6,"div",32),m.Zb(7,"mat-form-field"),m.Zb(8,"input",33),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentFirstLevel.doctypes_first_level_label=e})),m.mc(9,"translate"),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(11,"div",31),m.Zb(12,"div",34),m.Zb(13,"button",35),m.hc("click",(function(){return m.Hc(t),m.lc().saveFirstLevel()})),m.Sc(14),m.mc(15,"translate"),m.Yb(),m.Qc(16,tc,3,4,"button",36),m.Qc(17,ec,3,3,"button",37),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(3),e=m.lc();m.tc("label",m.nc(1,9,"lang.firstLevelDoctype")),m.Eb(4),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(9,11,"lang.label")),m.tc("placeholder",m.nc(10,13,"lang.label")),m.sc("ngModel",e.currentFirstLevel.doctypes_first_level_label),m.Eb(5),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(15,15,"lang.save")),m.Eb(2),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",e.creationMode)}}function ac(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",31),m.Zb(1,"div",32),m.Zb(2,"mat-form-field"),m.Zb(3,"input",47),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).currentSecondLevel.doctypes_second_level_id=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,4,"lang.id")),m.tc("placeholder",m.nc(5,6,"lang.id")),m.sc("ngModel",t.currentSecondLevel.doctypes_second_level_id)("disabled",!t.creationMode)}}function nc(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.doctypes_first_level_id),m.Eb(1),m.Uc(" ",t.doctypes_first_level_label," ")}}function sc(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",49),m.hc("click",(function(){return m.Hc(t),m.lc(2).removeSecondLevel()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){m.lc();const t=m.Dc(3),e=m.lc();m.sc("disabled",!t.form.valid||e.currentSecondLevel.hasChildren),m.Eb(1),m.Tc(m.nc(2,2,"lang.delete"))}}function cc(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",50),m.hc("click",(function(){return m.Hc(t),m.lc(2).readMode()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.cancel")))}function oc(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",27),m.mc(1,"translate"),m.Zb(2,"form",28,41),m.Qc(4,ac,6,8,"div",30),m.Zb(5,"div",31),m.Zb(6,"div",32),m.Zb(7,"mat-form-field"),m.Zb(8,"input",42),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentSecondLevel.doctypes_second_level_label=e})),m.mc(9,"translate"),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(11,"div",31),m.Zb(12,"div",32),m.Zb(13,"mat-form-field"),m.Zb(14,"mat-select",43),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentSecondLevel.doctypes_first_level_id=e})),m.mc(15,"translate"),m.mc(16,"translate"),m.Qc(17,nc,2,2,"mat-option",44),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"div",31),m.Zb(19,"div",34),m.Zb(20,"button",35),m.hc("click",(function(){return m.Hc(t),m.lc().saveSecondLevel()})),m.Sc(21),m.mc(22,"translate"),m.Yb(),m.Qc(23,sc,3,4,"button",45),m.Qc(24,cc,3,3,"button",46),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(3),e=m.lc();m.tc("label",m.nc(1,13,"lang.secondLevelDoctype")),m.Eb(4),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(9,15,"lang.label")),m.tc("placeholder",m.nc(10,17,"lang.label")),m.sc("ngModel",e.currentSecondLevel.doctypes_second_level_label),m.Eb(6),m.tc("title",m.nc(15,19,"lang.firstLevelAttached")),m.tc("placeholder",m.nc(16,21,"lang.firstLevelAttached")),m.sc("ngModel",e.currentSecondLevel.doctypes_first_level_id),m.Eb(3),m.sc("ngForOf",e.firstLevels),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(22,23,"lang.save")),m.Eb(2),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",e.creationMode)}}function rc(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",31),m.Zb(1,"div",32),m.Zb(2,"mat-form-field"),m.Zb(3,"input",66),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).currentType.type_id=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,4,"lang.id")),m.tc("placeholder",m.nc(5,6,"lang.id")),m.sc("ngModel",t.currentType.type_id)("disabled",!t.creationMode)}}function lc(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.doctypes_second_level_id),m.Eb(1),m.Uc(" ",t.doctypes_second_level_label," ")}}function dc(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function bc(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",67),m.hc("click",(function(){return m.Hc(t),m.lc(2).removeType()})),m.mc(1,"translate"),m.Sc(2),m.mc(3,"translate"),m.Yb()}if(2&t){m.lc();const t=m.Dc(3);m.tc("matTooltip",m.nc(1,3,"lang.toolTipDeleteDoctype")),m.sc("disabled",!t.form.valid),m.Eb(2),m.Tc(m.nc(3,5,"lang.delete"))}}function mc(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",50),m.hc("click",(function(){return m.Hc(t),m.lc(2).readMode()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.cancel")))}function pc(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",27),m.mc(1,"translate"),m.Zb(2,"form",28,51),m.Qc(4,rc,6,8,"div",30),m.Zb(5,"div",31),m.Zb(6,"div",32),m.Zb(7,"mat-form-field"),m.Zb(8,"input",52),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.description=e})),m.mc(9,"translate"),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(11,"div",31),m.Zb(12,"div",32),m.Zb(13,"mat-form-field"),m.Zb(14,"mat-select",53),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.doctypes_second_level_id=e})),m.mc(15,"translate"),m.mc(16,"translate"),m.Qc(17,lc,2,2,"mat-option",44),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"div",31),m.Zb(19,"div",32),m.Zb(20,"mat-form-field"),m.Zb(21,"input",54),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.process_delay=e})),m.mc(22,"translate"),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(24,"div",31),m.Zb(25,"div",32),m.Zb(26,"mat-form-field"),m.Zb(27,"input",55),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.delay1=e})),m.mc(28,"translate"),m.mc(29,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(30,"div",31),m.Zb(31,"div",32),m.Zb(32,"mat-form-field"),m.Zb(33,"input",56),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.delay2=e})),m.mc(34,"translate"),m.mc(35,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(36,"div",31),m.Zb(37,"div",32),m.Zb(38,"mat-form-field"),m.Zb(39,"mat-select",57),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.process_mode=e})),m.mc(40,"translate"),m.mc(41,"translate"),m.Qc(42,dc,2,2,"mat-option",44),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(43,"mat-accordion"),m.Zb(44,"mat-expansion-panel"),m.Zb(45,"mat-expansion-panel-header"),m.Zb(46,"mat-panel-title"),m.Sc(47),m.mc(48,"translate"),m.Yb(),m.Yb(),m.Zb(49,"div",31),m.Zb(50,"div",32),m.Zb(51,"mat-form-field"),m.Zb(52,"mat-select",58),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.retention_final_disposition=e})),m.mc(53,"translate"),m.mc(54,"translate"),m.Ub(55,"mat-option",59),m.Zb(56,"mat-option",60),m.Sc(57),m.mc(58,"translate"),m.Yb(),m.Zb(59,"mat-option",61),m.Sc(60),m.mc(61,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(62,"div",31),m.Zb(63,"div",62),m.Zb(64,"mat-form-field"),m.Zb(65,"input",63),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.retention_rule=e})),m.mc(66,"translate"),m.mc(67,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(68,"div",62),m.Zb(69,"mat-form-field"),m.Zb(70,"input",64),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentType.duration_current_use=e})),m.mc(71,"translate"),m.mc(72,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(73,"div",31),m.Zb(74,"div",34),m.Zb(75,"button",35),m.hc("click",(function(){return m.Hc(t),m.lc().saveType()})),m.Sc(76),m.mc(77,"translate"),m.Yb(),m.Qc(78,bc,4,7,"button",65),m.Qc(79,mc,3,3,"button",46),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(3),e=m.lc();m.tc("label",m.nc(1,38,"lang.doctype")),m.Eb(4),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(9,40,"lang.label")),m.tc("placeholder",m.nc(10,42,"lang.label")),m.sc("ngModel",e.currentType.description),m.Eb(6),m.tc("title",m.nc(15,44,"lang.secondLevelAttached")),m.tc("placeholder",m.nc(16,46,"lang.secondLevelAttached")),m.sc("ngModel",e.currentType.doctypes_second_level_id),m.Eb(3),m.sc("ngForOf",e.secondLevels),m.Eb(4),m.tc("title",m.nc(22,48,"lang.processDelayDay")),m.tc("placeholder",m.nc(23,50,"lang.processDelayDay")),m.sc("ngModel",e.currentType.process_delay),m.Eb(6),m.tc("title",m.nc(28,52,"lang.delay1")),m.tc("placeholder",m.nc(29,54,"lang.delay1")),m.sc("ngModel",e.currentType.delay1),m.Eb(6),m.tc("title",m.nc(34,56,"lang.delay2")),m.tc("placeholder",m.nc(35,58,"lang.delay2")),m.sc("ngModel",e.currentType.delay2),m.Eb(6),m.tc("title",m.nc(40,60,"lang.processMode")),m.tc("placeholder",m.nc(41,62,"lang.processMode")),m.sc("ngModel",e.currentType.process_mode),m.Eb(3),m.sc("ngForOf",e.processModes),m.Eb(5),m.Uc(" ",m.nc(48,64,"lang.archival")," "),m.Eb(5),m.tc("title",m.nc(53,66,"lang.retentionFinalDisposition")),m.tc("placeholder",m.nc(54,68,"lang.retentionFinalDisposition")),m.sc("ngModel",e.currentType.retention_final_disposition),m.Eb(5),m.Tc(m.nc(58,70,"lang.destruction")),m.Eb(3),m.Tc(m.nc(61,72,"lang.conservation")),m.Eb(5),m.tc("title",m.nc(66,74,"lang.retentionRule")),m.tc("placeholder",m.nc(67,76,"lang.retentionRule")),m.sc("ngModel",e.currentType.retention_rule),m.Eb(5),m.tc("title",m.nc(71,78,"lang.durationCurrentUse")),m.tc("placeholder",m.nc(72,80,"lang.durationCurrentUse")),m.sc("ngModel",e.currentType.duration_current_use),m.Eb(5),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(77,82,"lang.save")),m.Eb(2),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",e.creationMode)}}function uc(t,e){if(1&t&&(m.Zb(0,"mat-option",9),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("disabled",t.disabled)("value",t.type_id),m.Eb(1),m.Uc(" ",t.description," ")}}let hc=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.appService=s,this.viewContainerRef=c,this.config={},this.doctypes=[],this.currentType=!1,this.currentSecondLevel=!1,this.currentFirstLevel=!1,this.firstLevels=!1,this.types=!1,this.secondLevels=!1,this.processModes=!1,this.loading=!1,this.creationMode=!1,this.newSecondLevel=!1,this.newFirstLevel=!1,this.displayedColumns=["label","use","mandatory","column"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.documentTypes")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/doctypes").subscribe(t=>{this.doctypes=t.structure,setTimeout(()=>{$("#jstree").jstree({checkbox:{three_state:!1},core:{force_text:!0,themes:{name:"proton",responsive:!0},multiple:!1,data:this.doctypes,check_callback:function(t,e,i,a,n){if("move_node"===t)return void 0===n.ref||(!isNaN(parseFloat(e.id))&&isFinite(e.id)&&0===n.ref.id.indexOf("secondlevel_")||0===e.id.indexOf("secondlevel_")&&0===n.ref.id.indexOf("firstlevel_"))&&!(n.ref.children.indexOf(e.id)>-1)}},dnd:{is_draggable:function(t){return this.secondLevelSelected=t[0].id.replace("secondlevel_",""),!!(!isNaN(parseFloat(this.secondLevelSelected))&&isFinite(this.secondLevelSelected)||!isNaN(parseFloat(t[0].id))&&isFinite(t[0].id))}},plugins:["search","dnd","contextmenu"]});let t=!1;$("#jstree_search").keyup((function(){t&&clearTimeout(t),t=setTimeout((function(){const t=$("#jstree_search").val();$("#jstree").jstree(!0).search(t)}),250)})),$("#jstree").on("select_node.jstree",(t,e)=>{!1===this.sidenavRight.opened&&this.sidenavRight.open(),this.loadDoctype(e,!1)}).on("move_node.jstree",(t,e)=>{this.loadDoctype(e,!0)}).jstree()},0),$("#jstree").jstree("select_node",this.doctypes[0]),this.loading=!1},t=>{this.notify.handleErrors(t)})}loadDoctype(t,e){this.creationMode=!1,t.node.original.type_id?(this.currentFirstLevel=!1,this.currentSecondLevel=!1,this.http.get("../rest/doctypes/types/"+t.node.original.type_id).subscribe(i=>{this.currentType=i.doctype,this.secondLevels=i.secondLevel,this.processModes=["NORMAL","SVA","SVR"],e&&(this.currentType?(this.newSecondLevel=t.parent.replace("secondlevel_",""),!isNaN(parseFloat(this.newSecondLevel))&&isFinite(this.newSecondLevel)?this.currentType.doctypes_second_level_id!==this.newSecondLevel&&(this.currentType.doctypes_second_level_id=this.newSecondLevel,this.saveType()):alert(this.translate.instant("lang.cantMoveDoctype"))):alert(this.translate.instant("lang.noDoctypeSelected")))},t=>{this.notify.error(t.error.errors)})):t.node.original.doctypes_second_level_id?(this.currentFirstLevel=!1,this.currentType=!1,this.http.get("../rest/doctypes/secondLevel/"+t.node.original.doctypes_second_level_id).subscribe(i=>{this.currentSecondLevel=i.secondLevel,this.firstLevels=i.firstLevel,e&&(this.currentSecondLevel?(this.newFirstLevel=t.parent.replace("firstlevel_",""),!isNaN(parseFloat(this.newFirstLevel))&&isFinite(this.newFirstLevel)?this.currentSecondLevel.doctypes_first_level_id!==this.newFirstLevel&&(this.currentSecondLevel.doctypes_first_level_id=this.newFirstLevel,this.saveSecondLevel()):alert(this.translate.instant("lang.cantMoveFirstLevel"))):alert(this.translate.instant("lang.noFirstLevelSelected")))},t=>{this.notify.error(t.error.errors)})):(this.currentSecondLevel=!1,this.currentType=!1,this.http.get("../rest/doctypes/firstLevel/"+t.node.original.doctypes_first_level_id).subscribe(t=>{this.currentFirstLevel=t.firstLevel},t=>{this.notify.error(t.error.errors)}))}resetDatas(){this.currentFirstLevel=!1,this.currentSecondLevel=!1,this.currentType=!1}refreshTree(){$("#jstree").jstree(!0).settings.core.data=this.doctypes,$("#jstree").jstree("refresh")}saveFirstLevel(){this.creationMode?this.http.post("../rest/doctypes/firstLevel",this.currentFirstLevel).subscribe(t=>{this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),this.notify.success(this.translate.instant("lang.firstLevelAdded"))},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/doctypes/firstLevel/"+this.currentFirstLevel.doctypes_first_level_id,this.currentFirstLevel).subscribe(t=>{this.doctypes=t.doctypeTree,this.refreshTree(),this.notify.success(this.translate.instant("lang.firstLevelUpdated"))},t=>{this.notify.error(t.error.errors)})}saveSecondLevel(){this.creationMode?this.http.post("../rest/doctypes/secondLevel",this.currentSecondLevel).subscribe(t=>{this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),this.notify.success(this.translate.instant("lang.secondLevelAdded"))},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/doctypes/secondLevel/"+this.currentSecondLevel.doctypes_second_level_id,this.currentSecondLevel).subscribe(t=>{this.doctypes=t.doctypeTree,this.refreshTree(),this.notify.success(this.translate.instant("lang.secondLevelUpdated"))},t=>{this.notify.error(t.error.errors)})}saveType(){this.creationMode?this.http.post("../rest/doctypes/types",this.currentType).subscribe(t=>{this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),this.notify.success(this.translate.instant("lang.documentTypeAdded"))},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/doctypes/types/"+this.currentType.type_id,this.currentType).subscribe(t=>{this.doctypes=t.doctypeTree,this.refreshTree(),this.notify.success(this.translate.instant("lang.documentTypeUpdated"))},t=>{this.notify.error(t.error.errors)})}readMode(){this.creationMode=!1,$("#jstree").jstree("deselect_all"),$("#jstree").jstree("select_node",this.doctypes[0])}removeFirstLevel(){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+this.currentFirstLevel.doctypes_first_level_label+" \xbb")&&this.http.delete("../rest/doctypes/firstLevel/"+this.currentFirstLevel.doctypes_first_level_id).subscribe(t=>{this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),this.doctypes[0]?$("#jstree").jstree("select_node",this.doctypes[0]):!0===this.sidenavRight.opened&&this.sidenavRight.close(),this.notify.success(this.translate.instant("lang.firstLevelDeleted"))},t=>{this.notify.error(t.error.errors)})}removeSecondLevel(){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+this.currentSecondLevel.doctypes_second_level_label+" \xbb")&&this.http.delete("../rest/doctypes/secondLevel/"+this.currentSecondLevel.doctypes_second_level_id).subscribe(t=>{this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),$("#jstree").jstree("select_node",this.doctypes[0]),this.notify.success(this.translate.instant("lang.secondLevelDeleted"))},t=>{this.notify.error(t.error.errors)})}removeType(){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+this.currentType.description+" \xbb")&&this.http.delete("../rest/doctypes/types/"+this.currentType.type_id).subscribe(t=>{0===t.deleted?(this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),$("#jstree").jstree("select_node",this.doctypes[0]),this.notify.success(this.translate.instant("lang.documentTypeDeleted"))):(this.config={panelClass:"maarch-modal",data:{count:t.deleted,types:t.doctypes}},this.dialogRef=this.dialog.open(fc,this.config),this.dialogRef.afterClosed().subscribe(t=>{t&&this.http.put("../rest/doctypes/types/"+this.currentType.type_id+"/redirect",t).subscribe(t=>{this.resetDatas(),this.readMode(),this.doctypes=t.doctypeTree,this.refreshTree(),$("#jstree").jstree("select_node",this.doctypes[0]),this.notify.success(this.translate.instant("lang.documentTypeDeleted"))},t=>{this.notify.error(t.error.errors)}),this.dialogRef=null}))},t=>{this.notify.error(t.error.errors)})}prepareDoctypeAdd(t){this.currentFirstLevel=!1,this.currentSecondLevel=!1,this.currentType=!1,"firstLevel"===t&&(this.currentFirstLevel={}),"secondLevel"===t&&(this.currentSecondLevel={}),"doctype"===t&&(this.currentType={}),!1===this.sidenavRight.opened&&this.sidenavRight.open(),$("#jstree").jstree("deselect_all"),this.http.get("../rest/administration/doctypes/new").subscribe(t=>{this.firstLevels=t.firstLevel,this.secondLevels=t.secondLevel,this.processModes=["NORMAL","SVA","SVR"]},t=>{this.notify.error(t.error.errors)}),this.creationMode=t}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Gs,!0),m.Oc(Bs,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:22,vars:14,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",1,"col-md-4","col-sm-12",3,"mode","fixedInViewport","opened"],["snav2",""],[3,"label",4,"ngIf"],["mat-subheader",""],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fa-stack","fa-fw",2,"margin-left","-3px","font-size","18px"],[1,"fa","fa-folder"],[1,"fa","fa-plus",2,"position","absolute"],["mat-line",""],[1,"fa","fa-file"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["matInput","","id","jstree_search","name","jstree_search","type","text",3,"placeholder"],["id","jstree"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],[3,"label"],[1,"form-horizontal",2,"overflow","hidden"],["firstLevelForm","ngForm"],["class","form-group",4,"ngIf"],[1,"form-group"],[1,"col-sm-12"],["matInput","","required","","name","doctypes_first_level_label","id","doctypes_first_level_label","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled","click"],["type","button","mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["type","button","mat-raised-button","","color","default",3,"click",4,"ngIf"],["matInput","","required","","name","doctypes_first_level_id","id","doctypes_first_level_id","type","text","maxlength","255",3,"ngModel","title","placeholder","disabled","ngModelChange"],["type","button","mat-raised-button","","color","warn",3,"disabled","click"],["type","button","mat-raised-button","","color","default",3,"click"],["secondLevelForm","ngForm"],["matInput","","required","","name","doctypes_second_level_label","id","doctypes_second_level_label","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["id","doctypes_first_level_id","name","doctypes_first_level_id","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","default",3,"click",4,"ngIf"],["matInput","","required","","name","doctypes_second_level_id","id","doctypes_second_level_id","type","text","maxlength","255",3,"ngModel","title","placeholder","disabled","ngModelChange"],[3,"value"],["mat-raised-button","","color","warn",3,"disabled","click"],["mat-raised-button","","color","default",3,"click"],["typeForm","ngForm"],["matInput","","required","","name","description","id","description","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["id","doctypes_second_level_id","name","doctypes_second_level_id","required","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","required","","name","process_delay","id","process_delay","type","number","pattern","^[0-9]*$",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","required","","name","delay1","id","delay1","type","number","pattern","^[0-9]*$",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","required","","name","delay2","id","delay2","type","number","maxlength","255","pattern","^[0-9]*$",3,"ngModel","title","placeholder","ngModelChange"],["id","process_mode","name","process_mode","required","",3,"title","placeholder","ngModel","ngModelChange"],["id","retention_final_disposition","name","retention_final_disposition",3,"title","placeholder","ngModel","ngModelChange"],["value",""],["value","destruction"],["value","conservation"],[1,"col-sm-6"],["matInput","","name","retention_rule","id","retention_rule","type","text","maxlength","15",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","duration_current_use","id","duration_current_use","type","text","pattern","^[0-9]*$",3,"ngModel","title","placeholder","ngModelChange"],["mat-raised-button","","color","warn",3,"disabled","matTooltip","click",4,"ngIf"],["matInput","","required","","name","type_id","id","type_id","type","text","maxlength","255",3,"ngModel","title","placeholder","disabled","ngModelChange"],["mat-raised-button","","color","warn",3,"disabled","matTooltip","click"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Ws,25,12,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,qs,2,0,"div",9),m.Qc(14,Xs,8,7,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"mat-nav-list"),m.Zb(18,"mat-tab-group"),m.Qc(19,ic,18,17,"mat-tab",13),m.Qc(20,oc,25,25,"mat-tab",13),m.Qc(21,pc,80,84,"mat-tab",13),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!1),m.Eb(4),m.sc("ngIf",e.currentFirstLevel||"firstLevel"==e.creationMode),m.Eb(1),m.sc("ngIf",e.currentSecondLevel||"secondeLevel"==e.creationMode),m.Eb(1),m.sc("ngIf",e.currentType||"doctype"==e.creationMode))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.h,Ie.c,Ot.g,Ot.d,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,Ie.a,o.J,o.u,o.v,o.c,o.E,o.o,o.t,o.w,D.b,at.a,x.s,I.o,o.z,o.A,De.a,De.c,De.g,De.h,It.b],pipes:[p.d],encapsulation:2}),t})(),fc=(()=>{class t{constructor(t,e,i){this.http=t,this.data=e,this.dialogRef=i}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.b),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:25,vars:19,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["changeDoctypeForm","ngForm"],["role","alert",1,"alert-message","alert-message-info"],["color","primary","mat-list-icon","",1,"fa","fa-file","fa-2x"],["mat-line",""],["id","new_type_id","name","new_type_id","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"disabled","value",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn","type","submit",3,"disabled","click"],[3,"disabled","value"]],template:function(t,e){if(1&t&&(m.Zb(0,"div",0),m.Zb(1,"h2",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"form",null,2),m.Zb(7,"div",3),m.Zb(8,"mat-list"),m.Zb(9,"mat-list-item"),m.Ub(10,"mat-icon",4),m.Zb(11,"p",5),m.Zb(12,"b"),m.Sc(13),m.Yb(),m.Sc(14),m.mc(15,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(16,"mat-form-field"),m.Zb(17,"mat-select",6),m.hc("ngModelChange",(function(t){return e.data.new_type_id=t})),m.mc(18,"translate"),m.mc(19,"translate"),m.Qc(20,uc,2,3,"mat-option",7),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(21,"mat-dialog-actions"),m.Zb(22,"button",8),m.hc("click",(function(){return e.dialogRef.close(e.data)})),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(6);m.Eb(2),m.Tc(m.nc(3,9,"lang.documentTypeReplacement")),m.Eb(11),m.Tc(e.data.count),m.Eb(1),m.Uc(" ",m.nc(15,11,"lang.documents")," "),m.Eb(3),m.tc("title",m.nc(18,13,"lang.transferToDoctype")),m.tc("placeholder",m.nc(19,15,"lang.transferToDoctype")),m.sc("ngModel",e.data.new_type_id),m.Eb(3),m.sc("ngForOf",e.data.types),m.Eb(2),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(24,17,"lang.delete"))}},directives:[H.i,H.f,o.J,o.u,o.v,Ot.a,Ot.d,Tt.a,Ot.c,I.k,w.c,at.a,o.E,o.t,o.w,x.s,H.c,D.b,I.o],pipes:[p.d],encapsulation:2}),t})();const gc=["adminMenuTemplate"];function vc(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function yc(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function Cc(t,e){1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.label")))}function Ec(t,e){if(1&t&&(m.Zb(0,"mat-cell",39),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.title," ")}}function Sc(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.description"))}}function Mc(t,e){if(1&t&&(m.Zb(0,"mat-cell",39),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.description," ")}}function Yc(t,e){1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.type")))}function Zc(t,e){if(1&t&&(m.Zb(0,"mat-cell",39),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.typeLabel," ")}}function xc(t,e){1&t&&m.Ub(0,"mat-header-cell",40)}function _c(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",41),m.Zb(1,"button",42),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.delete(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",43),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function wc(t,e){1&t&&m.Ub(0,"mat-header-row")}function Oc(t,e){1&t&&(m.Ub(0,"mat-row",44),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/diffusionModels/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Tc(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,Cc,3,3,"mat-header-cell",26),m.Qc(13,Ec,2,1,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,Sc,3,5,"mat-header-cell",29),m.Qc(16,Mc,2,3,"mat-cell",30),m.Wb(),m.Xb(17,31),m.Qc(18,Yc,3,3,"mat-header-cell",26),m.Qc(19,Zc,2,1,"mat-cell",27),m.Wb(),m.Xb(20,32),m.Qc(21,xc,1,0,"mat-header-cell",33),m.Qc(22,_c,4,3,"mat-cell",34),m.Wb(),m.Qc(23,wc,1,0,"mat-header-row",35),m.Qc(24,Oc,2,4,"mat-row",36),m.Yb(),m.Zb(25,"div",37),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc("",t.listTemplates.length," ",m.nc(27,12,"lang.workflowModels"),"")}}let kc=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.appService=s,this.functions=c,this.adminService=o,this.viewContainerRef=r,this.loading=!1,this.listTemplates=[],this.listTemplatesForAssign=[],this.displayedColumns=["title","description","typeLabel","actions"],this.filterColumns=["title","description","typeLabel"]}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.workflowModels")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,yield this.getListemplates(),this.loadList(),this.loading=!1}))}getListemplates(){return new Promise((t,e)=>{this.http.get("../rest/listTemplates").pipe(Object(l.a)(t=>(t.listTemplates=t.listTemplates.filter(t=>null===t.entityId&&["visaCircuit","opinionCircuit"].indexOf(t.type)>-1).map(t=>Object.assign(Object.assign({},t),{typeLabel:this.translate.instant("lang."+t.type)})),t.listTemplates)),Object(Zt.tap)(e=>{this.listTemplates=e,t(!0)}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()})}loadList(){setTimeout(()=>{this.adminService.setDataSource("admin_listmodels",this.listTemplates,this.sort,this.paginator,this.filterColumns)},0)}delete(t){this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/listTemplates/"+t.id)),Object(Zt.tap)(()=>{this.listTemplates=this.listTemplates.filter(e=>e.id!==t.id),this.notify.success(this.translate.instant("lang.diffusionModelDeleted")),this.loadList()}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(gc,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/diffusionModels/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row",2,"margin","0px"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSortDisableClear","","matSort","",3,"dataSource"],["table",""],["matColumnDef","title"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","description"],["mat-sort-header","","style","flex:2;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:2;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","typeLabel"],["matColumnDef","actions"],["style","flex:1;",4,"matHeaderCellDef"],["style","justify-content: flex-end;flex:1;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],[2,"flex","1"],[2,"justify-content","flex-end","flex","1"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,vc,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,yc,2,0,"div",9),m.Qc(14,Tc,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})();var Ic=i("jbvq"),Dc=i("XkWp");const Uc=["snav2"],Pc=["appVisaWorkflow"],Fc=["appAvisWorkflow"];function Lc(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function jc(t,e){if(1&t&&(m.Zb(0,"mat-option",27),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function Rc(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",28),m.hc("click",(function(){return m.Hc(t),m.lc(2).cancelModification()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.cancel")))}function Qc(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",17),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",12),m.mc(3,"translate"),m.Zb(4,"form",18,19),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(6,"mat-form-field"),m.Zb(7,"mat-select",20),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().diffusionModel.type=e})),m.mc(8,"translate"),m.Qc(9,jc,2,2,"mat-option",21),m.Yb(),m.Yb(),m.Zb(10,"mat-form-field"),m.Zb(11,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().diffusionModel.title=e})),m.mc(12,"translate"),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Zb(14,"mat-form-field"),m.Zb(15,"textarea",23),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().diffusionModel.description=e})),m.mc(16,"translate"),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Zb(18,"div",24),m.Zb(19,"button",25),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Qc(22,Rc,3,3,"button",26),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.tc("label",m.nc(3,14,"lang.informations")),m.Eb(5),m.tc("placeholder",m.nc(8,16,"lang.diffusionType")),m.sc("ngModel",t.diffusionModel.type)("disabled",!t.creationMode),m.Eb(2),m.sc("ngForOf",t.itemTypeList),m.Eb(2),m.tc("title",m.nc(12,18,"lang.label")),m.tc("placeholder",m.nc(13,20,"lang.label")),m.sc("ngModel",t.diffusionModel.title),m.Eb(4),m.tc("title",m.nc(16,22,"lang.description")),m.tc("placeholder",m.nc(17,24,"lang.description")),m.sc("ngModel",t.diffusionModel.description),m.Eb(4),m.sc("disabled",!t.isValidForm()),m.Eb(1),m.Tc(m.nc(21,26,"lang.save")),m.Eb(2),m.sc("ngIf",!t.creationMode)}}function Ac(t,e){1&t&&m.Ub(0,"app-visa-workflow",29,30),2&t&&m.sc("showListModels",!1)("showComment",!1)("adminMode",!0)}function Hc(t,e){1&t&&m.Ub(0,"app-avis-workflow",31,32),2&t&&m.sc("showListModels",!1)("adminMode",!0)}let $c=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.loading=!0,this.diffusionModel={title:"",description:"",type:"opinionCircuit",items:[]},this.diffusionModelClone={},this.itemTypeList=[{id:"visaCircuit",label:this.translate.instant("lang.visaCircuit")},{id:"opinionCircuit",label:this.translate.instant("lang.opinionCircuit")}],this.listDiffModified=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.diffusionModelCreation")),this.creationMode=!0,this.loading=!1):(this.creationMode=!1,yield this.getTemplate(t.id),"visaCircuit"===this.diffusionModel.type?this.loadVisaCircuit():this.loadOpinionCircuit())})))}getTemplate(t){return new Promise((e,i)=>{this.http.get("../rest/listTemplates/"+t).pipe(Object(d.a)(i=>{this.diffusionModel=i.listTemplate,this.diffusionModel.id=t,e(!0)}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(c.a)(!1)))).subscribe()})}loadVisaCircuit(){const t={id:this.diffusionModel.id,type:"entity"};setTimeout(()=>Object(gt.a)(this,void 0,void 0,(function*(){this.appVisaWorkflow.resetWorkflow(),yield this.appVisaWorkflow.addItemToWorkflow(t,!1),this.diffusionModel.items=this.appVisaWorkflow.getWorkflow(),this.diffusionModelClone=JSON.parse(JSON.stringify(this.diffusionModel))})),0)}loadOpinionCircuit(){const t={id:this.diffusionModel.id,type:"entity"};setTimeout(()=>Object(gt.a)(this,void 0,void 0,(function*(){this.appAvisWorkflow.resetWorkflow(),yield this.appAvisWorkflow.addItemToWorkflow(t),this.diffusionModel.items=this.appAvisWorkflow.getWorkflow(),this.diffusionModelClone=JSON.parse(JSON.stringify(this.diffusionModel))})),0)}onSubmit(){this.creationMode?this.createTemplate():this.updateTemplate()}createTemplate(){this.http.post("../rest/listTemplates?admin=true",this.formatCircuit()).pipe(Object(d.a)(()=>{this.router.navigate(["/administration/diffusionModels"]),this.notify.success(this.translate.instant("lang.diffusionModelAdded"))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}updateTemplate(){this.http.put("../rest/listTemplates/"+this.diffusionModel.id,this.formatCircuit()).pipe(Object(d.a)(()=>{this.router.navigate(["/administration/diffusionModels"]),this.notify.success(this.translate.instant("lang.diffusionModelUpdated"))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}formatCircuit(){return"visaCircuit"===this.diffusionModel.type?(this.diffusionModel.items=this.appVisaWorkflow.getWorkflow().map((t,e)=>({id:t.item_id,type:"user",mode:t.requested_signature?"sign":"visa",sequence:e})),this.diffusionModel):(this.diffusionModel.items=this.appAvisWorkflow.getWorkflow().map((t,e)=>({id:t.item_id,type:"user",mode:"avis",sequence:e})),this.diffusionModel)}checkPrivileges(t){var e=!0;return t.forEach(t=>{t.hasPrivilege||(e=!1)}),e}isValidForm(){return"visaCircuit"===this.diffusionModel.type?void 0!==this.appVisaWorkflow&&this.appVisaWorkflow.getWorkflow().length>0&&""!==this.diffusionModel.title&&this.checkPrivileges(this.appVisaWorkflow.getWorkflow()):void 0!==this.appAvisWorkflow&&this.appAvisWorkflow.getWorkflow().length>0&&""!==this.diffusionModel.title&&this.checkPrivileges(this.appAvisWorkflow.getWorkflow())}cancelModification(){this.diffusionModel=JSON.parse(JSON.stringify(this.diffusionModelClone)),"visaCircuit"===this.diffusionModel.type?this.loadVisaCircuit():this.loadOpinionCircuit()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Uc,!0),m.ad(Pc,!0),m.ad(Fc,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.appVisaWorkflow=i.first),m.Cc(i=m.ic())&&(e.appAvisWorkflow=i.first))},decls:21,vars:16,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",1,"col-md-4","col-xs-11",3,"mode","fixedInViewport","opened"],["snav2",""],[3,"label"],[3,"showListModels","showComment","adminMode",4,"ngIf"],[3,"showListModels","adminMode",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"ngSubmit"],["diffusionModelForm","ngForm"],["id","type","name","type",3,"placeholder","ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","title","maxlength","255","required","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","name","description","matTextareaAutosize","","matAutosizeMinRows","1","matAutosizeMaxRows","5","maxlength","255",3,"title","placeholder","ngModel","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled"],["mat-raised-button","","type","button","color","default",3,"click",4,"ngIf"],[3,"value"],["mat-raised-button","","type","button","color","default",3,"click"],[3,"showListModels","showComment","adminMode"],["appVisaWorkflow",""],[3,"showListModels","adminMode"],["appAvisWorkflow",""]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,Lc,2,0,"div",8),m.Qc(12,Qc,23,28,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Zb(15,"mat-nav-list"),m.Zb(16,"mat-tab-group"),m.Zb(17,"mat-tab",12),m.mc(18,"translate"),m.Qc(19,Ac,2,3,"app-visa-workflow",13),m.Qc(20,Hc,2,2,"app-avis-workflow",14),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()),m.Eb(4),m.tc("label",m.nc(18,14,"lang."+e.diffusionModel.type)),m.Eb(2),m.sc("ngIf","visaCircuit"===e.diffusionModel.type),m.Eb(1),m.sc("ngIf","opinionCircuit"===e.diffusionModel.type))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.h,Ie.c,Ie.a,T.c,k.a,o.J,o.u,o.v,w.c,at.a,o.t,o.w,x.s,O.b,o.c,o.o,o.E,O.d,D.b,I.o,Ic.a,Dc.a],pipes:[p.d],styles:[".mat-list-item[draggable=false][_ngcontent-%COMP%]:hover{background:inherit}.mat-list-item[draggable=false][_ngcontent-%COMP%]{cursor:not-allowed!important}.mat-list-item[draggable=true][_ngcontent-%COMP%]{cursor:pointer}.mat-list-item[draggable=true][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:move}.primaryColor[_ngcontent-%COMP%]{color:#135f7f}.redColor[_ngcontent-%COMP%]{color:#e4342b}"]}),t})();const zc=["listFilter"];function Vc(t,e){1&t&&(m.Zb(0,"div",13),m.Ub(1,"mat-spinner"),m.Yb())}function Nc(t,e){if(1&t&&(m.Zb(0,"mat-option",14),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function Jc(t,e){if(1&t&&(m.Zb(0,"mat-option",14),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function Gc(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",15),m.Zb(1,"mat-form-field",5),m.Zb(2,"mat-label"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"mat-select",16),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().exportModel.delimiter=e})),m.mc(6,"translate"),m.Qc(7,Jc,2,2,"mat-option",7),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(3),m.Tc(m.nc(4,5,"lang.delimiter")),m.Eb(2),m.tc("placeholder",m.nc(6,7,"lang.delimiter")),m.sc("ngModel",t.exportModel.delimiter)("disabled","csv"!=t.exportModel.format),m.Eb(2),m.sc("ngForOf",t.delimiters)}}let Bc=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.notify=i,this.data=a,this.localStorage=n,this.headerService=s,this.loading=!1,this.loadingExport=!1,this.delimiters=[";",",","TAB"],this.formats=["csv"],this.exportModel={delimiter:";",format:"csv"}}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){this.setConfiguration()}))}exportData(){this.localStorage.save("exportEntities_"+this.headerService.user.id,JSON.stringify(this.exportModel)),this.loadingExport=!0,this.http.put("../rest/entities/export",this.exportModel,{responseType:"blob"}).pipe(Object(d.a)(t=>{if("text/html"!==t.type){const e=document.createElement("a");let i,a,n,s;e.href=window.URL.createObjectURL(t),i=new Date,a=i.getDate(),n=i.getMonth()+1,s=i.getFullYear(),a<10&&(a="0"+a),n<10&&(n="0"+n),i=a+"-"+n+"-"+s,e.setAttribute("download","export_entities_maarch_"+i+"."+this.exportModel.format.toLowerCase()),document.body.appendChild(e),e.click()}else alert(this.translate.instant("lang.tooMuchDatas"))}),Object(vt.a)(()=>this.loadingExport=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}setConfiguration(){null!==this.localStorage.get("exportEntitiesFields_"+this.headerService.user.id)&&(this.exportModel.delimiter=JSON.parse(this.localStorage.get("exportEntitiesFields_"+this.headerService.user.id)).delimiter)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.a),m.Tb(K.a),m.Tb(h.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(zc,!0),2&t&&m.Cc(i=m.ic())&&(e.listFilter=i.first)},decls:24,vars:23,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["mat-dialog-content",""],["class","loader",4,"ngIf"],[1,"row"],["appearance","outline"],[3,"placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","col-md-9",4,"ngIf"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"click"],["mat-raised-button","","mat-button","",3,"mat-dialog-close"],[1,"loader"],[3,"value"],[1,"col-md-9"],[3,"placeholder","ngModel","disabled","ngModelChange"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",2),m.Qc(5,Vc,2,0,"div",3),m.Zb(6,"div",4),m.Zb(7,"div"),m.Zb(8,"mat-form-field",5),m.Zb(9,"mat-label"),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Zb(12,"mat-select",6),m.hc("ngModelChange",(function(t){return e.exportModel.format=t})),m.mc(13,"translate"),m.Qc(14,Nc,2,2,"mat-option",7),m.Yb(),m.Yb(),m.Yb(),m.Qc(15,Gc,8,9,"div",8),m.Yb(),m.Yb(),m.Ub(16,"span",9),m.Zb(17,"div",10),m.Zb(18,"button",11),m.hc("click",(function(){return e.exportData()})),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"button",12),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,13,"lang.exportDatas")),m.Eb(3),m.sc("ngIf",e.loadingExport),m.Eb(2),m.Jb("col-md-12","csv"!=e.exportModel.format)("col-md-3","csv"==e.exportModel.format),m.Eb(3),m.Tc(m.nc(11,15,"lang.format")),m.Eb(2),m.tc("placeholder",m.nc(13,17,"lang.format")),m.sc("ngModel",e.exportModel.format),m.Eb(2),m.sc("ngForOf",e.formats),m.Eb(1),m.sc("ngIf","csv"==e.exportModel.format),m.Eb(4),m.Tc(m.nc(20,19,"lang.toExport")),m.Eb(3),m.Tc(m.nc(23,21,"lang.cancel")))},directives:[H.i,H.f,x.t,w.c,w.g,at.a,o.t,o.w,x.s,H.c,D.b,H.d,T.c,I.o],pipes:[p.d],styles:[".mat-dialog-container{position:relative}.mat-dialog-content[_ngcontent-%COMP%]{min-height:150px;padding-bottom:10px;overflow-x:hidden}.actions[_ngcontent-%COMP%], .loader[_ngcontent-%COMP%]{justify-content:center}.loader[_ngcontent-%COMP%]{position:absolute;display:flex;width:100%;left:0;top:0;height:100%;background:hsla(0,0%,100%,.6);z-index:1;align-items:center}"]}),t})();var Wc=i("y9tK");const qc=["snav2"],Xc=["adminMenuTemplate"],Kc=["paginatorUsers"],to=["paginatorTemplates"],eo=["tableUsers"],io=["tableTemplates"],ao=["appDiffusionsList"],no=["appVisaWorkflow"],so=["appAvisWorkflow"];function co(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",47),m.hc("click",(function(){m.Hc(t);const e=m.lc(2);return m.Dc(16).open(),e.prepareEntityAdd()})),m.Ub(1,"mat-icon",50),m.Zb(2,"p",49),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.add")," "))}const oo=function(t){return{opacity:t}};function ro(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",52),m.Zb(1,"mat-icon",53),m.Zb(2,"mat-slide-toggle",54),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).toggleRole(e),!1})),m.Yb(),m.Yb(),m.Zb(3,"p",55),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).toggleRole(e),!1})),m.Sc(4),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(2),m.sc("checked",t.available),m.Eb(1),m.sc("ngStyle",m.zc(3,oo,t.available?"":"0.5")),m.Eb(1),m.Uc(" ",t.label," ")}}function lo(t,e){if(1&t&&(m.Xb(0),m.Qc(1,ro,5,5,"a",51),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","dest"!=t.id&&"cc"!=t.id)}}function bo(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",45),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Qc(4,co,5,3,"a",46),m.Zb(5,"a",47),m.hc("click",(function(){return m.Hc(t),m.lc().openExportModal()})),m.Ub(6,"mat-icon",48),m.Zb(7,"p",49),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Ub(10,"mat-divider"),m.Zb(11,"mat-nav-list"),m.Zb(12,"h3",45),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Qc(15,lo,2,1,"ng-container",21),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,5,"lang.actions")),m.Eb(2),m.sc("ngIf",!t.creationMode),m.Eb(4),m.Uc(" ",m.nc(9,7,"lang.toExport")," "),m.Eb(5),m.Tc(m.nc(14,9,"lang.additionalRoles")),m.Eb(2),m.sc("ngForOf",t.listTemplateRoles)}}function mo(t,e){1&t&&(m.Zb(0,"div",56),m.Ub(1,"mat-spinner",57),m.Yb())}function po(t,e){1&t&&(m.Zb(0,"mat-hint"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.entityTreeInfo")))}function uo(t,e){1&t&&(m.Zb(0,"mat-hint"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.entityTreeInfoCreation")))}function ho(t,e){if(1&t&&(m.Zb(0,"mat-card",58),m.Zb(1,"mat-form-field"),m.Ub(2,"input",59),m.mc(3,"translate"),m.Qc(4,po,3,3,"mat-hint",60),m.Qc(5,uo,3,3,"mat-hint",60),m.Yb(),m.Ub(6,"div",61),m.Zb(7,"div",62),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.tc("placeholder",m.nc(3,5,"lang.searchEntities")),m.Eb(2),m.sc("ngIf",!t.creationMode),m.Eb(1),m.sc("ngIf",t.creationMode),m.Eb(3),m.Vc(" ",t.entities.length," ",m.nc(9,7,"lang.entities"),"")}}function fo(t,e){if(1&t&&(m.Zb(0,"mat-option",64),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.entity_id),m.Eb(1),m.Uc(" ",t.entity_label," ")}}function go(t,e){if(1&t&&(m.Xb(0),m.Qc(1,fo,2,2,"mat-option",63),m.Wb()),2&t){const t=e.$implicit,i=m.lc();m.Eb(1),m.sc("ngIf",!t.state.disabled&&t.entity_id!=i.currentEntity.entity_id||i.currentEntity.parent_entity_id==t.entity_id)}}function vo(t,e){if(1&t&&(m.Zb(0,"mat-option",64),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function yo(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",17),m.Zb(2,"mat-form-field"),m.Zb(3,"input",65),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().currentEntity.id=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(3),m.tc("title",m.nc(4,3,"lang.technicalId")),m.tc("placeholder",m.nc(5,5,"lang.technicalId")),m.sc("ngModel",t.currentEntity.id)}}function Co(t,e){1&t&&(m.Ub(0,"input",69),m.mc(1,"translate"),m.mc(2,"translate")),2&t&&(m.tc("title",m.nc(1,2,"lang.siretCode")),m.tc("placeholder",m.nc(2,4,"lang.siretCode")))}function Eo(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",70),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).currentEntity.business_id=e})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("title",m.nc(1,3,"lang.siretCode")),m.tc("placeholder",m.nc(2,5,"lang.siretCode")),m.sc("ngModel",t.currentEntity.business_id)}}function So(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",71),m.hc("click",(function(){return m.Hc(t),m.lc(2).addEntityToAnnuary()})),m.Ub(1,"mat-icon",72),m.Yb()}}function Mo(t,e){if(1&t&&(m.Zb(0,"div",16),m.Zb(1,"div",17),m.Zb(2,"mat-form-field"),m.Qc(3,Co,3,6,"input",66),m.Qc(4,Eo,3,7,"input",67),m.Qc(5,So,2,0,"button",68),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(3),m.sc("ngIf",!t.currentEntity.canSynchronizeSiret),m.Eb(1),m.sc("ngIf",t.currentEntity.canSynchronizeSiret),m.Eb(1),m.sc("ngIf",t.currentEntity.canSynchronizeSiret)}}function Yo(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",73),m.hc("click",(function(){return m.Hc(t),m.lc().removeEntity()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(),e=m.Dc(21);m.sc("disabled",!e.form.valid||t.currentEntity.hasChildren),m.Eb(1),m.Tc(m.nc(2,2,"lang.delete"))}}function Zo(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",74),m.hc("click",(function(){return m.Hc(t),m.lc().readMode()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.cancel")))}function xo(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",81),m.hc("click",(function(){return m.Hc(t),m.lc(3).deleteDiffList()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.delete")))}function _o(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",40),m.Zb(2,"button",41),m.hc("click",(function(){return m.Hc(t),m.lc(2).saveDiffList()})),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"button",79),m.hc("click",(function(){m.Hc(t),m.lc();const e=m.Dc(5),i=m.lc();return e.loadListModel(i.currentEntity.id)})),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Qc(8,xo,3,3,"button",80),m.Yb(),m.Yb()}if(2&t){m.lc();const t=m.Dc(5),e=m.lc();m.Eb(2),m.sc("disabled",t.hasEmptyDest()||!t.isModified()),m.Eb(1),m.Tc(m.nc(4,5,"lang.save")),m.Eb(2),m.sc("disabled",!t.isModified()),m.Eb(1),m.Tc(m.nc(7,7,"lang.cancel")),m.Eb(2),m.sc("ngIf",!t.isEmptyList()&&e.currentEntity.listTemplate.id)}}function wo(t,e){if(1&t&&(m.Zb(0,"mat-tab",13),m.mc(1,"translate"),m.Zb(2,"div",75),m.Zb(3,"div",76),m.Ub(4,"app-diffusions-list",77,78),m.Yb(),m.Qc(6,_o,9,9,"div",24),m.Yb(),m.Yb()),2&t){const t=m.lc();m.tc("label",m.nc(1,4,"lang.diffusionList")),m.Eb(4),m.sc("adminMode",!0)("target","redirect"),m.Eb(2),m.sc("ngIf",t.currentEntity.entity_id)}}function Oo(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",40),m.Zb(2,"button",41),m.hc("click",(function(){return m.Hc(t),m.lc(2).saveDiffListVisa()})),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"button",79),m.hc("click",(function(){m.Hc(t),m.lc();const e=m.Dc(5),i=m.lc();return e.loadListModel(i.currentEntity.id)})),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){m.lc();const t=m.Dc(5);m.Eb(2),m.sc("disabled",!t.isModified()),m.Eb(1),m.Tc(m.nc(4,4,"lang.save")),m.Eb(2),m.sc("disabled",!t.isModified()),m.Eb(1),m.Tc(m.nc(7,6,"lang.cancel"))}}function To(t,e){if(1&t&&(m.Zb(0,"mat-tab",13),m.mc(1,"translate"),m.Zb(2,"div",82),m.Zb(3,"div",76),m.Ub(4,"app-visa-workflow",83,84),m.Yb(),m.Qc(6,Oo,8,8,"div",24),m.Yb(),m.Yb()),2&t){const t=m.lc();m.tc("label",m.nc(1,5,"lang.visaWorkflow")),m.Eb(4),m.sc("adminMode",!0)("showListModels",!1)("showComment",!1),m.Eb(2),m.sc("ngIf",t.currentEntity.entity_id)}}function ko(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",40),m.Zb(2,"button",41),m.hc("click",(function(){return m.Hc(t),m.lc(2).saveDiffListOpinion()})),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"button",79),m.hc("click",(function(){m.Hc(t),m.lc();const e=m.Dc(5),i=m.lc();return e.loadListModel(i.currentEntity.id)})),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){m.lc();const t=m.Dc(5);m.Eb(2),m.sc("disabled",!t.isModified()),m.Eb(1),m.Tc(m.nc(4,4,"lang.save")),m.Eb(2),m.sc("disabled",!t.isModified()),m.Eb(1),m.Tc(m.nc(7,6,"lang.cancel"))}}function Io(t,e){if(1&t&&(m.Zb(0,"mat-tab",13),m.mc(1,"translate"),m.Zb(2,"div",85),m.Zb(3,"div",76),m.Ub(4,"app-avis-workflow",86,87),m.Yb(),m.Qc(6,ko,8,8,"div",24),m.Yb(),m.Yb()),2&t){const t=m.lc();m.tc("label",m.nc(1,4,"lang.avis")),m.Eb(4),m.sc("adminMode",!0)("showListModels",!1),m.Eb(2),m.sc("ngIf",t.currentEntity.entity_id)}}const Do=function(){return["/rest/autocomplete/users/administration"]};function Uo(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",101),m.Zb(1,"plugin-autocomplete",102),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc(2).linkUser(e)})),m.Yb(),m.Ub(2,"hr"),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.sc("labelPlaceholder",t.translate.instant("lang.linkUser"))("labelList",t.translate.instant("lang.availableUsers"))("routeDatas",m.yc(5,Do))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay")}}function Po(t,e){1&t&&(m.Zb(0,"mat-header-cell",103),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.firstname")))}function Fo(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.firstname," ")}}function Lo(t,e){1&t&&(m.Zb(0,"mat-header-cell",103),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.lastname")))}function jo(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.lastname," ")}}function Ro(t,e){1&t&&m.Ub(0,"mat-header-row")}function Qo(t,e){1&t&&(m.Ub(0,"mat-row",104),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/users/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Ao(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",13),m.mc(1,"translate"),m.Zb(2,"div",75),m.Qc(3,Uo,3,6,"div",88),m.Zb(4,"div",89),m.Zb(5,"mat-form-field"),m.Zb(6,"input",90),m.hc("keyup",(function(e){return m.Hc(t),m.lc().applyFilterUsers(e.target.value)})),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(8,"div",89),m.Ub(9,"mat-paginator",91,92),m.Yb(),m.Yb(),m.Zb(11,"mat-table",93,94),m.Xb(13,95),m.Qc(14,Po,3,3,"mat-header-cell",96),m.Qc(15,Fo,2,1,"mat-cell",97),m.Wb(),m.Xb(16,98),m.Qc(17,Lo,3,3,"mat-header-cell",96),m.Qc(18,jo,2,1,"mat-cell",97),m.Wb(),m.Qc(19,Ro,1,0,"mat-header-row",99),m.Qc(20,Qo,2,4,"mat-row",100),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.tc("label",m.nc(1,9,"lang.users")),m.Eb(3),m.sc("ngIf",t.currentEntity.canAdminUsers),m.Eb(3),m.tc("placeholder",m.nc(7,11,"lang.filterBy")),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.dataSourceUsers),m.Eb(8),m.sc("matHeaderRowDef",t.displayedColumnsUsers),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumnsUsers)}}function Ho(t,e){1&t&&(m.Zb(0,"mat-header-cell",115),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.templateName")," "))}function $o(t,e){if(1&t&&(m.Zb(0,"mat-cell",116),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.tc("matTooltip",t.template_comment),m.Eb(1),m.Uc(" ",t.template_label," ")}}function zo(t,e){1&t&&(m.Zb(0,"mat-header-cell",117),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.templateTarget")," "))}function Vo(t,e){if(1&t&&(m.Zb(0,"mat-cell",118),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",m.nc(2,1,"lang."+t.template_target)," ")}}function No(t,e){1&t&&m.Ub(0,"mat-header-row")}const Jo=function(t){return{cursor:t}};function Go(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-row",119),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).showTemplate(i.template_id)})),m.Yb()}if(2&t){const t=m.lc(2);m.sc("ngStyle",m.zc(1,Jo,t.currentEntity.canAdminTemplates?"pointer":"position"))}}function Bo(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",13),m.mc(1,"translate"),m.Zb(2,"div",75),m.Zb(3,"div",89),m.Zb(4,"mat-form-field"),m.Zb(5,"input",90),m.hc("keyup",(function(e){return m.Hc(t),m.lc().applyFilterTemplates(e.target.value)})),m.mc(6,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(7,"div",89),m.Ub(8,"mat-paginator",91,105),m.Yb(),m.Yb(),m.Zb(10,"mat-table",106,107),m.Xb(12,108),m.Qc(13,Ho,3,3,"mat-header-cell",109),m.Qc(14,$o,2,2,"mat-cell",110),m.Wb(),m.Xb(15,111),m.Qc(16,zo,3,3,"mat-header-cell",112),m.Qc(17,Vo,3,3,"mat-cell",113),m.Wb(),m.Qc(18,No,1,0,"mat-header-row",99),m.Qc(19,Go,1,3,"mat-row",114),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.tc("label",m.nc(1,8,"lang.templates")),m.Eb(5),m.tc("placeholder",m.nc(6,10,"lang.filterBy")),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.dataSourceTemplates),m.Eb(8),m.sc("matHeaderRowDef",t.displayedColumnsTemplates),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumnsTemplates)}}function Wo(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Ub(1,"mat-icon",7),m.Zb(2,"p",8),m.Zb(3,"b"),m.Sc(4),m.Yb(),m.Sc(5),m.mc(6,"translate"),m.Zb(7,"b"),m.Sc(8),m.Yb(),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.Tc(t.data.entity.entity_label),m.Eb(1),m.Uc(" ",m.nc(6,4,"lang.isDestTo")," "),m.Eb(3),m.Tc(t.data.entity.documents),m.Eb(1),m.Uc(" ",m.nc(10,6,"lang.documents"),"")}}function qo(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Ub(1,"mat-icon",9),m.Zb(2,"p",8),m.Zb(3,"b"),m.Sc(4),m.Yb(),m.Sc(5),m.mc(6,"translate"),m.Zb(7,"b"),m.Sc(8),m.Yb(),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.Tc(t.data.entity.entity_label),m.Eb(1),m.Uc(" ",m.nc(6,4,"lang.isCopyTo")," "),m.Eb(3),m.Tc(t.data.entity.instances),m.Eb(1),m.Uc(" ",m.nc(10,6,"lang.documents"),"")}}function Xo(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Ub(1,"mat-icon",10),m.Zb(2,"p",8),m.Zb(3,"b"),m.Sc(4),m.Yb(),m.Sc(5),m.mc(6,"lowercase"),m.mc(7,"translate"),m.Zb(8,"b"),m.Sc(9),m.Yb(),m.Sc(10),m.mc(11,"lowercase"),m.mc(12,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.Tc(t.data.entity.entity_label),m.Eb(1),m.Uc(" ",m.nc(6,4,m.nc(7,6,"lang.isLinkedTo"))," "),m.Eb(4),m.Tc(t.data.entity.users.length),m.Eb(1),m.Uc(" ",m.nc(11,8,m.nc(12,10,"lang.usersAlt")),"")}}function Ko(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Ub(1,"mat-icon",11),m.Zb(2,"p",8),m.Zb(3,"b"),m.Sc(4),m.Yb(),m.Sc(5),m.mc(6,"lowercase"),m.mc(7,"translate"),m.Zb(8,"b"),m.Sc(9),m.Yb(),m.Sc(10),m.mc(11,"lowercase"),m.mc(12,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.Tc(t.data.entity.entity_label),m.Eb(1),m.Uc(" ",m.nc(6,4,m.nc(7,6,"lang.isLinkedTo"))," "),m.Eb(4),m.Tc(t.data.entity.templates.length),m.Eb(1),m.Uc(" ",m.nc(11,8,m.nc(12,10,"lang.templates")),"")}}const tr=function(){return["/rest/autocomplete/entities"]};let er=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.router=s,this.appService=c,this.functions=o,this.viewContainerRef=r,this.loading=!1,this.entities=[],this.listTemplateRoles=[],this.entityTypeList=[],this.currentEntity={},this.isDraggable=!0,this.newEntity=!1,this.creationMode=!1,this.visaCircuitModified=!1,this.opinionCircuitModified=!1,this.config={},this.dataSourceUsers=new G.o(this.currentEntity.users),this.dataSourceTemplates=new G.o(this.currentEntity.templates),this.displayedColumnsUsers=["firstname","lastname"],this.displayedColumnsTemplates=["template_label","template_target"]}applyFilterUsers(t){t=(t=t.trim()).toLowerCase(),this.dataSourceUsers.filter=t}applyFilterTemplates(t){t=(t=t.trim()).toLowerCase(),this.dataSourceTemplates.filter=t}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.entities")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,yield this.getEntityTypes(),yield this.getRoles(),yield this.getEntities(),this.loading=!1,this.initEntitiesTree()}))}initEntitiesTree(){setTimeout(()=>{$("#jstree").jstree({checkbox:{deselect_all:!0,three_state:!1},core:{force_text:!0,themes:{name:"proton",responsive:!0},multiple:!1,data:this.entities,check_callback:function(t,e,i,a,n){if("move_node"===t)return"#"!==i.id&&!!i.original.allowed}},dnd:{is_draggable:function(t){let e=0;const i=t.length;for(;e<i;e++)if(!t[e].original.allowed)return!1;return!0}},plugins:["checkbox","search","dnd","sort"]}),$("#jstree").jstree("select_node",this.entities[0]);let t=!1;$("#jstree_search").keyup((function(){t&&clearTimeout(t),t=setTimeout((function(){const t=$("#jstree_search").val();$("#jstree").jstree(!0).search(t)}),250)})),$("#jstree").on("select_node.jstree",(t,e)=>{!1===this.sidenavRight.opened&&this.sidenavRight.open(),!0===this.creationMode?this.currentEntity.parent_entity_id=e.node.id:!0===this.newEntity?(this.loadEntity(this.currentEntity.entity_id),this.newEntity=!1):this.loadEntity(e.node.id)}).on("deselect_node.jstree",(t,e)=>{this.sidenavRight.close()}).on("move_node.jstree",(t,e)=>{this.currentEntity.parent_entity_id!==this.currentEntity.entity_id&&(this.currentEntity.parent_entity_id=e.parent),this.moveEntity()}).jstree(),$(document).on("dnd_start.vakata",(t,e)=>{$("#jstree").jstree("deselect_all"),$("#jstree").jstree("select_node",e.data.nodes[0])})},0)}getEntityTypes(){return new Promise((t,e)=>{this.http.get("../rest/entityTypes").pipe(Object(d.a)(e=>{this.entityTypeList=e.types,t(!0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}getRoles(){return new Promise((t,e)=>{this.http.get("../rest/listTemplates/types/entity_id/roles").pipe(Object(d.a)(e=>{this.listTemplateRoles=e.roles,t(!0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}getEntities(){return new Promise((t,e)=>{this.http.get("../rest/entities").pipe(Object(d.a)(e=>{this.entities=e.entities,t(!0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}loadEntity(t){this.visaCircuitModified=!1,this.opinionCircuitModified=!1,this.http.get("../rest/entities/"+t+"/details").subscribe(t=>{this.currentEntity=t.entity,this.appDiffusionsList.loadListModel(this.currentEntity.id),this.appVisaWorkflow.loadListModel(this.currentEntity.id),this.appAvisWorkflow.loadListModel(this.currentEntity.id),this.idVisaCircuit=this.currentEntity.visaCircuit?this.currentEntity.visaCircuit.id:null,this.idOpinionCircuit=this.currentEntity.opinionCircuit?this.currentEntity.opinionCircuit.id:null,this.dataSourceUsers=new G.o(this.currentEntity.users),this.dataSourceUsers.paginator=this.paginatorUsers,this.dataSourceUsers.sort=this.sortUsers,this.dataSourceTemplates=new G.o(this.currentEntity.templates),this.dataSourceTemplates.paginator=this.paginatorTemplates,this.dataSourceTemplates.sort=this.sortTemplates,this.currentEntity.listTemplate.items||(this.currentEntity.listTemplate.items=[]),this.listTemplateRoles.forEach(t=>{t.available&&!this.currentEntity.listTemplate.items[t.id]&&(this.currentEntity.listTemplate.items[t.id]=[])})},t=>{this.notify.error(t.error.errors)})}addElemListModelVisa(t){this.visaCircuitModified=!0;const e={id:t.id,type:"user",mode:"sign",idToDisplay:t.idToDisplay,descriptionToDisplay:t.otherInfo};this.currentEntity.visaCircuit.items||(this.currentEntity.visaCircuit.items=[]),this.currentEntity.visaCircuit.items.push(e),this.currentEntity.visaCircuit.items.length>1&&(this.currentEntity.visaCircuit.items[this.currentEntity.visaCircuit.items.length-2].mode="visa")}addElemListModelOpinion(t){this.opinionCircuitModified=!0;const e={id:t.id,type:"user",mode:"avis",idToDisplay:t.idToDisplay,descriptionToDisplay:t.otherInfo};this.currentEntity.opinionCircuit.items||(this.currentEntity.opinionCircuit.items=[]),this.currentEntity.opinionCircuit.items.push(e)}saveEntity(){"#"===this.currentEntity.parent_entity_id&&(this.currentEntity.parent_entity_id="");let t=!0;""===this.currentEntity.parent_entity_id&&(t=confirm(this.translate.instant("lang.entityWithoutParentMessage"))),t&&(this.creationMode?this.http.post("../rest/entities",this.currentEntity).subscribe(t=>{this.currentEntity.listTemplate=[],this.entities=t.entities,this.creationMode=!1,this.newEntity=!0,$("#jstree").jstree(!0).settings.core.data=this.entities,$("#jstree").jstree(!0).refresh(),$("#jstree").on("refresh.jstree",t=>{$("#jstree").jstree("deselect_all"),$("#jstree").jstree("select_node",this.currentEntity.entity_id)}),this.notify.success(this.translate.instant("lang.entityAdded"))},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/entities/"+this.currentEntity.entity_id,this.currentEntity).subscribe(t=>{this.entities=t.entities,$("#jstree").jstree(!0).settings.core.data=this.entities,$("#jstree").jstree("refresh"),this.notify.success(this.translate.instant("lang.entityUpdated"))},t=>{this.notify.error(t.error.errors)}))}moveEntity(){this.http.put("../rest/entities/"+this.currentEntity.entity_id,this.currentEntity).subscribe(()=>{this.notify.success(this.translate.instant("lang.entityUpdated"))},t=>{this.notify.error(t.error.errors)})}readMode(){if(this.creationMode=!1,this.isDraggable=!0,$("#jstree").jstree("deselect_all"),this.currentEntity.parent_entity_id){for(let t=0;t<this.entities.length;t++)if(this.entities[t].entity_id===this.currentEntity.parent_entity_id){$("#jstree").jstree("select_node",this.entities[t]);break}}else this.sidenavRight.close()}selectParentEntity(t){this.creationMode&&($("#jstree").jstree("deselect_all"),$("#jstree").jstree("select_node",t))}removeEntity(){this.currentEntity.documents>0||this.currentEntity.redirects>0||this.currentEntity.instances>0||this.currentEntity.users.length>0||this.currentEntity.templates.length>0?(this.config={panelClass:"maarch-modal",data:{entity:this.currentEntity}},this.dialogRef=this.dialog.open(ir,this.config),this.dialogRef.afterClosed().subscribe(t=>{t&&(this.currentEntity.listTemplate.id&&this.http.delete("../rest/listTemplates/"+this.currentEntity.listTemplate.id).subscribe(t=>{this.currentEntity.listTemplate.id=t.id,this.http.get("../rest/listTemplates/types/entity_id/roles").subscribe(t=>{this.listTemplateRoles=t.roles},t=>{this.notify.error(t.error.errors)})},t=>{this.notify.error(t.error.errors)}),this.idVisaCircuit&&this.http.delete("../rest/listTemplates/"+this.idVisaCircuit).subscribe(()=>{this.idVisaCircuit=null},t=>{this.notify.error(t.error.errors)}),this.http.put("../rest/entities/"+t.entity_id+"/reassign/"+t.redirectEntity,{}).subscribe(t=>{this.entities=t.entities,$("#jstree").jstree(!0).settings.core.data=this.entities,$("#jstree").jstree("refresh"),this.sidenavRight.close(),this.notify.success(this.translate.instant(void 0===t.deleted||t.deleted?"lang.entityDeleted":"lang.entityDeletedButAnnuaryUnreachable"))},t=>{this.notify.error(t.error.errors)})),this.dialogRef=null})):confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+this.currentEntity.entity_label+" \xbb")&&(this.currentEntity.listTemplate.id&&this.http.delete("../rest/listTemplates/"+this.currentEntity.listTemplate.id).subscribe(t=>{this.currentEntity.listTemplate.id=t.id,this.http.get("../rest/listTemplates/types/entity_id/roles").subscribe(t=>{this.listTemplateRoles=t.roles},t=>{this.notify.error(t.error.errors)})},t=>{this.notify.error(t.error.errors)}),this.idVisaCircuit&&this.http.delete("../rest/listTemplates/"+this.idVisaCircuit).subscribe(()=>{this.idVisaCircuit=null},t=>{this.notify.error(t.error.errors)}),this.http.delete("../rest/entities/"+this.currentEntity.entity_id).subscribe(t=>{this.entities=t.entities,$("#jstree").jstree(!0).settings.core.data=this.entities,$("#jstree").jstree("refresh"),this.sidenavRight.close(),this.notify.success(this.translate.instant(void 0===t.deleted||t.deleted?"lang.entityDeleted":"lang.entityDeletedButAnnuaryUnreachable"))},t=>{this.notify.error(t.error.errors)}))}prepareEntityAdd(){if(this.creationMode=!0,this.isDraggable=!1,this.currentEntity.entity_id){for(let t=0;t<this.entities.length;t++)if(this.entities[t].entity_id===this.currentEntity.entity_id){this.currentEntity={entity_type:this.entityTypeList[0].id},this.currentEntity.parent_entity_id=this.entities[t].entity_id;break}}else this.currentEntity={entity_type:this.entityTypeList[0].id},$("#jstree").jstree("deselect_all"),this.sidenavRight.open()}updateStatus(t,e){this.http.put("../rest/entities/"+t.entity_id+"/status",{method:e}).subscribe(t=>{this.notify.success("")},t=>{this.notify.error(t.error.errors)})}saveDiffList(){const t={title:this.currentEntity.entity_id,description:this.currentEntity.entity_id,type:"diffusionList",entityId:this.currentEntity.id,items:this.appDiffusionsList.getCurrentListinstance().map(t=>({id:t.item_id,type:t.item_type,mode:t.item_mode}))};this.functions.empty(this.currentEntity.listTemplate.id)?this.http.post("../rest/listTemplates?admin=true",t).pipe(Object(d.a)(t=>{this.currentEntity.listTemplate.id=t.id,this.notify.success(this.translate.instant("lang.diffusionModelUpdated")),this.appDiffusionsList.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.http.put("../rest/listTemplates/"+this.currentEntity.listTemplate.id,t).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.diffusionModelUpdated")),this.appDiffusionsList.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}deleteDiffList(){this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/listTemplates/"+this.currentEntity.listTemplate.id)),Object(d.a)(()=>{this.currentEntity.listTemplate.id=null,this.notify.success(this.translate.instant("lang.diffusionModelDeleted")),this.appDiffusionsList.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}saveDiffListVisa(){const t={title:this.currentEntity.entity_id,description:this.currentEntity.entity_id,type:"visaCircuit",entityId:this.currentEntity.id,items:this.appVisaWorkflow.getWorkflow().map((t,e)=>({id:t.item_id,type:t.item_type,mode:t.requested_signature?"sign":"visa",sequence:e}))};this.appVisaWorkflow.isValidWorkflow()||this.functions.empty(t.items)?this.functions.empty(t.items)?this.http.delete("../rest/listTemplates/"+this.idVisaCircuit).pipe(Object(d.a)(()=>{this.idVisaCircuit=null,this.notify.success(this.translate.instant("lang.diffusionModelDeleted")),this.appVisaWorkflow.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.functions.empty(this.idVisaCircuit)?this.http.post("../rest/listTemplates?admin=true",t).pipe(Object(d.a)(t=>{this.idVisaCircuit=t.id,this.notify.success(this.translate.instant("lang.diffusionModelUpdated")),this.appVisaWorkflow.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.http.put("../rest/listTemplates/"+this.idVisaCircuit,t).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.diffusionModelUpdated")),this.appVisaWorkflow.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.notify.error(this.appVisaWorkflow.getError())}saveDiffListOpinion(){const t={title:this.currentEntity.entity_id,description:this.currentEntity.entity_id,type:"opinionCircuit",entityId:this.currentEntity.id,items:this.appAvisWorkflow.getWorkflow().map((t,e)=>({id:t.item_id,type:t.item_type,mode:"avis",sequence:e}))};this.functions.empty(t.items)?this.http.delete("../rest/listTemplates/"+this.idOpinionCircuit).pipe(Object(d.a)(()=>{this.idOpinionCircuit=null,this.notify.success(this.translate.instant("lang.diffusionModelDeleted")),this.appAvisWorkflow.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.functions.empty(this.idOpinionCircuit)?this.http.post("../rest/listTemplates?admin=true",t).pipe(Object(d.a)(t=>{this.idOpinionCircuit=t.id,this.notify.success(this.translate.instant("lang.diffusionModelUpdated")),this.appAvisWorkflow.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.http.put("../rest/listTemplates/"+this.idOpinionCircuit,t).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.diffusionModelUpdated")),this.appAvisWorkflow.loadListModel(this.currentEntity.id)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}removeDiffListOpinion(t,e){this.opinionCircuitModified=!0,this.currentEntity.opinionCircuit.items.splice(e,1)}toggleRole(t){t.usedIn.length>0?this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,data:{title:this.translate.instant("lang.confirmAction"),msg:this.translate.instant("lang.roleUsedInTemplateInfo")+" : <b>"+t.usedIn.join(", ")+"</b><br/>"+this.translate.instant("lang.roleUsedInTemplateInfo2")}}).afterClosed().subscribe(e=>{"ok"===e&&(t.available=!t.available,this.http.put("../rest/listTemplates/types/entity_id/roles",{roles:this.listTemplateRoles}).subscribe(()=>{t.usedIn=[],this.currentEntity.listTemplate&&(this.currentEntity.listTemplate.items[t.id]=[]),this.notify.success(this.translate.instant("lang.listTemplatesRolesUpdated"))},t=>{this.notify.error(t.error.errors)}))}):(t.available=!t.available,this.http.put("../rest/listTemplates/types/entity_id/roles",{roles:this.listTemplateRoles}).subscribe(()=>{this.currentEntity.listTemplate&&(this.currentEntity.listTemplate.items[t.id]=[],this.http.get("../rest/listTemplates/types/entity_id/roles").subscribe(t=>{this.listTemplateRoles=t.roles},t=>{this.notify.error(t.error.errors)})),this.notify.success(this.translate.instant("lang.listTemplatesRolesUpdated"))},t=>{this.notify.error(t.error.errors)}))}linkUser(t){this.http.post("../rest/users/"+t.id+"/entities",{entityId:this.currentEntity.entity_id,role:""}).subscribe(e=>{const i=t.idToDisplay.split(" ");this.currentEntity.users.push({id:t.id,user_id:t.otherInfo,firstname:i[0],lastname:i[1]}),this.dataSourceUsers=new G.o(this.currentEntity.users),this.dataSourceUsers.paginator=this.paginatorUsers,this.dataSourceUsers.sort=this.sortUsers,this.notify.success(this.translate.instant("lang.userAdded"))},t=>{this.notify.error(t.error.errors)})}showTemplate(t){this.currentEntity.canAdminTemplates&&this.router.navigate(["/administration/templates/"+t])}addEntityToAnnuary(){this.http.put("../rest/entities/"+this.currentEntity.id+"/annuaries",this.currentEntity).subscribe(t=>{this.currentEntity.business_id=t.entitySiret,this.notify.success(this.translate.instant(void 0===t.synchronized?"lang.siretGenerated":t.synchronized?"lang.siretGeneratedAndSynchronizationDone":"lang.siretGeneratedButAnnuaryUnreachable"))},t=>{this.notify.handleErrors(t)})}openExportModal(){this.dialog.open(Bc,{panelClass:"maarch-modal",width:"800px",autoFocus:!1})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(s.c),m.Tb(f.a),m.Tb(C.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(qc,!0),m.Oc(Xc,!0),m.ad(Kc,!0),m.ad(to,!0),m.ad(eo,!0),m.ad(io,!0),m.ad(ao,!0),m.ad(no,!0),m.ad(so,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginatorUsers=i.first),m.Cc(i=m.ic())&&(e.paginatorTemplates=i.first),m.Cc(i=m.ic())&&(e.sortUsers=i.first),m.Cc(i=m.ic())&&(e.sortTemplates=i.first),m.Cc(i=m.ic())&&(e.appDiffusionsList=i.first),m.Cc(i=m.ic())&&(e.appVisaWorkflow=i.first),m.Cc(i=m.ic())&&(e.appAvisWorkflow=i.first))},decls:132,vars:142,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",1,"col-md-5","col-xs-11",3,"mode","fixedInViewport","opened"],["snav2",""],[3,"label"],[1,"form-horizontal",2,"overflow","hidden"],["entityForm","ngForm"],[1,"form-group"],[1,"col-sm-12"],["id","parent_entity_id","name","parent_entity_id",3,"title","placeholder","ngModel","ngModelChange","selectionChange"],["value",""],[2,"opacity","0.5","text-align","center"],[4,"ngFor","ngForOf"],["id","entity_type","name","entity_type","maxlength","32","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["matInput","","required","","name","entity_id","id","entity_id","type","text","maxlength","32","pattern","^[\\w-]*$",3,"ngModel","title","placeholder","disabled","ngModelChange"],["matInput","","required","","name","entity_label","id","entity_label","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","required","","name","short_label","id","short_label","type","text","maxlength","50",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","email","id","email","type","text","maxlength","255","pattern","(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$)",3,"ngModel","title","placeholder","ngModelChange"],[1,"col-sm-4"],["matInput","","name","adrs_1","id","adrs_1","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","adrs_2","id","adrs_2","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","adrs_3","id","adrs_3","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","zipcode","id","zipcode","type","text","maxlength","32",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","city","id","city","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","country","id","country","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","entity_full_name","id","entity_full_name","matTextareaAutosize","","matAutosizeMinRows","1","matAutosizeMaxRows","5",3,"ngModel","placeholder","title","ngModelChange"],[1,"col-sm-6"],["matInput","","name","archival_agency","id","archival_agency","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","archival_agreement","id","archival_agreement","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","default",3,"click",4,"ngIf"],[3,"label",4,"ngIf"],["mat-subheader",""],["mat-list-item","",3,"click",4,"ngIf"],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fas","fa-file-export"],["mat-line",""],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-list-item","","disableRipple","true",4,"ngIf"],["mat-list-item","","disableRipple","true"],["color","primary","mat-list-icon",""],["color","primary",3,"checked","click"],["mat-line","",3,"ngStyle","click"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["matInput","","id","jstree_search","name","jstree_search","type","text",3,"placeholder"],[4,"ngIf"],["id","jstree"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],[3,"value",4,"ngIf"],[3,"value"],["matInput","","name","id","id","id","type","text","disabled","",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","value","Param\xe8tre SIRET manquant","type","text","maxlength","255","disabled","",3,"title","placeholder",4,"ngIf"],["matInput","","name","business_id","id","business_id","type","text","maxlength","255","disabled","",3,"ngModel","title","placeholder","ngModelChange",4,"ngIf"],["color","primary","mat-icon-button","","matSuffix","","title","G\xe9n\xe9rer un num\xe9ro SIRET",3,"click",4,"ngIf"],["matInput","","value","Param\xe8tre SIRET manquant","type","text","maxlength","255","disabled","",3,"title","placeholder"],["matInput","","name","business_id","id","business_id","type","text","maxlength","255","disabled","",3,"ngModel","title","placeholder","ngModelChange"],["color","primary","mat-icon-button","","matSuffix","","title","G\xe9n\xe9rer un num\xe9ro SIRET",3,"click"],[1,"fas","fa-compress-arrows-alt"],["mat-raised-button","","color","warn",3,"disabled","click"],["mat-raised-button","","color","default",3,"click"],[1,"row",2,"margin","0px"],[1,"col-md-12"],[3,"adminMode","target"],["appDiffusionsList",""],["mat-raised-button","","color","default",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["id","visaCircuitContent",1,"row",2,"margin","0px"],[3,"adminMode","showListModels","showComment"],["appVisaWorkflow",""],["id","opinionCircuitContent",1,"row",2,"margin","0px"],[3,"adminMode","showListModels"],["appAvisWorkflow",""],["class","col-md-12","style","padding:5px;",4,"ngIf"],[1,"col-md-6","col-xs-6"],["matInput","",3,"placeholder","keyup"],[3,"length","hidePageSize","pageSize"],["paginatorUsers",""],["matSort","","matSortActive","lastname","matSortDirection","asc",3,"dataSource"],["tableUsers","matSort"],["matColumnDef","firstname"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","lastname"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"col-md-12",2,"padding","5px"],[3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","subInfoKey","triggerEvent"],["mat-sort-header",""],[2,"cursor","pointer",3,"routerLink","matTooltip"],["paginatorTemplates",""],["matSort","","matSortActive","template_label","matSortDirection","asc",3,"dataSource"],["tableTemplates","matSort"],["matColumnDef","template_label"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",3,"matTooltip",4,"matCellDef"],["matColumnDef","template_target"],["mat-sort-header","","style","flex:1;",4,"matHeaderCellDef"],["style","flex:1;",4,"matCellDef"],[3,"ngStyle","click",4,"matRowDef","matRowDefColumns"],["mat-sort-header","",2,"flex","2"],[2,"flex","2",3,"matTooltip"],["mat-sort-header","",2,"flex","1"],[2,"flex","1"],[3,"ngStyle","click"]],template:function(t,e){if(1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,bo,16,11,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,mo,2,0,"div",9),m.Qc(14,ho,10,9,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"mat-nav-list"),m.Zb(18,"mat-tab-group"),m.Zb(19,"mat-tab",13),m.Zb(20,"form",14,15),m.Zb(22,"div",16),m.Zb(23,"div",17),m.Zb(24,"mat-form-field"),m.Zb(25,"mat-select",18),m.hc("ngModelChange",(function(t){return e.currentEntity.parent_entity_id=t}))("selectionChange",(function(){return e.selectParentEntity(e.currentEntity.parent_entity_id)})),m.mc(26,"translate"),m.mc(27,"translate"),m.Zb(28,"mat-option",19),m.Zb(29,"i",20),m.Sc(30),m.mc(31,"translate"),m.Yb(),m.Yb(),m.Qc(32,go,2,1,"ng-container",21),m.mc(33,"sortBy"),m.Yb(),m.Yb(),m.Zb(34,"mat-form-field"),m.Zb(35,"mat-select",22),m.hc("ngModelChange",(function(t){return e.currentEntity.entity_type=t})),m.mc(36,"translate"),m.mc(37,"translate"),m.Qc(38,vo,2,2,"mat-option",23),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(39,yo,6,7,"div",24),m.Zb(40,"div",16),m.Zb(41,"div",17),m.Zb(42,"mat-form-field"),m.Zb(43,"input",25),m.hc("ngModelChange",(function(t){return e.currentEntity.entity_id=t})),m.mc(44,"translate"),m.mc(45,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(46,"div",16),m.Zb(47,"div",17),m.Zb(48,"mat-form-field"),m.Zb(49,"input",26),m.hc("ngModelChange",(function(t){return e.currentEntity.entity_label=t})),m.mc(50,"translate"),m.mc(51,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(52,"div",16),m.Zb(53,"div",17),m.Zb(54,"mat-form-field"),m.Zb(55,"input",27),m.hc("ngModelChange",(function(t){return e.currentEntity.short_label=t})),m.mc(56,"translate"),m.mc(57,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(58,"div",16),m.Zb(59,"div",17),m.Zb(60,"mat-form-field"),m.Zb(61,"input",28),m.hc("ngModelChange",(function(t){return e.currentEntity.email=t})),m.mc(62,"translate"),m.mc(63,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(64,"mat-accordion"),m.Zb(65,"mat-expansion-panel"),m.Zb(66,"mat-expansion-panel-header"),m.Zb(67,"mat-panel-title"),m.Sc(68),m.mc(69,"translate"),m.Yb(),m.Yb(),m.Zb(70,"div",16),m.Zb(71,"div",29),m.Zb(72,"mat-form-field"),m.Zb(73,"input",30),m.hc("ngModelChange",(function(t){return e.currentEntity.adrs_1=t})),m.mc(74,"translate"),m.mc(75,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(76,"div",29),m.Zb(77,"mat-form-field"),m.Zb(78,"input",31),m.hc("ngModelChange",(function(t){return e.currentEntity.adrs_2=t})),m.mc(79,"translate"),m.mc(80,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(81,"div",29),m.Zb(82,"mat-form-field"),m.Zb(83,"input",32),m.hc("ngModelChange",(function(t){return e.currentEntity.adrs_3=t})),m.mc(84,"translate"),m.mc(85,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(86,"div",16),m.Zb(87,"div",29),m.Zb(88,"mat-form-field"),m.Zb(89,"input",33),m.hc("ngModelChange",(function(t){return e.currentEntity.zipcode=t})),m.mc(90,"translate"),m.mc(91,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(92,"div",29),m.Zb(93,"mat-form-field"),m.Zb(94,"input",34),m.hc("ngModelChange",(function(t){return e.currentEntity.city=t})),m.mc(95,"translate"),m.mc(96,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(97,"div",29),m.Zb(98,"mat-form-field"),m.Zb(99,"input",35),m.hc("ngModelChange",(function(t){return e.currentEntity.country=t})),m.mc(100,"translate"),m.mc(101,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(102,"div",16),m.Zb(103,"div",17),m.Zb(104,"mat-form-field"),m.Zb(105,"textarea",36),m.hc("ngModelChange",(function(t){return e.currentEntity.entity_full_name=t})),m.mc(106,"translate"),m.mc(107,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(108,Mo,6,3,"div",24),m.Zb(109,"div",16),m.Zb(110,"div",37),m.Zb(111,"mat-form-field"),m.Zb(112,"input",38),m.hc("ngModelChange",(function(t){return e.currentEntity.archival_agency=t})),m.mc(113,"translate"),m.mc(114,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(115,"div",37),m.Zb(116,"mat-form-field"),m.Zb(117,"input",39),m.hc("ngModelChange",(function(t){return e.currentEntity.archival_agreement=t})),m.mc(118,"translate"),m.mc(119,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(120,"div",16),m.Zb(121,"div",40),m.Zb(122,"button",41),m.hc("click",(function(){return e.saveEntity()})),m.Sc(123),m.mc(124,"translate"),m.Yb(),m.Qc(125,Yo,3,4,"button",42),m.Qc(126,Zo,3,3,"button",43),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(127,wo,7,6,"mat-tab",44),m.Qc(128,To,7,7,"mat-tab",44),m.Qc(129,Io,7,6,"mat-tab",44),m.Qc(130,Ao,21,13,"mat-tab",44),m.Qc(131,Bo,20,12,"mat-tab",44),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(21);m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!1),m.Eb(4),m.sc("label",e.translate.instant(e.creationMode?"lang.createNewEntity":"lang.informations")),m.Eb(6),m.tc("title",m.nc(26,73,"lang.isLinkedTo")),m.tc("placeholder",m.nc(27,75,"lang.isLinkedTo")),m.sc("ngModel",e.currentEntity.parent_entity_id),m.Eb(5),m.Uc("- ",m.nc(31,77,"lang.noEntity")," -"),m.Eb(2),m.sc("ngForOf",m.oc(33,79,e.entities,"entity_label")),m.Eb(3),m.tc("title",m.nc(36,82,"lang.entityType")),m.tc("placeholder",m.nc(37,84,"lang.entityType")),m.sc("ngModel",e.currentEntity.entity_type),m.Eb(3),m.sc("ngForOf",e.entityTypeList),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(44,86,"lang.id")),m.tc("placeholder",m.nc(45,88,"lang.id")),m.sc("ngModel",e.currentEntity.entity_id)("disabled",!e.creationMode),m.Eb(6),m.tc("title",m.nc(50,90,"lang.label")),m.tc("placeholder",m.nc(51,92,"lang.label")),m.sc("ngModel",e.currentEntity.entity_label),m.Eb(6),m.tc("title",m.nc(56,94,"lang.shortLabel")),m.tc("placeholder",m.nc(57,96,"lang.shortLabel")),m.sc("ngModel",e.currentEntity.short_label),m.Eb(6),m.tc("title",m.nc(62,98,"lang.email")),m.tc("placeholder",m.nc(63,100,"lang.email")),m.sc("ngModel",e.currentEntity.email),m.Eb(7),m.Uc(" ",m.nc(69,102,"lang.otherInformations")," "),m.Eb(5),m.uc("title","",m.nc(74,104,"lang.address"),"1"),m.uc("placeholder","",m.nc(75,106,"lang.address"),"1"),m.sc("ngModel",e.currentEntity.adrs_1),m.Eb(5),m.uc("title","",m.nc(79,108,"lang.address"),"2"),m.uc("placeholder","",m.nc(80,110,"lang.address"),"2"),m.sc("ngModel",e.currentEntity.adrs_2),m.Eb(5),m.uc("title","",m.nc(84,112,"lang.address"),"3"),m.uc("placeholder","",m.nc(85,114,"lang.address"),"3"),m.sc("ngModel",e.currentEntity.adrs_3),m.Eb(6),m.tc("title",m.nc(90,116,"lang.zipcode")),m.tc("placeholder",m.nc(91,118,"lang.zipcode")),m.sc("ngModel",e.currentEntity.zipcode),m.Eb(5),m.tc("title",m.nc(95,120,"lang.city")),m.tc("placeholder",m.nc(96,122,"lang.city")),m.sc("ngModel",e.currentEntity.city),m.Eb(5),m.tc("title",m.nc(100,124,"lang.country")),m.tc("placeholder",m.nc(101,126,"lang.country")),m.sc("ngModel",e.currentEntity.country),m.Eb(6),m.tc("placeholder",m.nc(106,128,"lang.entityFullName")),m.tc("title",m.nc(107,130,"lang.entityFullName")),m.sc("ngModel",e.currentEntity.entity_full_name),m.Eb(3),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(113,132,"lang.archivalAgency")),m.tc("placeholder",m.nc(114,134,"lang.archivalAgency")),m.sc("ngModel",e.currentEntity.archival_agency),m.Eb(5),m.tc("title",m.nc(118,136,"lang.archivalAgreement")),m.tc("placeholder",m.nc(119,138,"lang.archivalAgreement")),m.sc("ngModel",e.currentEntity.archival_agreement),m.Eb(5),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(124,140,"lang.save")),m.Eb(2),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode)}},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.h,Ie.c,Ie.a,o.J,o.u,o.v,w.c,at.a,o.t,o.w,I.o,x.s,o.o,o.E,O.b,o.c,o.A,De.a,De.c,De.g,De.h,O.d,D.b,Ot.g,Ot.d,Tt.a,Ot.c,I.k,_.a,et.a,x.w,T.c,k.a,w.f,w.j,Wc.a,Ic.a,Dc.a,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Dt.a,G.h,V.b,G.a,G.j,G.l,s.d,It.b],pipes:[p.d,U.a],styles:[".mat-list-item[draggable=false][_ngcontent-%COMP%]:hover{background:inherit}.mat-list-item[draggable=false][_ngcontent-%COMP%]{cursor:not-allowed!important}.mat-list-item[draggable=true][_ngcontent-%COMP%]{cursor:pointer}.mat-list-item[draggable=true][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:move}"]}),t})(),ir=(()=>{class t{constructor(t,e,i,a){this.translate=t,this.http=e,this.data=i,this.dialogRef=a,console.log(this.data.entity.redirectEntity)}setRedirectEntity(t){this.data.entity.redirectEntity=t.id}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:17,vars:17,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["role","alert",1,"alert-message","alert-message-info"],[4,"ngIf"],["singleMode","","required","",3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","subInfoKey","triggerEvent"],[1,"divider-modal"],["mat-raised-button","","color","warn","type","submit",1,"btn","btn-danger",3,"disabled","click"],["color","primary","mat-list-icon","",1,"fa","fa-file","fa-2x"],["mat-line",""],["color","primary","mat-list-icon","",1,"fa","fa-sitemap","fa-2x"],["color","primary","mat-list-icon","",1,"fa","fa-user","fa-2x"],["color","primary","mat-list-icon","",1,"fa","fa-file-alt","fa-2x"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h2",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"div",2),m.Zb(6,"mat-list"),m.Qc(7,Wo,11,8,"mat-list-item",3),m.Qc(8,qo,11,8,"mat-list-item",3),m.Qc(9,Xo,13,12,"mat-list-item",3),m.Qc(10,Ko,13,12,"mat-list-item",3),m.Yb(),m.Yb(),m.Zb(11,"plugin-autocomplete",4),m.hc("triggerEvent",(function(t){return e.setRedirectEntity(t)})),m.Yb(),m.Yb(),m.Ub(12,"span",5),m.Zb(13,"mat-dialog-actions"),m.Zb(14,"button",6),m.hc("click",(function(){return e.dialogRef.close(e.data.entity)})),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,12,"lang.entityReplacement")),m.Eb(5),m.sc("ngIf",e.data.entity.documents>0),m.Eb(1),m.sc("ngIf",e.data.entity.instances>0),m.Eb(1),m.sc("ngIf",e.data.entity.users.length>0),m.Eb(1),m.sc("ngIf",e.data.entity.templates.length>0),m.Eb(1),m.sc("labelPlaceholder",e.translate.instant("lang.chooseEntity"))("labelList",e.translate.instant("lang.availableEntities"))("routeDatas",m.yc(16,tr))("targetSearchKey","idToDisplay")("subInfoKey","descriptionToDisplay"),m.Eb(3),m.sc("disabled",void 0===e.data.entity.redirectEntity||e.data.entity.redirectEntity==e.data.entity.entity_id),m.Eb(1),m.Tc(m.nc(16,14,"lang.delete")))},directives:[H.i,H.f,Ot.a,x.t,Dt.a,H.c,D.b,Ot.d,Tt.a,Ot.c,I.k],pipes:[p.d,x.p],styles:[".alert-message[_ngcontent-%COMP%] { max-width: inherit; }"]}),t})();const ar=["adminMenuTemplate"];function nr(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function sr(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function cr(t,e){1&t&&(m.Zb(0,"mat-header-cell"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.imgRelated")))}function or(t,e){if(1&t&&m.Ub(0,"mat-icon",41),2&t){const t=m.lc().$implicit;m.Hb("fm ",t.img_filename," fm-2x")}}function rr(t,e){if(1&t&&m.Ub(0,"mat-icon",41),2&t){const t=m.lc().$implicit;m.Hb("fa ",t.img_filename," fa-2x")}}function lr(t,e){if(1&t&&(m.Zb(0,"mat-cell",39),m.Qc(1,or,1,3,"mat-icon",40),m.Qc(2,rr,1,3,"mat-icon",40),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",0==t.img_filename.indexOf("fm")),m.Eb(1),m.sc("ngIf",0==t.img_filename.indexOf("fa"))}}function dr(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.id"))}}function br(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.id," ")}}function mr(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.statusName")))}function pr(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label_status," ")}}function ur(t,e){1&t&&m.Ub(0,"mat-header-cell")}function hr(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",43),m.Zb(1,"button",44),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteStatus(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",45),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function fr(t,e){1&t&&m.Ub(0,"mat-header-row")}function gr(t,e){1&t&&(m.Ub(0,"mat-row",46),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/statuses/",e.$implicit.identifier,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function vr(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,cr,3,3,"mat-header-cell",26),m.Qc(13,lr,3,2,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,dr,3,5,"mat-header-cell",29),m.Qc(16,br,2,3,"mat-cell",30),m.Wb(),m.Xb(17,31),m.Qc(18,mr,3,3,"mat-header-cell",32),m.Qc(19,pr,2,1,"mat-cell",33),m.Wb(),m.Xb(20,34),m.Qc(21,ur,1,0,"mat-header-cell",26),m.Qc(22,hr,4,3,"mat-cell",35),m.Wb(),m.Qc(23,fr,1,0,"mat-header-row",36),m.Qc(24,gr,2,4,"mat-row",37),m.Yb(),m.Zb(25,"div",38),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.statuses.length," ",m.nc(27,12,"lang.statuses"),"")}}let yr=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.loading=!1,this.statuses=[],this.displayedColumns=["img_filename","id","label_status","identifier"],this.filterColumns=["id","label_status"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.statuses")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/statuses").subscribe(t=>{this.statuses=t.statuses,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_status",this.statuses,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.error(t.error.errors)})}deleteStatus(t){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+t.id+" \xbb")&&this.http.delete("../rest/statuses/"+t.identifier).subscribe(t=>{this.statuses=t.statuses,this.adminService.setDataSource("admin_status",this.statuses,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.statusDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(ar,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/statuses/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","img_filename"],[4,"matHeaderCellDef"],["color","primary",4,"matCellDef"],["matColumnDef","id"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","label_status"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","identifier"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["color","primary"],["aria-hidden","true",3,"class",4,"ngIf"],["aria-hidden","true"],["mat-sort-header",""],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,nr,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,sr,2,0,"div",9),m.Qc(14,vr,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,G.a,V.b,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})();function Cr(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function Er(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",31),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).status.id=e}))("blur",(function(){return m.Hc(t),m.lc(2).isAvailable()})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("title",m.nc(1,4,"lang.id")),m.tc("placeholder",m.nc(2,6,"lang.id")),m.sc("formControl",t.statusId)("ngModel",t.status.id)}}function Sr(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",32),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).status.id=e})),m.mc(1,"translate"),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(2);m.tc("title",m.nc(1,3,"lang.id")),m.tc("placeholder",m.nc(2,5,"lang.id")),m.sc("ngModel",t.status.id)}}function Mr(t,e){if(1&t&&(m.Zb(0,"mat-error"),m.Sc(1),m.Yb()),2&t){const t=m.lc(2);m.Eb(1),m.Tc(t.getErrorMessage())}}const Yr=function(t){return[t]};function Zr(t,e){if(1&t&&(m.Zb(0,"mat-option",33),m.Ub(1,"i",34),m.Sc(2),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.image_name),m.Eb(1),m.Gb(t.image_name),m.sc("ngClass",m.zc(6,Yr,0==t.image_name.indexOf("fm")?"fm":"fa")),m.Eb(1),m.Uc(" ",t.image_name," ")}}function xr(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Zb(1,"form",13,14),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().submitStatus()})),m.Zb(3,"div",15),m.Zb(4,"div",16),m.Zb(5,"mat-form-field"),m.Qc(6,Er,3,8,"input",17),m.Qc(7,Sr,3,7,"input",18),m.Qc(8,Mr,2,1,"mat-error",19),m.Yb(),m.Yb(),m.Yb(),m.Zb(9,"div",15),m.Zb(10,"div",16),m.Zb(11,"mat-form-field"),m.Zb(12,"input",20),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().status.label_status=e})),m.mc(13,"translate"),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"div",15),m.Zb(16,"div",21),m.Zb(17,"mat-slide-toggle",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().status.can_be_searched=e})),m.mc(18,"translate"),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Yb(),m.Zb(21,"div",21),m.Zb(22,"mat-slide-toggle",23),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().status.can_be_modified=e})),m.mc(23,"translate"),m.Sc(24),m.mc(25,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(26,"div",15),m.Zb(27,"div",24),m.Ub(28,"mat-icon",25),m.Yb(),m.Zb(29,"div",26),m.Zb(30,"mat-form-field"),m.Zb(31,"mat-select",27),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().status.img_filename=e})),m.mc(32,"translate"),m.Qc(33,Zr,3,8,"mat-option",28),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(34,"div",15),m.Zb(35,"div",29),m.Zb(36,"button",30),m.Sc(37),m.mc(38,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.lc();m.Eb(6),m.sc("ngIf",e.creationMode),m.Eb(1),m.sc("ngIf",!e.creationMode),m.Eb(1),m.sc("ngIf",e.statusId.invalid),m.Eb(4),m.tc("title",m.nc(13,23,"lang.label")),m.tc("placeholder",m.nc(14,25,"lang.label")),m.sc("ngModel",e.status.label_status),m.Eb(5),m.tc("matTooltip",m.nc(18,27,"lang.tooltipSearchStatus")),m.sc("ngModel",e.status.can_be_searched)("checked",1==e.status.can_be_searched),m.Eb(2),m.Uc(" ",m.nc(20,29,"lang.canBeSearched")," "),m.Eb(3),m.tc("matTooltip",m.nc(23,31,"lang.tooltipIndexStatus")),m.sc("ngModel",e.status.can_be_modified)("checked",1==e.status.can_be_modified),m.Eb(2),m.Uc(" ",m.nc(25,33,"lang.canBeModified")," "),m.Eb(4),m.Gb(e.status.img_filename),m.sc("ngClass",m.zc(39,Yr,0==e.status.img_filename.indexOf("fm")?"fm fm-2x":"fa fa-2x")),m.Eb(3),m.tc("placeholder",m.nc(32,35,"lang.imgRelated")),m.sc("ngModel",e.status.img_filename),m.Eb(2),m.sc("ngForOf",e.statusImages),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(38,37,"lang.save"))}}let _r=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.status={id:null,label_status:null,can_be_searched:null,can_be_modified:null,img_filename:"fm-letter"},this.statusImages="",this.loading=!1,this.statusId=new o.h("",[o.H.required,o.H.pattern(/^[\w.-]*$/)])}getErrorMessage(){return this.statusId.hasError("required")?this.translate.instant("lang.enterValue"):this.statusId.hasError("pattern")?this.translate.instant("lang.patternId"):""}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>{void 0===t.identifier?(this.headerService.setHeader(this.translate.instant("lang.statusCreation")),this.http.get("../rest/administration/statuses/new").subscribe(t=>{this.status.img_filename="fm-letter",this.status.can_be_searched=!0,this.status.can_be_modified=!0,this.statusImages=t.statusImages,this.creationMode=!0,this.loading=!1}),this.statusIdAvailable=!1):(this.creationMode=!1,this.statusIdentifier=t.identifier,this.http.get("../rest/statuses/"+t.identifier).subscribe(t=>{this.status=t.status[0],this.headerService.setHeader(this.translate.instant("lang.statusModification"),this.status.label_status),this.status.can_be_searched="Y"===this.status.can_be_searched,this.status.can_be_modified="Y"===this.status.can_be_modified,this.statusImages=t.statusImages,this.statusIdAvailable=!0,this.loading=!1},t=>{this.notify.error(t.error.errors)}))})}isAvailable(){this.status.id?this.http.get("../rest/status/"+this.status.id).subscribe(()=>{this.statusIdAvailable=!1},t=>{this.statusIdAvailable=!1,"id not found"===t.error.errors&&(this.statusIdAvailable=!0)}):this.statusIdAvailable=!1}submitStatus(){!0===this.creationMode?this.http.post("../rest/statuses",this.status).subscribe(()=>{this.notify.success(this.translate.instant("lang.statusAdded")),this.router.navigate(["administration/statuses"])},t=>{this.notify.error(t.error.errors)}):!1===this.creationMode&&this.http.put("../rest/statuses/"+this.statusIdentifier,this.status).subscribe(()=>{this.notify.success(this.translate.instant("lang.statusUpdated")),this.router.navigate(["administration/statuses"])},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"form-horizontal",3,"ngSubmit"],["statusFormUp","ngForm"],[1,"form-group"],[1,"col-sm-12"],["matInput","","maxlength","10","name","id","id","id","type","text","pattern","^[\\w.-]*$","required","",3,"formControl","ngModel","title","placeholder","ngModelChange","blur",4,"ngIf"],["matInput","","maxlength","10","name","id","id","id","required","","disabled","",3,"ngModel","title","placeholder","ngModelChange",4,"ngIf"],[4,"ngIf"],["matInput","","name","label_status","id","label_status","maxlength","50","type","text","required","",3,"ngModel","title","placeholder","ngModelChange"],[1,"col-sm-6",2,"white-space","nowrap","text-align","center"],["id","can_be_search","name","can_be_search","color","primary",3,"matTooltip","ngModel","checked","ngModelChange"],["id","can_be_modified","name","can_be_modified","color","primary",3,"matTooltip","ngModel","checked","ngModelChange"],[1,"col-sm-1",2,"text-align","right"],["aria-hidden","true","color","primary",3,"ngClass"],[1,"col-sm-11"],["id","status","name","status","required","",3,"ngModel","placeholder","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-12",2,"text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["matInput","","maxlength","10","name","id","id","id","type","text","pattern","^[\\w.-]*$","required","",3,"formControl","ngModel","title","placeholder","ngModelChange","blur"],["matInput","","maxlength","10","name","id","id","id","required","","disabled","",3,"ngModel","title","placeholder","ngModelChange"],[3,"value"],["color","primary",3,"ngClass"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,Cr,2,0,"div",8),m.Qc(12,xr,39,41,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.o,o.E,o.t,o.w,et.a,It.b,Tt.a,x.q,at.a,x.s,D.b,o.A,o.i,w.b,I.o],pipes:[p.d],encapsulation:2}),t})();const wr=["snav2"],Or=["adminMenuTemplate"];function Tr(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function kr(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function Ir(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.id"))}}function Dr(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.id," ")}}function Ur(t,e){1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.actionName")))}function Pr(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label_action," ")}}function Fr(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.actionHistory")," ")}}function Lr(t,e){1&t&&(m.Zb(0,"span"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.no")," "))}function jr(t,e){1&t&&(m.Zb(0,"span"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.yes")," "))}function Rr(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Qc(1,Lr,3,3,"span",39),m.Qc(2,jr,3,3,"span",39),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.sc("ngIf","N"==t.history),m.Eb(1),m.sc("ngIf","Y"==t.history)}}function Qr(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Ar(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",40),m.Zb(1,"button",41),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteAction(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",42),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("matTooltip",m.nc(2,2,"lang.delete")),m.sc("disabled","Y"==t.is_system)}}function Hr(t,e){1&t&&m.Ub(0,"mat-header-row")}function $r(t,e){1&t&&(m.Ub(0,"mat-row",43),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/actions/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function zr(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,Ir,3,5,"mat-header-cell",26),m.Qc(13,Dr,2,3,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,Ur,3,3,"mat-header-cell",29),m.Qc(16,Pr,2,1,"mat-cell",30),m.Wb(),m.Xb(17,31),m.Qc(18,Fr,3,5,"mat-header-cell",26),m.Qc(19,Rr,3,4,"mat-cell",27),m.Wb(),m.Xb(20,32),m.Qc(21,Qr,1,0,"mat-header-cell",33),m.Qc(22,Ar,4,4,"mat-cell",34),m.Wb(),m.Qc(23,Hr,1,0,"mat-header-row",35),m.Qc(24,$r,2,4,"mat-row",36),m.Yb(),m.Zb(25,"div",37),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.actions.length," ",m.nc(27,12,"lang.actions"),"")}}let Vr=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.adminService=s,this.functions=c,this.viewContainerRef=o,this.search=null,this.actions=[],this.titles=[],this.loading=!1,this.displayedColumns=["id","label_action","history","actions"],this.filterColumns=["id","label_action"]}ngOnInit(){this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/actions").subscribe(t=>{this.actions=t.actions,this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.actions")),this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_actions",this.actions,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.handleErrors(t)})}deleteAction(t){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+t.label_action+" \xbb")&&this.http.delete("../rest/actions/"+t.id).subscribe(t=>{this.actions=t.actions,this.adminService.setDataSource("admin_actions",this.actions,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.actionDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(wt),m.Tb(C.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(wr,!0),m.Oc(Or,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/actions/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"placeholder","formControl"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","id"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","label_action"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","history"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],[4,"ngIf"],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Tr,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,kr,2,0,"div",9),m.Qc(14,zr,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})();var Nr=i("fBaO");const Jr=["snav2"];function Gr(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function Br(t,e){1&t&&(m.Zb(0,"div",28),m.Zb(1,"b"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Sc(4),m.mc(5,"translate"),m.Yb()),2&t&&(m.Eb(2),m.Uc("",m.nc(3,2,"lang.isSytemAction")," !"),m.Eb(2),m.Uc(" ",m.nc(5,4,"lang.doNotModifyUnlessExpert")," "))}function Wr(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",32),m.hc("removed",(function(){m.Hc(t);const i=e.index;return m.lc(3).removeSelectedFields(i)})),m.Sc(1),m.Ub(2,"mat-icon",33),m.Yb()}if(2&t){const t=e.$implicit;m.sc("removable",!0),m.Eb(1),m.Uc(" ",t," ")}}function qr(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",17),m.Zb(2,"plugin-select-search",29),m.hc("afterSelected",(function(){return m.Hc(t),m.lc(2).getSelectedFields()})),m.Yb(),m.Zb(3,"mat-chip-list",30),m.Qc(4,Wr,3,2,"mat-chip",31),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Gb(""),m.sc("showLabel",!0)("label",t.translate.instant("lang.checkEmptyFields"))("placeholderLabel",t.translate.instant("lang.checkEmptyFields"))("formControlSelect",t.customFieldsFormControl)("datas",t.availableCustomFields),m.Eb(2),m.sc("ngForOf",t.selectedFieldsValue)}}function Xr(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",17),m.Zb(2,"mat-form-field"),m.Zb(3,"mat-select",34),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).arMode=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Zb(6,"mat-option",35),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-option",36),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Zb(12,"mat-option",37),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,7,"lang.generateARMode")),m.tc("placeholder",m.nc(5,9,"lang.generateARMode")),m.sc("required","create_acknowledgement_receipt"==t.action.actionPageId)("ngModel",t.arMode),m.Eb(4),m.Tc(m.nc(8,11,"lang.autoAR")),m.Eb(3),m.Tc(m.nc(11,13,"lang.manualAR")),m.Eb(3),m.Tc(m.nc(14,15,"lang.bothAR"))}}function Kr(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",16),m.Zb(1,"div",17),m.Zb(2,"plugin-select-search",29),m.hc("afterSelected",(function(){m.Hc(t);const e=m.lc(2);return e.action.id_status=e.selectStatusId.value})),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Gb(""),m.sc("showLabel",!0)("label",t.translate.instant("lang.associatedStatus"))("placeholderLabel",t.translate.instant("lang.associatedStatus"))("formControlSelect",t.selectStatusId)("datas",t.statuses)}}function tl(t,e){if(1&t&&(m.Zb(0,"mat-option",38),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",t.label," ")}}function el(t,e){if(1&t&&(m.Zb(0,"mat-option",39),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.sc("value",t.id)("disabled","registeredMail"!==t.id&&"registeredMail"===i.action.actionPageGroup),m.Eb(1),m.Uc(" ",t.label," ")}}function il(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Qc(1,Br,6,6,"div",13),m.Zb(2,"form",14,15),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(4,"div",16),m.Zb(5,"div",17),m.Zb(6,"mat-form-field"),m.Zb(7,"input",18),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().action.label_action=e})),m.mc(8,"translate"),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(10,"div",16),m.Zb(11,"div",17),m.Zb(12,"plugin-select-search",19),m.hc("afterSelected",(function(){return m.Hc(t),m.lc().getCustomFields()})),m.Yb(),m.Yb(),m.Yb(),m.Qc(13,qr,5,8,"div",20),m.Qc(14,Xr,15,17,"div",20),m.Qc(15,Kr,3,7,"div",20),m.Zb(16,"div",16),m.Zb(17,"div",17),m.Zb(18,"mat-form-field"),m.Zb(19,"mat-select",21),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().action.keyword=e})),m.mc(20,"translate"),m.mc(21,"translate"),m.Qc(22,tl,2,2,"mat-option",22),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(23,"div",16),m.Zb(24,"div",23),m.Zb(25,"mat-slide-toggle",24),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().action.history=e})),m.mc(26,"translate"),m.Sc(27),m.mc(28,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(29,"div",16),m.Zb(30,"div",17),m.Zb(31,"mat-form-field"),m.Zb(32,"mat-select",25),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().action.actionCategories=e})),m.mc(33,"translate"),m.mc(34,"translate"),m.Qc(35,el,2,3,"mat-option",26),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(36,"div",16),m.Zb(37,"div",23),m.Zb(38,"button",27),m.Sc(39),m.mc(40,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(3),e=m.lc();m.Eb(1),m.sc("ngIf",1==e.action.is_system),m.Eb(6),m.tc("title",m.nc(8,30,"lang.label")),m.tc("placeholder",m.nc(9,32,"lang.label")),m.sc("ngModel",e.action.label_action),m.Eb(5),m.Gb(""),m.sc("showLabel",!0)("label",e.translate.instant("lang.actionCarriedOut"))("placeholderLabel",e.translate.instant("lang.actionCarriedOut"))("formControlSelect",e.selectActionPageId)("datas",e.actionPages)("optGroupList",e.group)("optGroupTarget","category"),m.Eb(1),m.sc("ngIf",!e.functions.empty(e.availableCustomFields)&&"close_mail"==e.action.actionPageId),m.Eb(1),m.sc("ngIf","create_acknowledgement_receipt"==e.action.actionPageId),m.Eb(1),m.sc("ngIf","reconcile"!=e.action.actionPageId),m.Eb(4),m.tc("title",m.nc(20,34,"lang.keyword")),m.tc("placeholder",m.nc(21,36,"lang.keyword")),m.sc("ngModel",e.action.keyword),m.Eb(3),m.sc("ngForOf",e.keywordsList),m.Eb(3),m.tc("title",m.nc(26,38,"lang.actionHistoryDesc")),m.sc("ngModel",e.action.history)("checked","Y"==e.action.history),m.Eb(2),m.Uc(" ",m.nc(28,40,"lang.actionHistory"),""),m.Eb(5),m.tc("title",m.nc(33,42,"lang.chooseCategoryAssociation")),m.tc("placeholder",m.nc(34,44,"lang.chooseCategoryAssociation")),m.sc("ngModel",e.action.actionCategories),m.Eb(3),m.sc("ngForOf",e.categoriesList),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(40,46,"lang.save"))}}let al=(()=>{class t{constructor(t,e,i,a,n,s,c,r){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.functions=r,this.action={},this.statuses=[],this.actionPages=[],this.categoriesList=[],this.keywordsList=[],this.group=[],this.loading=!1,this.availableCustomFields=[],this.customFieldsFormControl=new o.h({value:"",disabled:!1}),this.selectedFieldsValue=[],this.selectedFieldsId=[],this.selectActionPageId=new o.h,this.selectStatusId=new o.h}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>{void 0===t.id?(this.creationMode=!0,this.http.get("../rest/initAction").subscribe(t=>{this.action=t.action,this.selectActionPageId.setValue(this.action.actionPageId),this.selectStatusId.setValue(this.action.id_status),this.categoriesList=t.categoriesList,this.statuses=t.statuses.map(t=>({id:t.id,label:t.label_status})),this.actionPages=t.actionPages,this.actionPages.map(t=>t.category).filter((t,e,i)=>i.indexOf(t)===e).forEach(t=>{this.group.push({id:t,label:this.translate.instant("lang."+t)})}),this.keywordsList=t.keywordsList,this.headerService.setHeader(this.translate.instant("lang.actionCreation")),this.loading=!1})):(this.creationMode=!1,this.http.get("../rest/actions/"+t.id).subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){this.action=t.action,this.selectActionPageId.setValue(this.action.actionPageId),this.selectStatusId.setValue(this.action.id_status),this.categoriesList=t.categoriesList,this.statuses=t.statuses.map(t=>({id:t.id,label:t.label_status})),this.actionPages=t.actionPages,this.actionPages.map(t=>t.category).filter((t,e,i)=>i.indexOf(t)===e).forEach(t=>{this.group.push({id:t,label:this.translate.instant("lang."+t)})}),this.keywordsList=t.keywordsList,this.headerService.setHeader(this.translate.instant("lang.actionCreation"),t.action.label_action),yield this.getCustomFields(),this.loading=!1,"close_mail"===this.action.actionPageId?(this.customFieldsFormControl=new o.h({value:this.action.parameters.requiredFields,disabled:!1}),this.selectedFieldsId=[],this.action.parameters.requiredFields&&(this.selectedFieldsId=this.action.parameters.requiredFields),this.selectedFieldsId.forEach(t=>{this.availableCustomFields.forEach(e=>{e.id===t&&this.selectedFieldsValue.push(e.label)})})):"create_acknowledgement_receipt"===this.action.actionPageId&&(this.arMode=this.action.parameters.mode)}))))})}getCustomFields(){return this.action.actionPageId=this.selectActionPageId.value,this.action.actionPageGroup=this.actionPages.filter(t=>t.id===this.action.actionPageId)[0].category,"registeredMail"===this.action.actionPageGroup&&(this.action.actionCategories=["registeredMail"]),new Promise((t,e)=>{"close_mail"===this.action.actionPageId&&this.functions.empty(this.availableCustomFields)?this.http.get("../rest/customFields").pipe(Object(d.a)(e=>(this.availableCustomFields=e.customFields.map(t=>(t.id="indexingCustomField_"+t.id,t)),t(!0))),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():t(!0)})}getSelectedFields(){this.availableCustomFields.forEach(t=>{t.id===this.customFieldsFormControl.value&&(this.selectedValue=t)}),this.selectedFieldsId.indexOf(this.customFieldsFormControl.value)<0&&(this.selectedFieldsValue.push(this.selectedValue.label),this.selectedFieldsId.push(this.customFieldsFormControl.value)),this.customFieldsFormControl.reset()}removeSelectedFields(t){this.selectedFieldsValue.splice(t,1),this.selectedFieldsId.splice(t,1)}onSubmit(){"close_mail"===this.action.actionPageId?this.action.parameters={requiredFields:this.selectedFieldsId}:"create_acknowledgement_receipt"===this.action.actionPageId&&(this.action.parameters={mode:this.arMode}),this.creationMode?this.http.post("../rest/actions",this.action).subscribe(()=>{this.router.navigate(["/administration/actions"]),this.notify.success(this.translate.instant("lang.actionAdded"))},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/actions/"+this.action.id,this.action).subscribe(()=>{this.router.navigate(["/administration/actions"]),this.notify.success(this.translate.instant("lang.actionUpdated"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(Jr,!0),2&t&&m.Cc(i=m.ic())&&(e.sidenavRight=i.first)},decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"form-horizontal",3,"ngSubmit"],["actionsFormUp","ngForm"],[1,"form-group"],[1,"col-sm-12"],["matInput","","required","","name","action_name","id","action_name","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],[2,"width","100%",3,"showLabel","label","placeholderLabel","formControlSelect","datas","optGroupList","optGroupTarget","afterSelected"],["class","form-group",4,"ngIf"],["id","keyword","name","keyword",3,"title","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-12",2,"text-align","center"],["name","history","id","history","color","primary",3,"title","ngModel","checked","ngModelChange"],["id","categorieslist","name","categorieslist","multiple","","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["role","alert",1,"alert","alert-danger"],[2,"width","100%",3,"showLabel","label","placeholderLabel","formControlSelect","datas","afterSelected"],[1,"checkbox-selected-list"],["selected","",3,"removable","removed",4,"ngFor","ngForOf"],["selected","",3,"removable","removed"],["matChipRemove","",1,"fa","fa-times-circle"],["id","generateARmode","name","generateARmode",3,"required","title","placeholder","ngModel","ngModelChange"],["value","auto"],["value","manual"],["value","both"],[3,"value"],[3,"value","disabled"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,Gr,2,0,"div",8),m.Qc(12,il,41,48,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.E,o.o,o.t,o.w,Nr.a,at.a,x.s,et.a,D.b,An.d,An.a,Tt.a,An.e,I.o],pipes:[p.d],encapsulation:2}),t})();function nl(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function sl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"input",27),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).parameter.param_value_string=e})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.tc("placeholder",m.nc(2,2,"lang.value")),m.sc("ngModel",t.parameter.param_value_string)}}function cl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"input",28),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).parameter.param_value_int=e})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.tc("placeholder",m.nc(2,2,"lang.value")),m.sc("ngModel",t.parameter.param_value_int)}}function ol(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"input",29),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).parameter.param_value_date=e})),m.mc(2,"translate"),m.Yb(),m.Ub(3,"mat-datepicker-toggle",30),m.Ub(4,"mat-datepicker",31,32),m.Yb()}if(2&t){const t=m.Dc(5),e=m.lc(2);m.Eb(1),m.tc("placeholder",m.nc(2,4,"lang.date")),m.sc("ngModel",e.parameter.param_value_date)("matDatepicker",t),m.Eb(2),m.sc("for",t)}}function rl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Zb(1,"form",13,14),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(3,"div",15),m.Zb(4,"div",16),m.Zb(5,"mat-form-field"),m.Zb(6,"input",17),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().parameter.id=e})),m.mc(7,"translate"),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(9,"div",15),m.Zb(10,"div",16),m.Zb(11,"mat-form-field"),m.Zb(12,"input",18),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().parameter.description=e})),m.mc(13,"translate"),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"div",15),m.Zb(16,"div",19),m.Zb(17,"mat-form-field"),m.Zb(18,"mat-select",20),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().type=e})),m.mc(19,"translate"),m.Zb(20,"mat-option",21),m.Sc(21),m.mc(22,"translate"),m.Yb(),m.Zb(23,"mat-option",22),m.Sc(24),m.mc(25,"translate"),m.Yb(),m.Zb(26,"mat-option",23),m.Sc(27),m.mc(28,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(29,"div",19),m.Qc(30,sl,3,4,"mat-form-field",24),m.Qc(31,cl,3,4,"mat-form-field",24),m.Qc(32,ol,6,6,"mat-form-field",24),m.Yb(),m.Yb(),m.Zb(33,"div",15),m.Zb(34,"div",25),m.Zb(35,"button",26),m.Sc(36),m.mc(37,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.lc();m.Eb(6),m.tc("title",m.nc(7,18,"lang.id")),m.tc("placeholder",m.nc(8,20,"lang.id")),m.sc("ngModel",e.parameter.id)("disabled",!e.creationMode),m.Eb(6),m.tc("title",m.nc(13,22,"lang.description")),m.tc("placeholder",m.nc(14,24,"lang.description")),m.sc("ngModel",e.parameter.description),m.Eb(6),m.tc("placeholder",m.nc(19,26,"lang.type")),m.sc("ngModel",e.type)("disabled",!e.creationMode),m.Eb(3),m.Uc(" ",m.nc(22,28,"lang.stringInput")," "),m.Eb(3),m.Uc(" ",m.nc(25,30,"lang.integer")," "),m.Eb(3),m.Uc(" ",m.nc(28,32,"lang.date")," "),m.Eb(3),m.sc("ngIf","string"==e.type),m.Eb(1),m.sc("ngIf","int"==e.type),m.Eb(1),m.sc("ngIf","date"==e.type),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(37,34,"lang.save"))}}let ll=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.loading=!1,this.parameter={}}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.parameterCreation")),this.creationMode=!0,this.loading=!1):(this.creationMode=!1,this.http.get("../rest/parameters/"+t.id).subscribe(t=>{this.parameter=t.parameter,this.headerService.setHeader(this.translate.instant("lang.parameterModification"),this.parameter.id),this.type="number"==typeof this.parameter.param_value_int?"int":this.parameter.param_value_date?"date":"string",this.loading=!1},t=>{this.notify.handleErrors(t)}))})}onSubmit(){"date"===this.type?(this.parameter.param_value_int=null,this.parameter.param_value_string=null):"int"===this.type?(this.parameter.param_value_date=null,this.parameter.param_value_string=null):"string"===this.type&&(this.parameter.param_value_date=null,this.parameter.param_value_int=null),!0===this.creationMode?this.http.post("../rest/parameters",this.parameter).subscribe(()=>{this.router.navigate(["administration/parameters"]),this.notify.success(this.translate.instant("lang.parameterAdded"))},t=>{this.notify.error(t.error.errors)}):!1===this.creationMode&&this.http.put("../rest/parameters/"+this.parameter.id,this.parameter).subscribe(()=>{this.router.navigate(["administration/parameters"]),this.notify.success(this.translate.instant("lang.parameterUpdated"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"form-horizontal",3,"ngSubmit"],["parameterForm","ngForm"],[1,"form-group"],[1,"col-sm-12"],["matInput","","name","id","type","text","pattern","^[\\w-]*$","required","",3,"ngModel","disabled","title","placeholder","ngModelChange"],["matInput","","name","description","id","description","type","text",3,"ngModel","title","placeholder","ngModelChange"],[1,"col-sm-6"],["name","type","required","",3,"placeholder","ngModel","disabled","ngModelChange"],["value","string"],["value","int"],["value","date"],[4,"ngIf"],[1,"col-sm-12",2,"text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["matInput","","name","paramValueString","type","text","required","",3,"ngModel","placeholder","ngModelChange"],["matInput","","name","paramValueInt","type","number","pattern","^[0-9]*$","required","",3,"ngModel","placeholder","ngModelChange"],["matInput","","name","paramValueDate","required","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["startView","month"],["picker",""]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,nl,2,0,"div",8),m.Qc(12,rl,38,36,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.A,o.E,o.t,o.w,at.a,I.o,D.b,o.z,je.f,je.h,w.j,je.d],pipes:[p.d],encapsulation:2}),t})();var dl=i("Kj3r"),bl=i("jhN1");function ml(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",17),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().selectBg(i.url)})),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc();m.Pc("background","url("+t.url+")",m.Mb),m.Jb("selected",t.url===i.stepFormGroup.controls.bodyImage.value)("disabled",i.stepFormGroup.controls.bodyImage.disabled)}}function pl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",18),m.hc("click",(function(){return m.Hc(t),m.Dc(2).click()})),m.Zb(1,"input",19,20),m.hc("change",(function(e){return m.Hc(t),m.lc().uploadTrigger(e,"bg")})),m.Yb(),m.Ub(3,"i",21),m.Yb()}}let ul=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this._formBuilder=e,this.notify=i,this.sanitizer=a,this.scanPipe=n,this.http=s,this.readonlyState=!1,this.backgroundList=[],o.H.pattern(/^[a-zA-Z0-9_\-]*$/),this.stepFormGroup=this._formBuilder.group({applicationName:["",o.H.required],loginpage_message:[""],homepage_message:[""],traffic_record_summary_sheet:[""],bodyImage:["../rest/images?image=loginPage"],logo:["../rest/images?image=logo"]}),this.backgroundList=Array.from({length:16}).map((t,e)=>({filename:e+1+".jpg",url:`assets/${e+1}.jpg`}))}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){yield this.getParameters()}))}getParameters(){return new Promise(t=>{this.http.get("../rest/parameters").pipe(Object(d.a)(t=>{this.stepFormGroup.controls.homepage_message.setValue(t.parameters.filter(t=>"homepage_message"===t.id)[0].value),this.stepFormGroup.controls.loginpage_message.setValue(t.parameters.filter(t=>"loginpage_message"===t.id)[0].value),this.stepFormGroup.controls.traffic_record_summary_sheet.setValue(t.parameters.filter(t=>"traffic_record_summary_sheet"===t.id)[0].value)}),Object(q.a)(()=>this.http.get("../rest/authenticationInformations")),Object(d.a)(t=>{this.stepFormGroup.controls.applicationName.setValue(t.applicationName),setTimeout(()=>{this.stepFormGroup.controls.applicationName.valueChanges.pipe(Object(dl.a)(1e3),Object(d.a)(()=>this.saveParameter("applicationName"))).subscribe(),this.stepFormGroup.controls.homepage_message.valueChanges.pipe(Object(dl.a)(100),Object(d.a)(()=>this.saveParameter("homepage_message"))).subscribe(),this.stepFormGroup.controls.loginpage_message.valueChanges.pipe(Object(dl.a)(100),Object(d.a)(()=>this.saveParameter("loginpage_message"))).subscribe(),this.stepFormGroup.controls.traffic_record_summary_sheet.valueChanges.pipe(Object(dl.a)(100),Object(d.a)(()=>this.saveParameter("traffic_record_summary_sheet"))).subscribe(),this.initMce()},100)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}isValidStep(){return void 0!==this.stepFormGroup&&this.stepFormGroup.valid}initMce(t=!1){let e={selector:"#loginpage_message",setup:t=>{t.on("Blur",t=>{this.stepFormGroup.controls[t.target.id].setValue(tinymce.get(t.target.id).getContent())})},base_url:"../node_modules/tinymce/",height:"200",suffix:".min",language:this.translate.instant("lang.langISO").replace("-","_"),language_url:`../node_modules/tinymce-i18n/langs/${this.translate.instant("lang.langISO").replace("-","_")}.js`,menubar:!1,statusbar:!1,readonly:t,plugins:["autolink","table","code"],external_plugins:{maarch_b64image:"../../src/frontend/plugins/tinymce/maarch_b64image/plugin.min.js"},table_toolbar:"",table_sizing_mode:"relative",table_resize_bars:!1,toolbar_sticky:!0,toolbar_drawer:"floating",table_style_by_css:!0,content_style:"table td { padding: 1px; vertical-align: top; }",forced_root_block:!1,toolbar:t?"":"undo redo | fontselect fontsizeselect | bold italic underline strikethrough forecolor | table maarch_b64image |         alignleft aligncenter alignright alignjustify         bullist numlist outdent indent | removeformat code"};tinymce.init(e),e.selector="#homepage_message",tinymce.init(e),e.selector="#traffic_record_summary_sheet",e.height="500",tinymce.init(e)}uploadTrigger(t,e){if(t.target.files&&t.target.files[0]){const i=this.canUploadFile(t.target.files[0],e);if(!0===i){const i=new FileReader;i.readAsDataURL(t.target.files[0]),i.onload=t=>{if("logo"===e)this.stepFormGroup.controls.logo.setValue(t.target.result),this.saveParameter("logo");else{const e=new Image;e.onload=e=>{e.target.width<1920||e.target.height<1080?this.notify.error(this.translate.instant("lang.badImageResolution",{value1:"1920x1080"})):(this.backgroundList.push({filename:t.target.result,url:t.target.result}),this.stepFormGroup.controls.bodyImage.setValue(t.target.result),this.saveParameter("bodyImage"))},e.src=t.target.result}}}else this.notify.error(i)}}canUploadFile(t,e){const i="logo"!==e?["image/jpg","image/jpeg"]:["image/svg+xml"];if("logo"===e){if(t.size>5e6)return this.translate.instant("lang.maxFileSizeExceeded",{value1:"5mo"});if(-1===i.indexOf(t.type))return this.translate.instant("lang.onlyExtensionsAllowed",{value1:i.join(", ")})}else{if(t.size>1e7)return this.translate.instant("lang.maxFileSizeExceeded",{value1:"10mo"});if(-1===i.indexOf(t.type))return this.translate.instant("lang.onlyExtensionsAllowed",{value1:i.join(", ")})}return!0}logoURL(){return this.sanitizer.bypassSecurityTrustUrl(this.stepFormGroup.controls.logo.value)}selectBg(t){this.stepFormGroup.controls.bodyImage.disabled||(this.stepFormGroup.controls.bodyImage.setValue(t),this.saveParameter("bodyImage"))}clickLogoButton(t){this.stepFormGroup.controls.logo.disabled||t.click()}saveParameter(t){let e={};"logo"===t||"bodyImage"===t?e.image=this.stepFormGroup.controls[t].value:"applicationName"===t?e.applicationName=this.stepFormGroup.controls[t].value:e={param_value_string:this.stepFormGroup.controls[t].value},this.http.put("../rest/parameters/"+t,e).subscribe(()=>{this.notify.success(this.translate.instant("lang.parameterUpdated")),"logo"===t&&setTimeout(()=>{window.location.reload()},500)},t=>{this.notify.error(t.error.errors)})}ngOnDestroy(){tinymce.remove()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(o.g),m.Tb(y.a),m.Tb(bl.b),m.Tb(v.o),m.Tb(u.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-parameters-customization"]],features:[m.Db([v.o])],decls:44,vars:30,consts:[[2,"display","contents",3,"formGroup"],[1,"col-md-6"],["appearance","outline"],["matInput","","formControlName","applicationName"],["name","loginpage_message","id","loginpage_message","formControlName","loginpage_message",2,"padding-top","10px"],["name","homepage_message","id","homepage_message","formControlName","homepage_message",2,"padding-top","10px"],["matRipple","",2,"width","350px","background-size","100%","cursor","pointer"],[2,"width","100%",3,"src","click"],["type","file","name","files[]","accept","image/svg+xml",2,"display","none",3,"change"],["uploadLogo",""],[1,"backgroundList"],[1,"backgroundItem",2,"background","url(../rest/images?image=loginPage)","background-size","cover"],[1,"backgroundItem",2,"background","url(assets/bodylogin.jpg)","background-size","cover",3,"click"],["style","opacity: 0.3;","class","backgroundItem",3,"selected","disabled","background","click",4,"ngFor","ngForOf"],["style","opacity: 0.3;display: flex;align-items: center;justify-content: center;","class","backgroundItem",3,"click",4,"ngIf"],[1,"col-md-10",2,"margin-top","20px"],["name","traffic_record_summary_sheet","id","traffic_record_summary_sheet","formControlName","traffic_record_summary_sheet",2,"padding-top","10px"],[1,"backgroundItem",2,"opacity","0.3",3,"click"],[1,"backgroundItem",2,"opacity","0.3","display","flex","align-items","center","justify-content","center",3,"click"],["type","file","name","files[]","accept","image/jpeg",2,"display","none",3,"change"],["uploadFile",""],[1,"fa","fa-plus",2,"font-size","30px","color","#666"]],template:function(t,e){if(1&t){const t=m.ac();m.Zb(0,"form",0),m.Zb(1,"div",1),m.Zb(2,"mat-form-field",2),m.Zb(3,"mat-label"),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Ub(6,"input",3),m.Yb(),m.Zb(7,"div"),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Ub(10,"textarea",4),m.Ub(11,"br"),m.Ub(12,"br"),m.Zb(13,"div"),m.Sc(14),m.mc(15,"translate"),m.Yb(),m.Ub(16,"textarea",5),m.Ub(17,"br"),m.Ub(18,"br"),m.Yb(),m.Zb(19,"div",1),m.Zb(20,"div"),m.Sc(21),m.mc(22,"translate"),m.Yb(),m.Zb(23,"div"),m.Zb(24,"mat-card",6),m.Zb(25,"img",7),m.hc("click",(function(){m.Hc(t);const i=m.Dc(27);return e.clickLogoButton(i)})),m.Yb(),m.Zb(26,"input",8,9),m.hc("change",(function(t){return e.uploadTrigger(t,"logo")})),m.Yb(),m.Yb(),m.Yb(),m.Ub(28,"br"),m.Zb(29,"div"),m.Sc(30),m.mc(31,"translate"),m.Yb(),m.Zb(32,"div",10),m.Ub(33,"mat-card",11),m.Zb(34,"mat-card",12),m.hc("click",(function(){return e.selectBg("assets/bodylogin.jpg")})),m.Yb(),m.Qc(35,ml,1,6,"mat-card",13),m.Qc(36,pl,4,0,"mat-card",14),m.Yb(),m.Yb(),m.Zb(37,"div",15),m.Zb(38,"div"),m.Sc(39),m.mc(40,"translate"),m.Yb(),m.Ub(41,"textarea",16),m.Ub(42,"br"),m.Ub(43,"br"),m.Yb(),m.Yb()}2&t&&(m.sc("formGroup",e.stepFormGroup),m.Eb(4),m.Tc(m.nc(5,18,"lang.applicationName")),m.Eb(4),m.Uc("",m.nc(9,20,"lang.loginMsg")," : "),m.Eb(6),m.Uc("",m.nc(15,22,"lang.homeMsg")," : "),m.Eb(7),m.Uc("",m.nc(22,24,"lang.chooseLogo")," : "),m.Eb(4),m.sc("src",e.logoURL(),m.Kc),m.Eb(5),m.Uc("",m.nc(31,26,"lang.chooseLoginBg")," : "),m.Eb(3),m.Jb("disabled",e.stepFormGroup.controls.bodyImage.disabled)("selected","../rest/images?image=loginPage"===e.stepFormGroup.controls.bodyImage.value),m.Eb(1),m.Jb("disabled",e.stepFormGroup.controls.bodyImage.disabled)("selected","assets/bodylogin.jpg"===e.stepFormGroup.controls.bodyImage.value),m.Eb(1),m.sc("ngForOf",e.backgroundList),m.Eb(1),m.sc("ngIf",!e.stepFormGroup.controls.bodyImage.disabled),m.Eb(3),m.Uc("",m.nc(40,28,"lang.trafficRecordSummarySheetParameters")," : "))},directives:[o.J,o.u,o.l,w.c,w.g,O.b,o.c,o.t,o.j,k.a,I.t,x.s,x.t],pipes:[p.d],styles:[".backgroundList[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);grid-gap:10px}.selected[_ngcontent-%COMP%]{transition:all .3s;opacity:1!important;border:10px solid #f99830!important}.backgroundItem[_ngcontent-%COMP%]{border:0 solid #f99830;opacity:.5;transition:all .3s;cursor:pointer;height:120px;background-size:cover!important}.disabled[_ngcontent-%COMP%]{cursor:default!important}.backgroundItem[_ngcontent-%COMP%]:not(.disabled):hover{transition:all .3s;opacity:1!important}"]}),t})();const hl=["adminMenuTemplate"];function fl(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function gl(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function vl(t,e){1&t&&(m.Zb(0,"mat-header-cell",40),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.id")," "))}function yl(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.id," ")}}function Cl(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",40),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc(" ",m.nc(2,3,"lang.description")," ")}}function El(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.description," ")}}function Sl(t,e){1&t&&(m.Zb(0,"mat-header-cell",40),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.value")," "))}function Ml(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.value," ")}}function Yl(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Zl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",41),m.Zb(1,"button",42),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteParameter(a.id)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",43),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function xl(t,e){1&t&&m.Ub(0,"mat-header-row")}function _l(t,e){1&t&&(m.Ub(0,"mat-row",44),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/parameters/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function wl(t,e){1&t&&m.Ub(0,"app-parameters-customization")}function Ol(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",18),m.mc(3,"translate"),m.Zb(4,"div",19),m.Zb(5,"div",20),m.Zb(6,"mat-form-field"),m.Ub(7,"input",21),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Zb(9,"div",20),m.Ub(10,"mat-paginator",22,23),m.Yb(),m.Yb(),m.Zb(12,"mat-table",24,25),m.Xb(14,26),m.Qc(15,vl,3,3,"mat-header-cell",27),m.Qc(16,yl,2,1,"mat-cell",28),m.Wb(),m.Xb(17,29),m.Qc(18,Cl,3,5,"mat-header-cell",30),m.Qc(19,El,2,3,"mat-cell",31),m.Wb(),m.Xb(20,32),m.Qc(21,Sl,3,3,"mat-header-cell",27),m.Qc(22,Ml,2,1,"mat-cell",28),m.Wb(),m.Xb(23,33),m.Qc(24,Yl,1,0,"mat-header-cell",34),m.Qc(25,Zl,4,3,"mat-cell",35),m.Wb(),m.Qc(26,xl,1,0,"mat-header-row",36),m.Qc(27,_l,2,4,"mat-row",37),m.Yb(),m.Zb(28,"div",38),m.Sc(29),m.mc(30,"translate"),m.Yb(),m.Yb(),m.Zb(31,"mat-tab",18),m.mc(32,"translate"),m.Qc(33,wl,1,0,"ng-template",39),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.sc("label",m.nc(3,12,"lang.technicalParameters")),m.Eb(5),m.tc("placeholder",m.nc(8,14,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.parameters.length," ",m.nc(30,16,"lang.parameters"),""),m.Eb(2),m.sc("label",m.nc(32,18,"lang.customization"))}}let Tl=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.parameters={},this.loading=!1,this.displayedColumns=["id","description","value","actions"],this.filterColumns=["id","description","value"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.parameters")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/parameters").subscribe(t=>{this.parameters=t.parameters.filter(t=>-1===["homepage_message","loginpage_message","traffic_record_summary_sheet"].indexOf(t.id)),this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_parameters",this.parameters,this.sort,this.paginator,this.filterColumns)},0)})}deleteParameter(t){confirm(this.translate.instant("lang.deleteMsg"))&&this.http.delete("../rest/parameters/"+t).subscribe(t=>{this.parameters=t.parameters.filter(t=>-1===["homepage_message","loginpage_message","traffic_record_summary_sheet"].indexOf(t.id)),this.adminService.setDataSource("admin_parameters",this.parameters,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.parameterDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(hl,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/parameters/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"label"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","id"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","description"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","value"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["matTabContent",""],["mat-sort-header",""],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,fl,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,gl,2,0,"div",9),m.Qc(14,Ol,34,20,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,Ie.c,Ie.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Ie.b,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d,ul],pipes:[p.d],encapsulation:2}),t})();const kl=["snav2"],Il=["adminMenuTemplate"];function Dl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",16),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",17),m.Ub(5,"mat-icon",18),m.Zb(6,"p",19),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Zb(9,"a",20),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(16).toggle()})),m.Ub(10,"mat-icon",21),m.Zb(11,"p",19),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Yb()}2&t&&(m.Eb(2),m.Tc(m.nc(3,3,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,5,"lang.add")," "),m.Eb(5),m.Uc(" ",m.nc(13,7,"lang.prioritiesOrder")," "))}function Ul(t,e){1&t&&(m.Zb(0,"div",22),m.Ub(1,"mat-spinner",23),m.Yb())}function Pl(t,e){1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.technicalId")," "))}function Fl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",46),m.Zb(1,"span",47),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.Sc(2),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(2),m.Uc(" ",t.id," ")}}function Ll(t,e){1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.label")," "))}function jl(t,e){if(1&t&&(m.Zb(0,"mat-cell",46),m.Ub(1,"input",48),m.Sc(2),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.tc("value",t.color),m.Eb(1),m.Uc(" ",t.label," ")}}function Rl(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc(" ",m.nc(2,3,"lang.processDelayDay"),"")}}function Ql(t,e){if(1&t&&(m.Zb(0,"mat-cell",46),m.Zb(1,"span"),m.Sc(2),m.Yb(),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(2),m.Uc(" ",t.delays," ")}}function Al(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Hl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",49),m.Zb(1,"button",50),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deletePriority(a.id)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",51),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function $l(t,e){1&t&&m.Ub(0,"mat-header-row")}function zl(t,e){1&t&&(m.Ub(0,"mat-row",52),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/priorities/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Vl(t,e){if(1&t&&(m.Zb(0,"mat-card",24),m.Zb(1,"div",25),m.Zb(2,"div",26),m.Zb(3,"mat-form-field"),m.Ub(4,"input",27),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",26),m.Ub(7,"mat-paginator",28,29),m.Yb(),m.Yb(),m.Zb(9,"mat-table",30,31),m.Xb(11,32),m.Qc(12,Pl,3,3,"mat-header-cell",33),m.Qc(13,Fl,3,1,"mat-cell",34),m.Wb(),m.Xb(14,35),m.Qc(15,Ll,3,3,"mat-header-cell",33),m.Qc(16,jl,3,2,"mat-cell",34),m.Wb(),m.Xb(17,36),m.Qc(18,Rl,3,5,"mat-header-cell",37),m.Qc(19,Ql,3,3,"mat-cell",38),m.Wb(),m.Xb(20,39),m.Qc(21,Al,1,0,"mat-header-cell",40),m.Qc(22,Hl,4,3,"mat-cell",41),m.Wb(),m.Qc(23,$l,1,0,"mat-header-row",42),m.Qc(24,zl,2,4,"mat-row",43),m.Yb(),m.Zb(25,"div",44),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.priorities.length," ",m.nc(27,12,"lang.priorities"),"")}}function Nl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",53),m.hc("onDropSuccess",(function(){return m.Hc(t),m.lc().updatePrioritiesOrder()})),m.mc(1,"translate"),m.Ub(2,"mat-icon",54),m.Zb(3,"p",19),m.Sc(4),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=e.index;m.tc("title",m.nc(1,4,"lang.move")),m.sc("sortableIndex",i),m.Eb(4),m.Vc("",i+1," - ",t.label,"")}}const Jl=function(){return["boxers-zone"]};let Gl=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.loading=!1,this.priorities=[],this.prioritiesOrder=[],this.displayedColumns=["id","label","delays","actions"],this.filterColumns=["id","label","delays"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.prioritiesAlt")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/priorities").subscribe(t=>{this.priorities=t.priorities,this.loading=!1,this.http.get("../rest/sortedPriorities").subscribe(t=>{this.prioritiesOrder=t.priorities},t=>{this.notify.handleErrors(t)}),setTimeout(()=>{this.adminService.setDataSource("admin_priorities",this.priorities,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.handleErrors(t)})}deletePriority(t){confirm(this.translate.instant("lang.deleteMsg"))&&this.http.delete("../rest/priorities/"+t).subscribe(t=>{this.priorities=t.priorities,this.adminService.setDataSource("admin_priorities",this.priorities,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.priorityDeleted"))},t=>{this.notify.error(t.error.errors)})}updatePrioritiesOrder(){this.http.put("../rest/sortedPriorities",this.prioritiesOrder).subscribe(t=>{this.prioritiesOrder=t.priorities,this.notify.success(this.translate.instant("lang.modificationSaved"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(kl,!0),m.Oc(Il,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:23,vars:18,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",3,"mode","fixedInViewport","opened"],["snav2",""],[2,"font-size","15px","padding","5px"],["dnd-sortable-container","",3,"dropZones","sortableData"],["disableRipple","true","dnd-sortable","",3,"title","sortableIndex","onDropSuccess",4,"ngFor","ngForOf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/priorities/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fa","fa-list-ol"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","id"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","label"],["matColumnDef","delays"],["mat-sort-header","","style","flex:2;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:2;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],[3,"click"],["type","color","disabled","",2,"background","none","border","none","width","45px",3,"value"],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"],["disableRipple","true","dnd-sortable","",3,"title","sortableIndex","onDropSuccess"],["color","primary","mat-list-icon","",1,"fa","fa-inbox"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Dl,14,9,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Ul,2,0,"div",9),m.Qc(14,Vl,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"p",13),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Zb(20,"mat-list"),m.Zb(21,"span",14),m.Qc(22,Nl,5,6,"mat-list-item",15),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1)),m.Eb(3),m.Uc(" ",m.nc(19,15,"lang.prioritiesHelpDesc")," "),m.Eb(3),m.sc("dropZones",m.yc(17,Jl))("sortableData",e.prioritiesOrder),m.Eb(1),m.sc("ngForOf",e.prioritiesOrder))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Le.f,x.s,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d,Le.e],pipes:[p.d],encapsulation:2}),t})();function Bl(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function Wl(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Zb(1,"form",13,14),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(3,"div",15),m.Zb(4,"div",16),m.Zb(5,"div",17),m.Zb(6,"mat-form-field"),m.Zb(7,"input",18),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().priority.color=e})),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(9,"div",19),m.Zb(10,"mat-form-field"),m.Zb(11,"input",20),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().priority.label=e})),m.mc(12,"translate"),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(14,"div",15),m.Zb(15,"div",21),m.Zb(16,"mat-form-field"),m.Zb(17,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().priority.delays=e})),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(19,"div",15),m.Zb(20,"div",23),m.Zb(21,"button",24),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.lc();m.Eb(7),m.tc("matTooltip",m.nc(8,9,"lang.chooseColor")),m.sc("ngModel",e.priority.color),m.Eb(4),m.tc("title",m.nc(12,11,"lang.label")),m.tc("placeholder",m.nc(13,13,"lang.label")),m.sc("ngModel",e.priority.label),m.Eb(6),m.tc("placeholder",m.nc(18,15,"lang.processDelayDay")),m.sc("ngModel",e.priority.delays),m.Eb(4),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(23,17,"lang.save"))}}let ql=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.loading=!1,this.priority={color:"#135f7f",delays:"0"}}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.priorityCreation")),this.creationMode=!0,this.loading=!1):(this.creationMode=!1,this.id=t.id,this.http.get("../rest/priorities/"+this.id).subscribe(t=>{this.priority=t.priority,this.headerService.setHeader(this.translate.instant("lang.priorityModification"),this.priority.label),this.loading=!1},t=>{this.notify.handleErrors(t)}))})}onSubmit(){this.creationMode?this.http.post("../rest/priorities",this.priority).subscribe(()=>{this.notify.success(this.translate.instant("lang.priorityAdded")),this.router.navigate(["/administration/priorities"])},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/priorities/"+this.id,this.priority).subscribe(()=>{this.notify.success(this.translate.instant("lang.priorityUpdated")),this.router.navigate(["/administration/priorities"])},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"form-horizontal",3,"ngSubmit"],["priorityForm","ngForm"],[1,"form-group"],[1,"row",2,"margin","0px"],[1,"col-md-1","col-xs-2"],["matInput","","type","color","name","color","required","",3,"matTooltip","ngModel","ngModelChange"],[1,"col-md-11","col-xs-10"],["matInput","","type","text","name","label","maxlength","128","required","",3,"title","placeholder","ngModel","ngModelChange"],[1,"col-md-4"],["matInput","","type","number","name","delays","required","","pattern","^\\d+$",3,"placeholder","ngModel","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,Bl,2,0,"div",8),m.Qc(12,Wl,24,19,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.E,It.b,o.t,o.w,o.o,o.z,o.A,D.b],pipes:[p.d],encapsulation:2}),t})();const Xl=["snav2"],Kl=["adminMenuTemplate"];function td(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",14),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",35),m.Ub(5,"mat-icon",36),m.Zb(6,"p",37),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Zb(9,"a",38),m.hc("click",(function(){m.Hc(t);const e=m.lc(),i=m.Dc(16);return e.loadCron(),i.toggle()}))("next",(function(){m.Hc(t);const e=m.lc();return m.Dc(16).open(),e.paramCron()})),m.Ub(10,"mat-icon",39),m.Zb(11,"p",37),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Yb()}2&t&&(m.Eb(2),m.Tc(m.nc(3,3,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,5,"lang.add")," "),m.Eb(5),m.Uc(" ",m.nc(13,7,"lang.toSchedule")," "))}function ed(t,e){1&t&&(m.Zb(0,"div",40),m.Ub(1,"mat-spinner",41),m.Yb())}function id(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",64),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.id"))}}function ad(t,e){if(1&t&&(m.Zb(0,"mat-cell",65),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.notification_id," ")}}function nd(t,e){1&t&&(m.Zb(0,"mat-header-cell",66),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.description")," "))}function sd(t,e){if(1&t&&(m.Zb(0,"mat-cell",67),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.description," ")}}function cd(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",64),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.status"))}}function od(t,e){1&t&&(m.Zb(0,"span",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.active")))}function rd(t,e){1&t&&(m.Zb(0,"span",72),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.suspended")))}function ld(t,e){if(1&t&&(m.Zb(0,"mat-cell",68),m.mc(1,"translate"),m.Qc(2,od,3,3,"span",69),m.Qc(3,rd,3,3,"span",70),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.tc("matTooltip",m.nc(1,5,"lang.view")),m.Eb(2),m.sc("ngIf","Y"==t.is_enabled),m.Eb(1),m.sc("ngIf","N"==t.is_enabled)}}function dd(t,e){1&t&&m.Ub(0,"mat-header-cell",65)}function bd(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",73),m.Zb(1,"button",74),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteNotification(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",75),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function md(t,e){1&t&&m.Ub(0,"mat-header-row")}function pd(t,e){if(1&t&&(m.Ub(0,"mat-row",76),m.mc(1,"translate")),2&t){const t=e.$implicit;m.uc("routerLink","/administration/notifications/",t.notification_sid,""),m.tc("matTooltip",m.nc(1,3,"lang.view")),m.sc("joyrideStep",t.notification_id+"_Tour")}}function ud(t,e){if(1&t&&(m.Zb(0,"mat-card",42),m.Zb(1,"div",43),m.Zb(2,"div",44),m.Zb(3,"mat-form-field"),m.Ub(4,"input",45),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",44),m.Ub(7,"mat-paginator",46,47),m.Yb(),m.Yb(),m.Zb(9,"mat-table",48,49),m.Xb(11,50),m.Qc(12,id,3,5,"mat-header-cell",51),m.Qc(13,ad,2,3,"mat-cell",52),m.Wb(),m.Xb(14,53),m.Qc(15,nd,3,3,"mat-header-cell",54),m.Qc(16,sd,2,1,"mat-cell",55),m.Wb(),m.Xb(17,56),m.Qc(18,cd,3,5,"mat-header-cell",51),m.Qc(19,ld,4,7,"mat-cell",57),m.Wb(),m.Xb(20,58),m.Qc(21,dd,1,0,"mat-header-cell",59),m.Qc(22,bd,4,3,"mat-cell",60),m.Wb(),m.Qc(23,md,1,0,"mat-header-row",61),m.Qc(24,pd,2,5,"mat-row",62),m.Yb(),m.Zb(25,"div",63),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.notifications.length," ",m.nc(27,12,"lang.notifications"),"")}}function hd(t,e){if(1&t&&(m.Zb(0,"mat-option",77),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",t.label," ")}}function fd(t,e){if(1&t&&(m.Zb(0,"mat-option",77),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",t.label," ")}}function gd(t,e){if(1&t&&(m.Zb(0,"mat-option",77),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",t.label," ")}}function vd(t,e){if(1&t&&(m.Zb(0,"mat-option",77),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",t.label," ")}}function yd(t,e){if(1&t&&(m.Zb(0,"mat-option",77),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.value),m.Eb(1),m.Uc(" ",t.label," ")}}function Cd(t,e){if(1&t&&(m.Zb(0,"mat-option",77),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.path),m.Eb(1),m.Uc(" ",t.description," ")}}function Ed(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",79),m.hc("removed",(function(){m.Hc(t);const e=m.lc().index;return m.lc().deleteCron(e)})),m.Sc(1),m.Ub(2,"span",80),m.Zb(3,"b"),m.Sc(4),m.Yb(),m.Ub(5,"mat-icon",81),m.mc(6,"translate"),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(1),m.Uc(" ",t.description," "),m.Eb(3),m.Yc("",t.m,"\xa0\xa0",t.h,"\xa0\xa0",t.dom,"\xa0\xa0",t.mon,"\xa0\xa0",t.dow,""),m.Eb(1),m.tc("matTooltip",m.nc(6,7,"lang.delete"))}}function Sd(t,e){if(1&t&&(m.Zb(0,"span"),m.Qc(1,Ed,7,9,"mat-chip",78),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","normal"==t.state)}}let Md=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.notifications=[],this.loading=!1,this.months=[],this.dom=[],this.dow=[],this.newCron={m:"",h:"",dom:"",mon:"",cmd:"",state:"normal"},this.displayedColumns=["notification_id","description","is_enabled","notifications"],this.filterColumns=["notification_id","description"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.notifications")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/notifications").subscribe(t=>{this.notifications=t.notifications,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_notif",this.notifications,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.error(t.error.errors)})}deleteNotification(t){confirm(this.translate.instant("lang.deleteMsg"))&&this.http.delete("../rest/notifications/"+t.notification_sid).subscribe(t=>{this.notifications=t.notifications,setTimeout(()=>{this.adminService.setDataSource("admin_notif",this.notifications,this.sort,this.paginator,this.filterColumns)},0),this.sidenavRight.close(),this.notify.success(this.translate.instant("lang.notificationDeleted"))},t=>{this.notify.error(t.error.errors)})}loadCron(){return new Promise(t=>{this.hours=[{label:this.translate.instant("lang.eachHour"),value:"*"}],this.minutes=[{label:this.translate.instant("lang.eachMinute"),value:"*"}],this.months=[{label:this.translate.instant("lang.eachMonth"),value:"*"},{label:this.translate.instant("lang.january"),value:"1"},{label:this.translate.instant("lang.february"),value:"2"},{label:this.translate.instant("lang.march"),value:"3"},{label:this.translate.instant("lang.april"),value:"4"},{label:this.translate.instant("lang.may"),value:"5"},{label:this.translate.instant("lang.june"),value:"6"},{label:this.translate.instant("lang.july"),value:"7"},{label:this.translate.instant("lang.august"),value:"8"},{label:this.translate.instant("lang.september"),value:"9"},{label:this.translate.instant("lang.october"),value:"10"},{label:this.translate.instant("lang.november"),value:"11"},{label:this.translate.instant("lang.december"),value:"12"}],this.dom=[{label:this.translate.instant("lang.notUsed"),value:"*"}],this.dow=[{label:this.translate.instant("lang.eachDay"),value:"*"},{label:this.translate.instant("lang.monday"),value:"1"},{label:this.translate.instant("lang.tuesday"),value:"2"},{label:this.translate.instant("lang.wednesday"),value:"3"},{label:this.translate.instant("lang.thursday"),value:"4"},{label:this.translate.instant("lang.friday"),value:"5"},{label:this.translate.instant("lang.saturday"),value:"6"},{label:this.translate.instant("lang.sunday"),value:"7"}],this.newCron={m:"",h:"",dom:"",mon:"",cmd:"",state:"normal"};for(let e=0;e<=23;e++)this.hours.push({label:e,value:String(e)});for(let e=0;e<=59;e++)this.minutes.push({label:e,value:String(e)});for(let e=1;e<=31;e++)this.dom.push({label:e,value:String(e)});this.http.get("../rest/notifications/schedule").pipe(Object(Zt.tap)(t=>{this.crontab=t.crontab,this.authorizedNotification=t.authorizedNotification}),Object(vt.a)(()=>t(!0)),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}saveCron(){const t=this.newCron.cmd.split("/");this.newCron.description=t[t.length-1],this.crontab.push(this.newCron),this.http.post("../rest/notifications/schedule",this.crontab).subscribe(t=>{this.newCron={m:"",h:"",dom:"",mon:"",cmd:"",description:"",state:"normal"},this.notify.success(this.translate.instant("lang.notificationScheduleUpdated"))},t=>{this.crontab.pop(),this.notify.error(t.error.errors)})}deleteCron(t){this.crontab[t].state="deleted",this.http.post("../rest/notifications/schedule",this.crontab).subscribe(e=>{this.crontab.splice(t,1),this.notify.success(this.translate.instant("lang.notificationScheduleUpdated"))},t=>{this.notify.error(t.error.errors)})}onNext(){return console.log("next"),this.sidenavRight.open(),!1}paramCron(){return Object(gt.a)(this,void 0,void 0,(function*(){yield this.loadCron();const t=this.authorizedNotification.filter(t=>t.path.indexOf("_BASKETS.sh")>-1)[0];this.newCron={m:"0",h:"8",dom:"*",dow:"*",mon:"*",cmd:t.path,description:t.description,state:"normal"}}))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Xl,!0),m.Oc(Kl,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:76,vars:73,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",3,"mode","fixedInViewport","opened","next"],["snav2",""],["joyrideStep","notifTour3",3,"next"],["mat-subheader",""],[1,"form-horizontal",2,"overflow","hidden"],["notifForm","ngForm"],[1,"form-group",2,"padding-left","15px","padding-right","15px"],[1,"col-sm-4"],["name","hour","id","hour","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","minute","id","minute","required","",3,"title","placeholder","ngModel","ngModelChange"],["name","day","id","day","required","",3,"title","placeholder","ngModel","ngModelChange"],[1,"col-sm-6"],["name","month","id","month","required","",3,"title","placeholder","ngModel","ngModelChange"],["name","dayM","id","dayM","required","",3,"title","placeholder","ngModel","ngModelChange"],[1,"col-sm-12"],["name","script","id","script","required","",3,"title","placeholder","ngModel","ngModelChange"],[1,"col-sm-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled","click"],["role","alert",1,"alert","alert-info",2,"margin","15px"],["joyrideStep","notifTour4"],[1,"mat-chip-list-stacked"],["chipList",""],[4,"ngFor","ngForOf"],["mat-list-item","","routerLink","/administration/notifications/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","","joyrideStep","notifTour",3,"click","next"],["color","primary","mat-list-icon","",1,"fa","fa-clock"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","notification_id"],["mat-sort-header","","style","flex:1;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:1;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","description"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","is_enabled"],["style","flex:1;",3,"matTooltip","hide-for-mobile",4,"matCellDef"],["matColumnDef","notifications"],["style","flex:1;",4,"matHeaderCellDef"],["style","justify-content: flex-end;flex:1;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip","joyrideStep",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header","",2,"flex","1"],[2,"flex","1"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],[2,"flex","1",3,"matTooltip"],["color","primary","class","label",4,"ngIf"],["color","warn","class","label",4,"ngIf"],["color","primary",1,"label"],["color","warn",1,"label"],[2,"justify-content","flex-end","flex","1"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip","joyrideStep"],[3,"value"],["color","primary","style","margin:5px;border-radius:0px;display:flex;","selectable","false","removable","true",3,"removed",4,"ngIf"],["color","primary","selectable","false","removable","true",2,"margin","5px","border-radius","0px","display","flex",3,"removed"],[2,"flex","1 1 auto"],["matChipRemove","","color","warn",1,"fa","fa-times",3,"matTooltip"]],template:function(t,e){if(1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,td,14,9,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,ed,2,0,"div",9),m.Qc(14,ud,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.hc("next",(function(){return e.paramCron()})),m.Zb(17,"mat-list",13),m.hc("next",(function(){return e.saveCron()})),m.Zb(18,"h3",14),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"form",15,16),m.Zb(23,"div",17),m.Zb(24,"div",18),m.Zb(25,"mat-form-field"),m.Zb(26,"mat-select",19),m.hc("ngModelChange",(function(t){return e.newCron.h=t})),m.mc(27,"translate"),m.mc(28,"translate"),m.Qc(29,hd,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Zb(30,"div",18),m.Zb(31,"mat-form-field"),m.Zb(32,"mat-select",21),m.hc("ngModelChange",(function(t){return e.newCron.m=t})),m.mc(33,"translate"),m.mc(34,"translate"),m.Qc(35,fd,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Zb(36,"div",18),m.Zb(37,"mat-form-field"),m.Zb(38,"mat-select",22),m.hc("ngModelChange",(function(t){return e.newCron.dow=t})),m.mc(39,"translate"),m.mc(40,"translate"),m.Qc(41,gd,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(42,"div",17),m.Zb(43,"div",23),m.Zb(44,"mat-form-field"),m.Zb(45,"mat-select",24),m.hc("ngModelChange",(function(t){return e.newCron.mon=t})),m.mc(46,"translate"),m.mc(47,"translate"),m.Qc(48,vd,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Zb(49,"div",23),m.Zb(50,"mat-form-field"),m.Zb(51,"mat-select",25),m.hc("ngModelChange",(function(t){return e.newCron.dom=t})),m.mc(52,"translate"),m.mc(53,"translate"),m.Qc(54,yd,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Zb(55,"div",26),m.Zb(56,"mat-form-field"),m.Zb(57,"mat-select",27),m.hc("ngModelChange",(function(t){return e.newCron.cmd=t})),m.mc(58,"translate"),m.mc(59,"translate"),m.Qc(60,Cd,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Zb(61,"div",28),m.Zb(62,"button",29),m.hc("click",(function(){return e.saveCron()})),m.Sc(63),m.mc(64,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(65,"mat-divider"),m.Zb(66,"div",30),m.Sc(67),m.mc(68,"translate"),m.Yb(),m.Zb(69,"mat-list",31),m.Zb(70,"h3",14),m.Sc(71),m.mc(72,"translate"),m.Yb(),m.Zb(73,"mat-chip-list",32,33),m.Qc(75,Sd,2,1,"span",34),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(22);m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1)),m.Eb(4),m.Tc(m.nc(20,41,"lang.notificationSchedule")),m.Eb(7),m.tc("title",m.nc(27,43,"lang.hour")),m.tc("placeholder",m.nc(28,45,"lang.hour")),m.sc("ngModel",e.newCron.h),m.Eb(3),m.sc("ngForOf",e.hours),m.Eb(3),m.tc("title",m.nc(33,47,"lang.minute")),m.tc("placeholder",m.nc(34,49,"lang.minute")),m.sc("ngModel",e.newCron.m),m.Eb(3),m.sc("ngForOf",e.minutes),m.Eb(3),m.tc("title",m.nc(39,51,"lang.day")),m.tc("placeholder",m.nc(40,53,"lang.day")),m.sc("ngModel",e.newCron.dow),m.Eb(3),m.sc("ngForOf",e.dow),m.Eb(4),m.tc("title",m.nc(46,55,"lang.month")),m.tc("placeholder",m.nc(47,57,"lang.month")),m.sc("ngModel",e.newCron.mon),m.Eb(3),m.sc("ngForOf",e.months),m.Eb(3),m.tc("title",m.nc(52,59,"lang.dayOfMonth")),m.tc("placeholder",m.nc(53,61,"lang.dayOfMonth")),m.sc("ngModel",e.newCron.dom),m.Eb(3),m.sc("ngForOf",e.dom),m.Eb(3),m.tc("title",m.nc(58,63,"lang.script")),m.tc("placeholder",m.nc(59,65,"lang.script")),m.sc("ngModel",e.newCron.cmd),m.Eb(3),m.sc("ngForOf",e.authorizedNotification),m.Eb(2),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(64,67,"lang.save")),m.Eb(4),m.Uc(" ",m.nc(68,69,"lang.NotificationScheduleInfo")," "),m.Eb(4),m.Tc(m.nc(72,71,"lang.activeCron")),m.Eb(4),m.sc("ngForOf",e.crontab)}},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Y.a,Ot.g,o.J,o.u,o.v,w.c,at.a,o.E,o.t,o.w,x.s,D.b,_.a,An.d,Ot.h,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,O.b,o.c,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,It.b,G.j,G.l,s.d,I.o,An.a,An.e],pipes:[p.d],encapsulation:2}),t})();const Yd=["adminMenuTemplate"];function Zd(t,e){1&t&&(m.Zb(0,"h3",14),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.actions")))}function xd(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",15),m.hc("click",(function(){return m.Hc(t),m.lc(2).createScript()}))("next",(function(){return m.Hc(t),m.lc(2).createScript()})),m.Ub(1,"mat-icon",16),m.Zb(2,"p",17),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.createScriptNotification")," "))}function _d(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",18),m.hc("click",(function(){return m.Hc(t),m.lc(2).toggleNotif()})),m.Ub(1,"mat-icon",19),m.Zb(2,"p",17),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.activateNotification")," "))}function wd(t,e){if(1&t){const t=m.ac();m.Zb(0,"a",18),m.hc("click",(function(){return m.Hc(t),m.lc(2).toggleNotif()})),m.Ub(1,"mat-icon",20),m.Zb(2,"p",17),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb()}2&t&&(m.Eb(3),m.Uc(" ",m.nc(4,1,"lang.suspendNotification")," "))}function Od(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,Zd,3,3,"h3",11),m.Qc(2,xd,5,3,"a",12),m.Qc(3,_d,5,3,"a",13),m.Qc(4,wd,5,3,"a",13),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngIf",!t.creationMode),m.Eb(1),m.sc("ngIf",!t.creationMode&&!t.loading&&!t.notification.scriptcreated),m.Eb(1),m.sc("ngIf",!t.creationMode&&!t.loading&&"N"==t.notification.is_enabled),m.Eb(1),m.sc("ngIf",!t.creationMode&&!t.loading&&"Y"==t.notification.is_enabled)}}function Td(t,e){1&t&&(m.Zb(0,"div",21),m.Ub(1,"mat-spinner",22),m.Yb())}function kd(t,e){1&t&&(m.Zb(0,"div",46),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.suspended"),""))}function Id(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Ub(1,"mat-icon",49),m.Sc(2),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(2),m.Uc(" ",t.label_action," ")}}function Dd(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Id,3,2,"mat-option",47),m.Wb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.sc("ngIf",!i.isNumber(t.id))}}function Ud(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Ub(1,"mat-icon",50),m.Sc(2),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(2),m.Uc(" ",t.label_action," ")}}function Pd(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Ud,3,2,"mat-option",47),m.Wb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.sc("ngIf",i.isNumber(t.id))}}function Fd(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.template_id),m.Eb(1),m.Uc(" ",t.template_label," ")}}function Ld(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(t.label)}}function jd(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Ld,2,2,"mat-option",47),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","dest_user"==t.id)}}function Rd(t,e){if(1&t&&(m.Zb(0,"mat-optgroup",32),m.mc(1,"translate"),m.Qc(2,jd,2,1,"ng-container",33),m.Yb()),2&t){const t=m.lc(2);m.uc("label","",m.nc(1,2,"lang.memberUserDest")," :"),m.Eb(2),m.sc("ngForOf",t.notification.data.diffusionType)}}function Qd(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(t.label)}}function Ad(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Qd,2,2,"mat-option",47),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","copy_list"==t.id)}}function Hd(t,e){if(1&t&&(m.Zb(0,"mat-optgroup",32),m.mc(1,"translate"),m.Qc(2,Ad,2,1,"ng-container",33),m.Yb()),2&t){const t=m.lc(2);m.uc("label","",m.nc(1,2,"lang.memberUsersCopy")," :"),m.Eb(2),m.sc("ngForOf",t.notification.data.diffusionType)}}function $d(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(t.label)}}function zd(t,e){if(1&t&&(m.Xb(0),m.Qc(1,$d,2,2,"mat-option",47),m.Wb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.sc("ngIf","group"==t.id||"entity"==t.id&&"baskets"!=i.notification.event_id||"user"==t.id&&"baskets"!=i.notification.event_id)}}function Vd(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(t.label)}}function Nd(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Vd,2,2,"mat-option",47),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","group"!=t.id&&"entity"!=t.id&&"user"!=t.id&&"copy_list"!=t.id&&"group"!=t.id&&"dest_user"!=t.id)}}function Jd(t,e){if(1&t&&(m.Zb(0,"mat-optgroup",32),m.mc(1,"translate"),m.Qc(2,Nd,2,1,"ng-container",33),m.Yb()),2&t){const t=m.lc(2);m.uc("label","",m.nc(1,2,"lang.others")," :"),m.Eb(2),m.sc("ngForOf",t.notification.data.diffusionType)}}function Gd(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.group_id),m.Eb(1),m.Uc(" ",t.group_desc," ")}}function Bd(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-select",51),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).notification.diffusion_properties=e})),m.mc(2,"translate"),m.mc(3,"translate"),m.Qc(4,Gd,2,2,"mat-option",36),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.tc("title",m.nc(2,4,"lang.memberDiffTypeUsers")),m.tc("placeholder",m.nc(3,6,"lang.memberDiffTypeUsers")),m.sc("ngModel",t.notification.diffusion_properties),m.Eb(3),m.sc("ngForOf",t.notification.data.groups)}}function Wd(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function qd(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-select",51),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).notification.diffusion_properties=e})),m.mc(2,"translate"),m.mc(3,"translate"),m.Qc(4,Wd,2,2,"mat-option",36),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.tc("title",m.nc(2,4,"lang.memberDiffTypeUsers")),m.tc("placeholder",m.nc(3,6,"lang.memberDiffTypeUsers")),m.sc("ngModel",t.notification.diffusion_properties),m.Eb(3),m.sc("ngForOf",t.notification.data.users)}}function Xd(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.entity_id),m.Eb(1),m.Uc(" ",t.entity_label," ")}}function Kd(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-select",51),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).notification.diffusion_properties=e})),m.mc(2,"translate"),m.mc(3,"translate"),m.Qc(4,Xd,2,2,"mat-option",36),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.tc("title",m.nc(2,4,"lang.memberDiffTypeUsers")),m.tc("placeholder",m.nc(3,6,"lang.memberDiffTypeUsers")),m.sc("ngModel",t.notification.diffusion_properties),m.Eb(3),m.sc("ngForOf",t.notification.data.entities)}}function tb(t,e){if(1&t&&(m.Zb(0,"mat-option",48),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label_status," ")}}function eb(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-select",52),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).notification.diffusion_properties=e})),m.mc(2,"translate"),m.mc(3,"translate"),m.mc(4,"translate"),m.Qc(5,tb,2,2,"mat-option",36),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.uc("title","",m.nc(2,5,"lang.selectedDocumentStatus")," (optionnel)"),m.vc("placeholder","",m.nc(3,7,"lang.selectedDocumentStatus")," (",m.nc(4,9,"lang.optional"),")"),m.sc("ngModel",t.notification.diffusion_properties),m.Eb(4),m.sc("ngForOf",t.notification.data.status)}}function ib(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",23),m.Qc(1,kd,3,3,"div",24),m.Zb(2,"form",25,26),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(4,"div",27),m.Zb(5,"div",28),m.Zb(6,"mat-form-field"),m.Zb(7,"input",29),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().notification.notification_id=e})),m.mc(8,"translate"),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(10,"div",27),m.Zb(11,"div",28),m.Zb(12,"mat-form-field"),m.Zb(13,"input",30),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().notification.description=e})),m.mc(14,"translate"),m.mc(15,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(16,"div",27),m.Zb(17,"div",28),m.Zb(18,"mat-form-field"),m.Zb(19,"mat-select",31),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().notification.event_id=e})),m.mc(20,"translate"),m.mc(21,"translate"),m.Zb(22,"mat-optgroup",32),m.mc(23,"translate"),m.Qc(24,Dd,2,1,"ng-container",33),m.Yb(),m.Zb(25,"mat-optgroup",32),m.mc(26,"translate"),m.Qc(27,Pd,2,1,"ng-container",33),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(28,"div",27),m.Zb(29,"div",34),m.Zb(30,"mat-form-field"),m.Zb(31,"mat-select",35),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().notification.template_id=e})),m.mc(32,"translate"),m.mc(33,"translate"),m.Qc(34,Fd,2,2,"mat-option",36),m.Yb(),m.Yb(),m.Yb(),m.Zb(35,"div",37),m.Zb(36,"mat-form-field"),m.Zb(37,"mat-select",38),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().notification.attachfor_type=e})),m.mc(38,"translate"),m.mc(39,"translate"),m.Zb(40,"mat-option",39),m.Sc(41),m.mc(42,"translate"),m.Yb(),m.Zb(43,"mat-option",40),m.Sc(44),m.mc(45,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(46,"div",27),m.Zb(47,"div",37),m.Zb(48,"mat-form-field"),m.Zb(49,"mat-select",41),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().notification.diffusion_type=e})),m.mc(50,"translate"),m.mc(51,"translate"),m.Qc(52,Rd,3,4,"mat-optgroup",42),m.Qc(53,Hd,3,4,"mat-optgroup",42),m.Zb(54,"mat-optgroup",32),m.mc(55,"translate"),m.Qc(56,zd,2,1,"ng-container",33),m.Yb(),m.Qc(57,Jd,3,4,"mat-optgroup",42),m.Yb(),m.Yb(),m.Yb(),m.Zb(58,"div",34),m.Qc(59,Bd,5,8,"mat-form-field",43),m.Qc(60,qd,5,8,"mat-form-field",43),m.Qc(61,Kd,5,8,"mat-form-field",43),m.Qc(62,eb,6,11,"mat-form-field",43),m.Yb(),m.Yb(),m.Zb(63,"div",27),m.Zb(64,"div",44),m.Zb(65,"button",45),m.Sc(66),m.mc(67,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(3),e=m.lc();m.Eb(1),m.sc("ngIf","N"==e.notification.is_enabled),m.Eb(6),m.tc("title",m.nc(8,38,"lang.id")),m.tc("placeholder",m.nc(9,40,"lang.id")),m.sc("ngModel",e.notification.notification_id)("disabled",!e.creationMode),m.Eb(6),m.tc("title",m.nc(14,42,"lang.description")),m.tc("placeholder",m.nc(15,44,"lang.description")),m.sc("ngModel",e.notification.description),m.Eb(6),m.tc("title",m.nc(20,46,"lang.NotificationEvent")),m.tc("placeholder",m.nc(21,48,"lang.NotificationEvent")),m.sc("ngModel",e.notification.event_id),m.Eb(3),m.uc("label","",m.nc(23,50,"lang.triggerSystem")," :"),m.Eb(2),m.sc("ngForOf",e.notification.data.event),m.Eb(1),m.uc("label","",m.nc(26,52,"lang.triggerAction")," :"),m.Eb(2),m.sc("ngForOf",e.notification.data.event),m.Eb(4),m.tc("title",m.nc(32,54,"lang.notificationModel")),m.tc("placeholder",m.nc(33,56,"lang.notificationModel")),m.sc("ngModel",e.notification.template_id),m.Eb(3),m.sc("ngForOf",e.notification.data.template),m.Eb(3),m.tc("title",m.nc(38,58,"lang.attachment")),m.tc("placeholder",m.nc(39,60,"lang.attachment")),m.sc("ngModel",e.notification.attachfor_type),m.Eb(4),m.Uc(" ",m.nc(42,62,"lang.noAttachment")," "),m.Eb(3),m.Uc(" ",m.nc(45,64,"lang.notificationJoinDocument")," "),m.Eb(5),m.tc("title",m.nc(50,66,"lang.sendTo")),m.tc("placeholder",m.nc(51,68,"lang.sendTo")),m.sc("ngModel",e.notification.diffusion_type),m.Eb(3),m.sc("ngIf","baskets"!=e.notification.event_id),m.Eb(1),m.sc("ngIf","baskets"!=e.notification.event_id),m.Eb(1),m.uc("label","",m.nc(55,70,"lang.memberAllUsers")," :"),m.Eb(2),m.sc("ngForOf",e.notification.data.diffusionType),m.Eb(1),m.sc("ngIf","baskets"!=e.notification.event_id),m.Eb(2),m.sc("ngIf","group"==e.notification.diffusion_type),m.Eb(1),m.sc("ngIf","user"==e.notification.diffusion_type),m.Eb(1),m.sc("ngIf","entity"==e.notification.diffusion_type),m.Eb(1),m.sc("ngIf","dest_user"==e.notification.diffusion_type||"copy_list"==e.notification.diffusion_type||"dest_entity"==e.notification.diffusion_type||"dest_user_visa"==e.notification.diffusion_type||"dest_user_sign"==e.notification.diffusion_type),m.Eb(3),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(67,72,"lang.save"))}}let ab=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.viewContainerRef=o,this.notification={diffusionType_label:null},this.loading=!1}ngOnInit(){this.loading=!0,this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.route.params.subscribe(t=>{void 0===t.identifier?(this.headerService.setHeader(this.translate.instant("lang.notificationCreation")),this.creationMode=!0,this.http.get("../rest/administration/notifications/new").subscribe(t=>{this.notification=t.notification,this.notification.attachfor_properties=[],this.loading=!1},t=>{this.notify.error(t.error.errors)})):(this.creationMode=!1,this.http.get("../rest/notifications/"+t.identifier).subscribe(t=>{this.headerService.setHeader(this.translate.instant("lang.notificationModification"),t.notification.description),this.notification=t.notification,this.notification.attachfor_properties=[],this.loading=!1},t=>{this.notify.error(t.error.errors)}))})}createScript(){this.http.post("../rest/scriptNotification",this.notification).subscribe(t=>{this.notification.scriptcreated=t,this.notify.success(this.translate.instant("lang.scriptCreated"))},t=>{this.notify.error(t.error.errors)})}onSubmit(){this.creationMode?(this.notification.is_enabled="Y",this.http.post("../rest/notifications",this.notification).subscribe(t=>{this.router.navigate(["/administration/notifications"]),this.notify.success(this.translate.instant("lang.notificationAdded"))},t=>{this.notify.error(t.error.errors)})):this.http.put("../rest/notifications/"+this.notification.notification_sid,this.notification).subscribe(t=>{this.router.navigate(["/administration/notifications"]),this.notify.success(this.translate.instant("lang.notificationUpdated"))},t=>{this.notify.error(t.error.errors)})}toggleNotif(){this.notification.is_enabled="Y"===this.notification.is_enabled?"N":"Y",this.http.put("../rest/notifications/"+this.notification.notification_sid,this.notification).subscribe(t=>{this.notify.success(this.translate.instant("lang.notificationUpdated"))},t=>{this.notify.error(t.error.errors)})}isNumber(t){return $.isNumeric(t)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(Yd,!0),2&t&&m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first)},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader","",4,"ngIf"],["mat-list-item","","joyrideStep","createScriptTour",3,"click","next",4,"ngIf"],["mat-list-item","",3,"click",4,"ngIf"],["mat-subheader",""],["mat-list-item","","joyrideStep","createScriptTour",3,"click","next"],["color","primary","mat-list-icon","",1,"fa","fa-terminal"],["mat-line",""],["mat-list-item","",3,"click"],["color","accent","mat-list-icon","",1,"fa","fa-play"],["color","warn","mat-list-icon","",1,"fa","fa-pause"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["class","text-warning","style","position: absolute;opacity: 0.1;font-size: 120px;transform: rotate(324deg);-webkit-transform: rotate(324deg);margin-left: 25%;margin-top: 90px;",4,"ngIf"],[1,"form-horizontal",3,"ngSubmit"],["notificationsFormUp","ngForm"],[1,"form-group"],[1,"col-md-12"],["matInput","","required","","name","notification_id","id","notification_id","type","text","pattern","^[\\w.-]*$","maxlength","50",3,"ngModel","title","placeholder","disabled","ngModelChange"],["matInput","","required","","name","description","id","description","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["id","event_id","name","event_id","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"label"],[4,"ngFor","ngForOf"],[1,"col-md-8"],["id","template_id","name","template_id","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4"],["id","attachfor_type","name","attachfor_type",3,"title","placeholder","ngModel","ngModelChange"],["value",""],["value","main_document"],["id","diffusion_type","name","diffusion_type","required","",3,"title","placeholder","ngModel","ngModelChange"],[3,"label",4,"ngIf"],[4,"ngIf"],[1,"col-sm-12",2,"text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"text-warning",2,"position","absolute","opacity","0.1","font-size","120px","transform","rotate(324deg)","-webkit-transform","rotate(324deg)","margin-left","25%","margin-top","90px"],[3,"value",4,"ngIf"],[3,"value"],["color","primary",1,"fa","fa-cog",2,"height","auto"],["color","primary",1,"fa","fa-exchange-alt",2,"height","auto"],["id","diffusion_properties","name","diffusion_properties","required","","multiple","",3,"title","placeholder","ngModel","ngModelChange"],["id","diffusion_properties","name","diffusion_properties","multiple","",3,"title","placeholder","ngModel","ngModelChange"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Od,5,4,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Td,2,0,"div",9),m.Qc(14,ib,68,74,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,Y.a,Tt.a,Ot.c,I.k,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.E,o.A,o.o,o.t,o.w,at.a,I.n,x.s,I.o,D.b],pipes:[p.d],encapsulation:2}),t})();var nb=i("VdM8");const sb=["adminMenuTemplate"],cb=["appHistoryList"];function ob(t,e){if(1&t&&(m.Zb(0,"a",21),m.Ub(1,"mat-icon",22),m.Zb(2,"p",23),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function rb(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,ob,4,6,"a",20),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",t.subMenus)}}function lb(t,e){if(1&t&&m.Ub(0,"mat-datepicker-toggle",24),2&t){m.lc();const t=m.Dc(19);m.sc("for",t)}}function db(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",25),m.hc("click",(function(e){m.Hc(t),m.lc();const i=m.Dc(33);return e.stopPropagation(),i.startDateFilter="",i.filterStartDate()})),m.Ub(1,"mat-icon",26),m.Yb()}if(2&t){const t=m.lc();m.sc("title",t.translate.instant("lang.eraseValue"))}}function bb(t,e){if(1&t&&m.Ub(0,"mat-datepicker-toggle",24),2&t){m.lc();const t=m.Dc(28);m.sc("for",t)}}function mb(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",25),m.hc("click",(function(e){m.Hc(t),m.lc();const i=m.Dc(33);return e.stopPropagation(),i.endDateFilter="",i.filterEndDate()})),m.Ub(1,"mat-icon",26),m.Yb()}if(2&t){const t=m.lc();m.sc("title",t.translate.instant("lang.eraseValue"))}}let pb=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.appService=i,this.functions=a,this.privilegeService=n,this.headerService=s,this.viewContainerRef=c,this.startDateFilter="",this.endDateFilter="",this.subMenus=[{icon:"fa fa-history",route:"/administration/history",label:this.translate.instant("lang.history"),current:!0},{icon:"fa fa-history",route:"/administration/history-batch",label:this.translate.instant("lang.historyBatch"),current:!1}]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.history").toLowerCase(),"",""),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.subMenus=this.privilegeService.hasCurrentUserPrivilege("view_history_batch")?[{icon:"fa fa-history",route:"/administration/history",label:this.translate.instant("lang.history"),current:!0},{icon:"fa fa-history",route:"/administration/history-batch",label:this.translate.instant("lang.historyBatch"),current:!1}]:[{icon:"fa fa-history",route:"/administration/history",label:this.translate.instant("lang.history"),current:!0}]}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(f.a),m.Tb(C.a),m.Tb(g.a),m.Tb(h.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["admin-history"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(sb,!0),m.ad(cb,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.appHistoryList=i.first))},decls:34,vars:26,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[2,"display","grid","grid-template-columns","repeat(2, 1fr)","grid-gap","10px","width","100%"],[1,"dateFilter",2,"cursor","pointer",3,"click"],[2,"color","white"],["matInput","","readonly","",2,"cursor","pointer",3,"ngModel","matDatepicker","placeholder","max","ngModelChange","dateChange"],["matSuffix","",3,"for",4,"ngIf"],[3,"touchUi"],["startPicker",""],["mat-button","","color","warn","matSuffix","","mat-icon-button","",3,"title","click",4,"ngIf"],["matInput","","readonly","",2,"cursor","pointer",3,"ngModel","matDatepicker","placeholder","min","ngModelChange","dateChange"],["endPicker",""],[1,"container"],[1,"container-content"],["appHistoryList",""],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],["mat-line",""],["matSuffix","",3,"for"],["mat-button","","color","warn","matSuffix","","mat-icon-button","",3,"title","click"],["color","warn",1,"fa","fa-calendar-times"]],template:function(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-sidenav-container",0),m.Qc(1,rb,2,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Zb(10,"div",6),m.Zb(11,"div",7),m.Zb(12,"mat-form-field",8),m.hc("click",(function(){return m.Hc(t),m.Dc(19).open()})),m.Zb(13,"mat-label",9),m.Sc(14),m.mc(15,"translate"),m.Yb(),m.Zb(16,"input",10),m.hc("ngModelChange",(function(e){return m.Hc(t),m.Dc(33).startDateFilter=e}))("dateChange",(function(){return m.Hc(t),m.Dc(33).filterStartDate()})),m.Yb(),m.Qc(17,lb,1,1,"mat-datepicker-toggle",11),m.Ub(18,"mat-datepicker",12,13),m.Qc(20,db,2,1,"button",14),m.Yb(),m.Zb(21,"mat-form-field",8),m.hc("click",(function(){return m.Hc(t),m.Dc(28).open()})),m.Zb(22,"mat-label",9),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Zb(25,"input",15),m.hc("ngModelChange",(function(e){return m.Hc(t),m.Dc(33).endDateFilter=e}))("dateChange",(function(){return m.Hc(t),m.Dc(33).filterEndDate()})),m.Yb(),m.Qc(26,bb,1,1,"mat-datepicker-toggle",11),m.Ub(27,"mat-datepicker",12,16),m.Qc(29,mb,2,1,"button",14),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(30,"div",17),m.Zb(31,"div",18),m.Ub(32,"app-history-list",null,19),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(19),i=m.Dc(28),a=m.Dc(33);m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(4),m.Uc("",m.nc(15,22,"lang.since")," "),m.Eb(2),m.sc("ngModel",a.startDateFilter)("matDatepicker",t)("placeholder",e.translate.instant("lang.since"))("max",a.endDateFilter),m.Eb(1),m.sc("ngIf",!a.startDateFilter),m.Eb(1),m.sc("touchUi",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",a.startDateFilter),m.Eb(3),m.Uc("",m.nc(24,24,"lang.until")," "),m.Eb(2),m.sc("ngModel",a.endDateFilter)("matDatepicker",i)("placeholder",e.translate.instant("lang.until"))("min",a.startDateFilter),m.Eb(1),m.sc("ngIf",!a.endDateFilter),m.Eb(1),m.sc("touchUi",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",a.endDateFilter),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode())}},directives:[S.e,S.f,M.a,Z.a,w.c,w.g,O.b,o.c,je.f,o.t,o.w,x.t,je.d,nb.a,Ot.h,x.s,Ot.d,s.f,Tt.a,Ot.c,I.k,je.h,w.j,D.b],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}.paginatorResultList[_ngcontent-%COMP%]    .mat-paginator-range-label{justify-content:flex-end;display:flex}.filterList[_ngcontent-%COMP%]    .mat-optgroup-label{color:#135f7f;position:-webkit-sticky;position:sticky;top:0;background:#fff!important;z-index:1}.label[_ngcontent-%COMP%]{cursor:pointer;margin:5px}.bg-head-content[_ngcontent-%COMP%]     .mat-focused .mat-form-field-label{color:#fff!important}.bg-head-content[_ngcontent-%COMP%]    .mat-form-field-ripple, .bg-head-content[_ngcontent-%COMP%]    .mat-form-field-underline{background-color:#fff!important}.bg-head-content[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%], .bg-head-content[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#fff}"]}),t})();var ub=i("XNiG"),hb=i("VRyK"),fb=i("1G5W"),gb=i("eIep"),vb=i("8IW6"),yb=i("ZI/H");const Cb=["adminMenuTemplate"],Eb=["tableHistoryListSort"],Sb=["autoCompleteInput"];function Mb(t,e){if(1&t&&(m.Zb(0,"a",53),m.Ub(1,"mat-icon",54),m.Zb(2,"p",55),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function Yb(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,Mb,4,6,"a",52),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",t.subMenus)}}function Zb(t,e){if(1&t&&m.Ub(0,"mat-datepicker-toggle",56),2&t){m.lc();const t=m.Dc(19);m.sc("for",t)}}function xb(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",57),m.hc("click",(function(e){m.Hc(t);const i=m.lc();return e.stopPropagation(),i.startDateFilter="",i.filterStartDate()})),m.Ub(1,"mat-icon",58),m.Yb()}if(2&t){const t=m.lc();m.sc("title",t.translate.instant("lang.eraseValue"))}}function _b(t,e){if(1&t&&m.Ub(0,"mat-datepicker-toggle",56),2&t){m.lc();const t=m.Dc(28);m.sc("for",t)}}function wb(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",57),m.hc("click",(function(e){m.Hc(t);const i=m.lc();return e.stopPropagation(),i.endDateFilter="",i.filterEndDate()})),m.Ub(1,"mat-icon",58),m.Yb()}if(2&t){const t=m.lc();m.sc("title",t.translate.instant("lang.eraseValue"))}}function Ob(t,e){1&t&&m.Ub(0,"mat-spinner")}function Tb(t,e){if(1&t&&(m.Zb(0,"div",59),m.Qc(1,Ob,1,0,"mat-spinner",28),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngIf",t.isLoadingResults)}}function kb(t,e){1&t&&(m.Zb(0,"mat-option",60),m.Zb(1,"div",61),m.Ub(2,"mat-spinner",62),m.Yb(),m.Yb())}function Ib(t,e){if(1&t&&(m.Zb(0,"mat-option",66),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2).$implicit,a=m.lc(2);m.Pc("color",t.used?"":a.filterColor[i.key]),m.sc("id",i.key)("value",t)("disabled",t.used),m.Eb(1),m.Uc(" ",t.label," ")}}function Db(t,e){if(1&t&&(m.Zb(0,"mat-optgroup",64),m.Qc(1,Ib,2,6,"mat-option",65),m.mc(2,"sortBy"),m.mc(3,"async"),m.Yb()),2&t){const t=m.lc().$implicit,e=m.lc(2);m.sc("label",e.translate.instant("lang."+t.key)),m.Eb(1),m.sc("ngForOf",m.oc(2,2,m.nc(3,5,e.filteredList[t.key]),"label"))}}function Ub(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Db,4,7,"mat-optgroup",63),m.mc(2,"async"),m.Wb()),2&t){const t=e.$implicit,a=m.lc(2);var i;const n=(null==(i=m.nc(2,1,a.filteredList[t.key]))?null:i.length)>0;m.Eb(1),m.sc("ngIf",n)}}function Pb(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Ub,3,3,"ng-container",34),m.mc(2,"keyvalue"),m.Wb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",m.nc(2,1,t.filterList))}}function Fb(t,e){if(1&t){const t=m.ac();m.Zb(0,"span",68),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=e.index,n=m.lc(2).$implicit;return m.lc().removeItemFilter(i,n.key,a)})),m.Sc(1),m.Ub(2,"i",69),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(2).$implicit,a=m.lc();m.Pc("background",a.filterColor[i.key],m.Mb),m.sc("title",a.translate.instant("lang."+i.key)),m.Eb(1),m.Uc("",t.label," ")}}function Lb(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Fb,3,4,"span",67),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(1),m.sc("ngForOf",e.filterUsed[t.key])}}const jb=function(){return["startDate","endDate"]};function Rb(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Lb,2,1,"ng-container",28),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",-1===m.yc(1,jb).indexOf(t.key))}}function Qb(t,e){1&t&&(m.Zb(0,"mat-header-cell",70),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.event")))}function Ab(t,e){if(1&t&&(m.Zb(0,"mat-cell",71),m.mc(1,"fullDate"),m.Sc(2),m.mc(3,"ucfirst"),m.mc(4,"timeAgo"),m.Yb()),2&t){const t=e.$implicit;m.sc("title",m.nc(1,2,t.event_date)),m.Eb(2),m.Uc(" ",m.nc(3,4,m.oc(4,6,t.event_date,"full"))," ")}}function Hb(t,e){1&t&&(m.Zb(0,"mat-header-cell",70),m.Sc(1),m.mc(2,"ucfirst"),m.mc(3,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,m.nc(3,3,"lang.totalProcessed"))," "))}function $b(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Jb("empty",0===t.total_processed),m.Eb(1),m.Uc(" ",t.total_processed," ")}}function zb(t,e){1&t&&(m.Zb(0,"mat-header-cell",70),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.totalErrors")," "))}function Vb(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Jb("empty",0===t.total_errors)("error",t.total_errors>0),m.Eb(1),m.Uc(" ",t.total_errors," ")}}function Nb(t,e){1&t&&(m.Zb(0,"mat-header-cell",72),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.information")," "))}function Jb(t,e){if(1&t&&(m.Zb(0,"mat-cell",73),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.info," ")}}function Gb(t,e){1&t&&(m.Zb(0,"mat-header-cell",70),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.module")," "))}function Bb(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.module_name," ")}}function Wb(t,e){1&t&&m.Ub(0,"mat-header-row")}function qb(t,e){1&t&&m.Ub(0,"mat-row")}let Xb=(()=>{class t{constructor(t,e,i,a,n,s,c,r,l,d){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.dialog=s,this.functions=c,this.latinisePipe=r,this.privilegeService=l,this.viewContainerRef=d,this.loading=!1,this.filtersChange=new m.o,this.displayedColumnsHistory=["event_date","total_processed","total_errors","info","module_name"],this.isLoadingResults=!0,this.routeUrl="../rest/batchHistory",this.resultsLength=0,this.searchHistory=new o.h,this.startDateFilter="",this.endDateFilter="",this.filterUrl="",this.filterList=null,this.filteredList={},this.filterUsed={},this.filterColor={startDate:"#b5cfd8",endDate:"#7393a7",totalErrors:"#fc6471",modules:"#009dc5"},this.loadingFilters=!0,this.destroy$=new ub.a,this.subMenus=[]}ngOnInit(){this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.subMenus=this.privilegeService.hasCurrentUserPrivilege("view_history")?[{icon:"fa fa-history",route:"/administration/history",label:this.translate.instant("lang.history"),current:!1},{icon:"fa fa-history",route:"/administration/history-batch",label:this.translate.instant("lang.historyBatch"),current:!0}]:[{icon:"fa fa-history",route:"/administration/history-batch",label:this.translate.instant("lang.historyBatch"),current:!0}],this.loading=!0,this.initHistoryList()}initHistoryList(){this.resultListDatabase=new Kb(this.http),this.paginator.pageIndex=0,this.sort.active="event_date",this.sort.direction="desc",this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),Object(hb.a)(this.sort.sortChange,this.paginator.page,this.filtersChange).pipe(Object(fb.a)(this.destroy$),Object(r.a)({}),Object(gb.a)(()=>(this.isLoadingResults=!0,this.resultListDatabase.getRepoIssues(this.sort.active,this.sort.direction,this.paginator.pageIndex,this.routeUrl,this.filterUrl))),Object(l.a)(t=>(this.isLoadingResults=!1,t=this.processPostData(t),this.resultsLength=t.count,this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.historyBatch").toLowerCase(),"",""),t.history)),Object(b.a)(t=>(this.notify.handleErrors(t),this.isLoadingResults=!1,Object(c.a)([])))).subscribe(t=>this.data=t)}processPostData(t){return t.history=t.history.map(t=>Object.assign(Object.assign({},t),{total_errors:null===t.total_errors?0:t.total_errors})),t}refreshDao(){this.paginator.pageIndex=0,this.filtersChange.emit()}initFilterListHistory(){null===this.filterList&&(this.filterList={},this.loadingFilters=!0,this.http.get("../rest/batchHistory/availableFilters").pipe(Object(l.a)(t=>{let e={modules:[{}],totalErrors:[{}]};return e.modules=t.modules,e.totalErrors=[{id:"errorElement",label:this.translate.instant("lang.totalErrors")}],e}),Object(d.a)(t=>{Object.keys(t).forEach(e=>{this.functions.empty(this.filterList[e])&&(this.filterList[e]=[],this.filteredList[e]=[]),t[e].forEach(t=>{this.filterList[e].push(t)}),this.filteredList[e]=this.searchHistory.valueChanges.pipe(Object(r.a)(""),Object(l.a)(t=>t?this.filter(t,e):this.filterList[e].slice()))})}),Object(vt.a)(()=>this.loadingFilters=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe())}filterStartDate(){this.functions.empty(this.filterUsed.startDate)&&(this.filterUsed.startDate=[]),this.filterUsed.startDate[0]={id:this.functions.empty(this.startDateFilter)?"":this.functions.formatDateObjectToDateString(this.startDateFilter),label:this.functions.empty(this.startDateFilter)?"":this.functions.formatDateObjectToDateString(this.startDateFilter)},this.generateUrlFilter(),this.refreshDao()}filterEndDate(){this.functions.empty(this.filterUsed.endDate)&&(this.filterUsed.endDate=[]),this.filterUsed.endDate[0]={id:this.functions.empty(this.endDateFilter)?"":this.functions.formatDateObjectToDateString(this.endDateFilter,!0),label:this.functions.empty(this.endDateFilter)?"":this.functions.formatDateObjectToDateString(this.endDateFilter)},this.generateUrlFilter(),this.refreshDao()}addItemFilter(t){t.value.used=!0,this.functions.empty(this.filterUsed[t.id])&&(this.filterUsed[t.id]=[]),this.filterUsed[t.id].push(t.value),this.generateUrlFilter(),this.searchHistory.reset(),this.autoCompleteInput.nativeElement.blur(),this.refreshDao()}removeItemFilter(t,e,i){t.used=!1,this.filterUsed[e].splice(i,1),this.generateUrlFilter(),this.refreshDao()}generateUrlFilter(){this.filterUrl="";let t=[];Object.keys(this.filterUsed).forEach(e=>{this.filterUsed[e].forEach(i=>{this.functions.empty(i.id)||(["startDate","endDate"].indexOf(e)>-1?t.push(`${e}=${i.id}`):t.push(`${e}[]=${i.id}`))})}),t.length>0&&(this.filterUrl="&"+t.join("&"))}filter(t,e){if("string"==typeof t){const i=this.latinisePipe.transform(t.toLowerCase());return this.filterList[e].filter(t=>this.latinisePipe.transform(t.label.toLowerCase()).includes(i))}return this.filterList[e]}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(C.a),m.Tb(v.c),m.Tb(g.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Cb,!0),m.Oc(z.a,!0),m.Oc(Eb,!0),m.Oc(Sb,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first),m.Cc(i=m.ic())&&(e.autoCompleteInput=i.first))},decls:72,vars:45,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[2,"display","grid","grid-template-columns","repeat(2, 1fr)","grid-gap","10px","width","100%"],[1,"dateFilter",2,"cursor","pointer",3,"click"],[2,"color","white"],["matInput","","readonly","",2,"cursor","pointer",3,"ngModel","matDatepicker","placeholder","max","ngModelChange","dateChange"],["matSuffix","",3,"for",4,"ngIf"],[3,"touchUi"],["startPicker",""],["mat-button","","color","warn","matSuffix","","mat-icon-button","",3,"title","click",4,"ngIf"],["matInput","","readonly","",2,"cursor","pointer",3,"ngModel","matDatepicker","placeholder","min","ngModelChange","dateChange"],["endPicker",""],[1,"container"],[1,"container-content"],["class","example-loading-shade",4,"ngIf"],[1,"table-head"],[1,"table-head-result"],["floatLabel","never",2,"font-size","13px"],["type","text","matInput","","maxlength","128",3,"matAutocomplete","placeholder","formControl","click"],["autoCompleteInput",""],[3,"optionSelected","opened"],["auto","matAutocomplete"],["disabled","",4,"ngIf"],[4,"ngIf"],[1,"table-head-tool"],[1,"paginatorResultList",3,"length","hidePageSize","pageSize"],["paginatorHistoryList",""],[2,"height","90%","overflow","auto","position","absolute","width","100%"],[1,"filterBadges"],[4,"ngFor","ngForOf"],["id","history-list","matSort","","matSortActive","event_date","matSortDirection","desc",2,"width","100%",3,"dataSource"],["tableHistoryListSort","matSort"],["matColumnDef","event_date"],["mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"title",4,"matCellDef"],["matColumnDef","total_processed"],[3,"empty",4,"matCellDef"],["matColumnDef","total_errors"],[3,"empty","error",4,"matCellDef"],["matColumnDef","info"],["mat-sort-header","","style","flex: 2;",4,"matHeaderCellDef"],["style","flex: 2;",4,"matCellDef"],["matColumnDef","module_name"],[4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],["mat-line",""],["matSuffix","",3,"for"],["mat-button","","color","warn","matSuffix","","mat-icon-button","",3,"title","click"],["color","warn",1,"fa","fa-calendar-times"],[1,"example-loading-shade"],["disabled",""],[2,"display","flex","justify-content","center"],["diameter","35"],["class","filterList",3,"label",4,"ngIf"],[1,"filterList",3,"label"],[3,"id","color","value","disabled",4,"ngFor","ngForOf"],[3,"id","value","disabled"],["class","label",3,"background","title","click",4,"ngFor","ngForOf"],[1,"label",3,"title","click"],[1,"fa","fa-times-circle"],["mat-sort-header",""],["mat-cell","",3,"title"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"]],template:function(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Yb,2,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Zb(10,"div",6),m.Zb(11,"div",7),m.Zb(12,"mat-form-field",8),m.hc("click",(function(){return m.Hc(t),m.Dc(19).open()})),m.Zb(13,"mat-label",9),m.Sc(14),m.mc(15,"translate"),m.Yb(),m.Zb(16,"input",10),m.hc("ngModelChange",(function(t){return e.startDateFilter=t}))("dateChange",(function(){return e.filterStartDate()})),m.Yb(),m.Qc(17,Zb,1,1,"mat-datepicker-toggle",11),m.Ub(18,"mat-datepicker",12,13),m.Qc(20,xb,2,1,"button",14),m.Yb(),m.Zb(21,"mat-form-field",8),m.hc("click",(function(){return m.Hc(t),m.Dc(28).open()})),m.Zb(22,"mat-label",9),m.Sc(23),m.mc(24,"translate"),m.Yb(),m.Zb(25,"input",15),m.hc("ngModelChange",(function(t){return e.endDateFilter=t}))("dateChange",(function(){return e.filterEndDate()})),m.Yb(),m.Qc(26,_b,1,1,"mat-datepicker-toggle",11),m.Ub(27,"mat-datepicker",12,16),m.Qc(29,wb,2,1,"button",14),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(30,"div",17),m.Zb(31,"div",18),m.Qc(32,Tb,2,1,"div",19),m.Zb(33,"div",20),m.Zb(34,"div",21),m.Zb(35,"mat-form-field",22),m.Zb(36,"input",23,24),m.hc("click",(function(t){return t.stopPropagation()})),m.Yb(),m.Zb(38,"mat-autocomplete",25,26),m.hc("optionSelected",(function(t){return e.addItemFilter(t.option)}))("opened",(function(){return e.initFilterListHistory()})),m.Qc(40,kb,3,0,"mat-option",27),m.Qc(41,Pb,3,3,"ng-container",28),m.Yb(),m.Yb(),m.Yb(),m.Zb(42,"div",29),m.Ub(43,"mat-paginator",30,31),m.Yb(),m.Yb(),m.Zb(45,"div",32),m.Zb(46,"div",33),m.Qc(47,Rb,2,2,"ng-container",34),m.mc(48,"keyvalue"),m.Yb(),m.Zb(49,"mat-table",35,36),m.Xb(51,37),m.Qc(52,Qb,3,3,"mat-header-cell",38),m.Qc(53,Ab,5,9,"mat-cell",39),m.Wb(),m.Xb(54,40),m.Qc(55,Hb,4,5,"mat-header-cell",38),m.Qc(56,$b,2,3,"mat-cell",41),m.Wb(),m.Xb(57,42),m.Qc(58,zb,3,3,"mat-header-cell",38),m.Qc(59,Vb,2,5,"mat-cell",43),m.Wb(),m.Xb(60,44),m.Qc(61,Nb,3,3,"mat-header-cell",45),m.Qc(62,Jb,2,1,"mat-cell",46),m.Wb(),m.Xb(63,47),m.Qc(64,Gb,3,3,"mat-header-cell",38),m.Qc(65,Bb,2,1,"mat-cell",48),m.Wb(),m.Qc(66,Wb,1,0,"mat-header-row",49),m.Qc(67,qb,1,0,"mat-row",50),m.Yb(),m.Zb(68,"div",51),m.Sc(69),m.mc(70,"translate"),m.Yb(),m.Yb(),m.Ub(71,"div",20),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(19),i=m.Dc(28),a=m.Dc(39);m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(4),m.Uc("",m.nc(15,37,"lang.since")," "),m.Eb(2),m.sc("ngModel",e.startDateFilter)("matDatepicker",t)("placeholder",e.translate.instant("lang.since"))("max",e.endDateFilter),m.Eb(1),m.sc("ngIf",!e.startDateFilter),m.Eb(1),m.sc("touchUi",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.startDateFilter),m.Eb(3),m.Uc("",m.nc(24,39,"lang.until")," "),m.Eb(2),m.sc("ngModel",e.endDateFilter)("matDatepicker",i)("placeholder",e.translate.instant("lang.until"))("min",e.startDateFilter),m.Eb(1),m.sc("ngIf",!e.endDateFilter),m.Eb(1),m.sc("touchUi",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.endDateFilter),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.isLoadingResults),m.Eb(4),m.sc("matAutocomplete",a)("placeholder",e.translate.instant("lang.filterBy"))("formControl",e.searchHistory),m.Eb(4),m.sc("ngIf",e.loadingFilters),m.Eb(1),m.sc("ngIf",null!==e.filterList&&!e.loadingFilters),m.Eb(2),m.sc("length",e.resultsLength)("hidePageSize",!0)("pageSize",10),m.Eb(4),m.sc("ngForOf",m.nc(48,41,e.filterUsed)),m.Eb(2),m.sc("dataSource",e.data),m.Eb(17),m.sc("matHeaderRowDef",e.displayedColumnsHistory),m.Eb(1),m.sc("matRowDefColumns",e.displayedColumnsHistory),m.Eb(2),m.Vc(" ",e.resultsLength," ",m.nc(70,43,"lang.elements"),"")}},directives:[S.e,S.f,M.a,Z.a,w.c,w.g,O.b,o.c,je.f,o.t,o.w,x.t,je.d,Hn.d,o.o,o.i,Hn.a,z.a,x.s,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Ot.h,Ot.d,s.f,Tt.a,Ot.c,I.k,je.h,w.j,D.b,T.c,I.o,I.n,G.h,V.b,G.a,G.j,G.l],pipes:[p.d,x.l,x.b,U.a,vb.a,v.u,yb.a],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}.paginatorResultList[_ngcontent-%COMP%]    .mat-paginator-range-label{justify-content:flex-end;display:flex}.filterList[_ngcontent-%COMP%]    .mat-optgroup-label{color:#135f7f;position:-webkit-sticky;position:sticky;top:0;background:#fff!important;z-index:1}.label[_ngcontent-%COMP%]{cursor:pointer;margin:5px}.bg-head-content[_ngcontent-%COMP%]     .mat-focused .mat-form-field-label{color:#fff!important}.bg-head-content[_ngcontent-%COMP%]    .mat-form-field-ripple, .bg-head-content[_ngcontent-%COMP%]    .mat-form-field-underline{background-color:#fff!important}.bg-head-content[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%], .bg-head-content[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#fff}.empty[_ngcontent-%COMP%]{opacity:.5}.error[_ngcontent-%COMP%]{color:#8e3e52;font-weight:700}"]}),t})();class Kb{constructor(t){this.http=t}getRepoIssues(t,e,i,a,n){return this.http.get(`${a}?limit=10&offset=${10*i}&order=${e}&orderBy=${t}${n}`)}}function tm(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function em(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",32),m.hc("removed",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).removeChrono(i)})),m.Zb(1,"span",33),m.Sc(2),m.Yb(),m.Sc(3),m.Ub(4,"mat-icon",34),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(2);m.sc("removable",!0),m.Eb(2),m.Tc(i.chronoList.indexOf(t)+1),m.Eb(1),m.Uc(" \xa0",t," ")}}function im(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",32),m.hc("removed",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).removeResId(i)})),m.Zb(1,"span",33),m.Sc(2),m.Yb(),m.Sc(3),m.Ub(4,"mat-icon",34),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(2);m.sc("removable",!0),m.Eb(2),m.Tc(i.resIdList.indexOf(t)+1),m.Eb(1),m.Uc(" \xa0",t," ")}}function am(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Zb(1,"form",13,14),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(3,"mat-tab-group",15),m.hc("selectedTabChange",(function(e){return m.Hc(t),m.lc().resetInput(e)})),m.Zb(4,"mat-tab",16),m.mc(5,"translate"),m.Zb(6,"div",17),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-form-field"),m.Zb(10,"input",18),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().chrono=e})),m.mc(11,"translate"),m.mc(12,"translate"),m.Yb(),m.Yb(),m.Zb(13,"div",19),m.Zb(14,"div",20),m.Zb(15,"div",21),m.Zb(16,"button",22),m.hc("click",(function(){return m.Hc(t),m.lc().addChrono()})),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(19,"mat-chip-list",23,24),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().chronoList=e})),m.Qc(21,em,5,3,"mat-chip",25),m.Yb(),m.Yb(),m.Ub(22,"mat-divider"),m.Yb(),m.Zb(23,"mat-tab",16),m.mc(24,"translate"),m.Zb(25,"div",17),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Zb(28,"mat-form-field"),m.Zb(29,"input",26),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().resId=e})),m.mc(30,"translate"),m.mc(31,"translate"),m.Yb(),m.Yb(),m.Zb(32,"div",19),m.Zb(33,"div",20),m.Zb(34,"div",21),m.Zb(35,"button",27),m.hc("click",(function(){return m.Hc(t),m.lc().addResId()})),m.Sc(36),m.mc(37,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(38,"mat-chip-list",28,24),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().resIdList=e})),m.Qc(40,im,5,3,"mat-chip",25),m.Yb(),m.Yb(),m.Ub(41,"mat-divider"),m.Yb(),m.Yb(),m.Zb(42,"plugin-autocomplete",29),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc().setStatus(e)})),m.Yb(),m.Zb(43,"div",20),m.Zb(44,"div",30),m.Zb(45,"button",31),m.Sc(46),m.mc(47,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(4),m.tc("label",m.nc(5,25,"lang.chronoNumber")),m.Eb(3),m.Uc(" ",m.nc(8,27,"lang.updateStatusInformationsChrono")," "),m.Eb(3),m.tc("title",m.nc(11,29,"lang.chronoNumber")),m.tc("placeholder",m.nc(12,31,"lang.chronoNumber")),m.sc("ngModel",t.chrono),m.Eb(6),m.sc("disabled",!t.chrono),m.Eb(1),m.Tc(m.nc(18,33,"lang.add")),m.Eb(2),m.sc("ngModel",t.chronoList),m.Eb(2),m.sc("ngForOf",t.chronoList),m.Eb(2),m.tc("label",m.nc(24,35,"lang.resId")),m.Eb(3),m.Uc(" ",m.nc(27,37,"lang.updateStatusInformationsGed")," "),m.Eb(3),m.tc("title",m.nc(30,39,"lang.resId")),m.tc("placeholder",m.nc(31,41,"lang.resId")),m.sc("ngModel",t.resId),m.Eb(6),m.sc("disabled",!t.resId),m.Eb(1),m.Tc(m.nc(37,43,"lang.add")),m.Eb(2),m.sc("ngModel",t.resIdList),m.Eb(2),m.sc("ngForOf",t.resIdList),m.Eb(2),m.sc("labelPlaceholder",t.translate.instant("lang.availableStatuses"))("labelList",t.translate.instant("lang.availableStatuses"))("datas",t.statuses)("targetSearchKey","idToDisplay")("subInfoKey","id"),m.Eb(3),m.sc("disabled",0==t.resIdList.length&&0==t.chronoList.length||t.resIdList.length>0&&t.chronoList.length>0||!t.statusId),m.Eb(1),m.Tc(m.nc(47,45,"lang.save"))}}let nm=(()=>{class t{constructor(t,e,i,a,n){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.loading=!1,this.statuses=[],this.statusId="",this.resId="",this.chrono="",this.resIdList=[],this.chronoList=[]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.updateStatus")),this.loading=!0,this.http.get("../rest/autocomplete/statuses").pipe(Object(Zt.tap)(t=>this.statuses=t),Object(Zt.tap)(()=>this.loading=!1)).subscribe()}onSubmit(){const t={status:this.statusId};this.resIdList.length>0?t.resId=this.resIdList:this.chronoList.length>0&&(t.chrono=this.chronoList),this.http.put("../rest/res/resource/status",t).subscribe(()=>{this.resId="",this.chrono="",this.statusId="",this.resIdList=[],this.chronoList=[],this.notify.success(this.translate.instant("lang.modificationSaved"))},t=>{this.notify.error(t.error.errors)})}addResId(){-1===this.resIdList.indexOf(this.resId)&&this.resIdList.push(this.resId),this.resId=""}addChrono(){-1===this.chronoList.indexOf(this.chrono)&&this.chronoList.push(this.chrono),this.chrono=""}setStatus(t){this.statusId=t.id}removeResId(t){const e=this.resIdList.indexOf(t);this.resIdList.splice(e,1)}removeChrono(t){const e=this.chronoList.indexOf(t);this.chronoList.splice(e,1)}resetInput(t){0===t.index?this.resId="":this.chrono=""}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"form-horizontal",3,"ngSubmit"],["updateStatusForm","ngForm"],[3,"selectedTabChange"],[3,"label"],["role","alert",1,"alert","alert-info"],["matInput","","name","chrono",3,"title","placeholder","ngModel","ngModelChange"],[1,"row"],[1,"form-group"],[1,"col-md-12","text-left",2,"padding","10px"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"],["name","chronoChips",3,"ngModel","ngModelChange"],["chipList",""],["color","primary",3,"removable","removed",4,"ngFor","ngForOf"],["type","number","id","","matInput","","name","resId",3,"title","placeholder","ngModel","ngModelChange"],["mat-raised-button","","color","primary","type","button",3,"disabled","click"],["name","resIdChips",3,"ngModel","ngModelChange"],["singleMode","","required","",3,"labelPlaceholder","labelList","datas","targetSearchKey","subInfoKey","triggerEvent"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary",3,"disabled"],["color","primary",3,"removable","removed"],[1,"badge","badge-pill","badge-dark"],["matChipRemove","",1,"fa","fa-times-circle"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,tm,2,0,"div",8),m.Qc(12,am,48,47,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.v,Ie.c,Ie.a,w.c,O.b,o.c,o.t,o.w,D.b,An.d,x.s,_.a,o.z,Dt.a,An.a,Tt.a,An.e],pipes:[p.d],styles:[".mat-tab-body{overflow-y:hidden!important}.row[_ngcontent-%COMP%]{margin-left:0}"]}),t})();const sm=["snav2"],cm=["adminMenuTemplate"];function om(t,e){if(1&t&&(m.Zb(0,"a",18),m.Ub(1,"mat-icon",19),m.Zb(2,"p",16),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function rm(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",13),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",14),m.Ub(5,"mat-icon",15),m.Zb(6,"p",16),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Ub(9,"mat-divider"),m.Zb(10,"mat-nav-list"),m.Qc(11,om,4,6,"a",17),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,3,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,5,"lang.add")," "),m.Eb(4),m.sc("ngForOf",t.subMenus)}}function lm(t,e){1&t&&(m.Zb(0,"div",20),m.Ub(1,"mat-spinner",21),m.Yb())}function dm(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",49),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.label")," ")}}function bm(t,e){if(1&t&&(m.Zb(0,"mat-cell",50),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Tc(t.label)}}function mm(t,e){1&t&&(m.Zb(0,"mat-header-cell",49),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.description")," "))}function pm(t,e){if(1&t&&(m.Zb(0,"mat-cell",50),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.description," ")}}function um(t,e){1&t&&(m.Zb(0,"mat-header-cell",51),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.relatedContactNumber")," "))}function hm(t,e){if(1&t&&(m.Zb(0,"span"),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.Tc(t.nbContacts)}}function fm(t,e){if(1&t&&(m.Zb(0,"span",55),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.Tc(t.nbContacts)}}function gm(t,e){if(1&t&&(m.Zb(0,"mat-cell",52),m.Qc(1,hm,2,1,"span",53),m.Qc(2,fm,2,1,"span",54),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",0==t.nbContacts),m.Eb(1),m.sc("ngIf",t.nbContacts>0)}}function vm(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",51),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.public")," ")}}function ym(t,e){1&t&&(m.Zb(0,"span"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.no")," "))}function Cm(t,e){1&t&&(m.Zb(0,"span"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.yes")," "))}function Em(t,e){if(1&t&&(m.Zb(0,"mat-cell",52),m.Qc(1,ym,3,3,"span",53),m.Qc(2,Cm,3,3,"span",53),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.sc("ngIf",!t.public),m.Eb(1),m.sc("ngIf",t.public)}}function Sm(t,e){1&t&&(m.Zb(0,"mat-header-cell",51),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.createdBy")," "))}function Mm(t,e){if(1&t&&(m.Zb(0,"mat-cell",52),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.labelledOwner," ")}}function Ym(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Zm(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",56),m.Zb(1,"button",57),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteContactsGroup(a.position)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",58),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function xm(t,e){1&t&&m.Ub(0,"mat-header-row")}function _m(t,e){1&t&&(m.Ub(0,"mat-row",59),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/contacts/contacts-groups/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function wm(t,e){if(1&t&&(m.Zb(0,"mat-card",22),m.Zb(1,"div",23),m.Zb(2,"div",24),m.Zb(3,"mat-form-field"),m.Ub(4,"input",25),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",24),m.Ub(7,"mat-paginator",26,27),m.Yb(),m.Yb(),m.Zb(9,"mat-table",28,29),m.Xb(11,30),m.Qc(12,dm,3,5,"mat-header-cell",31),m.Qc(13,bm,2,3,"mat-cell",32),m.Wb(),m.Xb(14,33),m.Qc(15,mm,3,3,"mat-header-cell",34),m.Qc(16,pm,2,1,"mat-cell",35),m.Wb(),m.Xb(17,36),m.Qc(18,um,3,3,"mat-header-cell",37),m.Qc(19,gm,3,2,"mat-cell",38),m.Wb(),m.Xb(20,39),m.Qc(21,vm,3,5,"mat-header-cell",40),m.Qc(22,Em,3,4,"mat-cell",41),m.Wb(),m.Xb(23,42),m.Qc(24,Sm,3,3,"mat-header-cell",37),m.Qc(25,Mm,2,1,"mat-cell",38),m.Wb(),m.Xb(26,43),m.Qc(27,Ym,1,0,"mat-header-cell",44),m.Qc(28,Zm,4,3,"mat-cell",45),m.Wb(),m.Qc(29,xm,1,0,"mat-header-row",46),m.Qc(30,_m,2,4,"mat-row",47),m.Yb(),m.Zb(31,"div",48),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(20),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.contactsGroups.length," ",m.nc(33,12,"lang.contactsGroupsAlt"),"")}}let Om=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.search=null,this.contactsGroups=[],this.titles=[],this.loading=!1,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!1},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!1},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!1},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!0},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!1}],this.displayedColumns=["label","description","nbContacts","public","owner","actions"],this.filterColumns=["label","description"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.contactsGroups")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/contactsGroups").subscribe(t=>{this.contactsGroups=t.contactsGroups,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_contacts_groups",this.contactsGroups,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.handleErrors(t)})}deleteContactsGroup(t){const e=this.contactsGroups[t];confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+e.label+" \xbb")&&this.http.delete("../rest/contactsGroups/"+e.id).subscribe(()=>{const e=this.contactsGroups.length-1;this.contactsGroups[t]=this.contactsGroups[e],this.contactsGroups[t].position=t,this.contactsGroups.splice(e,1),this.adminService.setDataSource("admin_contacts_groups",this.contactsGroups,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.contactsGroupDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(sm,!0),m.Oc(cm,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:17,vars:10,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["position","end",3,"mode","fixedInViewport"],["snav2",""],["mat-subheader",""],["mat-list-item","","routerLink","/administration/contacts/contacts-groups/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSortDisableClear","","matSort","",3,"dataSource"],["table",""],["matColumnDef","label"],["mat-sort-header","","style","flex:2;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:2;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","description"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","nbContacts"],["mat-sort-header","","style","flex:1;",4,"matHeaderCellDef"],["style","flex:1;",4,"matCellDef"],["matColumnDef","public"],["mat-sort-header","","style","flex:1;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:1;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","owner"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],["mat-sort-header","",2,"flex","1"],[2,"flex","1"],[4,"ngIf"],["color","primary","style","font-weight:bold;",4,"ngIf"],["color","primary",2,"font-weight","bold"],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,rm,12,7,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,lm,2,0,"div",9),m.Qc(14,wm,34,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Ub(15,"mat-sidenav",11,12),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode()))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,_.a,x.s,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}"]}),t})();var Tm=i("/uUt"),km=i("bv9b");const Im=["snav2"],Dm=["adminMenuTemplate"],Um=["paginatorContactList"],Pm=["paginatorAdded"],Fm=["tableAdded"];function Lm(t,e){if(1&t&&(m.Zb(0,"a",31),m.Ub(1,"mat-icon",32),m.Zb(2,"p",33),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function jm(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,Lm,4,6,"a",30),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",t.subMenus)}}function Rm(t,e){1&t&&(m.Zb(0,"div",34),m.Ub(1,"mat-spinner",35),m.Yb())}function Qm(t,e){if(1&t&&m.Ub(0,"div",60),2&t){const t=m.lc(3);m.sc("innerHTML",t.translate.instant("lang.limitDataReached_1000"),m.Ic)}}function Am(t,e){1&t&&m.Ub(0,"mat-progress-bar",61)}function Hm(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-header-cell",68),m.Zb(1,"mat-checkbox",69),m.hc("change",(function(e){m.Hc(t);const i=m.lc(4);return e?i.masterToggle(e):null})),m.Yb(),m.Yb()}if(2&t){const t=m.lc(4);m.Eb(1),m.sc("checked",t.selection.hasValue())}}function $m(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",68),m.Zb(1,"mat-checkbox",70),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()}))("change",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(4);return i?n.selection.toggle(a.id):null})),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(4);m.Eb(1),m.uc("id","check_",t.id,""),m.sc("disabled",i.isInGrp(t))("checked",i.selection.isSelected(t.id))}}function zm(t,e){1&t&&(m.Zb(0,"mat-header-cell",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.contact")," "))}function Vm(t,e){if(1&t&&(m.Zb(0,"mat-cell",71),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.contact," ")}}function Nm(t,e){1&t&&(m.Zb(0,"mat-header-cell",71),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.address")," "))}function Jm(t,e){if(1&t&&(m.Zb(0,"mat-cell",71),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.address," ")}}function Gm(t,e){1&t&&m.Ub(0,"mat-header-row")}const Bm=function(t){return{opacity:t}};function Wm(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-row",72),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(4).selectContact(i.id)})),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(4);m.sc("ngStyle",m.zc(1,Bm,i.isInGrp(t)?"0.5":""))}}function qm(t,e){if(1&t&&(m.Zb(0,"mat-table",62,63),m.Xb(2,64),m.Qc(3,Hm,2,1,"mat-header-cell",26),m.Qc(4,$m,2,3,"mat-cell",65),m.Wb(),m.Xb(5,21),m.Qc(6,zm,3,3,"mat-header-cell",66),m.Qc(7,Vm,2,1,"mat-cell",23),m.Wb(),m.Xb(8,24),m.Qc(9,Nm,3,3,"mat-header-cell",66),m.Qc(10,Jm,2,1,"mat-cell",23),m.Wb(),m.Qc(11,Gm,1,0,"mat-header-row",28),m.Qc(12,Wm,1,3,"mat-row",67),m.Yb()),2&t){const t=m.lc(3);m.sc("dataSource",t.dataSource),m.Eb(11),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns)}}function Xm(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-tab",37),m.mc(1,"translate"),m.Zb(2,"div",14),m.Zb(3,"div",49),m.Zb(4,"mat-form-field",50),m.Zb(5,"span",51),m.Ub(6,"mat-icon",52),m.Sc(7,"\xa0\xa0 "),m.Yb(),m.Zb(8,"input",53),m.hc("keyup",(function(){return m.Hc(t),m.lc(2).launchLoading()})),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(10,"div",15),m.Qc(11,Qm,1,1,"div",54),m.Yb(),m.Zb(12,"div",15),m.Ub(13,"mat-paginator",17,55),m.Yb(),m.Yb(),m.Qc(15,Am,1,0,"mat-progress-bar",56),m.Qc(16,qm,13,3,"mat-table",57),m.Zb(17,"div",40),m.Zb(18,"div",58),m.Zb(19,"button",59),m.hc("click",(function(e){return m.Hc(t),m.lc(2).saveContactsList(e.target)})),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.tc("label",m.nc(1,11,"lang.addContacts")),m.Eb(8),m.tc("placeholder",m.nc(9,13,"lang.linkContact")),m.sc("formControl",t.searchTerm),m.Eb(3),m.sc("ngIf",t.dataSource&&1e3==t.dataSource.data.length),m.Eb(2),m.sc("length",0)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("ngIf",!t.dataSource&&!t.initAutoCompleteContact),m.Eb(1),m.sc("ngIf",t.dataSource),m.Eb(3),m.sc("disabled",0==t.selection.selected.length),m.Eb(1),m.Tc(m.nc(21,15,"lang.add"))}}function Km(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",36),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",37),m.mc(3,"translate"),m.Zb(4,"form",38,39),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(6,"div",40),m.Zb(7,"div",41),m.Zb(8,"mat-form-field"),m.Zb(9,"input",42),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().contactsGroup.label=e})),m.mc(10,"translate"),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(12,"div",40),m.Zb(13,"div",41),m.Zb(14,"mat-form-field"),m.Zb(15,"input",43),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().contactsGroup.description=e})),m.mc(16,"translate"),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"div",40),m.Zb(19,"div",44),m.Zb(20,"mat-slide-toggle",45),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().contactsGroup.public=e})),m.mc(21,"translate"),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(24,"div",40),m.Zb(25,"div",46),m.Zb(26,"button",47),m.Sc(27),m.mc(28,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(29,Xm,22,17,"mat-tab",48),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(5),e=m.lc();m.Eb(2),m.tc("label",m.nc(3,14,"lang.informations")),m.Eb(7),m.tc("title",m.nc(10,16,"lang.label")),m.tc("placeholder",m.nc(11,18,"lang.label")),m.sc("ngModel",e.contactsGroup.label),m.Eb(6),m.tc("title",m.nc(16,20,"lang.description")),m.tc("placeholder",m.nc(17,22,"lang.description")),m.sc("ngModel",e.contactsGroup.description),m.Eb(5),m.tc("title",m.nc(21,24,"lang.contactsGroupDesc")),m.sc("ngModel",e.contactsGroup.public)("checked",e.contactsGroup.public),m.Eb(2),m.Tc(m.nc(23,26,"lang.public")),m.Eb(4),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(28,28,"lang.save")),m.Eb(2),m.sc("ngIf",!e.creationMode)}}function tp(t,e){1&t&&(m.Zb(0,"mat-header-cell",73),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.contact")," "))}function ep(t,e){if(1&t&&(m.Zb(0,"mat-cell",71),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.contact," ")}}function ip(t,e){1&t&&(m.Zb(0,"mat-header-cell",73),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.address")," "))}function ap(t,e){if(1&t&&(m.Zb(0,"mat-cell",71),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.address," ")}}function np(t,e){1&t&&m.Ub(0,"mat-header-cell",68)}function sp(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",74),m.Zb(1,"button",75),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc();return i.stopPropagation(),n.preDelete(a.position)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",76),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function cp(t,e){1&t&&m.Ub(0,"mat-header-row")}function op(t,e){1&t&&m.Ub(0,"mat-row")}let rp=(()=>{class t{constructor(t,e,i,a,n,s,c,r){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.viewContainerRef=r,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!1},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!1},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!1},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!1},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!1}],this.contactsGroup={},this.loading=!1,this.initAutoCompleteContact=!0,this.searchTerm=new o.h,this.searchResult=[],this.displayedColumns=["select","contact","address"],this.displayedColumnsAdded=["contact","address","actions"],this.selection=new Ze.c(!0,[]),this.searchTerm.valueChanges.pipe(Object(dl.a)(500),Object(W.a)(t=>t.length>2),Object(Tm.a)(),Object(gb.a)(t=>this.http.get("../rest/autocomplete/contacts",{params:{search:t}}))).subscribe(t=>{this.searchResult=t,this.dataSource=new G.o(this.searchResult),this.dataSource.paginator=this.paginator})}masterToggle(t){t.checked?this.dataSource.data.forEach(t=>{$("#check_"+t.id+"-input").is(":disabled")||this.selection.select(t.id)}):this.selection.clear()}applyFilter(t){t=(t=t.trim()).toLowerCase(),this.dataSourceAdded.filter=t}ngOnInit(){this.loading=!0,this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.contactGroupCreation")),this.creationMode=!0,this.contactsGroup.public=!1,this.loading=!1):(this.creationMode=!1,this.http.get("../rest/contactsGroups/"+t.id).subscribe(t=>{this.contactsGroup=t.contactsGroup,this.headerService.setHeader(this.translate.instant("lang.contactsGroupModification"),this.contactsGroup.label),this.nbContact=this.contactsGroup.nbContacts,setTimeout(()=>{this.dataSourceAdded=new G.o(this.contactsGroup.contacts),this.dataSourceAdded.paginator=this.paginatorAdded,this.dataSourceAdded.sort=this.sortAdded},0),this.loading=!1}))})}saveContactsList(t){t.textContent=this.translate.instant("lang.loading")+"...",t.disabled=!0,this.http.post("../rest/contactsGroups/"+this.contactsGroup.id+"/contacts",{contacts:this.selection.selected}).subscribe(e=>{this.notify.success(this.translate.instant("lang.contactAdded")),this.nbContact=this.nbContact+this.selection.selected.length,this.selection.clear(),t.textContent=this.translate.instant("lang.add"),this.contactsGroup=e.contactsGroup,setTimeout(()=>{this.dataSourceAdded=new G.o(this.contactsGroup.contacts),this.dataSourceAdded.paginator=this.paginatorAdded,this.dataSourceAdded.sort=this.sortAdded},0)},t=>{this.notify.error(t.error.errors)})}onSubmit(){this.creationMode?this.http.post("../rest/contactsGroups",this.contactsGroup).subscribe(t=>{this.router.navigate(["/administration/contacts/contacts-groups/"+t.contactsGroup]),this.notify.success(this.translate.instant("lang.contactsGroupAdded"))},t=>{this.notify.error(t.error.errors)}):this.http.put("../rest/contactsGroups/"+this.contactsGroup.id,this.contactsGroup).subscribe(()=>{this.router.navigate(["/administration/contacts-groups"]),this.notify.success(this.translate.instant("lang.contactsGroupUpdated"))},t=>{this.notify.error(t.error.errors)})}preDelete(t){confirm(this.translate.instant("lang.reallyWantToDeleteContactFromGroup"))&&this.removeContact(this.contactsGroup.contacts[t],t)}removeContact(t,e){this.http.delete("../rest/contactsGroups/"+this.contactsGroup.id+"/contacts/"+t.id).subscribe(()=>{const t=this.contactsGroup.contacts.length-1;this.contactsGroup.contacts[e]=this.contactsGroup.contacts[t],this.contactsGroup.contacts[e].position=e,this.contactsGroup.contacts.splice(t,1),this.nbContact=this.nbContact-1,this.dataSourceAdded=new G.o(this.contactsGroup.contacts),this.dataSourceAdded.paginator=this.paginatorAdded,this.dataSourceAdded.sort=this.sortAdded,this.notify.success(this.translate.instant("lang.contactDeletedFromGroup"))},t=>{this.notify.error(t.error.errors)})}launchLoading(){this.searchTerm.value.length>2&&(this.dataSource=null,this.initAutoCompleteContact=!1)}isInGrp(t){let e=!1;return this.contactsGroup.contacts.forEach(i=>{i.id==t.id&&(e=!0)}),e}selectContact(t){$("#check_"+t+"-input").is(":disabled")||this.selection.toggle(t)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Im,!0),m.Oc(Dm,!0),m.Oc(Um,!0),m.Oc(Pm,!0),m.Oc(Fm,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.paginatorAdded=i.first),m.Cc(i=m.ic())&&(e.sortAdded=i.first))},decls:42,vars:24,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["position","end",2,"overflow-x","hidden","width","40%",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[1,"row",2,"margin","0px"],[1,"col-md-6","col-xs-6"],["matInput","",3,"placeholder","keyup"],[3,"length","hidePageSize","pageSize"],["paginatorAdded",""],["matSort","","matSortActive","contact","matSortDirection","asc",3,"dataSource"],["tableAdded","matSort"],["matColumnDef","contact"],["mat-sort-header","","style","flex:3;",4,"matHeaderCellDef"],["style","flex:3;",4,"matCellDef"],["matColumnDef","address"],["matColumnDef","actions"],["style","flex:1;",4,"matHeaderCellDef"],["style","justify-content: flex-end;flex:1;",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"label"],[1,"form-horizontal",3,"ngSubmit"],["contactsGroupFormUp","ngForm"],[1,"form-group"],[1,"col-sm-12"],["matInput","","required","","name","label","id","label","type","text","maxlength","32",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","required","","name","description","id","description","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],[1,"col-sm-6",2,"text-align","center"],["name","public","id","public","color","primary",3,"title","ngModel","checked","ngModelChange"],[1,"col-sm-12",2,"text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"label",4,"ngIf"],[1,"col-md-8",2,"padding","5px"],["hintLabel","3 caract\xe8res minium"],["matPrefix",""],["color","primary",1,"fa","fa-user-plus"],["type","text","matInput","","autocomplete","off","minlength","3",1,"autocompleteSearch",3,"placeholder","formControl","keyup"],["class","alert alert-danger",3,"innerHTML",4,"ngIf"],["paginatorContactList",""],["mode","indeterminate",4,"ngIf"],[3,"dataSource",4,"ngIf"],[1,"col-sm-12",2,"text-align","center","margin-top","30px"],["mat-raised-button","","color","primary","type","button",3,"disabled","click"],[1,"alert","alert-danger",3,"innerHTML"],["mode","indeterminate"],[3,"dataSource"],["tableContactList",""],["matColumnDef","select"],["style","flex:1;",4,"matCellDef"],["style","flex:3;",4,"matHeaderCellDef"],["style","cursor: pointer;",3,"ngStyle","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1"],["color","primary",3,"checked","change"],["color","primary",3,"id","disabled","checked","click","change"],[2,"flex","3"],[2,"cursor","pointer",3,"ngStyle","click"],["mat-sort-header","",2,"flex","3"],[2,"justify-content","flex-end","flex","1"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,jm,2,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Rm,2,0,"div",9),m.Qc(14,Km,30,30,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"mat-list"),m.Zb(18,"h3",13),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Yb(),m.Zb(21,"div",14),m.Zb(22,"div",15),m.Zb(23,"mat-form-field"),m.Zb(24,"input",16),m.hc("keyup",(function(t){return e.applyFilter(t.target.value)})),m.mc(25,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(26,"div",15),m.Ub(27,"mat-paginator",17,18),m.Yb(),m.Yb(),m.Zb(29,"mat-table",19,20),m.Xb(31,21),m.Qc(32,tp,3,3,"mat-header-cell",22),m.Qc(33,ep,2,1,"mat-cell",23),m.Wb(),m.Xb(34,24),m.Qc(35,ip,3,3,"mat-header-cell",22),m.Qc(36,ap,2,1,"mat-cell",23),m.Wb(),m.Xb(37,25),m.Qc(38,np,1,0,"mat-header-cell",26),m.Qc(39,sp,4,3,"mat-cell",27),m.Wb(),m.Qc(40,cp,1,0,"mat-header-row",28),m.Qc(41,op,1,0,"mat-row",29),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()&&!e.creationMode),m.Eb(4),m.Vc("",e.nbContact," ",m.nc(20,20,"lang.relatedContacts")," : "),m.Eb(5),m.tc("placeholder",m.nc(25,22,"lang.filterBy")),m.Eb(3),m.sc("length",0)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",e.dataSourceAdded),m.Eb(11),m.sc("matHeaderRowDef",e.displayedColumnsAdded),m.Eb(1),m.sc("matRowDefColumns",e.displayedColumnsAdded))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Ot.g,w.c,O.b,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Ot.h,x.s,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,Ie.c,Ie.a,o.J,o.u,o.v,o.c,o.E,o.o,o.t,o.w,et.a,D.b,w.i,o.p,o.i,km.a,G.h,Pe.a,G.a,G.j,G.l,x.w,V.b,It.b],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}"]}),t})();var lp=i("5RNC");const dp=["adminMenuTemplate"];function bp(t,e){1&t&&(m.Zb(0,"span"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.disabledContactsFilling")))}function mp(t,e){1&t&&(m.Zb(0,"span"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.enabledContactsFilling")))}function pp(t,e){if(1&t&&(m.Zb(0,"a",18),m.Ub(1,"mat-icon",13),m.Zb(2,"p",19),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}const up=function(t){return{opacity:t}};function hp(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Zb(5,"mat-icon",13),m.Zb(6,"mat-slide-toggle",14),m.hc("change",(function(){return m.Hc(t),m.lc().toggleFillingContact()})),m.Yb(),m.Yb(),m.Zb(7,"p",15),m.hc("click",(function(){return m.Hc(t),m.lc().toggleFillingContact()})),m.Qc(8,bp,3,3,"span",16),m.Qc(9,mp,3,3,"span",16),m.Yb(),m.Yb(),m.Yb(),m.Ub(10,"mat-divider"),m.Zb(11,"mat-nav-list"),m.Qc(12,pp,4,6,"a",17),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,6,"lang.actions")),m.Eb(4),m.sc("checked",t.contactsFilling.enable),m.Eb(1),m.sc("ngStyle",m.zc(8,up,t.contactsFilling.enable?"":"0.5")),m.Eb(1),m.sc("ngIf",t.contactsFilling.enable),m.Eb(1),m.sc("ngIf",!t.contactsFilling.enable),m.Eb(3),m.sc("ngForOf",t.subMenus)}}function fp(t,e){1&t&&(m.Zb(0,"div",20),m.Ub(1,"mat-spinner",21),m.Yb())}function gp(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.label")))}function vp(t,e){if(1&t&&(m.Zb(0,"div"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.Tc(m.nc(2,1,"lang.contactsParameters_"+t.identifier))}}function yp(t,e){if(1&t&&(m.Zb(0,"div"),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.Tc(t.label)}}function Cp(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Qc(1,vp,3,3,"div",16),m.Qc(2,yp,2,1,"div",16),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",!t.label),m.Eb(1),m.sc("ngIf",t.label)}}function Ep(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.mandatory")))}function Sp(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell"),m.Zb(1,"mat-slide-toggle",43),m.hc("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(2).addCriteria(i,a,"mandatory")})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("title",m.nc(2,3,"lang.mandatory")),m.sc("disabled","lastname"==t.identifier||"company"==t.identifier)("checked",t.mandatory)}}function Mp(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.contactsFillingCriteria")," "))}function Yp(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell"),m.Zb(1,"mat-slide-toggle",44),m.hc("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(2).addCriteria(i,a,"filling")})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("title",m.nc(2,2,"lang.contactsFillingCriteria")),m.sc("checked",t.filling)}}function Zp(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.autocompletionSearchable")," "))}function xp(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell"),m.Zb(1,"mat-slide-toggle",43),m.hc("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(2).addCriteria(i,a,"searchable")})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("title",m.nc(2,3,"lang.autocompletionSearchable")),m.sc("disabled","lastname"==t.identifier||"company"==t.identifier||"civility"==t.identifier)("checked",t.searchable)}}function _p(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.autocompletionDisplayable")," "))}function wp(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell"),m.Zb(1,"mat-slide-toggle",43),m.hc("change",(function(i){m.Hc(t);const a=e.$implicit;return m.lc(2).addCriteria(i,a,"displayable")})),m.mc(2,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("title",m.nc(2,3,"lang.autocompletionDisplayable")),m.sc("disabled","lastname"==t.identifier||"company"==t.identifier)("checked",t.displayable)}}function Op(t,e){1&t&&m.Ub(0,"mat-header-row")}function Tp(t,e){1&t&&m.Ub(0,"mat-row")}const kp=function(t){return{color:t}};function Ip(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",22),m.Zb(1,"div",23),m.Zb(2,"div",24),m.Zb(3,"mat-card",25),m.Zb(4,"mat-card-header"),m.Zb(5,"mat-card-title"),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Yb(),m.Zb(8,"p"),m.Sc(9),m.mc(10,"translate"),m.Zb(11,"b",26),m.Sc(12,"0%"),m.Yb(),m.Sc(13),m.mc(14,"translate"),m.Zb(15,"b",26),m.Sc(16),m.Yb(),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Zb(19,"mat-slider",27),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().contactsFilling.first_threshold=e}))("change",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Yb(),m.Ub(20,"input",28),m.Yb(),m.Yb(),m.Zb(21,"div",24),m.Zb(22,"mat-card",25),m.Zb(23,"mat-card-header"),m.Zb(24,"mat-card-title"),m.Sc(25),m.mc(26,"translate"),m.Yb(),m.Yb(),m.Zb(27,"p"),m.Sc(28),m.mc(29,"translate"),m.Zb(30,"b",26),m.Sc(31),m.Yb(),m.Sc(32),m.mc(33,"translate"),m.Zb(34,"b",26),m.Sc(35),m.Yb(),m.Sc(36),m.mc(37,"translate"),m.Yb(),m.Zb(38,"mat-slider",29),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().contactsFilling.second_threshold=e}))("change",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Yb(),m.Ub(39,"input",28),m.Yb(),m.Yb(),m.Zb(40,"div",24),m.Zb(41,"mat-card",25),m.Zb(42,"mat-card-header"),m.Zb(43,"mat-card-title"),m.Sc(44),m.mc(45,"translate"),m.Yb(),m.Yb(),m.Zb(46,"p"),m.Sc(47),m.mc(48,"translate"),m.Zb(49,"b",26),m.Sc(50),m.Yb(),m.Sc(51),m.mc(52,"translate"),m.Zb(53,"b",26),m.Sc(54,"100%"),m.Yb(),m.Sc(55),m.mc(56,"translate"),m.Yb(),m.Ub(57,"mat-slider",30),m.Ub(58,"input",28),m.Yb(),m.Yb(),m.Yb(),m.Zb(59,"mat-table",31,32),m.Xb(61,33),m.Qc(62,gp,3,3,"mat-header-cell",34),m.Qc(63,Cp,3,2,"mat-cell",35),m.Wb(),m.Xb(64,36),m.Qc(65,Ep,3,3,"mat-header-cell",34),m.Qc(66,Sp,3,5,"mat-cell",35),m.Wb(),m.Xb(67,37),m.Qc(68,Mp,3,3,"mat-header-cell",34),m.Qc(69,Yp,3,4,"mat-cell",35),m.Wb(),m.Xb(70,38),m.Qc(71,Zp,3,3,"mat-header-cell",34),m.Qc(72,xp,3,5,"mat-cell",35),m.Wb(),m.Xb(73,39),m.Qc(74,_p,3,3,"mat-header-cell",34),m.Qc(75,wp,3,5,"mat-cell",35),m.Wb(),m.Qc(76,Op,1,0,"mat-header-row",40),m.Qc(77,Tp,1,0,"mat-row",41),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(6),m.Tc(m.nc(7,31,"lang.contactsFillingStep1")),m.Eb(3),m.Uc("",m.nc(10,33,"lang.fromRange")," "),m.Eb(2),m.sc("ngStyle",m.zc(55,kp,t.fillingColor.first_threshold)),m.Eb(2),m.Uc(" ",m.nc(14,35,"lang.toRange")," "),m.Eb(2),m.sc("ngStyle",m.zc(57,kp,t.fillingColor.first_threshold)),m.Eb(1),m.Uc("",t.contactsFilling.first_threshold,"%"),m.Eb(1),m.Uc(" ",m.nc(18,37,"lang.contactsFillingStr"),""),m.Eb(2),m.sc("ngModel",t.contactsFilling.first_threshold),m.Eb(1),m.tc("value",t.fillingColor.first_threshold),m.Eb(5),m.Tc(m.nc(26,39,"lang.contactsFillingStep2")),m.Eb(3),m.Uc("",m.nc(29,41,"lang.fromRange")," "),m.Eb(2),m.sc("ngStyle",m.zc(59,kp,t.fillingColor.second_threshold)),m.Eb(1),m.Uc("",t.contactsFilling.first_threshold+1,"%"),m.Eb(1),m.Uc(" ",m.nc(33,43,"lang.toRange")," "),m.Eb(2),m.sc("ngStyle",m.zc(61,kp,t.fillingColor.second_threshold)),m.Eb(1),m.Uc("",t.contactsFilling.second_threshold,"%"),m.Eb(1),m.Uc(" ",m.nc(37,45,"lang.contactsFillingStr"),""),m.Eb(2),m.sc("ngModel",t.contactsFilling.second_threshold)("min",t.contactsFilling.first_threshold+1),m.Eb(1),m.tc("value",t.fillingColor.second_threshold),m.Eb(5),m.Tc(m.nc(45,47,"lang.contactsFillingStep3")),m.Eb(3),m.Uc("",m.nc(48,49,"lang.fromRange")," "),m.Eb(2),m.sc("ngStyle",m.zc(63,kp,t.fillingColor.third_threshold)),m.Eb(1),m.Uc("",t.contactsFilling.second_threshold+1,"%"),m.Eb(1),m.Uc(" ",m.nc(52,51,"lang.toRange")," "),m.Eb(2),m.sc("ngStyle",m.zc(65,kp,t.fillingColor.third_threshold)),m.Eb(2),m.Uc(" ",m.nc(56,53,"lang.contactsFillingStr"),""),m.Eb(3),m.tc("value",t.fillingColor.third_threshold),m.Eb(1),m.sc("dataSource",t.dataSource),m.Eb(17),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns)}}let Dp=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.viewContainerRef=s,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!1},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!1},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!0},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!1},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!1}],this.contactsFilling={enable:!1,first_threshold:"33",second_threshold:"66"},this.contactsParameters=[],this.arrRatingColumns=[],this.fillingColor={first_threshold:"#E81C2B",second_threshold:"#F4891E",third_threshold:"#0AA34F"},this.loading=!1,this.dataSource=new G.o(this.contactsParameters),this.displayedColumns=["identifier","mandatory","filling","searchable","displayable"]}ngOnInit(){this.loading=!0,this.headerService.setHeader(this.translate.instant("lang.contactsParameters")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.http.get("../rest/contactsParameters").subscribe(t=>{this.contactsFilling=t.contactsFilling,this.contactsParameters=t.contactsParameters,this.loading=!1,setTimeout(()=>{this.dataSource=new G.o(this.contactsParameters),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},0)})}addCriteria(t,e,i){this.contactsParameters.forEach((a,n)=>{a.id==e.id&&(this.contactsParameters[n][i]=t.checked)}),this.onSubmit()}onSubmit(){this.contactsFilling.first_threshold>=this.contactsFilling.second_threshold&&(this.contactsFilling.second_threshold=this.contactsFilling.first_threshold+1),this.http.put("../rest/contactsParameters",{contactsFilling:this.contactsFilling,contactsParameters:this.contactsParameters}).subscribe(()=>{this.notify.success(this.translate.instant("lang.parameterUpdated"))},t=>{this.notify.error(t.error.errors)})}toggleFillingContact(){this.contactsFilling.enable=!0!==this.contactsFilling.enable,this.onSubmit()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(dp,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","disableRipple","true"],["color","primary","mat-list-icon",""],["color","primary",3,"checked","change"],["mat-line","",3,"ngStyle","click"],[4,"ngIf"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-4","col-xs-12"],[2,"margin-bottom","5px"],[3,"ngStyle"],["color","primary","max","98","min","1","step","1","thumbLabel","true",2,"width","100%",3,"ngModel","ngModelChange","change"],["disabled","","matInput","","type","color","name","color",3,"value"],["color","primary","max","99","step","1","thumbLabel","true",2,"width","100%",3,"ngModel","min","ngModelChange","change"],["color","primary","max","100","min","100","step","1","thumbLabel","true","disabled","",2,"width","100%"],["matSort","",3,"dataSource"],["table",""],["matColumnDef","identifier"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","mandatory"],["matColumnDef","filling"],["matColumnDef","searchable"],["matColumnDef","displayable"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],["color","primary",2,"margin-left","11px",3,"disabled","title","checked","change"],["color","primary",2,"margin-left","11px",3,"title","checked","change"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,hp,13,10,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,fp,2,0,"div",9),m.Qc(14,Ip,78,67,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,Tt.a,Ot.c,et.a,I.k,x.w,_.a,x.s,s.f,T.c,k.a,k.f,k.m,lp.a,o.t,o.w,O.b,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,G.j,G.l],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}"]}),t})();const Up=["snav2"];function Pp(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Sc(2,"\xa0 "),m.Zb(3,"div"),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(4),m.Uc(" ",m.nc(5,1,"lang.updateInProgress")," "))}function Fp(t,e){1&t&&(m.Zb(0,"div",17),m.Ub(1,"mat-spinner",18),m.Yb())}function Lp(t,e){1&t&&(m.Zb(0,"div",24),m.Ub(1,"mat-icon",25),m.Zb(2,"span",26),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Ub(5,"mat-icon",27),m.Yb()),2&t&&(m.Eb(3),m.Uc("",m.nc(4,1,"lang.appUpToDate")," !"))}function jp(t,e){if(1&t&&(m.Zb(0,"div",28),m.Ub(1,"mat-icon",29),m.Zb(2,"span",26),m.Sc(3),m.mc(4,"translate"),m.Zb(5,"a",30),m.Sc(6),m.Yb(),m.Yb(),m.Ub(7,"mat-icon",31),m.Yb()),2&t){const t=m.lc(2);m.Eb(3),m.Uc(" ",m.nc(4,3,"lang.newVersionAvailable")," ! "),m.Eb(2),m.uc("href","https://labs.maarch.org/maarch/MaarchCourrier/tags/",t.versions.lastAvailableMinorVersion,"",m.Kc),m.Eb(1),m.Tc(t.versions.lastAvailableMinorVersion)}}function Rp(t,e){if(1&t&&m.Ub(0,"div",32),2&t){const t=m.lc(2);m.sc("innerHTML",t.translate.instant("lang.updateWarn")+t.versions.diffOutput.join("<br/>"),m.Ic)}}function Qp(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",33),m.Zb(1,"button",34),m.hc("click",(function(){return m.Hc(t),m.lc(2).updateVersionAccess()})),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(1),m.sc("disabled",!t.versions.canUpdate),m.Eb(1),m.Tc(m.nc(3,2,"lang.makeUpdate"))}}function Ap(t,e){if(1&t&&(m.Zb(0,"mat-card",19),m.Qc(1,Lp,6,3,"div",20),m.Qc(2,jp,8,5,"div",21),m.Qc(3,Rp,1,1,"div",22),m.Qc(4,Qp,4,4,"div",23),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngIf",null==t.versions.lastAvailableMinorVersion),m.Eb(1),m.sc("ngIf",null!=t.versions.lastAvailableMinorVersion),m.Eb(1),m.sc("ngIf",!t.versions.canUpdate&&null!=t.versions.lastAvailableMinorVersion),m.Eb(1),m.sc("ngIf",null!=t.versions.lastAvailableMinorVersion)}}function Hp(t,e){if(1&t&&(m.Zb(0,"div",35),m.Sc(1," Maarch Courrier\xa0"),m.Zb(2,"a",30),m.Sc(3),m.Yb(),m.Sc(4),m.mc(5,"translate"),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.uc("href","https://labs.maarch.org/maarch/MaarchCourrier/tags/",t.versions.lastAvailableMajorVersion,"",m.Kc),m.Eb(1),m.Tc(t.versions.lastAvailableMajorVersion),m.Eb(1),m.Uc("\xa0",m.nc(5,3,"lang.isAvailable")," ! ")}}let $p=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.headerService=i,this.notify=a,this.dialog=n,this.appService=s,this.loading=!1,this.updateInprogress=!1,this.versions={}}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.updateVersionControl")),this.loading=!0,this.http.get("../rest/versionsUpdate").pipe(Object(d.a)(t=>{this.versions=t}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1))),Object(d.a)(()=>{this.loading=!1})).subscribe()}updateVersionAccess(){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",data:{title:this.translate.instant("lang.confirm")+" ?",msg:this.translate.instant("lang.updateInfo")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>(this.dialogRef=null,"ok"===t?(this.updateInprogress=!0,!0):(this.updateInprogress=!1,!1))),Object(q.a)(()=>this.http.put("../rest/versionsUpdate",{})),Object(d.a)(()=>{this.dialogRef=this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.updateOk"),msg:this.translate.instant("lang.saveInDocserversInfo")}})}),Object(q.a)(()=>this.dialogRef.afterClosed()),Object(d.a)(()=>{this.dialogRef=null,window.location.reload(!0)}),Object(b.a)(t=>(this.dialogRef=this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.updateKO"),msg:this.translate.instant("lang.saveInDocserversInfo")}}),this.notify.handleErrors(t),Object(N.of)(!1))),Object(d.a)(()=>{this.updateInprogress=!1})).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(h.a),m.Tb(y.a),m.Tb(H.b),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(Up,!0),2&t&&m.Cc(i=m.ic())&&(e.sidenavRight=i.first)},decls:24,vars:17,consts:[["class","updateInProgress",4,"ngIf"],["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden",3,"mode","fixedInViewport","opened"],["snav2",""],["class","alert-message alert-message-info","style","display: flex;",4,"ngIf"],["mat-subheader",""],[1,"updateInProgress"],["diameter","30"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["class","alert alert-info","style","display: flex;",4,"ngIf"],["class","alert alert-success","style","display: flex;",4,"ngIf"],["class","alert-message alert-message-danger",3,"innerHTML",4,"ngIf"],["class","col-sm-12","style","text-align:center;",4,"ngIf"],[1,"alert","alert-info",2,"display","flex"],[1,"fa","fa-check","fa-2x",2,"flex","1","text-align","left"],[2,"flex","1","text-align","center"],[1,"fa","fa-check","fa-2x",2,"flex","1","text-align","right"],[1,"alert","alert-success",2,"display","flex"],[1,"fa","fa-info-circle","fa-2x",2,"flex","1","text-align","left"],["target","_blank",2,"font-weight","bold",3,"href"],[1,"fa","fa-info-circle","fa-2x",2,"flex","1","text-align","right"],[1,"alert-message","alert-message-danger",3,"innerHTML"],[1,"col-sm-12",2,"text-align","center"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"alert-message","alert-message-info",2,"display","flex"]],template:function(t,e){1&t&&(m.Qc(0,Pp,6,3,"div",0),m.Zb(1,"mat-sidenav-container",1),m.Zb(2,"mat-sidenav-content"),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Zb(5,"div",4),m.Ub(6,"header-left"),m.Yb(),m.Zb(7,"div",5),m.Ub(8,"header-right"),m.Yb(),m.Yb(),m.Ub(9,"div",6),m.Yb(),m.Zb(10,"div",7),m.Zb(11,"div",8),m.Qc(12,Fp,2,0,"div",9),m.Qc(13,Ap,5,4,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(14,"mat-sidenav",11,12),m.Qc(16,Hp,6,5,"div",13),m.Zb(17,"mat-list"),m.Zb(18,"h3",14),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"mat-list-item"),m.Zb(22,"b"),m.Sc(23),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.sc("ngIf",e.updateInprogress),m.Eb(4),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",null!=e.versions.lastAvailableMajorVersion),m.Eb(3),m.Tc(m.nc(20,15,"lang.currentVersion")),m.Eb(4),m.Tc(e.versions.currentVersion))},directives:[x.t,S.e,S.f,M.a,Z.a,S.d,Ot.a,Ot.g,Ot.d,T.c,k.a,Tt.a,D.b],pipes:[p.d],styles:[".updateInProgress[_ngcontent-%COMP%]{z-index:2;display:flex;position:fixed;top:0;left:0;width:100%;height:100%;background:hsla(0,0%,100%,.93);justify-content:center;align-items:center}.alert-message-danger[_ngcontent-%COMP%]{width:100%;max-width:100%}"]}),t})();const zp=["adminMenuTemplate"];function Vp(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function Np(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function Jp(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",42),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(3).toggleDocserver(e)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",43),m.Yb()}2&t&&m.tc("matTooltip",m.nc(1,1,"lang.lockDocserver"))}function Gp(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",44),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(3).toggleDocserver(e)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",45),m.Yb()}2&t&&m.tc("matTooltip",m.nc(1,1,"lang.unlockDocserver"))}function Bp(t,e){if(1&t&&m.Ub(0,"mat-progress-spinner",46),2&t){const t=m.lc().$implicit;m.sc("value",t.percentage)}}function Wp(t,e){if(1&t&&m.Ub(0,"mat-progress-spinner",47),2&t){const t=m.lc().$implicit;m.sc("value",t.percentage)}}function qp(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",21),m.Zb(1,"mat-card"),m.Zb(2,"form",22,23),m.hc("ngSubmit",(function(){m.Hc(t);const i=e.$implicit,a=e.index;return m.lc(3).onSubmit(i,a)})),m.Qc(4,Jp,3,3,"button",24),m.Qc(5,Gp,3,3,"button",25),m.Zb(6,"div",26),m.Zb(7,"div",27),m.Zb(8,"mat-form-field"),m.Zb(9,"input",28),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.device_label=i})),m.mc(10,"translate"),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(12,"div",21),m.Qc(13,Bp,1,1,"mat-progress-spinner",29),m.Qc(14,Wp,1,1,"mat-progress-spinner",30),m.Zb(15,"span",31),m.Sc(16),m.Yb(),m.Yb(),m.Zb(17,"div",32),m.Zb(18,"mat-form-field"),m.Zb(19,"input",33),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.coll_id=i})),m.mc(20,"translate"),m.mc(21,"translate"),m.Yb(),m.Yb(),m.Zb(22,"mat-form-field"),m.Zb(23,"input",34),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.docserver_id=i})),m.mc(24,"translate"),m.mc(25,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(26,"div",21),m.Zb(27,"mat-form-field"),m.Zb(28,"input",35),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.limitSizeFormatted=i})),m.mc(29,"translate"),m.mc(30,"translate"),m.Yb(),m.Zb(31,"span",36),m.Sc(32," Go"),m.Yb(),m.Yb(),m.Yb(),m.Ub(33,"div",32),m.Zb(34,"div",27),m.Zb(35,"mat-form-field"),m.Zb(36,"input",37),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.path_template=i})),m.mc(37,"translate"),m.mc(38,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(39,"div",38),m.Zb(40,"button",39),m.Sc(41),m.mc(42,"translate"),m.Yb(),m.Zb(43,"button",40),m.hc("click",(function(){m.Hc(t);const i=e.index,a=m.lc().$implicit;return m.lc(2).cancelModification(a.docserver_type_id,i)})),m.Sc(44),m.mc(45,"translate"),m.Yb(),m.Zb(46,"button",41),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=e.index;return m.lc(3).delete(i,a)})),m.Sc(47),m.mc(48,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=e.index,a=m.lc().$implicit,n=m.lc(2);m.Eb(4),m.sc("ngIf",!t.is_readonly),m.Eb(1),m.sc("ngIf",t.is_readonly),m.Eb(4),m.tc("title",m.nc(10,29,"lang.label")),m.tc("placeholder",m.nc(11,31,"lang.label")),m.sc("ngModel",t.device_label)("disabled",t.is_readonly),m.Eb(4),m.sc("ngIf",t.percentage<60),m.Eb(1),m.sc("ngIf",t.percentage>=60),m.Eb(1),m.tc("title",t.actualSizeFormatted),m.Eb(1),m.Uc("",t.percentage,"%"),m.Eb(3),m.tc("title",m.nc(20,33,"lang.collection")),m.tc("placeholder",m.nc(21,35,"lang.collection")),m.sc("ngModel",t.coll_id),m.Eb(4),m.tc("title",m.nc(24,37,"lang.id")),m.tc("placeholder",m.nc(25,39,"lang.id")),m.sc("ngModel",t.docserver_id),m.Eb(5),m.tc("title",m.nc(29,41,"lang.maxSize")),m.tc("placeholder",m.nc(30,43,"lang.maxSize")),m.sc("ngModel",t.limitSizeFormatted)("disabled",t.is_readonly),m.Eb(8),m.tc("title",m.nc(37,45,"lang.path")),m.tc("placeholder",m.nc(38,47,"lang.path")),m.sc("ngModel",t.path_template)("disabled",t.is_readonly),m.Eb(4),m.sc("disabled",n.checkModif(t,n.docserversClone[a.docserver_type_id][i])),m.Eb(1),m.Tc(m.nc(42,49,"lang.update")),m.Eb(2),m.sc("disabled",n.checkModif(t,n.docserversClone[a.docserver_type_id][i])),m.Eb(1),m.Tc(m.nc(45,51,"lang.cancel")),m.Eb(3),m.Tc(m.nc(48,53,"lang.delete"))}}function Xp(t,e){if(1&t&&(m.Zb(0,"mat-expansion-panel"),m.Zb(1,"mat-expansion-panel-header"),m.Zb(2,"mat-panel-title"),m.Sc(3),m.Yb(),m.Zb(4,"mat-panel-description"),m.Sc(5),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Qc(7,qp,49,55,"div",20),m.Yb(),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(3),m.Uc(" ",t.docserver_type_label," "),m.Eb(2),m.Uc(" ",t.docserver_type_id," "),m.Eb(2),m.sc("ngForOf",i.docservers[t.docserver_type_id])}}function Kp(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"mat-accordion"),m.Qc(2,Xp,8,3,"mat-expansion-panel",18),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.sc("ngForOf",t.docserversTypes)}}let tu=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.viewContainerRef=s,this.loading=!1,this.docservers=[],this.docserversClone=[],this.docserversTypes={}}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.docservers")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/docservers").subscribe(t=>{this.docservers=t.docservers,this.docserversClone=JSON.parse(JSON.stringify(this.docservers)),this.docserversTypes=t.types,this.loading=!1})}toggleDocserver(t){t.is_readonly=!t.is_readonly}cancelModification(t,e){this.docservers[t][e]=JSON.parse(JSON.stringify(this.docserversClone[t][e]))}checkModif(t,e){return t.size_limit_number=1e9*t.limitSizeFormatted,JSON.stringify(t)===JSON.stringify(e)||!(t.size_limit_number>=t.actual_size_number&&t.limitSizeFormatted>0&&/^[\d]*$/.test(t.limitSizeFormatted))}onSubmit(t,e){t.size_limit_number=1e9*t.limitSizeFormatted,this.http.put("../rest/docservers/"+t.id,t).subscribe(i=>{this.docservers[t.docserver_type_id][e]=i.docserver,this.docserversClone[t.docserver_type_id][e]=JSON.parse(JSON.stringify(this.docservers[t.docserver_type_id][e])),this.notify.success(this.translate.instant("lang.docserverUpdated"))},t=>{this.notify.error(t.error.errors)})}delete(t,e){let i=null;i=0===t.actual_size_number?confirm(this.translate.instant("lang.delete")+" ?"):confirm(this.translate.instant("lang.docserverdeleteWarning")),i&&this.http.delete("../rest/docservers/"+t.id).subscribe(()=>{this.docservers[t.docserver_type_id].splice(e,1),this.notify.success(this.translate.instant("lang.docserverDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(zp,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/docservers/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[4,"ngFor","ngForOf"],[1,"row"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"form-horizontal",3,"ngSubmit"],["docserverFormUp","ngForm"],["mat-icon-button","","color","accent","style","position: absolute;top: 5px;right:10px;",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn","style","position: absolute;top: 5px;right:10px;",3,"matTooltip","click",4,"ngIf"],[1,"row",2,"margin-top","10px"],[1,"col-md-12"],["matInput","","required","","name","label","id","label","type","text","maxlength","255",3,"title","placeholder","ngModel","disabled","ngModelChange"],["name","percent_val","id","percent_val","color","primary","mode","determinate","style","margin:auto;",3,"value",4,"ngIf"],["name","percent_val","id","percent_val","color","warn","mode","determinate","style","margin:auto;",3,"value",4,"ngIf"],[2,"position","absolute","font-weight","bold","left","50%","transform","translateX(-50%)","top","40%","font-weight","bold",3,"title"],[1,"col-md-8"],["matInput","","required","","name","collection","id","collection","type","text","disabled","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","required","","name","identifier","id","identifier","type","text","disabled","",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","required","","name","max_size","id","max_size","type","number",3,"title","placeholder","ngModel","disabled","ngModelChange"],["matSuffix",""],["matInput","","required","","name","path","id","path","type","text",3,"title","placeholder","ngModel","disabled","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","default",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],["mat-icon-button","","color","accent",2,"position","absolute","top","5px","right","10px",3,"matTooltip","click"],[1,"fa","fa-lock-open"],["mat-icon-button","","color","warn",2,"position","absolute","top","5px","right","10px",3,"matTooltip","click"],[1,"fa","fa-lock"],["name","percent_val","id","percent_val","color","primary","mode","determinate",2,"margin","auto",3,"value"],["name","percent_val","id","percent_val","color","warn","mode","determinate",2,"margin","auto",3,"value"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Vp,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Np,2,0,"div",9),m.Qc(14,Kp,3,1,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,De.a,x.s,De.c,De.g,De.h,De.f,o.J,o.u,o.v,w.c,O.b,o.c,o.E,o.o,o.t,o.w,o.z,w.j,D.b,It.b,T.a],pipes:[p.d],encapsulation:2}),t})();function eu(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function iu(t,e){if(1&t&&(m.Zb(0,"mat-option",30),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.docserver_type_id),m.Eb(1),m.Uc(" ",t.docserver_type_label," ")}}function au(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Zb(1,"form",13,14),m.hc("ngSubmit",(function(){m.Hc(t);const e=m.lc();return e.onSubmit(e.docserver)})),m.Zb(3,"div",15),m.Zb(4,"div",16),m.Zb(5,"mat-form-field"),m.Zb(6,"mat-select",17),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().docserver.docserver_type_id=e})),m.mc(7,"translate"),m.mc(8,"translate"),m.Qc(9,iu,2,2,"mat-option",18),m.Yb(),m.Yb(),m.Zb(10,"mat-form-field"),m.Zb(11,"input",19),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().docserver.docserver_id=e})),m.mc(12,"translate"),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Zb(14,"mat-form-field"),m.Zb(15,"input",20),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().docserver.device_label=e})),m.mc(16,"translate"),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Zb(18,"mat-form-field"),m.Zb(19,"mat-select",21),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().docserver.coll_id=e})),m.mc(20,"translate"),m.mc(21,"translate"),m.Zb(22,"mat-option",22),m.Sc(23," letterbox_coll "),m.Yb(),m.Zb(24,"mat-option",23),m.Sc(25," attachments_coll "),m.Yb(),m.Zb(26,"mat-option",24),m.Sc(27," archive_transfer_coll "),m.Yb(),m.Yb(),m.Yb(),m.Zb(28,"mat-form-field"),m.Zb(29,"input",25),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().docserver.limitSizeFormatted=e})),m.mc(30,"translate"),m.mc(31,"translate"),m.Yb(),m.Zb(32,"span",26),m.Sc(33," Go"),m.Yb(),m.Yb(),m.Zb(34,"mat-form-field"),m.Zb(35,"input",27),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().docserver.path_template=e})),m.mc(36,"translate"),m.mc(37,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(38,"div",28),m.Zb(39,"button",29),m.Sc(40),m.mc(41,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.lc();m.Eb(6),m.tc("title",m.nc(7,23,"lang.docserverType")),m.tc("placeholder",m.nc(8,25,"lang.docserverType")),m.sc("ngModel",e.docserver.docserver_type_id),m.Eb(3),m.sc("ngForOf",e.docserversTypes),m.Eb(2),m.tc("title",m.nc(12,27,"lang.id")),m.tc("placeholder",m.nc(13,29,"lang.id")),m.sc("ngModel",e.docserver.docserver_id),m.Eb(4),m.tc("title",m.nc(16,31,"lang.label")),m.tc("placeholder",m.nc(17,33,"lang.label")),m.sc("ngModel",e.docserver.device_label),m.Eb(4),m.tc("title",m.nc(20,35,"lang.collection")),m.tc("placeholder",m.nc(21,37,"lang.collection")),m.sc("ngModel",e.docserver.coll_id),m.Eb(10),m.tc("title",m.nc(30,39,"lang.maxSize")),m.tc("placeholder",m.nc(31,41,"lang.maxSize")),m.sc("ngModel",e.docserver.limitSizeFormatted)("disabled",e.docserver.is_readonly),m.Eb(6),m.tc("title",m.nc(36,43,"lang.path")),m.tc("placeholder",m.nc(37,45,"lang.path")),m.sc("ngModel",e.docserver.path_template)("disabled",e.docserver.is_readonly),m.Eb(4),m.sc("disabled",!t.form.valid),m.Eb(1),m.Tc(m.nc(41,47,"lang.add"))}}let nu=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.router=i,this.notify=a,this.headerService=n,this.appService=s,this.loading=!1,this.docserver={coll_id:"letterbox_coll",docserver_type_id:"DOC",limitSizeFormatted:"50"},this.docserversTypes=[]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.docserverCreation")),this.loading=!0,this.http.get("../rest/docserverTypes").subscribe(t=>{this.docserversTypes=t.docserverTypes,this.loading=!1})}onSubmit(t){t.size_limit_number=1e9*t.limitSizeFormatted,this.http.post("../rest/docservers",t).subscribe(t=>{this.notify.success(this.translate.instant("lang.docserverAdded")),this.router.navigate(["/administration/docservers/"])},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"form-horizontal",3,"ngSubmit"],["docserverForm","ngForm"],[1,"row",2,"margin-top","10px"],[1,"col-md-12"],["required","","name","docserver_type","id","docserver_type",3,"title","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","","name","identifier","id","identifier","type","text","maxlength","32","pattern","^[\\w.-]*$",3,"title","placeholder","ngModel","ngModelChange"],["matInput","","required","","name","label","id","label","type","text","maxlength","255",3,"title","placeholder","ngModel","ngModelChange"],["required","","name","collection","id","collection",3,"title","placeholder","ngModel","ngModelChange"],["value","letterbox_coll","selected",""],["value","attachments_coll"],["value","archive_transfer_coll"],["matInput","","required","","name","max_size","id","max_size","type","number","pattern","^\\d+$",3,"title","placeholder","ngModel","disabled","ngModelChange"],["matSuffix",""],["matInput","","required","","name","path","id","path","type","text",3,"title","placeholder","ngModel","disabled","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,eu,2,0,"div",8),m.Qc(12,au,42,49,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.v,w.c,at.a,o.E,o.t,o.w,x.s,O.b,o.c,o.o,o.A,I.o,o.z,w.j,D.b],pipes:[p.d],encapsulation:2}),t})();const su=["adminMenuTemplate"];function cu(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function ou(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function ru(t,e){1&t&&(m.Zb(0,"mat-header-cell",44),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.technicalId")," "))}function lu(t,e){if(1&t&&(m.Zb(0,"mat-cell",45),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.template_id," ")}}function du(t,e){1&t&&(m.Zb(0,"mat-header-cell",46),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.templateName")," "))}function bu(t,e){if(1&t&&(m.Zb(0,"mat-cell",47),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.template_label," ")}}function mu(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",46),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.description")," ")}}function pu(t,e){if(1&t&&(m.Zb(0,"mat-cell",47),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.template_comment," ")}}function uu(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",44),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc(" ",m.nc(2,3,"lang.templateTarget"),"")}}function hu(t,e){if(1&t&&(m.Zb(0,"mat-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",m.nc(2,3,"lang."+t.template_target)," ")}}function fu(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",44),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc("",m.nc(2,3,"lang.templateType")," ")}}function gu(t,e){if(1&t&&(m.Zb(0,"mat-cell",45),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.template_type," ")}}function vu(t,e){1&t&&m.Ub(0,"mat-header-cell")}function yu(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",48),m.Zb(1,"button",49),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteTemplate(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",50),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.tc("matTooltip",m.nc(2,2,"lang.delete")),m.sc("disabled","Y"==t.is_system)}}function Cu(t,e){1&t&&m.Ub(0,"mat-header-row")}function Eu(t,e){1&t&&(m.Ub(0,"mat-row",51),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/templates/",e.$implicit.template_id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Su(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,ru,3,3,"mat-header-cell",26),m.Qc(13,lu,2,1,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,du,3,3,"mat-header-cell",29),m.Qc(16,bu,2,1,"mat-cell",30),m.Wb(),m.Xb(17,31),m.Qc(18,mu,3,5,"mat-header-cell",32),m.Qc(19,pu,2,3,"mat-cell",33),m.Wb(),m.Xb(20,34),m.Qc(21,uu,3,5,"mat-header-cell",35),m.Qc(22,hu,3,5,"mat-cell",36),m.Wb(),m.Xb(23,37),m.Qc(24,fu,3,5,"mat-header-cell",35),m.Qc(25,gu,2,3,"mat-cell",36),m.Wb(),m.Xb(26,38),m.Qc(27,vu,1,0,"mat-header-cell",39),m.Qc(28,yu,4,4,"mat-cell",40),m.Wb(),m.Qc(29,Cu,1,0,"mat-header-row",41),m.Qc(30,Eu,2,4,"mat-row",42),m.Yb(),m.Zb(31,"div",43),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(20),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.templates.length," ",m.nc(33,12,"lang.templates"),"")}}let Mu=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.search=null,this.templates=[],this.titles=[],this.loading=!1,this.displayedColumns=["template_id","template_label","template_comment","template_type","template_target","actions"],this.filterColumns=["template_label","template_comment","template_type","template_target"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.templates")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/templates").subscribe(t=>{this.templates=t.templates,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_templates",this.templates,this.sort,this.paginator,this.filterColumns)},0)},t=>{this.notify.handleErrors(t)})}deleteTemplate(t){confirm(this.translate.instant("lang.confirmAction")+" "+this.translate.instant("lang.delete")+" \xab "+t.template_label+" \xbb")&&this.http.delete("../rest/templates/"+t.template_id).subscribe(()=>{for(const e in this.templates)this.templates[e].template_id===t.template_id&&this.templates.splice(Number(e),1);this.adminService.setDataSource("admin_templates",this.templates,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.templateDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(su,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/templates/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","template_id"],["mat-sort-header","","style","flex:1;",4,"matHeaderCellDef"],["style","flex:1;",4,"matCellDef"],["matColumnDef","template_label"],["mat-sort-header","","style","flex:2;",4,"matHeaderCellDef"],["style","flex:2;",4,"matCellDef"],["matColumnDef","template_comment"],["mat-sort-header","","style","flex:2;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:2;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","template_target"],["mat-sort-header","","style","flex:1;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex:1;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","template_type"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header","",2,"flex","1"],[2,"flex","1"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,cu,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,ou,2,0,"div",9),m.Qc(14,Su,34,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})();var Yu=i("Dxa7"),Zu=i("+AL4"),xu=i("IOqN");const _u=["onlyofficeViewer"],wu=["collaboraOnlineViewer"];function Ou(t,e){if(1&t){const t=m.ac();m.Zb(0,"onlyoffice-viewer",8,9),m.hc("triggerAfterUpdatedDoc",(function(){return m.Hc(t),m.lc().close()}))("triggerCloseEditor",(function(){return m.Hc(t),m.lc().dialogRef.close("")}))("triggerModifiedDocument",(function(){return m.Hc(t),m.lc().documentIsModified=!0})),m.Yb()}if(2&t){const t=m.lc();m.sc("hideCloseEditor",!0)("params",t.editorOptions)("file",t.file)("editMode",!0)}}function Tu(t,e){if(1&t){const t=m.ac();m.Zb(0,"app-collabora-online-viewer",10,11),m.hc("triggerAfterUpdatedDoc",(function(){return m.Hc(t),m.lc().close()}))("triggerCloseEditor",(function(){return m.Hc(t),m.lc().dialogRef.close("")}))("triggerModifiedDocument",(function(){return m.Hc(t),m.lc().documentIsModified=!0})),m.Yb()}if(2&t){const t=m.lc();m.sc("params",t.editorOptions)("file",t.file)("editMode",!0)}}let ku=(()=>{class t{constructor(t,e,i){this.translate=t,this.dialogRef=e,this.data=i,this.loading=!1,this.editorOptions=null,this.file=null,this.editorType=null,this.documentIsModified=!1}ngOnInit(){this.editorOptions=this.data.editorOptions,this.file=this.data.file,this.editorType=this.data.editorType}close(){"onlyoffice"===this.editorType?this.onlyofficeViewer.getFile().pipe(Object(Yu.take)(1),Object(Zt.tap)(t=>{this.dialogRef.close(t)})).subscribe():"collaboraonline"===this.editorType?this.collaboraOnlineViewer.getFile().pipe(Object(Yu.take)(1),Object(Zt.tap)(t=>{this.dialogRef.close(t)})).subscribe():this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(H.h),m.Tb(H.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.ad(_u,!0),m.ad(wu,!0)),2&t&&(m.Cc(i=m.ic())&&(e.onlyofficeViewer=i.first),m.Cc(i=m.ic())&&(e.collaboraOnlineViewer=i.first))},decls:12,vars:10,consts:[[1,"mat-dialog-content-container"],[2,"padding","0px"],["style","height:100%;width:100%;",3,"hideCloseEditor","params","file","editMode","triggerAfterUpdatedDoc","triggerCloseEditor","triggerModifiedDocument",4,"ngIf"],["style","height:100%;width:100%;",3,"params","file","editMode","triggerAfterUpdatedDoc","triggerCloseEditor","triggerModifiedDocument",4,"ngIf"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click"],["mat-raised-button","","mat-button","",3,"disabled","mat-dialog-close"],[2,"height","100%","width","100%",3,"hideCloseEditor","params","file","editMode","triggerAfterUpdatedDoc","triggerCloseEditor","triggerModifiedDocument"],["onlyofficeViewer",""],[2,"height","100%","width","100%",3,"params","file","editMode","triggerAfterUpdatedDoc","triggerCloseEditor","triggerModifiedDocument"],["collaboraOnlineViewer",""]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"mat-dialog-content",1),m.Qc(2,Ou,2,4,"onlyoffice-viewer",2),m.Qc(3,Tu,2,3,"app-collabora-online-viewer",3),m.Yb(),m.Ub(4,"span",4),m.Zb(5,"div",5),m.Zb(6,"button",6),m.hc("click",(function(){return e.close()})),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"button",7),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.sc("ngIf","onlyoffice"===e.editorType),m.Eb(1),m.sc("ngIf","collaboraonline"===e.editorType),m.Eb(3),m.sc("disabled",!e.documentIsModified),m.Eb(1),m.Tc(m.nc(8,6,"lang.validate")),m.Eb(2),m.sc("disabled",e.loading),m.Eb(1),m.Tc(m.nc(11,8,"lang.cancel")))},directives:[H.f,x.t,H.c,D.b,H.d,Zu.a,xu.a],pipes:[p.d],styles:[""]}),t})();const Iu=["snav2"],Du=["adminMenuTemplate"],Uu=["maarchTree"];function Pu(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",13),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",17),m.hc("click",(function(){return m.Hc(t),m.lc(2).duplicateTemplate()})),m.Ub(5,"mat-icon",18),m.Zb(6,"p",19),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Tc(m.nc(3,5,"lang.actions")),m.Eb(2),m.Jb("disabled",t.lockFound||"acknowledgementReceipt"==t.template.target),m.sc("disableRipple",t.lockFound||"acknowledgementReceipt"==t.template.target),m.Eb(3),m.Uc(" ",m.nc(8,7,"lang.duplicate")," ")}}function Fu(t,e){if(1&t&&m.Qc(0,Pu,9,9,"mat-nav-list",16),2&t){const t=m.lc();m.sc("ngIf",!t.creationMode&&!t.loading)}}function Lu(t,e){1&t&&(m.Zb(0,"div",20),m.Ub(1,"mat-spinner",21),m.Yb())}function ju(t,e){if(1&t&&(m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-form-field"),m.Ub(3,"input",34),m.mc(4,"translate"),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,3,"lang.technicalId")),m.tc("value",t.template.id),m.tc("placeholder",m.nc(5,5,"lang.technicalId"))}}function Ru(t,e){if(1&t&&(m.Zb(0,"mat-option",35),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",m.nc(2,2,"lang."+t),"")}}function Qu(t,e){if(1&t&&(m.Zb(0,"mat-option",35),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function Au(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-form-field"),m.Zb(3,"mat-select",36),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.template_attachment_type=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Zb(6,"mat-option",37),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Qc(9,Qu,2,2,"mat-option",31),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,5,"lang.attachmentType")),m.tc("placeholder",m.nc(5,7,"lang.attachmentType")),m.sc("ngModel",t.template.template_attachment_type),m.Eb(4),m.Tc(m.nc(8,9,"lang.allAttachments")),m.Eb(2),m.sc("ngForOf",t.attachmentTypesList)}}function Hu(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-form-field"),m.Zb(3,"mat-select",38),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.template_attachment_type=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Zb(6,"mat-option",39),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-option",40),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Zb(12,"mat-option",41),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,7,"lang.acknowledgementReceiptType")),m.tc("placeholder",m.nc(5,9,"lang.acknowledgementReceiptType")),m.sc("disabled",!t.creationMode)("ngModel",t.template.template_attachment_type),m.Eb(4),m.Tc(m.nc(8,11,"lang.ARsimple")),m.Eb(3),m.Tc(m.nc(11,13,"lang.ARsva")),m.Eb(3),m.Tc(m.nc(14,15,"lang.ARsvr"))}}function $u(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-form-field"),m.Zb(3,"input",42),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.subject=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,3,"lang.emailSubject")),m.tc("placeholder",m.nc(5,5,"lang.emailSubject")),m.sc("ngModel",t.template.subject)}}function zu(t,e){if(1&t&&(m.Zb(0,"mat-radio-button",45),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(3);m.sc("value",t)("checked",i.template.type===t),m.Eb(1),m.Uc(" ",t,"")}}function Vu(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-radio-group",43),m.hc("change",(function(e){return m.Hc(t),m.lc(2).changeType(e)})),m.Qc(3,zu,2,3,"mat-radio-button",44),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.sc("disabled",!t.creationMode),m.Eb(1),m.sc("ngForOf",t.availableTypes)}}function Nu(t,e){if(1&t&&(m.Zb(0,"mat-option",35),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.vc("value","",t.fileExt,": ",t.fileName,""),m.Eb(1),m.Vc(" ",t.fileExt,": ",t.fileName," ")}}function Ju(t,e){if(1&t&&(m.Xb(0),m.Qc(1,Nu,2,4,"mat-option",57),m.Wb()),2&t){const t=e.$implicit,i=m.lc().$implicit;m.Eb(1),m.sc("ngIf",i==t.fileExt)}}function Gu(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-optgroup",53),m.Qc(2,Ju,2,1,"ng-container",56),m.Yb(),m.Wb()),2&t){const t=e.$implicit,i=m.lc(4);m.Eb(1),m.uc("label","",t," :"),m.Eb(1),m.sc("ngForOf",i.defaultTemplatesList)}}function Bu(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-select",52),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(3).selectedModelFile=e}))("selectionChange",(function(){return m.Hc(t),m.lc(3).changeModel()})),m.mc(2,"translate"),m.mc(3,"translate"),m.Zb(4,"mat-optgroup",53),m.mc(5,"translate"),m.Zb(6,"mat-option",54),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(5).click()})),m.Ub(7,"mat-icon",55),m.Sc(8),m.Yb(),m.Yb(),m.Qc(9,Gu,3,2,"ng-container",56),m.Yb(),m.Yb()}if(2&t){const t=m.lc(3);m.Eb(1),m.tc("title",m.nc(2,9,"lang.defaultTemplate")),m.tc("placeholder",m.nc(3,11,"lang.chosenModel")),m.sc("disabled",!t.creationMode)("ngModel",t.selectedModelFile)("required","acknowledgementReceipt"!=t.template.target),m.Eb(3),m.uc("label","",m.nc(5,13,"lang.loadedFile")," :"),m.Eb(2),m.sc("value",t.template.file.name),m.Eb(2),m.Uc(" ",t.functionsService.empty(t.template.file)||t.functionsService.empty(t.template.file.name)?t.translate.instant("lang.importFile"):t.template.file.name," "),m.Eb(1),m.sc("ngForOf",t.extensionModels)}}function Wu(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",58),m.hc("click",(function(e){m.Hc(t);const i=m.lc(3);return e.stopPropagation(),i.editFile()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(3);m.sc("disabled",t.lockFound),m.Eb(1),m.Tc(m.nc(2,2,"lang.templateEdition"))}}function qu(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",58),m.hc("click",(function(e){m.Hc(t),m.lc();const i=m.Dc(5);return e.stopPropagation(),i.click()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(3);m.sc("disabled",t.lockFound),m.Eb(1),m.Tc(m.nc(2,2,"lang.importFile"))}}function Xu(t,e){if(1&t&&m.Ub(0,"iframe",59),2&t){const t=m.lc(3);m.sc("src",t.templateDocView,m.Jc)}}function Ku(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",46),m.Zb(2,"div",47),m.Zb(3,"div",27),m.Zb(4,"input",48,49),m.hc("change",(function(e){return m.Hc(t),m.lc(2).uploadFileTrigger(e)})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(6,"div",25),m.Qc(7,Bu,10,15,"mat-form-field",16),m.Qc(8,Wu,3,4,"button",50),m.Qc(9,qu,3,4,"button",50),m.Yb(),m.Qc(10,Xu,1,1,"iframe",51),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(7),m.sc("ngIf",t.creationMode||t.template.file.name),m.Eb(1),m.sc("ngIf",t.creationMode&&t.selectedModelFile||!t.creationMode),m.Eb(1),m.sc("ngIf",t.creationMode&&!t.selectedModelFile||!t.creationMode&&!t.functionsService.empty(t.template.file.name)&&"java"!==t.headerService.user.preferences.documentEdition),m.Eb(1),m.sc("ngIf",null!==t.templateDocView)}}function th(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-form-field"),m.Zb(3,"textarea",60),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.file.content=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Sc(6,"                                    "),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("placeholder",m.nc(4,4,"lang.contentTxtTemplate")),m.tc("title",m.nc(5,6,"lang.contentTxtTemplate")),m.sc("ngModel",t.template.file.content)("required","acknowledgementReceipt"!=t.template.target)}}function eh(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"div",61),m.Zb(3,"textarea",62),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.file.content=e})),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.sc("ngModel",t.template.file.content)("required","acknowledgementReceipt"!=t.template.target)}}function ih(t,e){if(1&t&&(m.Zb(0,"mat-option",35),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.sc("value",t.id),m.Eb(1),m.Tc(t.label)}}function ah(t,e){if(1&t&&(m.Xb(0),m.Qc(1,ih,2,2,"mat-option",57),m.Wb()),2&t){const t=e.$implicit,i=m.lc(3);m.Eb(1),m.sc("ngIf",i.displayDatasources(t))}}function nh(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"div",25),m.Zb(2,"mat-form-field"),m.Zb(3,"mat-select",63),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.datasource=e})),m.mc(4,"translate"),m.mc(5,"translate"),m.Zb(6,"mat-option",64),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Qc(9,ah,2,1,"ng-container",56),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(3),m.tc("title",m.nc(4,5,"lang.templateDatasource")),m.tc("placeholder",m.nc(5,7,"lang.templateDatasource")),m.sc("ngModel",t.template.datasource),m.Eb(4),m.Tc(m.nc(8,9,"lang.noDatasource")),m.Eb(2),m.sc("ngForOf",t.datasourcesList)}}function sh(t,e){if(1&t&&(m.Zb(0,"mat-option",35),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit;m.vc("value","",t.fileExt,": ",t.fileName,""),m.Eb(1),m.Vc(" ",t.fileExt,": ",t.fileName," ")}}function ch(t,e){if(1&t&&(m.Xb(0),m.Qc(1,sh,2,4,"mat-option",57),m.Wb()),2&t){const t=e.$implicit,i=m.lc().$implicit;m.Eb(1),m.sc("ngIf",i==t.fileExt)}}function oh(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-optgroup",53),m.Qc(2,ch,2,1,"ng-container",56),m.Yb(),m.Wb()),2&t){const t=e.$implicit,i=m.lc(3);m.Eb(1),m.uc("label","",t," :"),m.Eb(1),m.sc("ngForOf",i.defaultTemplatesList)}}function rh(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",58),m.hc("click",(function(e){m.Hc(t);const i=m.lc(3);return e.stopPropagation(),i.editFile()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(3);m.sc("disabled",t.lockFound),m.Eb(1),m.Tc(m.nc(2,2,"lang.templateEdition"))}}function lh(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",58),m.hc("click",(function(e){m.Hc(t),m.lc();const i=m.Dc(13);return e.stopPropagation(),i.click()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc(3);m.sc("disabled",t.lockFound),m.Eb(1),m.Tc(m.nc(2,2,"lang.importFile"))}}function dh(t,e){if(1&t&&m.Ub(0,"iframe",59),2&t){const t=m.lc(3);m.sc("src",t.templateDocView,m.Jc)}}function bh(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",27),m.Zb(1,"mat-tab-group",65),m.hc("selectedTabChange",(function(e){return m.Hc(t),m.lc(2).loadTab(e)})),m.Zb(2,"mat-tab",53),m.mc(3,"translate"),m.Zb(4,"div",25),m.Zb(5,"div",61),m.Zb(6,"textarea",66),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).template.file.electronic.content=e})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(7,"mat-tab",53),m.mc(8,"translate"),m.Zb(9,"div",46),m.Zb(10,"div",47),m.Zb(11,"div",27),m.Zb(12,"input",48,67),m.hc("change",(function(e){return m.Hc(t),m.lc(2).uploadFileTrigger(e)})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(14,"div",25),m.Zb(15,"mat-form-field"),m.Zb(16,"mat-select",68),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).selectedModelFile=e})),m.mc(17,"translate"),m.mc(18,"translate"),m.Zb(19,"mat-optgroup",53),m.mc(20,"translate"),m.Zb(21,"mat-option",69),m.hc("click",(function(){return m.Hc(t),m.Dc(13).click()})),m.Ub(22,"mat-icon",55),m.Sc(23),m.Yb(),m.Yb(),m.Qc(24,oh,3,2,"ng-container",56),m.Yb(),m.Yb(),m.Qc(25,rh,3,4,"button",50),m.Qc(26,lh,3,4,"button",50),m.Yb(),m.Qc(27,dh,1,1,"iframe",51),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.tc("label",m.nc(3,16,"lang.electronicTemplate")),m.Eb(4),m.sc("ngModel",t.template.file.electronic.content)("required","acknowledgementReceipt"!=t.template.target),m.Eb(1),m.tc("label",m.nc(8,18,"lang.paperTemplate")),m.Eb(9),m.tc("title",m.nc(17,20,"lang.defaultTemplate")),m.tc("placeholder",m.nc(18,22,"lang.chosenModel")),m.sc("disabled",!t.creationMode&&null!==t.template.file.paper.name)("ngModel",t.selectedModelFile)("required","acknowledgementReceipt"!=t.template.target),m.Eb(3),m.uc("label","",m.nc(20,24,"lang.loadedFile")," :"),m.Eb(2),m.sc("value",t.template.file.paper.name),m.Eb(2),m.Uc(" ",t.functionsService.empty(t.template.file.paper)||t.functionsService.empty(t.template.file.paper.name)?t.translate.instant("lang.importFile"):t.template.file.paper.name," "),m.Eb(1),m.sc("ngForOf",t.extensionModels),m.Eb(1),m.sc("ngIf",t.creationMode&&t.selectedModelFile||!t.creationMode&&!t.functionsService.empty(t.template.file.paper.name)),m.Eb(1),m.sc("ngIf",!t.selectedModelFile||!t.creationMode&&"java"!==t.headerService.user.preferences.documentEdition),m.Eb(1),m.sc("ngIf",null!==t.templateDocView)}}function mh(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",22),m.Zb(1,"form",23,24),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(3,"div",25),m.Qc(4,ju,6,7,"div",26),m.Zb(5,"div",27),m.Zb(6,"div",25),m.Zb(7,"mat-form-field"),m.Zb(8,"input",28),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().template.label=e})),m.mc(9,"translate"),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(11,"div",27),m.Zb(12,"div",25),m.Zb(13,"mat-form-field"),m.Zb(14,"textarea",29),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().template.description=e})),m.mc(15,"translate"),m.mc(16,"translate"),m.Sc(17,"                                    "),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"div",27),m.Zb(19,"div",25),m.Zb(20,"mat-form-field"),m.Zb(21,"mat-select",30),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().template.target=e}))("selectionChange",(function(){return m.Hc(t),m.lc().updateTemplateType()})),m.mc(22,"translate"),m.mc(23,"translate"),m.Qc(24,Ru,3,4,"mat-option",31),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(25,Au,10,11,"div",26),m.Qc(26,Hu,15,17,"div",26),m.Qc(27,$u,6,7,"div",26),m.Qc(28,Vu,4,2,"div",26),m.Qc(29,Ku,11,4,"div",26),m.Qc(30,th,7,8,"div",26),m.Qc(31,eh,4,2,"div",26),m.Qc(32,nh,10,11,"div",26),m.Qc(33,bh,28,26,"div",26),m.Yb(),m.Zb(34,"div",32),m.Zb(35,"button",33),m.Sc(36),m.mc(37,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.lc();m.Eb(4),m.sc("ngIf",!e.creationMode),m.Eb(4),m.tc("title",m.nc(9,23,"lang.templateName")),m.tc("placeholder",m.nc(10,25,"lang.templateName")),m.sc("ngModel",e.template.label),m.Eb(6),m.tc("placeholder",m.nc(15,27,"lang.description")),m.tc("title",m.nc(16,29,"lang.description")),m.sc("ngModel",e.template.description),m.Eb(7),m.tc("title",m.nc(22,31,"lang.templateTarget")),m.tc("placeholder",m.nc(23,33,"lang.templateTarget")),m.sc("disabled",!e.creationMode)("ngModel",e.template.target),m.Eb(3),m.sc("ngForOf",e.targetTypes),m.Eb(1),m.sc("ngIf","attachments"==e.template.target),m.Eb(1),m.sc("ngIf","acknowledgementReceipt"==e.template.target),m.Eb(1),m.sc("ngIf","sendmail"==e.template.target),m.Eb(1),m.sc("ngIf",e.availableTypes.length>1),m.Eb(1),m.sc("ngIf","OFFICE"==e.template.type),m.Eb(1),m.sc("ngIf","TXT"==e.template.type),m.Eb(1),m.sc("ngIf","HTML"==e.template.type),m.Eb(1),m.sc("ngIf","notifications"==e.template.target),m.Eb(1),m.sc("ngIf","OFFICE_HTML"==e.template.type),m.Eb(2),m.sc("disabled",!t.form.valid||e.lockFound),m.Eb(1),m.Tc(m.nc(37,35,"lang.save"))}}function ph(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Zb(1,"mat-icon",5),m.Ub(2,"i",6),m.Yb(),m.Zb(3,"span",7),m.Sc(4),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(4),m.Uc(" ",t.entity_label," ")}}let uh=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r,l,d){this.http=t,this.sanitizer=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.dialog=c,this.appService=o,this.viewContainerRef=r,this.functionsService=l,this.translate=d,this.loading=!1,this.template={id:0,label:"",description:"",datasource:"letterbox_attachment",target:"",type:"",file:null},this.targetTypes=["acknowledgementReceipt","notes","sendmail","indexingFile","notifications","attachments"],this.allowedExtensions=["doc","docx","dotx","odt","ott","html","xlsl","xlsx","xltx","ods","ots","csv"],this.selectedModelFile=null,this.availableTypes=[],this.statuses=[],this.categoriesList=[],this.keywordsList=[],this.jnlpValue={},this.extensionModels=[],this.buttonFileName=this.translate.instant("lang.importFile"),this.lockFound=!1,this.templateDocView=null,this.data=[],this.config={}}ngOnInit(){this.loading=!0,this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.templateCreation")),this.creationMode=!0,this.http.get("../rest/administration/templates/new").subscribe(t=>{this.setInitialValue(t),this.loading=!1})):(this.creationMode=!1,this.http.get("../rest/templates/"+t.id+"/details").subscribe(t=>{this.setInitialValue(t),this.template={id:t.template.template_id,label:t.template.template_label,description:t.template.template_comment,datasource:t.template.template_datasource,target:t.template.template_target,type:t.template.template_type,subject:t.template.subject,file:{}},this.updateTemplateType(),this.selectedModelFile=t.template.template_file_name,this.template.template_attachment_type=t.template.template_attachment_type,"HTML"===this.template.type||"TXT"===this.template.type?this.template.file.content=t.template.template_content:"OFFICE"===this.template.type?(this.template.file.format=t.template.template_file_name.split(".").pop(),this.template.file.name=t.template.template_file_name,this.getViewTemplateContent()):"acknowledgementReceipt"===this.template.target&&(this.functionsService.empty(t.template.template_file_name)||(this.template.file.paper.format=t.template.template_file_name.split(".").pop()),this.template.file.paper.name=t.template.template_file_name,this.template.file.electronic.content=t.template.template_content,this.getViewTemplateContent()),this.headerService.setHeader(this.translate.instant("lang.templateModification"),this.template.template_label),this.loading=!1})),this.template.template_attachment_type||(this.template.template_attachment_type="all")})}getViewTemplateContent(){this.http.get(`../rest/templates/${this.template.id}/content`).pipe(Object(d.a)(t=>{this.templateDocView=this.sanitizer.bypassSecurityTrustResourceUrl("data:application/pdf;base64,"+t.encodedDocument)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}initMce(t){setTimeout(()=>{tinymce.remove("textarea"),tinymce.baseURL="../node_modules/tinymce",tinymce.suffix=".min",tinymce.init({selector:t,statusbar:!1,language:this.translate.instant("lang.langISO").replace("-","_"),language_url:`../node_modules/tinymce-i18n/langs/${this.translate.instant("lang.langISO").replace("-","_")}.js`,height:"200",plugins:["autoresize","code"],external_plugins:{maarch_b64image:"../../src/frontend/plugins/tinymce/maarch_b64image/plugin.min.js"},menubar:!1,toolbar:"undo | bold italic underline | alignleft aligncenter alignright | maarch_b64image | forecolor | code",theme_buttons1_add:"fontselect,fontsizeselect",theme_buttons2_add_before:"cut,copy,paste,pastetext,pasteword,separator,search,replace,separator",theme_buttons2_add:"separator,insertdate,inserttime,preview,separator,forecolor,backcolor",theme_buttons3_add_before:"tablecontrols,separator",theme_buttons3_add:"separator,print,separator,ltr,rtl,separator,fullscreen,separator,insertlayer,moveforward,movebackward,absolut",theme_toolbar_align:"left",theme_advanced_toolbar_location:"top",theme_styles:"Header 1=header1;Header 2=header2;Header 3=header3;Table Row=tableRow1",setup:t=>{t.on("keyup",t=>{"HTML"===this.template.type&&null!=tinymce.get("templateHtml")&&(this.template.file.content=tinymce.get("templateHtml").getContent()),"OFFICE_HTML"===this.template.type&&null!=tinymce.get("templateOfficeHtml")&&(this.template.file.electronic.content=tinymce.get("templateOfficeHtml").getContent())})}})},20)}setInitialValue(t){this.extensionModels=[],t.templatesModels.forEach(t=>{-1===this.extensionModels.indexOf(t.fileExt)&&this.extensionModels.push(t.fileExt)}),this.defaultTemplatesList=t.templatesModels,this.attachmentTypesList=t.attachmentTypes,this.datasourcesList=t.datasources,this.maarchTree.initData(t.entities.map(t=>Object.assign(Object.assign({},t),{id:t.serialId})))}getBase64Document(t){const e=new Uint8Array(t).reduce((t,e)=>t+String.fromCharCode(e),"");return btoa(e)}uploadFileTrigger(t){if(t.target.files&&t.target.files[0]&&this.isExtensionAllowed(t.target.files[0])){const e=new FileReader;"acknowledgementReceipt"===this.template.target?(this.template.file.paper={name:"",type:"",content:""},this.template.file.paper.name=t.target.files[0].name,this.selectedModelFile=this.template.file.paper.name,this.template.file.paper.type=t.target.files[0].type,this.template.file.paper.format=this.template.file.paper.name.split(".").pop()):(this.template.file={name:"",type:"",content:""},this.template.file.name=t.target.files[0].name,this.selectedModelFile=this.template.file.name,this.template.file.type=t.target.files[0].type,this.template.file.format=this.template.file.name.split(".").pop()),e.readAsArrayBuffer(t.target.files[0]),e.onload=t=>{"acknowledgementReceipt"===this.template.target?this.template.file.paper.content=this.getBase64Document(t.target.result):this.template.file.content=this.getBase64Document(t.target.result),this.getViewTemplateFile()}}}isExtensionAllowed(t){const e=t.name.toLowerCase().split(".").pop();return 0!==this.allowedExtensions.filter(t=>t.toLowerCase()===e.toLowerCase()).length||(this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.notAllowedExtension")+" !",msg:this.translate.instant("lang.file")+" : <b>"+t.name+"</b>, "+this.translate.instant("lang.type")+" : <b>"+t.type+"</b><br/><br/><u>"+this.translate.instant("lang.allowedExtensions")+"</u> : <br/>"+this.allowedExtensions.filter((t,e,i)=>e===i.indexOf(t)).join(", ")}}),!1)}editFile(){const t={docUrl:"rest/onlyOffice/mergedFile"};if(this.creationMode){if("acknowledgementReceipt"!==this.template.target)if(this.functionsService.empty(this.template.file.content)){t.objectType="templateCreation";for(const e of this.defaultTemplatesList)this.selectedModelFile===e.fileExt+": "+e.fileName&&(t.objectId=e.filePath);t.extension=t.objectId.toLowerCase().split(".").pop()}else t.objectType="encodedResource",t.objectId=this.template.file.content,t.extension=this.template.file.format;else if("acknowledgementReceipt"===this.template.target)if(this.functionsService.empty(this.template.file.paper.content)){t.objectType="templateCreation";for(const e of this.defaultTemplatesList)this.selectedModelFile===e.fileExt+": "+e.fileName&&(t.objectId=e.filePath);t.extension=t.objectId.toLowerCase().split(".").pop()}else t.objectType="encodedResource",t.objectId=this.template.file.paper.content,t.extension=this.template.file.paper.format}else"acknowledgementReceipt"!==this.template.target?this.functionsService.empty(this.template.file.content)?(t.objectType="templateModification",t.objectId=this.template.id,t.extension=this.template.file.name.toLowerCase().split(".").pop()):(t.objectType="encodedResource",t.objectId=this.template.file.content,t.extension=this.template.file.format):"acknowledgementReceipt"===this.template.target&&(this.functionsService.empty(this.template.file.paper.content)?(t.objectType="templateModification",t.objectId=this.template.id,t.extension=this.template.file.paper.name.toLowerCase().split(".").pop()):(t.objectType="encodedResource",t.objectId=this.template.file.paper.content,t.extension=this.template.file.paper.format));if("java"===this.headerService.user.preferences.documentEdition){if(this.creationMode){t.objectId="",t.objectType="templateCreation";for(const e of this.defaultTemplatesList)this.selectedModelFile===e.fileExt+": "+e.fileName&&(t.objectId=e.filePath);if(this.functionsService.empty(t.objectId))return alert(this.translate.instant("lang.canNotEditImportedDocumentWhenJava")),!1}else t.objectType="templateModification",t.objectId=this.template.id;this.launchJavaEditor(t)}else"java"!==this.headerService.user.preferences.documentEdition&&this.launchIntegratedEditor(t,this.headerService.user.preferences.documentEdition)}launchJavaEditor(t){this.http.post("../rest/jnlp",t).pipe(Object(d.a)(e=>{window.location.href="../rest/jnlp/"+e.generatedJnlp,this.checkLockFile(e.jnlpUniqueId,t.extension)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}launchIntegratedEditor(t,e){this.dialogRef=this.dialog.open(ku,{autoFocus:!1,panelClass:"maarch-full-height-modal",minWidth:"80%",disableClose:!0,data:{title:this.template.template_style,editorOptions:t,file:{format:t.extension},editorType:e}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>!this.functionsService.empty(t)),Object(d.a)(e=>{"acknowledgementReceipt"===this.template.target?(this.template.file.paper.name=this.selectedModelFile,this.template.file.paper.format=t.extension,this.template.file.paper.content=e.content):(this.template.file.name=this.selectedModelFile,this.template.file.format=t.extension,this.template.file.content=e.content),this.getViewTemplateFile()}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}getViewTemplateFile(){this.http.post("../rest/convertedFile/encodedFile",{encodedFile:"acknowledgementReceipt"===this.template.target?this.template.file.paper.content:this.template.file.content,format:"acknowledgementReceipt"===this.template.target?this.template.file.paper.format:this.template.file.format}).pipe(Object(d.a)(t=>{this.templateDocView=this.sanitizer.bypassSecurityTrustResourceUrl("data:application/pdf;base64,"+t.encodedResource)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}checkLockFile(t,e){this.intervalLockFile=setInterval(()=>{this.http.get("../rest/jnlp/lock/"+t).pipe(Object(d.a)(t=>{this.lockFound=t.lockFileFound,this.lockFound||(clearInterval(this.intervalLockFile),this.loadTmpFile(`${t.fileTrunk}.${e}`))})).subscribe()},1e3)}loadTmpFile(t){this.http.get(`../rest/convertedFile/${t}?convert=true`).pipe(Object(d.a)(e=>{"acknowledgementReceipt"===this.template.target?(this.template.file.paper.name=this.selectedModelFile,this.template.file.paper.format=t.toLowerCase().split(".").pop(),this.template.file.paper.content=e.encodedResource):(this.template.file.name=this.selectedModelFile,this.template.file.format=t.toLowerCase().split(".").pop(),this.template.file.content=e.encodedResource),this.templateDocView=this.sanitizer.bypassSecurityTrustResourceUrl("data:application/pdf;base64,"+e.encodedConvertedResource)})).subscribe()}duplicateTemplate(){this.lockFound||"acknowledgementReceipt"===this.template.target||confirm(this.translate.instant("lang.confirmDuplicate"))&&this.http.post("../rest/templates/"+this.template.id+"/duplicate",{id:this.template.id}).subscribe(t=>{this.notify.success(this.translate.instant("lang.templateDuplicated")),this.router.navigate(["/administration/templates/"+t.id])},t=>{this.notify.error(t.error.errors)})}onSubmit(){this.isValidTemplate()&&(this.creationMode?this.http.post("../rest/templates",this.formatTemplate()).pipe(Object(d.a)(t=>{t.checkEntities?(this.config={panelClass:"maarch-modal",data:{entitiesList:t.checkEntities,template_attachment_type:this.template.template_attachment_type}},this.dialog.open(hh,this.config)):(this.router.navigate(["/administration/templates"]),this.notify.success(this.translate.instant("lang.templateAdded")))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe():this.http.put("../rest/templates/"+this.template.id,this.formatTemplate()).pipe(Object(d.a)(t=>{!this.functionsService.empty(t)&&t.checkEntities?(this.config={panelClass:"maarch-modal",data:{entitiesList:t.checkEntities,template_attachment_type:this.template.template_attachment_type}},this.dialogRef=this.dialog.open(hh,this.config)):(this.router.navigate(["/administration/templates"]),this.notify.success(this.translate.instant("lang.templateUpdated")))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe())}formatTemplate(){const t=Object.assign({},this.template);return t.entities=this.maarchTree.getSelectedNodes().map(t=>t.entity_id),t}isValidTemplate(){return"acknowledgementReceipt"===this.template.target&&this.functionsService.empty(this.template.file.paper.name)&&this.functionsService.empty(this.template.file.electronic.content)?(alert(this.translate.instant("lang.mustCompleteAR")),!1):"acknowledgementReceipt"===this.template.target||"OFFICE"!==this.template.type||!this.functionsService.empty(this.template.file.name)||(alert(this.translate.instant("lang.editModelFirst")),!1)}displayDatasources(t){return"notification"===t.target&&"notifications"===this.template.target||"document"===t.target&&"notifications"!==this.template.target}updateTemplateType(){this.template.file={name:"",type:"",content:""},this.templateDocView=null,["attachments","indexingFile"].indexOf(this.template.target)>-1?(this.template.type="OFFICE",this.availableTypes=["OFFICE"]):["notifications","sendmail"].indexOf(this.template.target)>-1?(this.template.type="HTML",this.availableTypes=["HTML","TXT"],this.initMce("textarea#templateHtml")):"notes"===this.template.target?(this.template.type="TXT",this.availableTypes=["TXT"]):"acknowledgementReceipt"===this.template.target&&(this.template.file={electronic:{name:"",type:"",content:""},paper:{name:"",type:"",content:""}},this.template.type="OFFICE_HTML",this.availableTypes=[],this.template.template_attachment_type="",this.initMce("textarea#templateOfficeHtml"))}changeType(t){"HTML"===t.value?this.initMce("textarea#templateHtml"):tinymce.remove("textarea"),this.template.type=t.value}changeModel(){this.template.file={name:"",type:"",content:""},this.template.file={electronic:{name:"",type:"",content:""}}}loadTab(t){0===t.index?this.initMce("textarea#templateOfficeHtml"):(tinymce.remove("textarea"),null==this.template.template_file_name&&null==this.template.template_style&&(this.buttonFileName=this.translate.instant("lang.importFile")))}ngOnDestroy(){tinymce.remove("textarea"),this.intervalLockFile&&clearInterval(this.intervalLockFile)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.b),m.Tb(bl.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(H.b),m.Tb(f.a),m.Tb(m.R),m.Tb(C.a),m.Tb(p.e))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Iu,!0),m.Oc(Du,!0),m.Oc(Uu,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.maarchTree=i.first))},decls:24,vars:14,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content",2,"padding","10px 10px 0px 10px"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content","style","display: contents;",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","width","400px",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[2,"padding","10px"],["maarchTree",""],[4,"ngIf"],["mat-list-item","",3,"disableRipple","click"],["color","primary","mat-list-icon","",1,"fa","fa-copy"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content",2,"display","contents"],[1,"form-horizontal",2,"display","contents",3,"ngSubmit"],["templatesFormUp","ngForm"],[1,"col-sm-12"],["class","form-group",4,"ngIf"],[1,"form-group"],["matInput","","name","label","type","text","maxlength","255","required","",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","description","name","template_comment","matTextareaAutosize","","matAutosizeMinRows","2","matAutosizeMaxRows","5","required","",3,"ngModel","placeholder","title","ngModelChange"],["name","target","required","",3,"disabled","title","placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-12",2,"background","white","position","sticky","bottom","0px","text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["matInput","","type","number","disabled","",3,"title","value","placeholder"],[3,"value"],["id","template_attachment_type","name","template_attachment_type",3,"title","placeholder","ngModel","ngModelChange"],["value","all"],["id","template_attachment_type","name","template_attachment_type","required","",3,"disabled","title","placeholder","ngModel","ngModelChange"],["value","simple"],["value","sva"],["value","svr"],["matInput","","name","subject","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["required","","name","type",3,"disabled","change"],["style","margin-left:10px","color","primary","name","type",3,"value","checked",4,"ngFor","ngForOf"],["color","primary","name","type",2,"margin-left","10px",3,"value","checked"],[1,"col-md-12",2,"display","none"],[1,"form-inline","hide"],["type","file","name","files[]","accept","application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml\u200c.slideshow,application/vnd.oasis.opendocument.text,application/vnd.oasis.opendocument.presentation,application/vnd.oasis.opendocument.spreadsheet",3,"change"],["uploadSignFileOffice",""],["mat-raised-button","","color","default","type","button",3,"disabled","click",4,"ngIf"],["style","width:100%;height:800px;",3,"src",4,"ngIf"],["id","template_style","name","template_style",3,"disabled","title","placeholder","ngModel","required","ngModelChange","selectionChange"],[3,"label"],[1,"selectFile",3,"value","click"],["color","primary",1,"fa","fa-paperclip",2,"height","auto"],[4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["mat-raised-button","","color","default","type","button",3,"disabled","click"],[2,"width","100%","height","800px",3,"src"],["matInput","","name","templateTxt","id","templateTxt","matTextareaAutosize","","matAutosizeMinRows","5","matAutosizeMaxRows","5",3,"ngModel","placeholder","title","required","ngModelChange"],["id","html_mode",2,"display","block","width","100%"],["name","templateHtml","id","templateHtml","rows","15","cols","60",2,"width","100%",3,"ngModel","required","ngModelChange"],["id","datasource","name","datasource",3,"title","placeholder","ngModel","ngModelChange"],["value",""],[3,"selectedTabChange"],["name","templateOfficeHtml","id","templateOfficeHtml","rows","15","cols","60",2,"width","100%",3,"ngModel","required","ngModelChange"],["uploadSignFileOfficeHtml",""],["id","template_style","name","template_style",3,"disabled","title","placeholder","ngModel","required","ngModelChange"],[2,"text-align","center",3,"value","click"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Fu,1,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Lu,2,0,"div",9),m.Qc(14,mh,38,37,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.Zb(17,"mat-list"),m.Zb(18,"h3",13),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"div",14),m.Ub(22,"app-maarch-flat-tree",null,15),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()),m.Eb(4),m.Tc(m.nc(20,12,"lang.chooseEntityAssociationModel")))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Ot.g,Ue.a,Ot.h,Ot.d,Tt.a,Ot.c,I.k,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.o,o.E,o.t,o.w,O.d,at.a,x.s,D.b,I.o,Qe.b,Qe.a,I.n,Ie.c,Ie.a],pipes:[p.d],styles:[".mat-list-item.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:default}.mat-list-item.disabled[_ngcontent-%COMP%]:active, .mat-list-item.disabled[_ngcontent-%COMP%]:focus, .mat-list-item.disabled[_ngcontent-%COMP%]:hover{background:initial}.selectFile[_ngcontent-%COMP%]{text-align:center}.selectFile[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex!important;align-items:center;justify-content:center}"]}),t})(),hh=(()=>{class t{constructor(t,e,i){this.http=t,this.data=e,this.dialogRef=i}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.b),m.Tb(H.a),m.Tb(H.h))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:18,vars:13,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["role","alert",1,"alert-message","alert-message-info"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",3,"click"],["mat-list-icon",""],["color","primary",1,"fa","fa-share-alt"],["mat-line",""]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"div",2),m.Zb(6,"p"),m.Sc(7),m.mc(8,"translate"),m.Zb(9,"b"),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(12,"mat-list"),m.Qc(13,ph,5,1,"mat-list-item",3),m.Yb(),m.Yb(),m.Zb(14,"mat-dialog-actions"),m.Zb(15,"button",4),m.hc("click",(function(){return e.dialogRef.close()})),m.Sc(16),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,5,"lang.templateAssociateEntities")),m.Eb(5),m.Tc(m.nc(8,7,"lang.templateCheckEntities")),m.Eb(3),m.Tc(m.nc(11,9,"lang.AR"+e.data.template_attachment_type)),m.Eb(3),m.sc("ngForOf",e.data.entitiesList),m.Eb(3),m.Tc(m.nc(17,11,"lang.close")))},directives:[H.i,H.f,Ot.a,x.s,H.c,D.b,Ot.d,Tt.a,Ot.c,I.k],pipes:[p.d],styles:[".alert-message[_ngcontent-%COMP%]{max-width:inherit}"]}),t})();function fh(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function gh(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",13),m.mc(3,"translate"),m.Zb(4,"form",14,15),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(6,"mat-list"),m.Zb(7,"p",16),m.Zb(8,"mat-slide-toggle",17),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.complexityUpper)})),m.Sc(9),m.Yb(),m.Zb(10,"mat-slide-toggle",17),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.complexityNumber)})),m.Sc(11),m.Yb(),m.Zb(12,"mat-slide-toggle",17),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.complexitySpecial)})),m.Sc(13),m.Yb(),m.Yb(),m.Zb(14,"mat-list-item",18),m.Zb(15,"mat-icon",19),m.Zb(16,"mat-slide-toggle",20),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.minLength)})),m.Yb(),m.Yb(),m.Zb(17,"p",21),m.Zb(18,"mat-form-field"),m.Zb(19,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().passwordRules.minLength.value=e})),m.Yb(),m.Zb(20,"span",23),m.Sc(21),m.mc(22,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(23,"mat-list-item",18),m.Zb(24,"mat-icon",19),m.Zb(25,"mat-slide-toggle",20),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.lockAttempts)})),m.Yb(),m.Yb(),m.Zb(26,"p",24),m.Zb(27,"mat-form-field",25),m.Zb(28,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().passwordRules.lockAttempts.value=e})),m.Yb(),m.Yb(),m.Zb(29,"mat-form-field",26),m.Zb(30,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().passwordRules.lockTime.value=e})),m.Yb(),m.Zb(31,"span",23),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(34,"mat-list-item",18),m.Zb(35,"mat-icon",19),m.Zb(36,"mat-slide-toggle",20),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.renewal)})),m.Yb(),m.Yb(),m.Zb(37,"p",21),m.Zb(38,"mat-form-field"),m.Zb(39,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().passwordRules.renewal.value=e})),m.Yb(),m.Zb(40,"span",23),m.Sc(41),m.mc(42,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(43,"mat-list-item",18),m.Zb(44,"mat-icon",19),m.Zb(45,"mat-slide-toggle",20),m.hc("change",(function(){m.Hc(t);const e=m.lc();return e.toggleRule(e.passwordRules.historyLastUse)})),m.Yb(),m.Yb(),m.Zb(46,"p",21),m.Zb(47,"mat-form-field"),m.Zb(48,"input",22),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().passwordRules.historyLastUse.value=e})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(49,"div",27),m.Zb(50,"button",28),m.Sc(51),m.mc(52,"translate"),m.Yb(),m.Zb(53,"button",29),m.hc("click",(function(){return m.Hc(t),m.lc().cancelModification()})),m.Sc(54),m.mc(55,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(5),e=m.lc();m.Eb(2),m.tc("label",m.nc(3,41,"lang.password")),m.Eb(6),m.sc("name",e.passwordRules.complexityUpper.label)("checked",e.passwordRules.complexityUpper.enabled),m.Eb(1),m.Uc(" ",e.passwordRules.complexityUpper.label,""),m.Eb(1),m.sc("name",e.passwordRules.complexityNumber.label)("checked",e.passwordRules.complexityNumber.enabled),m.Eb(1),m.Uc(" ",e.passwordRules.complexityNumber.label,""),m.Eb(1),m.sc("name",e.passwordRules.complexitySpecial.label)("checked",e.passwordRules.complexitySpecial.enabled),m.Eb(1),m.Uc(" ",e.passwordRules.complexitySpecial.label,""),m.Eb(3),m.sc("checked",e.passwordRules.minLength.enabled),m.Eb(3),m.tc("placeholder",e.passwordRules.minLength.label),m.sc("disabled",!e.passwordRules.minLength.enabled)("name",e.passwordRules.minLength.label)("ngModel",e.passwordRules.minLength.value),m.Eb(2),m.Uc("\xa0",m.nc(22,43,"lang.chars"),""),m.Eb(4),m.sc("checked",e.passwordRules.lockAttempts.enabled),m.Eb(3),m.tc("placeholder",e.passwordRules.lockAttempts.label),m.sc("disabled",!e.passwordRules.lockAttempts.enabled)("name",e.passwordRules.lockAttempts.label)("ngModel",e.passwordRules.lockAttempts.value),m.Eb(2),m.tc("placeholder",e.passwordRules.lockTime.label),m.sc("disabled",!e.passwordRules.lockTime.enabled)("name",e.passwordRules.lockTime.label)("ngModel",e.passwordRules.lockTime.value),m.Eb(2),m.Uc("\xa0",m.nc(33,45,"lang.minutes"),""),m.Eb(4),m.sc("checked",e.passwordRules.renewal.enabled),m.Eb(3),m.tc("placeholder",e.passwordRules.renewal.label),m.sc("disabled",!e.passwordRules.renewal.enabled)("name",e.passwordRules.renewal.label)("ngModel",e.passwordRules.renewal.value),m.Eb(2),m.Uc("\xa0",m.nc(42,47,"lang.days"),""),m.Eb(4),m.sc("checked",e.passwordRules.historyLastUse.enabled),m.Eb(3),m.tc("placeholder",e.passwordRules.historyLastUse.label),m.sc("disabled",!e.passwordRules.historyLastUse.enabled)("name",e.passwordRules.historyLastUse.label)("ngModel",e.passwordRules.historyLastUse.value),m.Eb(2),m.sc("disabled",!t.valid&&!e.disabledForm()||e.checkModif()),m.Eb(1),m.Tc(m.nc(52,49,"lang.validate")),m.Eb(2),m.sc("disabled",e.checkModif()),m.Eb(1),m.Tc(m.nc(55,51,"lang.cancel"))}}let vh=(()=>{class t{constructor(t,e,i,a,n){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.loading=!1,this.passwordRules={minLength:{enabled:!1,value:0},complexityUpper:{enabled:!1,value:0},complexityNumber:{enabled:!1,value:0},complexitySpecial:{enabled:!1,value:0},renewal:{enabled:!1,value:0},historyLastUse:{enabled:!1,value:0},lockTime:{enabled:!1,value:0},lockAttempts:{enabled:!1,value:0}},this.passwordRulesClone={},this.passwordRulesList=[]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.securitiesAdministration")),this.loading=!0,this.http.get("../rest/passwordRules").subscribe(t=>{this.passwordRulesList=t.rules,t.rules.forEach(t=>{this.passwordRules[t.label].enabled=t.enabled,this.passwordRules[t.label].value=t.value,this.passwordRules[t.label].label=this.translate.instant("lang.password"+t.label+"Required"),this.passwordRules[t.label].id=t.label,this.loading=!1}),this.passwordRulesClone=JSON.parse(JSON.stringify(this.passwordRules))},t=>{this.notify.error(t.error.errors)})}cancelModification(){this.passwordRules=JSON.parse(JSON.stringify(this.passwordRulesClone)),this.passwordRulesList.forEach(t=>{t.enabled=this.passwordRules[t.label].enabled,t.value=this.passwordRules[t.label].value})}checkModif(){return JSON.stringify(this.passwordRules)===JSON.stringify(this.passwordRulesClone)}disabledForm(){return!(this.passwordRules.lockTime.enabled||this.passwordRules.minLength.enabled||this.passwordRules.lockAttempts.enabled||this.passwordRules.renewal.enabled||this.passwordRules.historyLastUse.enabled)}toggleRule(t){t.enabled=!t.enabled,this.passwordRulesList.forEach(e=>{"lockAttempts"!==t.id||"lockTime"!==e.label&&"lockAttempts"!==e.label?t.id===e.label&&(e.enabled=t.enabled):(e.enabled=t.enabled,this.passwordRules.lockTime.enabled=t.enabled)})}onSubmit(){this.passwordRulesList.forEach(t=>{t.enabled=this.passwordRules[t.label].enabled,t.value=this.passwordRules[t.label].value}),this.http.put("../rest/passwordRules",{rules:this.passwordRulesList}).subscribe(t=>{this.passwordRulesClone=JSON.parse(JSON.stringify(this.passwordRules)),this.notify.success(this.translate.instant("lang.passwordRulesUpdated"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"label"],[3,"ngSubmit"],["passwordForm","ngForm"],[2,"margin-bottom","40px","text-align","center"],["color","primary",2,"padding-left","10px","padding-right","10px",3,"name","checked","change"],[2,"margin-top","15px","margin-bottom","15px"],["mat-list-icon",""],["color","primary",2,"position","relative","top","-10px",3,"checked","change"],["mat-line",""],["type","number","min","1","pattern","^[1-9][0-9]*","matInput","","required","",3,"disabled","name","ngModel","placeholder","ngModelChange"],["matSuffix",""],["mat-line","",2,"display","flex"],[2,"flex","1","padding-right","10px"],[2,"flex","1"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],["mat-raised-button","","type","button","color","default",3,"disabled","click"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,fh,2,0,"div",8),m.Qc(12,gh,56,53,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,Ie.c,Ie.a,o.J,o.u,o.v,Ot.a,et.a,Ot.d,Tt.a,Ot.c,I.k,w.c,o.z,O.b,o.c,o.A,o.E,o.t,o.w,w.j,D.b],pipes:[p.d],encapsulation:2}),t})();const yh=["snav2"],Ch=["adminMenuTemplate"],Eh=["sendmailForm"];function Sh(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",14),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",22),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(16).toggle()})),m.Ub(5,"mat-icon",23),m.Zb(6,"p",24),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()}2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.checkSendmail")," "))}function Mh(t,e){1&t&&(m.Zb(0,"div",25),m.Ub(1,"mat-spinner",26),m.Yb())}function Yh(t,e){if(1&t&&(m.Zb(0,"mat-option",49),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function Zh(t,e){if(1&t&&(m.Zb(0,"mat-option",49),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}const xh=function(){return["smtp","mail"]},_h=function(t){return[t]};function wh(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",27),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",28),m.mc(3,"translate"),m.Zb(4,"form",29,30),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(6,"div",15),m.Zb(7,"div",31),m.Zb(8,"mat-form-field"),m.Zb(9,"mat-select",32,33),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.type=e})),m.mc(11,"translate"),m.Qc(12,Yh,2,2,"mat-option",34),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"div",15),m.Zb(14,"div",35),m.Zb(15,"mat-form-field"),m.Zb(16,"mat-select",36),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.secure=e})),m.mc(17,"translate"),m.Qc(18,Zh,2,2,"mat-option",34),m.Yb(),m.Yb(),m.Yb(),m.Zb(19,"div",37),m.Zb(20,"mat-form-field"),m.Zb(21,"input",38),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.host=e})),m.mc(22,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(23,"div",39),m.Zb(24,"mat-form-field"),m.Zb(25,"input",40),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.port=e})),m.mc(26,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(27,"div",15),m.Zb(28,"div",16),m.Zb(29,"mat-slide-toggle",41),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.auth=e}))("change",(function(e){return m.Hc(t),m.lc().cleanAuthInfo(e)})),m.Sc(30),m.mc(31,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(32,"div",15),m.Zb(33,"div",16),m.Zb(34,"mat-form-field"),m.Zb(35,"input",42),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.user=e})),m.mc(36,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(37,"div",16),m.Zb(38,"mat-form-field"),m.Zb(39,"input",43),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.password=e})),m.Yb(),m.Zb(40,"mat-icon",44),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.hidePassword=!e.hidePassword})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(41,"div",15),m.Zb(42,"div",16),m.Zb(43,"mat-form-field"),m.Zb(44,"input",45),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().sendmail.from=e})),m.mc(45,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(46,"div",46),m.Zb(47,"button",47),m.Sc(48),m.mc(49,"translate"),m.Yb(),m.Zb(50,"button",48),m.hc("click",(function(){return m.Hc(t),m.lc().cancelModification()})),m.Sc(51),m.mc(52,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(5),e=m.lc();m.Eb(2),m.tc("label",m.nc(3,38,"lang.informations")),m.Eb(7),m.tc("placeholder",m.nc(11,40,"lang.configurationType")),m.sc("ngModel",e.sendmail.type),m.Eb(3),m.sc("ngForOf",e.smtpTypeList),m.Eb(1),m.Pc("opacity",m.yc(58,xh).indexOf(e.sendmail.type)>-1?"1":"0.5"),m.Eb(3),m.tc("placeholder",m.nc(17,42,"lang.smtpAuth")),m.sc("disabled",-1==m.yc(59,xh).indexOf(e.sendmail.type))("ngModel",e.sendmail.secure),m.Eb(2),m.sc("ngForOf",e.smtpSecList),m.Eb(3),m.tc("placeholder",m.nc(22,44,"lang.host")),m.sc("disabled",-1==m.yc(60,xh).indexOf(e.sendmail.type))("ngModel",e.sendmail.host),m.Eb(4),m.tc("placeholder",m.nc(26,46,"lang.port")),m.sc("ngModel",e.sendmail.port)("disabled",-1==m.yc(61,xh).indexOf(e.sendmail.type)),m.Eb(2),m.Pc("opacity",m.yc(62,xh).indexOf(e.sendmail.type)>-1?"1":"0.5"),m.Eb(2),m.sc("ngModel",e.sendmail.auth)("disabled",-1==m.yc(63,xh).indexOf(e.sendmail.type)),m.Eb(1),m.Tc(m.nc(31,48,"lang.enableAuth")),m.Eb(2),m.Pc("opacity",m.yc(64,xh).indexOf(e.sendmail.type)>-1?"1":"0.5"),m.Eb(3),m.tc("placeholder",m.nc(36,50,"lang.id")),m.sc("ngModel",e.sendmail.user)("disabled",!e.sendmail.auth||-1==m.yc(65,xh).indexOf(e.sendmail.type)),m.Eb(4),m.sc("type",e.hidePassword?"password":"text")("ngModel",e.sendmail.password)("disabled",!e.sendmail.auth||-1==m.yc(66,xh).indexOf(e.sendmail.type))("placeholder",e.translate.instant(!0===e.sendmail.passwordAlreadyExists?"lang.passwordModification":"lang.password"))("required",!e.sendmail.passwordAlreadyExists),m.Eb(1),m.sc("ngClass",m.zc(67,_h,e.hidePassword?"fa-eye-slash":"fa-eye")),m.Eb(4),m.tc("placeholder",m.nc(45,52,"lang.mailFrom")),m.sc("ngModel",e.sendmail.from),m.Eb(3),m.sc("disabled",e.checkModif()||!t.valid),m.Eb(1),m.Tc(m.nc(49,54,"lang.validate")),m.Eb(2),m.sc("disabled",e.checkModif()),m.Eb(1),m.Tc(m.nc(52,56,"lang.cancel"))}}function Oh(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-icon",50),m.hc("click",(function(){return m.Hc(t),m.lc().testEmailSend()})),m.mc(1,"translate"),m.Yb()}2&t&&m.tc("title",m.nc(1,1,"lang.beginSendTest"))}function Th(t,e){if(1&t&&(m.Zb(0,"mat-list-item"),m.Ub(1,"mat-icon",51),m.Zb(2,"p",24),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.Hb("fas ",t.emailSendResult.icon," fa-2x"),m.Eb(2),m.Uc(" ",t.emailSendResult.msg," ")}}function kh(t,e){if(1&t&&(m.Zb(0,"div",52),m.Sc(1),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.Uc(" ",t.emailSendResult.debug," ")}}let Ih=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.viewContainerRef=s,this.loading=!1,this.sendmail={type:"smtp",host:"",auth:!0,user:"",password:"",secure:"ssl",port:"465",charset:"utf-8",from:""},this.smtpTypeList=[{id:"smtp",label:this.translate.instant("lang.smtpclient")},{id:"sendmail",label:this.translate.instant("lang.smtprelay")},{id:"qmail",label:this.translate.instant("lang.qmail")},{id:"mail",label:this.translate.instant("lang.phpmail")}],this.smtpSecList=[{id:"",label:this.translate.instant("lang.none")},{id:"ssl",label:"ssl"},{id:"tls",label:"tls"}],this.sendmailClone={},this.hidePassword=!0,this.serverConnectionLoading=!1,this.emailSendLoading=!1,this.emailSendResult={icon:"",msg:"",debug:""},this.currentUser={},this.recipientTest="",this.passwordLabel=""}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.sendmailShort")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/configurations/admin_email_server").subscribe(t=>{this.sendmail=t.configuration.value,this.sendmailClone=JSON.parse(JSON.stringify(this.sendmail)),this.loading=!1},t=>{this.notify.handleErrors(t)})}cancelModification(){this.sendmail=JSON.parse(JSON.stringify(this.sendmailClone))}onSubmit(){this.sendmailFormCpt.invalid?this.notify.handleErrors({error:{errors:this.translate.instant("lang.notSavedBecauseInvalid")}}):this.http.put("../rest/configurations/admin_email_server",this.sendmail).subscribe(t=>{this.sendmailClone=JSON.parse(JSON.stringify(this.sendmail)),this.notify.success(this.translate.instant("lang.configurationUpdated"))},t=>{this.notify.handleErrors(t)})}checkModif(){return JSON.stringify(this.sendmailClone)===JSON.stringify(this.sendmail)}initEmailSend(){this.emailSendResult={icon:"",msg:"",debug:""},void 0===this.currentUser.mail&&this.http.get("../rest/currentUser/profile").subscribe(t=>{this.currentUser=t,this.recipientTest=t.mail})}testEmailSend(){JSON.stringify(this.sendmailClone)!==JSON.stringify(this.sendmail)&&this.onSubmit(),this.emailSendResult={icon:"fa-paper-plane primary",msg:this.translate.instant("lang.emailSendInProgress"),debug:""};const t={sender:{email:this.currentUser.mail},recipients:[this.recipientTest],object:"["+this.translate.instant("lang.doNotReply")+"] "+this.translate.instant("lang.emailSendTest"),status:"EXPRESS",body:this.translate.instant("lang.emailSendTest"),isHtml:!1};this.emailSendLoading=!0,this.http.post("../rest/emails",t).subscribe(t=>{this.emailSendLoading=!1,this.emailSendResult={icon:"fa-check green",msg:this.translate.instant("lang.emailSendSuccess"),debug:""}},t=>{this.emailSendLoading=!1,this.emailSendResult={icon:"fa-times red",msg:this.translate.instant("lang.emailSendFailed"),debug:t.error.errors}})}cleanAuthInfo(t){this.sendmail.passwordAlreadyExists=!1,this.sendmail.user="",this.sendmail.password=""}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(yh,!0),m.Oc(Ch,!0),m.ad(Eh,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.sendmailFormCpt=i.first))},decls:31,vars:22,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],["joyrideStep","emailTour",1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","width","500px",3,"mode","fixedInViewport","opened"],["snav2",""],["disableRipple","true",2,"display","flex","flex-direction","column"],["mat-subheader",""],[1,"form-group"],[1,"col-md-12"],["testSendmailForm","ngForm"],["name","recipientTest","matInput","","pattern","(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$)",3,"placeholder","ngModel","disabled","ngModelChange"],["color","primary","style","cursor: pointer;","matSuffix","","class","fa fa-paper-plane fa-2x",3,"title","click",4,"ngIf"],[4,"ngIf"],["class","bash",4,"ngIf"],["mat-list-item","","joyrideStep","emailTour2",3,"click"],["color","primary","mat-list-icon","",1,"fas","fa-signal"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"label"],[3,"ngSubmit"],["sendmailForm","ngForm"],[1,"col-md-12",2,"margin-bottom","20px"],["name","smtpType","required","",3,"placeholder","ngModel","ngModelChange"],["smtpType",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["name","SMTPSecure",3,"placeholder","disabled","ngModel","ngModelChange"],[1,"col-md-9"],["matInput","","name","host","required","",3,"disabled","ngModel","placeholder","ngModelChange"],[1,"col-md-1"],["name","port","type","number","matInput","","required","",3,"ngModel","disabled","placeholder","ngModelChange"],["color","primary","name","SMTPAuth",3,"ngModel","disabled","ngModelChange","change"],["name","user","matInput","","required","",3,"ngModel","disabled","placeholder","ngModelChange"],["name","password","matInput","",3,"type","ngModel","disabled","placeholder","required","ngModelChange"],["color","primary","matSuffix","",1,"fa","fa-2x",2,"cursor","pointer",3,"ngClass","click"],["name","mailFrom","required","","matInput","","pattern","(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$)",3,"ngModel","placeholder","ngModelChange"],[1,"col-md-12","text-center",2,"padding","10px"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],["mat-raised-button","","type","button","color","default",3,"disabled","click"],[3,"value"],["color","primary","matSuffix","",1,"fa","fa-paper-plane","fa-2x",2,"cursor","pointer",3,"title","click"],["mat-list-icon",""],[1,"bash"]],template:function(t,e){if(1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Sh,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Mh,2,0,"div",9),m.Qc(14,wh,53,69,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"mat-sidenav",11,12),m.hc("opened",(function(){return e.onSubmit(),e.initEmailSend()})),m.Zb(17,"mat-nav-list",13),m.Zb(18,"h3",14),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"div",15),m.Zb(22,"div",16),m.Zb(23,"form",null,17),m.Zb(25,"mat-form-field"),m.Zb(26,"input",18),m.hc("ngModelChange",(function(t){return e.recipientTest=t})),m.mc(27,"translate"),m.Yb(),m.Qc(28,Oh,2,3,"mat-icon",19),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Qc(29,Th,4,4,"mat-list-item",20),m.Yb(),m.Qc(30,kh,2,1,"div",21),m.Yb(),m.Yb()),2&t){const t=m.Dc(24);m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",(e.appService.getViewMode(),!1)),m.Eb(4),m.Tc(m.nc(20,18,"lang.emailSendTest")),m.Eb(7),m.tc("placeholder",m.nc(27,20,"lang.mailTo")),m.sc("ngModel",e.recipientTest)("disabled",e.emailSendLoading),m.Eb(2),m.sc("ngIf",!e.emailSendLoading&&t.valid),m.Eb(1),m.sc("ngIf",""!=e.emailSendResult.msg),m.Eb(1),m.sc("ngIf",e.emailSendResult.msg===e.translate.instant("lang.emailSendFailed"))}},directives:[S.e,S.f,M.a,Z.a,Y.a,x.t,S.d,Ot.h,Ot.g,o.J,o.u,o.v,w.c,O.b,o.c,o.A,o.t,o.w,Ot.d,Tt.a,Ot.c,I.k,T.c,k.a,Ie.c,Ie.a,at.a,o.E,x.s,o.z,et.a,w.j,x.q,D.b,I.o],pipes:[p.d],styles:[".mat-list-item[_ngcontent-%COMP%]:hover{background:inherit}.green[_ngcontent-%COMP%]{color:green}.primary[_ngcontent-%COMP%]{color:#135f7f}.red[_ngcontent-%COMP%]{color:red}.bash[_ngcontent-%COMP%]{background:#34495e;height:310px;border-radius:5px;top:40px;display:absolute;color:#fff;padding:10px;margin:10px}"]}),t})();const Dh=["adminMenuTemplate"];function Uh(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function Ph(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function Fh(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.label"))}}function Lh(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.label," ")}}function jh(t,e){1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.description")))}function Rh(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.description," ")}}function Qh(t,e){1&t&&(m.Zb(0,"mat-header-cell",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.mailevaAccount")))}function Ah(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.accountid," ")}}function Hh(t,e){1&t&&m.Ub(0,"mat-header-cell")}function $h(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",39),m.Zb(1,"button",40),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteShipping(a.id)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",41),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function zh(t,e){1&t&&m.Ub(0,"mat-header-row")}function Vh(t,e){1&t&&(m.Ub(0,"mat-row",42),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/shippings/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Nh(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,Fh,3,5,"mat-header-cell",26),m.Qc(13,Lh,2,3,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,jh,3,3,"mat-header-cell",29),m.Qc(16,Rh,2,1,"mat-cell",30),m.Wb(),m.Xb(17,31),m.Qc(18,Qh,3,3,"mat-header-cell",29),m.Qc(19,Ah,2,1,"mat-cell",30),m.Wb(),m.Xb(20,32),m.Qc(21,Hh,1,0,"mat-header-cell",33),m.Qc(22,$h,4,3,"mat-cell",34),m.Wb(),m.Qc(23,zh,1,0,"mat-header-row",35),m.Qc(24,Vh,2,4,"mat-row",36),m.Yb(),m.Zb(25,"div",37),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.shippings.length," ",m.nc(27,12,"lang.shippings"),"")}}let Jh=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.shippings=[],this.loading=!1,this.displayedColumns=["label","description","accountid","actions"],this.filterColumns=["label","description","accountid"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.shippings")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/administration/shippings").subscribe(t=>{this.shippings=t.shippings,setTimeout(()=>{this.adminService.setDataSource("admin_shippings",this.shippings,this.sort,this.paginator,this.filterColumns)},0),this.loading=!1})}deleteShipping(t){confirm(this.translate.instant("lang.deleteMsg"))&&this.http.delete("../rest/administration/shippings/"+t).subscribe(t=>{this.shippings=t.shippings,this.adminService.setDataSource("admin_shippings",this.shippings,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.shippingDeleted"))},t=>{this.notify.error(t.error.errors)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Dh,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/shippings/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","label"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","description"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","accountid"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Uh,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Ph,2,0,"div",9),m.Qc(14,Nh,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})();const Gh=["snav2"],Bh=["maarchTree"];function Wh(t,e){1&t&&(m.Zb(0,"div",16),m.Ub(1,"mat-spinner",17),m.Yb())}function qh(t,e){if(1&t&&m.Ub(0,"div",54),2&t){const t=m.lc(2);m.sc("innerHTML",t.translate.instant("lang.shippingUnavailable"),m.Ic)}}function Xh(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-list-item",55),m.Zb(1,"mat-slide-toggle",56),m.hc("change",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).toggleShapingOption(i)})),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.tc("name",t),m.sc("checked",i.shipping.options.shapingOptions.indexOf(t)>-1),m.Eb(1),m.Tc(m.nc(3,3,"lang.maileva_"+t))}}function Kh(t,e){if(1&t&&m.Ub(0,"div",57),2&t){const t=m.lc(2);m.sc("innerHTML",t.translate.instant("lang.warnShapingOption"),m.Ic)}}function tf(t,e){if(1&t&&(m.Zb(0,"mat-radio-button",58),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.tc("name",t),m.sc("value",t),m.Eb(1),m.Uc(" ",m.nc(2,3,"lang.maileva_"+t)," ")}}const ef=function(t){return[t]};function af(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",18),m.Qc(1,qh,1,1,"div",19),m.Zb(2,"form",20,21),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(4,"div",22),m.Zb(5,"div",23),m.Zb(6,"mat-form-field"),m.Zb(7,"input",24),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.label=e})),m.mc(8,"translate"),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(10,"div",22),m.Zb(11,"div",23),m.Zb(12,"mat-form-field"),m.Zb(13,"input",25),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.description=e})),m.mc(14,"translate"),m.mc(15,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(16,"div",26),m.Zb(17,"div",27),m.Zb(18,"div",28),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"mat-list",29),m.Qc(22,Xh,4,5,"mat-list-item",30),m.Qc(23,Kh,1,1,"div",31),m.Yb(),m.Yb(),m.Zb(24,"div",32),m.Zb(25,"div",28),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Zb(28,"mat-radio-group",33),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.options.sendMode=e})),m.Qc(29,tf,3,5,"mat-radio-button",34),m.Yb(),m.Yb(),m.Yb(),m.Zb(30,"div",26),m.Zb(31,"div",35),m.Zb(32,"div",28),m.Sc(33),m.mc(34,"translate"),m.Yb(),m.Zb(35,"div",36),m.Zb(36,"label",37),m.Sc(37),m.mc(38,"translate"),m.Yb(),m.Zb(39,"mat-form-field",38),m.Zb(40,"input",39),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.fee.firstPagePrice=e})),m.mc(41,"translate"),m.Yb(),m.Zb(42,"span",40),m.Sc(43,"\xa0\u20ac"),m.Yb(),m.Yb(),m.Yb(),m.Zb(44,"div",36),m.Zb(45,"label",41),m.Sc(46),m.mc(47,"translate"),m.Yb(),m.Zb(48,"mat-form-field",38),m.Zb(49,"input",42),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.fee.nextPagePrice=e})),m.mc(50,"translate"),m.Yb(),m.Zb(51,"span",40),m.Sc(52,"\xa0\u20ac"),m.Yb(),m.Yb(),m.Yb(),m.Zb(53,"div",36),m.Zb(54,"label",43),m.Sc(55),m.mc(56,"translate"),m.Yb(),m.Zb(57,"mat-form-field",38),m.Zb(58,"input",44),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.fee.postagePrice=e})),m.mc(59,"translate"),m.Yb(),m.Zb(60,"span",40),m.Sc(61,"\xa0\u20ac"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(62,"div",45),m.Zb(63,"div",28),m.Sc(64),m.mc(65,"translate"),m.Yb(),m.Zb(66,"div",46),m.Sc(67),m.mc(68,"translate"),m.Yb(),m.Zb(69,"div",23),m.Zb(70,"mat-form-field"),m.Zb(71,"input",47),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.account.id=e})),m.mc(72,"translate"),m.mc(73,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(74,"div",23),m.Zb(75,"mat-form-field"),m.Zb(76,"input",48),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().shipping.account.password=e})),m.Yb(),m.Zb(77,"mat-icon",49),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.hidePassword=!e.hidePassword})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(78,"div",50),m.Zb(79,"div",51),m.Zb(80,"button",52),m.Sc(81),m.mc(82,"translate"),m.Yb(),m.Zb(83,"button",53),m.hc("click",(function(){return m.Hc(t),m.lc().cancelModification()})),m.Sc(84),m.mc(85,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(3),e=m.lc();m.Eb(1),m.sc("ngIf",!e.shippingAvailable),m.Eb(6),m.tc("title",m.nc(8,37,"lang.label")),m.tc("placeholder",m.nc(9,39,"lang.label")),m.sc("ngModel",e.shipping.label),m.Eb(6),m.tc("title",m.nc(14,41,"lang.description")),m.tc("placeholder",m.nc(15,43,"lang.description")),m.sc("ngModel",e.shipping.description),m.Eb(6),m.Uc(" ",m.nc(20,45,"lang.shapingOptions")," "),m.Eb(3),m.sc("ngForOf",e.shapingOptions),m.Eb(1),m.sc("ngIf",-1==e.shipping.options.shapingOptions.indexOf("addressPage")),m.Eb(3),m.Uc(" ",m.nc(27,47,"lang.sendModes")," "),m.Eb(2),m.sc("ngModel",e.shipping.options.sendMode),m.Eb(1),m.sc("ngForOf",e.sendModes),m.Eb(4),m.Uc(" ",m.nc(34,49,"lang.pricesInformations")," "),m.Eb(4),m.Uc(" ",m.nc(38,51,"lang.maileva_firstPagePrice")," "),m.Eb(3),m.tc("title",m.nc(41,53,"lang.maileva_firstPagePrice")),m.sc("ngModel",e.shipping.fee.firstPagePrice),m.Eb(6),m.Uc(" ",m.nc(47,55,"lang.maileva_nextPagePrice")," "),m.Eb(3),m.tc("title",m.nc(50,57,"lang.maileva_nextPagePrice")),m.sc("ngModel",e.shipping.fee.nextPagePrice),m.Eb(6),m.Uc(" ",m.nc(56,59,"lang.maileva_postagePrice")," "),m.Eb(3),m.tc("title",m.nc(59,61,"lang.maileva_postagePrice")),m.sc("ngModel",e.shipping.fee.postagePrice),m.Eb(6),m.Uc(" ",m.nc(65,63,"lang.mailevaAccount")," "),m.Eb(3),m.Tc(m.nc(68,65,"lang.infoMailevaAccount")),m.Eb(4),m.tc("title",m.nc(72,67,"lang.login")),m.tc("placeholder",m.nc(73,69,"lang.id")),m.sc("ngModel",e.shipping.account.id),m.Eb(5),m.sc("type",e.hidePassword?"password":"text")("ngModel",e.shipping.account.password)("placeholder",e.translate.instant(!1===e.creationMode?"lang.passwordModification":"lang.password"))("required",e.creationMode),m.Eb(1),m.sc("ngClass",m.zc(75,ef,e.hidePassword?"fa-eye-slash":"fa-eye")),m.Eb(3),m.sc("disabled",e.checkModif()||!t.valid),m.Eb(1),m.Tc(m.nc(82,71,"lang.validate")),m.Eb(2),m.sc("disabled",e.checkModif()),m.Eb(1),m.Tc(m.nc(85,73,"lang.cancel"))}}let nf=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.loading=!1,this.creationMode=!0,this.shipping={label:"",description:"",options:{shapingOptions:["addressPage"],sendMode:"fast"},fee:{firstPagePrice:0,nextPagePrice:0,postagePrice:0},account:{id:"",password:""},entities:[]},this.entities=[],this.entitiesClone=null,this.shippingClone=null,this.shapingOptions=["color","duplexPrinting","addressPage"],this.sendModes=["fast","economic"],this.hidePassword=!0,this.shippingAvailable=!1}ngOnInit(){this.http.get("../rest/externalConnectionsEnabled").pipe(Object(d.a)(t=>{this.shippingAvailable=!0===t.connection.maileva}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe(),this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.shippingCreation")),this.creationMode=!0,this.http.get("../rest/administration/shippings/new").subscribe(t=>{this.entities=t.entities.map(t=>Object.assign(Object.assign({},t),{id:parseInt(t.id)})),this.entitiesClone=JSON.parse(JSON.stringify(this.entities)),this.initEntitiesTree(this.entities),this.shippingClone=JSON.parse(JSON.stringify(this.shipping)),this.loading=!1},t=>{this.notify.handleErrors(t)}),this.loading=!1):(this.headerService.setHeader(this.translate.instant("lang.shippingModification")),this.creationMode=!1,this.http.get("../rest/administration/shippings/"+t.id).subscribe(t=>{this.shipping=t.shipping,this.entities=t.entities,this.entitiesClone=JSON.parse(JSON.stringify(this.entities)),this.initEntitiesTree(this.entities),this.shippingClone=JSON.parse(JSON.stringify(this.shipping)),this.loading=!1},t=>{this.notify.handleErrors(t)}))})}initEntitiesTree(t){this.maarchTree.initData(t)}updateSelectedEntities(){this.shipping.entities=this.maarchTree.getSelectedNodes().map(t=>t.id)}onSubmit(){this.creationMode?this.http.post("../rest/administration/shippings",this.shipping).subscribe(t=>{this.shippingClone=JSON.parse(JSON.stringify(this.shipping)),this.notify.success(this.translate.instant("lang.shippingAdded")),this.router.navigate(["/administration/shippings"])},t=>{this.notify.handleErrors(t)}):this.http.put("../rest/administration/shippings/"+this.shipping.id,this.shipping).subscribe(t=>{this.shippingClone=JSON.parse(JSON.stringify(this.shipping)),this.notify.success(this.translate.instant("lang.shippingUpdated")),this.router.navigate(["/administration/shippings"])},t=>{this.notify.handleErrors(t)})}checkModif(){return JSON.stringify(this.shippingClone)===JSON.stringify(this.shipping)}toggleShapingOption(t){const e=this.shipping.options.shapingOptions.indexOf(t);e>-1?this.shipping.options.shapingOptions.splice(e,1):this.shipping.options.shapingOptions.push(t)}cancelModification(){this.shipping=JSON.parse(JSON.stringify(this.shippingClone)),this.entities=JSON.parse(JSON.stringify(this.entitiesClone)),this.initEntitiesTree(this.entities)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Gh,!0),m.Oc(Bh,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.maarchTree=i.first))},decls:22,vars:14,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","width","400px",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[2,"padding","10px"],[3,"afterSelectNode","afterDeselectNode"],["maarchTree",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["class","alert-message alert-message-danger","role","alert","style","max-width: 100%",3,"innerHTML",4,"ngIf"],[1,"form-horizontal",3,"ngSubmit"],["shippingForm","ngForm"],[1,"form-group"],[1,"col-sm-12"],["matInput","","required","","name","label","id","label","type","text","maxlength","64",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","required","","name","description","id","description","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],[1,"form-group",2,"flex-direction","row","flex-wrap","wrap"],[1,"formType","ratio-2","col-sm-12"],[1,"formType-title"],["role","list"],["role","listitem",4,"ngFor","ngForOf"],["class","alert-message alert-message-danger","role","alert","style","margin-top: 30px;max-width: none;",3,"innerHTML",4,"ngIf"],[1,"formType","ratio-1","col-sm-12"],["name","sendMode",1,"radio-group",3,"ngModel","ngModelChange"],["color","primary",3,"name","value",4,"ngFor","ngForOf"],[1,"formType","ratio-2",2,"flex-direction","column"],[1,"priceContent"],["for","firstPagePrice",1,"priceContent-label"],["appearance","outline"],["matInput","","required","","name","firstPagePrice","id","firstPagePrice","type","number","maxlength","255","min","0","step","0.1","pattern","^(?=.+)(?:[1-9]\\d*|0)?(?:\\.\\d+)?$",3,"ngModel","title","ngModelChange"],["matSuffix",""],["for","nextPagePrice",1,"priceContent-label"],["matInput","","required","","name","nextPagePrice","id","nextPagePrice","type","number","maxlength","255","min","0","step","0.1","pattern","^(?=.+)(?:[1-9]\\d*|0)?(?:\\.\\d+)?$",3,"ngModel","title","ngModelChange"],["for","postagePrice",1,"priceContent-label"],["matInput","","required","","name","postagePrice","id","postagePrice","type","number","maxlength","255","min","0","step","0.1","pattern","^(?=.+)(?:[1-9]\\d*|0)?(?:\\.\\d+)?$",3,"ngModel","title","ngModelChange"],[1,"formType","ratio-1",2,"flex-direction","column","justify-content","center"],[1,"alert-message","alert-message-info",2,"max-width","none"],["matInput","","required","","name","login","id","login","type","text","maxlength","255",3,"ngModel","title","placeholder","ngModelChange"],["name","password","matInput","",3,"type","ngModel","placeholder","required","ngModelChange"],["color","primary","matSuffix","","maxlength","255",1,"fa","fa-2x",2,"cursor","pointer",3,"ngClass","click"],[1,"form-group",2,"flex-direction","row","align-items","center"],[1,"col-sm-12","text-center",2,"padding","10px"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],["mat-raised-button","","type","button","color","default",3,"disabled","click"],["role","alert",1,"alert-message","alert-message-danger",2,"max-width","100%",3,"innerHTML"],["role","listitem"],["color","primary",3,"name","checked","change"],["role","alert",1,"alert-message","alert-message-danger",2,"margin-top","30px","max-width","none",3,"innerHTML"],["color","primary",3,"name","value"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,Wh,2,0,"div",8),m.Qc(12,af,86,77,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Zb(15,"mat-list"),m.Zb(16,"h3",12),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Zb(19,"div",13),m.Zb(20,"app-maarch-flat-tree",14,15),m.hc("afterSelectNode",(function(){return e.updateSelectedEntities()}))("afterDeselectNode",(function(){return e.updateSelectedEntities()})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()),m.Eb(4),m.Tc(m.nc(18,12,"lang.chooseEntityAssociationModel")))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Ot.g,Ue.a,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.E,o.o,o.t,o.w,x.s,Qe.b,o.z,o.A,w.j,Tt.a,x.q,D.b,Ot.d,et.a,Qe.a],pipes:[p.d],styles:[".radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.radio-group[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]{padding:10px}.form-group[_ngcontent-%COMP%], .formType[_ngcontent-%COMP%]{display:flex}.formType[_ngcontent-%COMP%]{align-items:center;margin:10px;border-radius:4px;border:1px solid #ccc;position:relative;padding:10px}.formType-title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:10px;font-weight:700;background:#fff;position:absolute;top:-7px;left:10px;padding:0;margin:0;color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-slide-toggle-label{color:#666;font-weight:700}.formType[_ngcontent-%COMP%]    .mat-radio-button, .formType[_ngcontent-%COMP%]    .mat-slide-toggle{opacity:.5;color:#666;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.formType[_ngcontent-%COMP%]    .mat-checked, .formType[_ngcontent-%COMP%]    .mat-radio-checked{opacity:1;color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-checked .mat-slide-toggle-label{color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-form-field-suffix{color:#f99830;font-size:15px;top:0}.ratio-1[_ngcontent-%COMP%], .ratio-2[_ngcontent-%COMP%]{flex:1}.priceContent[_ngcontent-%COMP%]{display:flex;align-items:first baseline;width:100%}.priceContent-label[_ngcontent-%COMP%]{text-align:right;color:#135f7f;flex:1;justify-content:flex-end;display:flex;padding-right:10px}.priceContent[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:90px!important}.priceContent[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-weight:700;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.priceInfo[_ngcontent-%COMP%]{font-size:10px;font-weight:700;opacity:.5}label[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();const sf=["snav2"];function cf(t,e){1&t&&(m.Zb(0,"div",14),m.Ub(1,"mat-spinner",15),m.Yb())}function of(t,e){if(1&t&&m.Ub(0,"div",19),2&t){const t=m.lc(2);m.sc("innerHTML",t.translate.instant("lang.noCustomFieldInfo"),m.Ic)}}function rf(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",31),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).switchSQLMode(e)})),m.Ub(1,"mat-icon",32),m.Yb()}}function lf(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",41),m.hc("click",(function(){m.Hc(t);const e=m.lc(3).$implicit;return m.lc(2).sortValues(e)})),m.Ub(1,"mat-icon",42),m.Yb()}if(2&t){const t=m.lc(5);m.sc("title",t.translate.instant("lang.orderValues"))}}function df(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field",43),m.Zb(1,"input",44),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.label=i})),m.Yb(),m.Zb(2,"button",45),m.hc("click",(function(){m.Hc(t);const i=e.index,a=m.lc(3).$implicit;return m.lc(2).removeValue(a,i)})),m.Ub(3,"mat-icon",46),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(5);m.Eb(1),m.sc("ngModel",t.label)("placeholder",i.translate.instant("lang.newValue")),m.Eb(1),m.sc("title",i.translate.instant("lang.delete"))}}function bf(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-expansion-panel",35),m.Zb(1,"mat-expansion-panel-header"),m.Zb(2,"mat-panel-title",36),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Zb(5,"div",37),m.Zb(6,"div",33),m.Zb(7,"button",38),m.hc("click",(function(){m.Hc(t);const e=m.lc(2).index;return m.lc(2).addValue(e)})),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Zb(10,"div"),m.Qc(11,lf,2,1,"button",39),m.Yb(),m.Yb(),m.Zb(12,"div",21),m.Qc(13,df,4,3,"mat-form-field",40),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2).$implicit;m.Eb(2),m.sc("matBadge",t.values.length),m.Eb(1),m.Uc(" ",m.nc(4,5,"lang.valuesList")," "),m.Eb(5),m.Uc(" ",m.nc(9,7,"lang.addValue"),""),m.Eb(3),m.sc("ngIf",t.values.length>0),m.Eb(2),m.sc("ngForOf",t.values)}}function mf(t,e){if(1&t&&(m.Zb(0,"div",33),m.Qc(1,bf,14,9,"mat-expansion-panel",34),m.Yb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.sc("ngIf",!t.SQLMode)}}function pf(t,e){if(1&t&&(m.Xb(0),m.Sc(1),m.mc(2,"translate"),m.Wb()),2&t){const t=m.lc().$implicit;m.Eb(1),m.Uc(" (",m.nc(2,1,"lang."+t.key),") ")}}function uf(t,e){if(1&t&&(m.Zb(0,"mat-option",54),m.Sc(1),m.Qc(2,pf,3,3,"ng-container",52),m.Yb()),2&t){const t=e.$implicit,i=m.lc(5);m.sc("value",t.key),m.Eb(1),m.Uc(" ",t.key," "),m.Eb(1),m.sc("ngIf",!i.functionsService.empty(i.translate.instant("lang."+t.key)))}}function hf(t,e){if(1&t){const t=m.ac();m.Zb(0,"span"),m.Zb(1,"input",61),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.delimiterStart=i})),m.Yb(),m.Zb(2,"mat-chip",62),m.hc("removed",(function(){m.Hc(t);const i=e.index,a=m.lc(4).$implicit;return m.lc(2).removeColumnLabel(a.values.label,i)})),m.Sc(3),m.Ub(4,"mat-icon",63),m.Yb(),m.Zb(5,"input",61),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.delimiterEnd=i})),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Pc("width",8*(t.delimiterStart.length+1),"px"),m.sc("ngModel",t.delimiterStart),m.Eb(2),m.Uc(" ",t.column," "),m.Eb(2),m.Pc("width",8*(t.delimiterEnd.length+1),"px"),m.sc("ngModel",t.delimiterEnd)}}function ff(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",64),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=m.lc(4).$implicit;return m.lc(2).addColumnLabel(a.values.label,i)})),m.Sc(1),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Tc(t)}}function gf(t,e){if(1&t&&(m.Zb(0,"div",55),m.Zb(1,"mat-label",56),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Qc(4,hf,6,7,"span",18),m.Zb(5,"button",57),m.Ub(6,"i",58),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-menu",null,59),m.Qc(11,ff,2,1,"button",60),m.Yb(),m.Yb()),2&t){const t=m.Dc(10),e=m.lc(3).$implicit,i=m.lc(2);m.Eb(2),m.Uc(" ",m.nc(3,5,"lang.targetLabel")," *"),m.Eb(2),m.sc("ngForOf",e.values.label),m.Eb(1),m.sc("matMenuTriggerFor",t),m.Eb(2),m.Uc(" ",m.nc(8,7,"lang.addColumn")," "),m.Eb(4),m.sc("ngForOf",i.availaibleTables[e.values.table])}}function vf(t,e){if(1&t&&(m.Zb(0,"mat-option",54),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function yf(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-label"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-select",49),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(3).$implicit.values.key=e})),m.Qc(5,vf,2,2,"mat-option",50),m.Yb(),m.Yb()}if(2&t){const t=m.lc(3).$implicit,e=m.lc(2);m.Eb(2),m.Tc(m.nc(3,3,"lang.targetIdentifier")),m.Eb(2),m.sc("ngModel",t.values.key),m.Eb(1),m.sc("ngForOf",e.availaibleTables[t.values.table])}}const Cf=function(){return["string","integer","date"]};function Ef(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-expansion-panel",35),m.Zb(1,"mat-expansion-panel-header"),m.Zb(2,"mat-panel-title"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Zb(5,"div",21),m.Zb(6,"div",48),m.Zb(7,"mat-form-field"),m.Zb(8,"mat-label"),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Zb(11,"mat-select",49),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).$implicit.values.table=e})),m.Qc(12,uf,3,3,"mat-option",50),m.mc(13,"keyvalue"),m.Yb(),m.Yb(),m.Qc(14,gf,12,9,"div",51),m.Qc(15,yf,6,5,"mat-form-field",52),m.Yb(),m.Zb(16,"mat-form-field"),m.Zb(17,"mat-label"),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Zb(20,"textarea",53),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).$implicit.values.clause=e})),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2).$implicit,e=m.lc(2);m.Eb(3),m.Uc(" ",m.nc(4,8,"lang.database")," "),m.Eb(6),m.Tc(m.nc(10,10,"lang.targetTable")),m.Eb(2),m.sc("ngModel",t.values.table),m.Eb(1),m.sc("ngForOf",m.nc(13,12,e.availaibleTables)),m.Eb(2),m.sc("ngIf",-1===m.yc(16,Cf).indexOf(t.type)&&t.values.table),m.Eb(1),m.sc("ngIf",t.values.table),m.Eb(3),m.Tc(m.nc(19,14,"lang.clause")),m.Eb(2),m.sc("ngModel",t.values.clause)}}function Sf(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",24),m.Zb(1,"div"),m.Zb(2,"button",31),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit;return m.lc(2).switchSQLMode(e)})),m.Ub(3,"mat-icon",47),m.Yb(),m.Yb(),m.Zb(4,"div",33),m.Qc(5,Ef,21,17,"mat-expansion-panel",34),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(5),m.sc("ngIf",t.SQLMode)}}const Mf=function(){return["select","radio","checkbox"]};function Yf(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-expansion-panel"),m.Zb(1,"mat-expansion-panel-header"),m.Zb(2,"mat-panel-title",20),m.Sc(3),m.Yb(),m.Zb(4,"mat-panel-description"),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Yb(),m.Zb(7,"div",21),m.Zb(8,"mat-form-field"),m.Zb(9,"input",22),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.id=i})),m.Yb(),m.Yb(),m.Zb(10,"mat-form-field"),m.Zb(11,"input",23),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.label=i})),m.Yb(),m.Yb(),m.Yb(),m.Zb(12,"div",24),m.Zb(13,"div"),m.Qc(14,rf,2,0,"button",25),m.Yb(),m.Qc(15,mf,2,1,"div",26),m.Yb(),m.Qc(16,Sf,6,1,"div",27),m.Zb(17,"div",28),m.Zb(18,"button",29),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=e.index;return m.lc(2).updateCustomField(i,a)})),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Zb(21,"button",30),m.hc("click",(function(){m.Hc(t);const i=e.index;return m.lc(2).removeCustomField(i)})),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=e.index,a=m.lc(2);m.Eb(3),m.Uc(" ",t.label," "),m.Eb(2),m.Uc(" ",m.nc(6,14,"lang."+t.type+"Input")," "),m.Eb(4),m.sc("ngModel",t.id)("placeholder",a.translate.instant("lang.technicalId"))("value",t.id),m.Eb(2),m.sc("ngModel",t.label)("placeholder",a.translate.instant("lang.label"))("value",t.label),m.Eb(3),m.sc("ngIf",!t.SQLMode&&"banAutocomplete"!==t.type),m.Eb(1),m.sc("ngIf",m.yc(20,Mf).indexOf(t.type)>-1),m.Eb(1),m.sc("ngIf",t.SQLMode),m.Eb(2),m.sc("disabled",a.isModified(t,i)||!a.isValidField(t)),m.Eb(1),m.Tc(m.nc(20,16,"lang.update")),m.Eb(3),m.Tc(m.nc(23,18,"lang.delete"))}}function Zf(t,e){if(1&t&&(m.Zb(0,"mat-card",16),m.Zb(1,"mat-tab-group"),m.Zb(2,"mat-tab",12),m.Qc(3,of,1,1,"div",17),m.Zb(4,"mat-accordion"),m.Qc(5,Yf,24,21,"mat-expansion-panel",18),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.sc("label",t.translate.instant("lang.usableFields")),m.Eb(1),m.sc("ngIf",0===t.customFields.length),m.Eb(2),m.sc("ngForOf",t.customFields)}}function xf(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-form-field",70),m.Ub(2,"textarea",71),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(2),m.sc("placeholder",e.translate.instant("lang."+t.type+"Input"))}}function _f(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-form-field",70),m.Ub(2,"input",72),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(2),m.sc("placeholder",e.translate.instant("lang."+t.type+"Input"))}}function wf(t,e){if(1&t&&(m.Zb(0,"mat-option",54),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Vc(" ",m.nc(2,3,"lang.choice")," ",t," ")}}function Of(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-form-field",70),m.Zb(2,"mat-select",73),m.Qc(3,wf,3,5,"mat-option",50),m.Yb(),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(2),m.sc("placeholder",e.translate.instant("lang."+t.type+"Input")),m.Eb(1),m.sc("ngForOf",e.sampleIncrement)}}function Tf(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-form-field",70),m.Zb(2,"input",74),m.hc("click",(function(){return m.Hc(t),m.Dc(5).open()})),m.Yb(),m.Ub(3,"mat-datepicker-toggle",75),m.Ub(4,"mat-datepicker",null,76),m.Yb(),m.Wb()}if(2&t){const t=m.Dc(5),e=m.lc().$implicit,i=m.lc();m.Eb(2),m.sc("matDatepicker",t)("placeholder",i.translate.instant("lang."+e.type+"Input")),m.Eb(1),m.sc("for",t)}}function kf(t,e){if(1&t&&(m.Zb(0,"mat-radio-button",54),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Vc(" ",m.nc(2,3,"lang.choice")," ",t," ")}}function If(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-radio-group",77),m.Qc(2,kf,3,5,"mat-radio-button",50),m.Yb(),m.Wb()),2&t){const t=m.lc(2);m.Eb(2),m.sc("ngForOf",t.sampleIncrement)}}function Df(t,e){if(1&t&&(m.Zb(0,"mat-list-option",83),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Vc(" ",m.nc(2,3,"lang.choice")," ",t," ")}}function Uf(t,e){1&t&&(m.Zb(0,"mat-chip"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.selectedValue")," "))}function Pf(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"div",78),m.Zb(2,"mat-selection-list",79,80),m.Qc(4,Df,3,5,"mat-list-option",81),m.Yb(),m.Yb(),m.Zb(5,"mat-chip-list",82),m.Qc(6,Uf,3,3,"mat-chip",18),m.Yb(),m.Wb()),2&t){const t=m.Dc(3),e=m.lc(2);m.Eb(4),m.sc("ngForOf",e.sampleIncrement),m.Eb(2),m.sc("ngForOf",t.selectedOptions.selected)}}function Ff(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",65),m.Zb(1,"div",66),m.Zb(2,"button",67),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().addCustomField(i)})),m.Ub(3,"mat-icon",68),m.Yb(),m.Yb(),m.Zb(4,"div",33),m.Zb(5,"div",69),m.Sc(6),m.Yb(),m.Qc(7,xf,3,1,"ng-container",52),m.Qc(8,_f,3,1,"ng-container",52),m.Qc(9,Of,4,2,"ng-container",52),m.Qc(10,Tf,6,3,"ng-container",52),m.Qc(11,If,3,1,"ng-container",52),m.Qc(12,Pf,7,2,"ng-container",52),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc();m.Eb(2),m.sc("title",i.translate.instant("lang.add")),m.Eb(4),m.Uc("",t.label," :"),m.Eb(1),m.sc("ngIf","string"===t.type||"banAutocomplete"===t.type),m.Eb(1),m.sc("ngIf","integer"===t.type),m.Eb(1),m.sc("ngIf","select"===t.type),m.Eb(1),m.sc("ngIf","date"===t.type),m.Eb(1),m.sc("ngIf","radio"===t.type),m.Eb(1),m.sc("ngIf","checkbox"===t.type)}}let Lf=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.appService=s,this.sortPipe=c,this.functionsService=o,this.loading=!0,this.customFieldsTypes=[{label:this.translate.instant("lang.stringInput"),type:"string"},{label:this.translate.instant("lang.integerInput"),type:"integer"},{label:this.translate.instant("lang.selectInput"),type:"select"},{label:this.translate.instant("lang.dateInput"),type:"date"},{label:this.translate.instant("lang.radioInput"),type:"radio"},{label:this.translate.instant("lang.checkboxInput"),type:"checkbox"},{label:this.translate.instant("lang.banAutocompleteInput"),type:"banAutocomplete"}],this.customFields=[],this.customFieldsClone=[],this.incrementCreation=1,this.sampleIncrement=[1,2,3,4],this.SQLMode=!1,this.availaibleTables={}}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.customFieldsAdmin")),this.getTables(),this.http.get("../rest/customFields?admin=true").pipe(Object(l.a)(t=>(t.customFields.forEach(t=>{this.functionsService.empty(t.values.key)?(t.SQLMode=!1,t.values=Object.values(t.values).map(t=>({label:t}))):t.SQLMode=!0}),t)),Object(d.a)(t=>{this.customFields=t.customFields,this.customFieldsClone=JSON.parse(JSON.stringify(this.customFields))}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addCustomField(t){let e={};this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.add"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(d.a)(()=>{e={label:this.translate.instant("lang.newField")+" "+this.incrementCreation,type:t.type,values:[]}}),Object(q.a)(t=>this.http.post("../rest/customFields",e)),Object(d.a)(t=>{e.id=t.customFieldId,this.customFields.push(e),this.notify.success(this.translate.instant("lang.customFieldAdded")),this.incrementCreation++}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addValue(t){this.customFields[t].values.push({label:""})}removeValue(t,e){t.values.splice(e,1)}removeCustomField(t){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete")+' "'+this.customFields[t].label+'"',msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/customFields/"+this.customFields[t].id)),Object(d.a)(()=>{this.customFields.splice(t,1),this.notify.success(this.translate.instant("lang.customFieldDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}updateCustomField(t,e){const i=Object.assign({},t);if(t.SQLMode)["string","integer","date"].indexOf(t.type)>-1&&(t.values.label=[{column:t.values.key,delimiterEnd:"",delimiterStart:""}]);else if(t.values=t.values.filter((t,e,i)=>i.map(t=>t.label).indexOf(t.label)===e),i.values=t.values.map(t=>t.label),this.customFields.filter(t=>t.label===i.label).length>1)return this.notify.handleErrors(this.translate.instant("lang.customFieldAlreadyExists")),Object(N.of)(!1);this.http.put("../rest/customFields/"+t.id,i).pipe(Object(d.a)(()=>{this.customFieldsClone[e]=JSON.parse(JSON.stringify(t)),this.notify.success(this.translate.instant("lang.customFieldUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}sortValues(t){t.values=this.sortPipe.transform(t.values,"label")}isModified(t,e){return!(JSON.stringify(t)!==JSON.stringify(this.customFieldsClone[e])&&""!==t.label&&!this.SQLMode)}switchSQLMode(t){t.SQLMode=!t.SQLMode,t.values=t.SQLMode?{key:"id",label:[{column:"id",delimiterEnd:"",delimiterStart:""}],table:"users",clause:"1=1"}:[]}getTables(){this.http.get("../rest/customFieldsWhiteList").pipe(Object(d.a)(t=>{t.allowedTables.forEach(t=>{this.availaibleTables[t.name]=t.columns})}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addColumnLabel(t,e){t.push({delimiterStart:"",delimiterEnd:"",column:e})}removeColumnLabel(t,e){t.splice(e,1)}isValidField(t){return!t.SQLMode||!(this.functionsService.empty(t.values.key)||this.functionsService.empty(t.values.label)||this.functionsService.empty(t.values.table)||this.functionsService.empty(t.values.clause))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(U.a),m.Tb(C.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(sf,!0),2&t&&m.Cc(i=m.ic())&&(e.sidenavRight=i.first)},features:[m.Db([U.a])],decls:18,vars:12,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end","opened","",1,"col-md-4","col-sm-12","customFielsdPanel",3,"mode","fixedInViewport"],["snav2",""],[3,"label"],["class","customFieldsTypesItem",4,"ngFor","ngForOf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["class","alert-message alert-message-info","role","alert",3,"innerHTML",4,"ngIf"],[4,"ngFor","ngForOf"],["role","alert",1,"alert-message","alert-message-info",3,"innerHTML"],["color","primary"],[1,"col-md-12"],["matInput","","name","id","disabled","",3,"ngModel","placeholder","value","ngModelChange"],["matInput","","name","label",3,"ngModel","placeholder","value","ngModelChange"],[1,"col-md-12",2,"display","flex","align-items","center"],["mat-mini-fab","","color","primary",3,"click",4,"ngIf"],["style","flex:1;",4,"ngIf"],["class","col-md-12","style","display: flex;align-items: center;",4,"ngIf"],[1,"col-md-12","text-center"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"],["mat-mini-fab","","color","primary",3,"click"],[1,"fas","fa-database",2,"height","auto"],[2,"flex","1"],["class","customFieldValues","opened","",4,"ngIf"],["opened","",1,"customFieldValues"],["matBadgeSize","small",3,"matBadge"],[1,"actionValuesCustom"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","default",3,"title","click",4,"ngIf"],["floatLabel","never",4,"ngFor","ngForOf"],["mat-mini-fab","","color","default",3,"title","click"],["color","primary",1,"fas","fa-sort-alpha-down",2,"height","auto"],["floatLabel","never"],["matInput","",3,"ngModel","placeholder","ngModelChange"],["color","warn","mat-icon-button","","matSuffix","",3,"title","click"],[1,"fa","fa-trash"],[1,"fas","fa-list-ol",2,"height","auto"],[2,"display","flex","flex-direction","column"],["required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["style","width:100%;padding-bottom: 20px;",4,"ngIf"],[4,"ngIf"],["matInput","","placeholder","Ex. status='OK'","required","",3,"ngModel","ngModelChange"],[3,"value"],[2,"width","100%","padding-bottom","20px"],[2,"font-size","75%","color","rgba(0,0,0,0.54)","width","100%","display","block"],["mat-button","","color","primary",3,"matMenuTriggerFor"],[1,"fa","fa-plus-circle"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],[2,"min-width","8px",3,"ngModel","ngModelChange"],[3,"removed"],["matChipRemove","",1,"fa","fa-times-circle"],["mat-menu-item","",3,"click"],[1,"customFieldsTypesItem"],[1,"addCustomFieldTypeContainer"],["mat-icon-button","","color","primary",3,"title","click"],[1,"fas","fa-plus-circle","fa-2x"],[2,"color","rgba(0,0,0,0.54)"],["floatLabel","never",1,"input-form"],["matInput","","matTextareaAutosize","","matAutosizeMinRows","1","cdkAutosizeMaxRows","6","disabled","",3,"placeholder"],["type","number","matInput","","disabled","",3,"placeholder"],["disabled","",3,"placeholder"],["matInput","","disabled","",3,"matDatepicker","placeholder","click"],["matSuffix","",3,"for"],["picker",""],["color","primary","disabled","",1,"radio-form"],[1,"input-form","checkbox-form"],["disabled","",1,"div-list"],["sampleList",""],["checkboxPosition","before",3,"value",4,"ngFor","ngForOf"],[1,"checkbox-selected-list"],["checkboxPosition","before",3,"value"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,cf,2,0,"div",8),m.Qc(12,Zf,6,3,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Zb(15,"mat-tab-group"),m.Zb(16,"mat-tab",12),m.Qc(17,Ff,13,8,"div",13),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode()),m.Eb(3),m.sc("label",e.translate.instant("lang.customFieldsTypesAvailable")),m.Eb(1),m.sc("ngForOf",e.customFieldsTypes))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ie.c,Ie.a,x.s,T.c,k.a,De.a,De.c,De.g,De.h,De.f,w.c,O.b,o.c,o.t,o.w,D.b,Tt.a,$n.a,w.j,w.g,at.a,o.E,I.o,Fe.d,Fe.e,An.a,An.e,Fe.b,O.d,je.f,je.h,je.d,Qe.b,Qe.a,Ot.i,An.d,Ot.f],pipes:[p.d,x.l],styles:[".mat-divider[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.customFielsdPanel[_ngcontent-%COMP%], .customFielsdPanel[_ngcontent-%COMP%]    .mat-tab-body-wrapper{padding-left:0}.mat-expansion-panel-header-description[_ngcontent-%COMP%]{flex-direction:row-reverse}.customFieldValues[_ngcontent-%COMP%]{box-shadow:none;border:1px solid rgba(0,0,0,.12)}.mat-expansion-panel[_ngcontent-%COMP%]{margin:5px}.mat-accordion[_ngcontent-%COMP%]{padding:5px}.mat-tab-body-content[_ngcontent-%COMP%], .mat-tab-body-wrapper[_ngcontent-%COMP%], .mat-tab-group[_ngcontent-%COMP%]{height:100%}.actionsCustomFields[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.actionValuesCustom[_ngcontent-%COMP%]{display:flex}.alert-message-info[_ngcontent-%COMP%]{margin-top:30px;max-width:100%}.addCustomFieldTypeContainer[_ngcontent-%COMP%]{justify-content:center;display:flex;align-items:center;width:60px}.customFieldsTypesItem[_ngcontent-%COMP%]{display:flex;padding-top:10px;padding-bottom:10px}.mat-badge-content[_ngcontent-%COMP%]{top:2px!important}",".banner[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:30px;border-radius:20px;border:1px solid #ccc;position:relative;padding:20px;width:100%}.banner[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:20px;font-weight:700;letter-spacing:2px;position:absolute;top:-18px;left:20px;padding:0;margin:0;color:#135f7f}.banner[_ngcontent-%COMP%]   .title-divider[_ngcontent-%COMP%]{position:absolute;width:99%;z-index:-1;top:17px;background:#fff;height:1px}.banner[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:50%;padding-right:10px}.banner[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-size:16px}.fieldRow[_ngcontent-%COMP%]{display:flex;padding-top:10px;padding-bottom:10px}.fieldLabel[_ngcontent-%COMP%]{color:#4a4a4a}.fieldLabel[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]{margin-right:10px}.fieldState[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;width:40px;justify-content:center;align-items:normal!important;padding-top:15px}.fieldState[_ngcontent-%COMP%]   .fieldRequired[_ngcontent-%COMP%]{font-size:5px;color:#135f7f}.fieldState[_ngcontent-%COMP%]   .fieldError[_ngcontent-%COMP%]{font-size:15px;color:#f99830}.fieldState[_ngcontent-%COMP%]   .fieldFull[_ngcontent-%COMP%]{font-size:15px;color:green}.fieldInput[_ngcontent-%COMP%]{position:relative}.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:13px;flex:1}@media (max-width:768px){.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:1em}}.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%], .fieldState[_ngcontent-%COMP%]{align-items:center;display:flex}.input-form[_ngcontent-%COMP%]{font-size:13px;color:#666;width:500px}.input-form[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{color:#135f7f;padding-left:20px}.input-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.input-form[_ngcontent-%COMP%]    .mat-select-value-text{padding-left:20px;color:#135f7f}.input-form[_ngcontent-%COMP%]    .mat-form-field-label{top:15px;left:20px}.input-form[_ngcontent-%COMP%]    .mat-form-field-infix{display:flex;padding-top:0;padding-bottom:5px}.input-form[_ngcontent-%COMP%]    .mat-form-field-label-wrapper{top:-13px}.input-form[_ngcontent-%COMP%]    .mat-form-field-flex{background:#fff;height:40px;border-radius:10px;border:1px solid #135f7f}.input-form[_ngcontent-%COMP%]     .mat-form-field-underline{display:none}.input-form[_ngcontent-%COMP%]    .mat-form-field-suffix{margin-right:20px}.input-form[_ngcontent-%COMP%]    .mat-select-arrow-wrapper{padding-right:20px}.input-form[_ngcontent-%COMP%]    .mat-list-option{color:rgba(0,0,0,.54)}.input-form[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.input-form[_ngcontent-%COMP%]    .mat-datepicker-toggle-default-icon{height:auto}.input-form.search-select[_ngcontent-%COMP%]    .mat-form-field-label-wrapper{top:-15px}.input-form.input-date[_ngcontent-%COMP%]    .mat-form-field-infix{padding-top:5px}.input-form-filled[_ngcontent-%COMP%]{color:#fff;width:500px;transition:all .1s}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-form-field-flex, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-form-field-flex{background:#fff!important;border:1px solid #fff!important;color:#135f7f!important;transition:all .1s}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-form-field-label, .input-form-filled[_ngcontent-%COMP%]:hover    .mat-select-placeholder, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-form-field-label, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-select-placeholder{color:#135f7f!important}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-select-arrow, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-select-arrow{color:rgba(19,95,127,.54)}.input-form-filled[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{color:#135f7f;padding-left:20px}.input-form-filled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-value{text-align:left;font-weight:400}.input-form-filled[_ngcontent-%COMP%]    .mat-select-value-text{padding-left:20px;color:#fff}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-label{color:#fff;left:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-infix{padding-bottom:15px}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-flex{background:#135f7f;border-radius:30px;border:1px solid #fff}.input-form-filled[_ngcontent-%COMP%]     .mat-form-field-underline{display:none}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-suffix{margin-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-arrow-wrapper{padding-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-arrow{color:hsla(0,0%,100%,.54)}.input-form-filled[_ngcontent-%COMP%]    .mat-select-placeholder{color:#fff}.input-form-filled[_ngcontent-%COMP%]    .mat-list-option{color:rgba(0,0,0,.54)}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.input-form-filled[_ngcontent-%COMP%]   textarea.cdk-textarea-autosize-measuring[_ngcontent-%COMP%]{padding:4px 0!important}.input-form-filled[_ngcontent-%COMP%]    .mat-datepicker-toggle-default-icon{height:auto}.input-form.mat-form-field-disabled[_ngcontent-%COMP%]    .mat-input-element{cursor:not-allowed;padding-left:20px}.input-form.mat-form-field-disabled[_ngcontent-%COMP%]    .mat-form-field-flex{cursor:not-allowed;border:1px dashed #353232}.opt-group[_ngcontent-%COMP%]{font-weight:700}.smallInput[_ngcontent-%COMP%]{font-size:11px;padding-left:20px;padding-right:20px}.smallInput[_ngcontent-%COMP%]    .mat-form-field-infix{padding:0 0 5px}.button-form-primary[_ngcontent-%COMP%]{background:#fff;border:1px solid #135f7f;color:#135f7f;border-radius:30px;padding-left:20px;padding-right:20px;width:240px;height:45px;transition:all .1s}@media (max-width:768px){.button-form-primary[_ngcontent-%COMP%]{width:auto}}.button-form-primary[_ngcontent-%COMP%]:hover, .button-form-primary[aria-expanded=true][_ngcontent-%COMP%]{background:#135f7f!important;border:1px solid #fff!important;color:#fff!important;transition:all .1s}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary-filled[_ngcontent-%COMP%]{background:#135f7f;border:1px solid #fff;color:#fff;border-radius:30px;padding-left:20px;padding-right:20px;width:240px;height:45px;transition:all .1s}@media (max-width:768px){.button-form-primary-filled[_ngcontent-%COMP%]{width:auto}}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary-alt[_ngcontent-%COMP%]{font-size:13px;background:#135f7f;border:1px solid #fff;color:#fff;border-radius:30px;padding:5px 20px;width:240px;transition:all .1s}@media (max-width:768px){.button-form-primary-alt[_ngcontent-%COMP%]{font-size:1em}}.button-form-primary-alt[_ngcontent-%COMP%]:hover, .button-form-primary-alt[aria-expanded=true][_ngcontent-%COMP%]{background:#fff!important;border:1px solid #fff!important;color:#135f7f!important;transition:all .1s}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary[aria-expanded=true][_ngcontent-%COMP%]{color:#135f7f;background:#fff;transition:all .1s;border:1px solid #135f7f}.button-form[_ngcontent-%COMP%]{background:#fff;color:#135f7f;border-radius:30px;padding:5px 20px;width:240px;transition:all .1s}.button-form[aria-expanded=true][_ngcontent-%COMP%]{transition:all .1s;border-bottom-left-radius:0;border-bottom-right-radius:0;border-top-left-radius:30px;border-top-right-radius:30px} .menuForm{width:240px;border-radius:30px;border:1px solid #fff;min-height:auto} .menuForm .mat-menu-content{padding-top:0;padding-bottom:0} .menuForm .mat-menu-content .mat-menu-item{transition:all .1s;font-size:13px;color:#666}@media (max-width:768px){ .menuForm .mat-menu-content .mat-menu-item{font-size:1em}} .menuForm .mat-menu-content .mat-menu-item:hover{transition:all .1s;color:#fff;background:#1a80ab} .parametersFieldsMenu{min-height:auto}.div-list[_ngcontent-%COMP%]{padding:0;max-height:150px;overflow:auto}.div-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{font-size:13px}@media (max-width:768px){.div-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{font-size:1em}}.checkbox-form[_ngcontent-%COMP%]{width:100%;padding:0;border:1px solid #135f7f;border-radius:30px;overflow:hidden}.checkbox-selected-list[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}.checkbox-selected-list[_ngcontent-%COMP%]    .mat-chip-list-wrapper{justify-content:center}.checkbox-selected-list[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{font-size:13px}@media (max-width:768px){.checkbox-selected-list[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{font-size:1em}}.radio-form[_ngcontent-%COMP%]{padding-left:20px;display:grid;grid-template-columns:repeat(2,1fr);width:100%}.radio-form[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]{flex:1}.radio-form[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]    .mat-radio-label-content{font-weight:400;color:rgba(0,0,0,.54)}.radio-form[_ngcontent-%COMP%]   .mat-radio-disabled[_ngcontent-%COMP%]{opacity:.5}.input-radio[_ngcontent-%COMP%]    .mat-form-field-infix{overflow:auto;padding-top:0}.input-radio[_ngcontent-%COMP%]    .mat-form-field-flex{height:auto}.input-radio[_ngcontent-%COMP%]    .mat-form-field-label{top:0;font-size:12px}.disabled[_ngcontent-%COMP%]{opacity:.2}.customFieldRow[_ngcontent-%COMP%]{display:flex;padding-top:20px;padding-bottom:20px}.customFieldDrag[_ngcontent-%COMP%]{cursor:move;width:50px;display:flex;align-items:center;justify-content:center}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{background:#fff;box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.indexingModelsCustomFieldsList.cdk-drop-list-dragging[_ngcontent-%COMP%]   .indexingModelsCustomFieldsList[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.advancedInput[_ngcontent-%COMP%]{flex-direction:column}.noMandatory[_ngcontent-%COMP%]{visibility:hidden}.checkboxInput[_ngcontent-%COMP%]{display:block}.categoryLabel[_ngcontent-%COMP%]{letter-spacing:1px;font-size:13px;color:#135f7f;font-weight:700}@media (max-width:768px){.categoryLabel[_ngcontent-%COMP%]{font-size:1em}}.textareaInput[_ngcontent-%COMP%]    .mat-form-field{line-height:normal}.textareaInput[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{padding:0;margin:0;color:#135f7f}.textareaInput[_ngcontent-%COMP%]    .mat-form-field-flex{padding-left:20px;height:auto!important;min-height:40px!important}.textareaInput[_ngcontent-%COMP%]    .mat-form-field-label{left:0}"]}),t})();var jf=i("87bG"),Rf=i("enVo"),Qf=i("sTim");const Af=["snav2"],Hf=["indexingForm"];function $f(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function zf(t,e){if(1&t&&(m.Zb(0,"mat-option",30),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t.id),m.Eb(1),m.Uc(" ",t.label," ")}}function Vf(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"mat-form-field"),m.Zb(3,"mat-label"),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Zb(6,"mat-select",19),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().indexingModel.category=e}))("selectionChange",(function(e){return m.Hc(t),m.lc().changeCategory(e)})),m.Qc(7,zf,2,2,"mat-option",20),m.Yb(),m.Yb(),m.Yb(),m.Zb(8,"div",18),m.Zb(9,"div",21),m.Zb(10,"mat-form-field",22),m.Zb(11,"mat-label"),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Zb(14,"input",23),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().indexingModel.label=e})),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"div",24),m.Zb(16,"mat-slide-toggle",25),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().indexingModel.default=e})),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(19,"mat-tab-group"),m.Zb(20,"mat-tab",12),m.Ub(21,"app-indexing-form",26,27),m.Zb(23,"div",28),m.Zb(24,"button",29),m.hc("click",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Sc(25),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(22),e=m.lc();m.Eb(4),m.Tc(m.nc(5,13,"lang.category_id")),m.Eb(2),m.sc("ngModel",e.indexingModel.category)("placeholder",e.translate.instant("lang.category_id")),m.Eb(1),m.sc("ngForOf",e.categoriesList),m.Eb(5),m.Tc(m.nc(13,15,"lang.modelName")),m.Eb(2),m.sc("ngModel",e.indexingModel.label),m.Eb(2),m.sc("ngModel",e.indexingModel.default),m.Eb(1),m.Uc(" ",m.nc(18,17,"lang.defaultModel")," "),m.Eb(3),m.sc("label",e.translate.instant("lang.indexingForm")),m.Eb(1),m.sc("indexingFormId",e.indexingModel.id)("admin",!0),m.Eb(3),m.sc("disabled",!t.isModified()&&!e.isModified()||""===e.indexingModel.label),m.Eb(1),m.Tc(e.translate.instant(e.creationMode?"lang.save":"lang.update"))}}function Nf(t,e){if(1&t&&m.Ub(0,"app-field-list",31),2&t){const t=m.lc();m.sc("dataFields",t.indexingForm.getAvailableFields())}}function Jf(t,e){if(1&t&&m.Ub(0,"app-field-list",32),2&t){const t=m.lc();m.sc("dataCustomFields",t.indexingForm.getAvailableCustomFields())}}let Gf=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.dialog=s,this.headerService=c,this.appService=o,this.loading=!0,this.indexingModel={id:0,label:"",category:"incoming",default:!1,owner:0,private:!1},this.indexingModelsCustomFields=[],this.creationMode=!0}ngOnInit(){this.route.params.subscribe(t=>{void 0===t.id?(this.creationMode=!0,this.headerService.setHeader(this.translate.instant("lang.indexingModelCreation")),this.http.get("../rest/categories").pipe(Object(d.a)(t=>{this.categoriesList=t.categories}),Object(d.a)(t=>{this.loading=!1,setTimeout(()=>{this.indexingForm.changeCategory(this.indexingModel.category)},0)}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe(),this.indexingModelClone=JSON.parse(JSON.stringify(this.indexingModel))):(this.creationMode=!1,this.http.get("../rest/indexingModels/"+t.id).pipe(Object(d.a)(t=>{this.indexingModel=t.indexingModel,this.headerService.setHeader(this.translate.instant("lang.indexingModelModification"),this.indexingModel.label),this.indexingModelClone=JSON.parse(JSON.stringify(this.indexingModel))}),Object(q.a)(()=>this.http.get("../rest/categories")),Object(d.a)(t=>{this.categoriesList=t.categories}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe())})}onSubmit(){const t=this.indexingForm.getDatas();t.forEach((e,i)=>{t[i].default_value=["string","integer","date"].indexOf(t[i].type)>-1&&t[i].SQLMode?null:t[i].default_value,delete t[i].event,delete t[i].label,delete t[i].system,delete t[i].type,delete t[i].values}),this.indexingModel.fields=t,this.creationMode?this.http.post("../rest/indexingModels",this.indexingModel).pipe(Object(d.a)(t=>{this.indexingForm.setModification(),this.setModification(),this.router.navigate(["/administration/indexingModels"]),this.notify.success(this.translate.instant("lang.indexingModelAdded"))}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe():this.http.put("../rest/indexingModels/"+this.indexingModel.id,this.indexingModel).pipe(Object(d.a)(t=>{this.indexingForm.setModification(),this.setModification(),this.router.navigate(["/administration/indexingModels"]),this.notify.success(this.translate.instant("lang.indexingModelUpdated"))}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}isModified(){let t="",e="";return t=JSON.stringify(this.indexingModel),e=JSON.stringify(this.indexingModelClone),t!==e}setModification(){this.indexingModelClone=JSON.parse(JSON.stringify(this.indexingModel))}changeCategory(t){this.indexingForm.changeCategory(t.value)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Af,!0),m.ad(Hf,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.indexingForm=i.first))},features:[m.Db([f.a,U.a])],decls:20,vars:14,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end","opened","",1,"col-md-4","col-sm-12",3,"mode","fixedInViewport"],["snav2",""],[3,"label"],[3,"dataFields",4,"ngIf"],[3,"dataCustomFields",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[2,"display","flex"],["name","category","required","",3,"ngModel","placeholder","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[2,"flex","1"],["appearance","outline",1,"indexingModelLabel"],["matInput","","name","label",3,"ngModel","ngModelChange"],[1,"defaultModel"],["color","primary","name","default",3,"ngModel","ngModelChange"],[3,"indexingFormId","admin"],["indexingForm",""],[1,"col-md-12","text-center"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"value"],[3,"dataFields"],[3,"dataCustomFields"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,$f,2,0,"div",8),m.Qc(12,Vf,26,19,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Zb(15,"mat-tab-group"),m.Zb(16,"mat-tab",12),m.Qc(17,Nf,1,1,"app-field-list",13),m.Yb(),m.Zb(18,"mat-tab",12),m.Qc(19,Jf,1,1,"app-field-list",14),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode()),m.Eb(3),m.sc("label",e.translate.instant("lang.availableFields")),m.Eb(1),m.sc("ngIf",void 0!==e.indexingForm),m.Eb(1),m.sc("label",e.translate.instant("lang.availableCustomFields")),m.Eb(1),m.sc("ngIf",void 0!==e.indexingForm))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ie.c,Ie.a,T.c,k.a,w.c,w.g,at.a,o.E,o.t,o.w,x.s,O.b,o.c,et.a,Rf.a,D.b,I.o,Qf.a],pipes:[p.d],styles:[".indexingModelLabel[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.defaultModel[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding-left:10px}",".banner[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:30px;border-radius:20px;border:1px solid #ccc;position:relative;padding:20px;width:100%}.banner[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:20px;font-weight:700;letter-spacing:2px;position:absolute;top:-18px;left:20px;padding:0;margin:0;color:#135f7f}.banner[_ngcontent-%COMP%]   .title-divider[_ngcontent-%COMP%]{position:absolute;width:99%;z-index:-1;top:17px;background:#fff;height:1px}.banner[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:50%;padding-right:10px}.banner[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-size:16px}.fieldRow[_ngcontent-%COMP%]{display:flex;padding-top:10px;padding-bottom:10px}.fieldLabel[_ngcontent-%COMP%]{color:#4a4a4a}.fieldLabel[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]{margin-right:10px}.fieldState[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;width:40px;justify-content:center;align-items:normal!important;padding-top:15px}.fieldState[_ngcontent-%COMP%]   .fieldRequired[_ngcontent-%COMP%]{font-size:5px;color:#135f7f}.fieldState[_ngcontent-%COMP%]   .fieldError[_ngcontent-%COMP%]{font-size:15px;color:#f99830}.fieldState[_ngcontent-%COMP%]   .fieldFull[_ngcontent-%COMP%]{font-size:15px;color:green}.fieldInput[_ngcontent-%COMP%]{position:relative}.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:13px;flex:1}@media (max-width:768px){.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:1em}}.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%], .fieldState[_ngcontent-%COMP%]{align-items:center;display:flex}.input-form[_ngcontent-%COMP%]{font-size:13px;color:#666;width:500px}.input-form[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{color:#135f7f;padding-left:20px}.input-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.input-form[_ngcontent-%COMP%]    .mat-select-value-text{padding-left:20px;color:#135f7f}.input-form[_ngcontent-%COMP%]    .mat-form-field-label{top:15px;left:20px}.input-form[_ngcontent-%COMP%]    .mat-form-field-infix{display:flex;padding-top:0;padding-bottom:5px}.input-form[_ngcontent-%COMP%]    .mat-form-field-label-wrapper{top:-13px}.input-form[_ngcontent-%COMP%]    .mat-form-field-flex{background:#fff;height:40px;border-radius:10px;border:1px solid #135f7f}.input-form[_ngcontent-%COMP%]     .mat-form-field-underline{display:none}.input-form[_ngcontent-%COMP%]    .mat-form-field-suffix{margin-right:20px}.input-form[_ngcontent-%COMP%]    .mat-select-arrow-wrapper{padding-right:20px}.input-form[_ngcontent-%COMP%]    .mat-list-option{color:rgba(0,0,0,.54)}.input-form[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.input-form[_ngcontent-%COMP%]    .mat-datepicker-toggle-default-icon{height:auto}.input-form.search-select[_ngcontent-%COMP%]    .mat-form-field-label-wrapper{top:-15px}.input-form.input-date[_ngcontent-%COMP%]    .mat-form-field-infix{padding-top:5px}.input-form-filled[_ngcontent-%COMP%]{color:#fff;width:500px;transition:all .1s}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-form-field-flex, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-form-field-flex{background:#fff!important;border:1px solid #fff!important;color:#135f7f!important;transition:all .1s}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-form-field-label, .input-form-filled[_ngcontent-%COMP%]:hover    .mat-select-placeholder, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-form-field-label, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-select-placeholder{color:#135f7f!important}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-select-arrow, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-select-arrow{color:rgba(19,95,127,.54)}.input-form-filled[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{color:#135f7f;padding-left:20px}.input-form-filled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-value{text-align:left;font-weight:400}.input-form-filled[_ngcontent-%COMP%]    .mat-select-value-text{padding-left:20px;color:#fff}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-label{color:#fff;left:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-infix{padding-bottom:15px}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-flex{background:#135f7f;border-radius:30px;border:1px solid #fff}.input-form-filled[_ngcontent-%COMP%]     .mat-form-field-underline{display:none}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-suffix{margin-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-arrow-wrapper{padding-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-arrow{color:hsla(0,0%,100%,.54)}.input-form-filled[_ngcontent-%COMP%]    .mat-select-placeholder{color:#fff}.input-form-filled[_ngcontent-%COMP%]    .mat-list-option{color:rgba(0,0,0,.54)}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.input-form-filled[_ngcontent-%COMP%]   textarea.cdk-textarea-autosize-measuring[_ngcontent-%COMP%]{padding:4px 0!important}.input-form-filled[_ngcontent-%COMP%]    .mat-datepicker-toggle-default-icon{height:auto}.input-form.mat-form-field-disabled[_ngcontent-%COMP%]    .mat-input-element{cursor:not-allowed;padding-left:20px}.input-form.mat-form-field-disabled[_ngcontent-%COMP%]    .mat-form-field-flex{cursor:not-allowed;border:1px dashed #353232}.opt-group[_ngcontent-%COMP%]{font-weight:700}.smallInput[_ngcontent-%COMP%]{font-size:11px;padding-left:20px;padding-right:20px}.smallInput[_ngcontent-%COMP%]    .mat-form-field-infix{padding:0 0 5px}.button-form-primary[_ngcontent-%COMP%]{background:#fff;border:1px solid #135f7f;color:#135f7f;border-radius:30px;padding-left:20px;padding-right:20px;width:240px;height:45px;transition:all .1s}@media (max-width:768px){.button-form-primary[_ngcontent-%COMP%]{width:auto}}.button-form-primary[_ngcontent-%COMP%]:hover, .button-form-primary[aria-expanded=true][_ngcontent-%COMP%]{background:#135f7f!important;border:1px solid #fff!important;color:#fff!important;transition:all .1s}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary-filled[_ngcontent-%COMP%]{background:#135f7f;border:1px solid #fff;color:#fff;border-radius:30px;padding-left:20px;padding-right:20px;width:240px;height:45px;transition:all .1s}@media (max-width:768px){.button-form-primary-filled[_ngcontent-%COMP%]{width:auto}}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary-alt[_ngcontent-%COMP%]{font-size:13px;background:#135f7f;border:1px solid #fff;color:#fff;border-radius:30px;padding:5px 20px;width:240px;transition:all .1s}@media (max-width:768px){.button-form-primary-alt[_ngcontent-%COMP%]{font-size:1em}}.button-form-primary-alt[_ngcontent-%COMP%]:hover, .button-form-primary-alt[aria-expanded=true][_ngcontent-%COMP%]{background:#fff!important;border:1px solid #fff!important;color:#135f7f!important;transition:all .1s}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary[aria-expanded=true][_ngcontent-%COMP%]{color:#135f7f;background:#fff;transition:all .1s;border:1px solid #135f7f}.button-form[_ngcontent-%COMP%]{background:#fff;color:#135f7f;border-radius:30px;padding:5px 20px;width:240px;transition:all .1s}.button-form[aria-expanded=true][_ngcontent-%COMP%]{transition:all .1s;border-bottom-left-radius:0;border-bottom-right-radius:0;border-top-left-radius:30px;border-top-right-radius:30px} .menuForm{width:240px;border-radius:30px;border:1px solid #fff;min-height:auto} .menuForm .mat-menu-content{padding-top:0;padding-bottom:0} .menuForm .mat-menu-content .mat-menu-item{transition:all .1s;font-size:13px;color:#666}@media (max-width:768px){ .menuForm .mat-menu-content .mat-menu-item{font-size:1em}} .menuForm .mat-menu-content .mat-menu-item:hover{transition:all .1s;color:#fff;background:#1a80ab} .parametersFieldsMenu{min-height:auto}.div-list[_ngcontent-%COMP%]{padding:0;max-height:150px;overflow:auto}.div-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{font-size:13px}@media (max-width:768px){.div-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{font-size:1em}}.checkbox-form[_ngcontent-%COMP%]{width:100%;padding:0;border:1px solid #135f7f;border-radius:30px;overflow:hidden}.checkbox-selected-list[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}.checkbox-selected-list[_ngcontent-%COMP%]    .mat-chip-list-wrapper{justify-content:center}.checkbox-selected-list[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{font-size:13px}@media (max-width:768px){.checkbox-selected-list[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{font-size:1em}}.radio-form[_ngcontent-%COMP%]{padding-left:20px;display:grid;grid-template-columns:repeat(2,1fr);width:100%}.radio-form[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]{flex:1}.radio-form[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]    .mat-radio-label-content{font-weight:400;color:rgba(0,0,0,.54)}.radio-form[_ngcontent-%COMP%]   .mat-radio-disabled[_ngcontent-%COMP%]{opacity:.5}.input-radio[_ngcontent-%COMP%]    .mat-form-field-infix{overflow:auto;padding-top:0}.input-radio[_ngcontent-%COMP%]    .mat-form-field-flex{height:auto}.input-radio[_ngcontent-%COMP%]    .mat-form-field-label{top:0;font-size:12px}.disabled[_ngcontent-%COMP%]{opacity:.2}.customFieldRow[_ngcontent-%COMP%]{display:flex;padding-top:20px;padding-bottom:20px}.customFieldDrag[_ngcontent-%COMP%]{cursor:move;width:50px;display:flex;align-items:center;justify-content:center}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{background:#fff;box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.indexingModelsCustomFieldsList.cdk-drop-list-dragging[_ngcontent-%COMP%]   .indexingModelsCustomFieldsList[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.advancedInput[_ngcontent-%COMP%]{flex-direction:column}.noMandatory[_ngcontent-%COMP%]{visibility:hidden}.checkboxInput[_ngcontent-%COMP%]{display:block}.categoryLabel[_ngcontent-%COMP%]{letter-spacing:1px;font-size:13px;color:#135f7f;font-weight:700}@media (max-width:768px){.categoryLabel[_ngcontent-%COMP%]{font-size:1em}}.textareaInput[_ngcontent-%COMP%]    .mat-form-field{line-height:normal}.textareaInput[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{padding:0;margin:0;color:#135f7f}.textareaInput[_ngcontent-%COMP%]    .mat-form-field-flex{padding-left:20px;height:auto!important;min-height:40px!important}.textareaInput[_ngcontent-%COMP%]    .mat-form-field-label{left:0}"]}),t})();function Bf(t,e){if(1&t&&(m.Zb(0,"li"),m.Zb(1,"b"),m.Sc(2),m.Yb(),m.Sc(3),m.mc(4,"translate"),m.Zb(5,"b"),m.Sc(6),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(2),m.Tc(t.count),m.Eb(1),m.Uc(" ",m.nc(4,3,"lang.mailsWithStatus")," "),m.Eb(3),m.Tc(t.status)}}function Wf(t,e){if(1&t&&(m.Zb(0,"mat-option",14),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.sc("value",t.id)("disabled",t.id===i.mainIndexingModel.id),m.Eb(1),m.Uc(" ",t.label," ")}}function qf(t,e){if(1&t){const t=m.ac();m.Zb(0,"div"),m.Zb(1,"mat-form-field",11),m.Zb(2,"mat-select",12),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().modelIds=e}))("selectionChange",(function(e){return m.Hc(t),m.lc().changeModel(e)})),m.Qc(3,Wf,2,3,"mat-option",13),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.sc("ngModel",t.modelIds)("placeholder",t.translate.instant("lang.indexingModel")),m.Eb(1),m.sc("ngForOf",t.indexingModels)}}function Xf(t,e){if(1&t&&(m.Zb(0,"li"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label," ")}}function Kf(t,e){if(1&t&&(m.Zb(0,"div",15),m.Sc(1),m.mc(2,"translate"),m.Zb(3,"ul"),m.Qc(4,Xf,2,1,"li",4),m.Yb(),m.Sc(5),m.mc(6,"translate"),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.Uc(" ",m.nc(2,3,"lang.indexingModelFieldsReset")," "),m.Eb(3),m.sc("ngForOf",t.resetFields),m.Eb(1),m.Uc(" ",m.nc(6,5,"lang.confirmAction")," ")}}let tg=(()=>{class t{constructor(t,e,i,a,n,s){this.translate=t,this.data=e,this.dialogRef=i,this.http=a,this.notify=n,this.sortPipe=s,this.indexingModels=[],this.modelIds=[],this.resetFields=[],this.statuses=[],this.customFields=[],this.availableFields=[{identifier:"doctype",label:this.translate.instant("lang.doctype")},{identifier:"subject",label:this.translate.instant("lang.subject")},{identifier:"recipients",label:this.translate.instant("lang.getRecipients")},{identifier:"priority",label:this.translate.instant("lang.priority")},{identifier:"confidentiality",label:this.translate.instant("lang.confidential")},{identifier:"initiator",label:this.translate.instant("lang.initiatorEntityAlt")},{identifier:"departureDate",label:this.translate.instant("lang.departureDate")},{identifier:"processLimitDate",label:this.translate.instant("lang.processLimitDate")},{identifier:"tags",label:this.translate.instant("lang.tags")},{identifier:"senders",label:this.translate.instant("lang.getSenders")},{identifier:"destination",label:this.translate.instant("lang.destination")},{identifier:"folders",label:this.translate.instant("lang.folders")},{identifier:"documentDate",label:this.translate.instant("lang.docDate")},{identifier:"arrivalDate",label:this.translate.instant("lang.arrivalDate")}],this.loading=!1,this.mainIndexingModel=e.indexingModel}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){this.loadIndexingModels(),this.loadStatuses(),this.loadCustomFields(),this.loadIndexingModelFields()}))}loadIndexingModels(){this.http.get("../rest/indexingModels").pipe(Object(l.a)(t=>t.indexingModels.filter(t=>!1===t.private)),Object(d.a)(t=>{this.indexingModels=t,this.sortPipe.transform(this.indexingModels,"label"),this.modelIds=this.indexingModels.map(t=>t.id)}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}loadIndexingModelFields(){this.http.get("../rest/indexingModels/"+this.mainIndexingModel.id).pipe(Object(d.a)(t=>{this.mainIndexingModelFields=t.indexingModel.fields,this.mainIndexingModelFields=this.mainIndexingModelFields.map(t=>{const e=this.availableFields.find(e=>e.identifier===t.identifier);return t.label=void 0===e?this.translate.instant("lang.undefined"):e.label,t})}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}loadStatuses(){this.http.get("../rest/statuses").pipe(Object(d.a)(t=>{this.statuses=t.statuses,this.mainIndexingModel.used.forEach(t=>{const e=this.statuses.find(e=>e.id===t.status);void 0!==e&&(t.status=e.label_status)})}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}loadCustomFields(){this.http.get("../rest/customFields").pipe(Object(d.a)(t=>{t.customFields=t.customFields.map(t=>({identifier:"indexingCustomField_"+t.id,label:t.label})),t.customFields.forEach(t=>{this.availableFields.push(t)}),this.sortPipe.transform(this.availableFields,"label"),this.loadIndexingModelFields()}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}changeModel(t){this.selectedModelId=t.value,this.http.get("../rest/indexingModels/"+this.selectedModelId).pipe(Object(d.a)(t=>{this.selectedModelFields=t.indexingModel.fields,this.resetFields=this.mainIndexingModelFields.filter(t=>void 0===this.selectedModelFields.find(e=>e.identifier===t.identifier)),this.sortPipe.transform(this.resetFields,"label")}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}onSubmit(){this.http.request("DELETE","../rest/indexingModels/"+this.mainIndexingModel.id,{body:{targetId:this.selectedModelId}}).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.indexingModelDeleted")),this.dialogRef.close("ok")}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(H.a),m.Tb(H.h),m.Tb(u.b),m.Tb(y.a),m.Tb(U.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],features:[m.Db([U.a])],decls:22,vars:19,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"alert-message","alert-message-info"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","alert-message alert-message-danger",4,"ngIf"],[1,"divider-modal"],["mat-dialog-actions",""],["color","primary","mat-raised-button","",1,"actions",3,"disabled","click"],["color","","mat-raised-button","",1,"actions",3,"click"],[2,"padding","10px","margin-top","15px"],["name","model","required","",3,"ngModel","placeholder","ngModelChange","selectionChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],[1,"alert-message","alert-message-danger"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Sc(6),m.mc(7,"translate"),m.Zb(8,"ul"),m.Qc(9,Bf,7,5,"li",4),m.Yb(),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Qc(12,qf,4,3,"div",5),m.Qc(13,Kf,7,7,"div",6),m.Ub(14,"span",7),m.Zb(15,"div",8),m.Zb(16,"button",9),m.hc("click",(function(){return e.onSubmit()})),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Zb(19,"button",10),m.hc("click",(function(){return e.dialogRef.close("")})),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,9,"lang.indexingModelReassign")),m.Eb(4),m.Uc(" ",m.nc(7,11,"lang.indexingModelUsedBy")," "),m.Eb(3),m.sc("ngForOf",e.mainIndexingModel.used),m.Eb(1),m.Uc(" ",m.nc(11,13,"lang.indexingModelReplaceToDelete")," "),m.Eb(2),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("ngIf",0!==e.resetFields.length),m.Eb(3),m.sc("disabled",void 0===e.selectedModelId),m.Eb(1),m.Tc(m.nc(18,15,"lang.validate")),m.Eb(3),m.Tc(m.nc(21,17,"lang.cancel")))},directives:[H.i,H.f,x.s,x.t,H.c,D.b,w.c,at.a,o.E,o.t,o.w,I.o],pipes:[p.d],styles:[".alert-message-info[_ngcontent-%COMP%]{margin:0;font-size:16px}"]}),t})();const eg=["adminMenuTemplate"];function ig(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function ag(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function ng(t,e){1&t&&(m.Zb(0,"mat-header-cell",41),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.technicalId")))}function sg(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.id," ")}}function cg(t,e){1&t&&(m.Zb(0,"mat-header-cell",41),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.category_id")))}function og(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",m.nc(2,1,"lang."+t.category)," ")}}function rg(t,e){1&t&&(m.Zb(0,"mat-header-cell",42),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.label")))}function lg(t,e){if(1&t&&(m.Zb(0,"mat-cell",43),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label," ")}}function dg(t,e){1&t&&(m.Zb(0,"mat-header-cell",41),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.perimeter")))}const bg=function(t,e){return{dataLabelWarn:t,dataLabelPrimary:e}};function mg(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Zb(1,"span",44),m.Sc(2),m.Yb(),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.sc("ngClass",m.Ac(2,bg,t.private,!t.private)),m.Eb(1),m.Tc(i.translate.instant(t.private?"lang.private":"lang.public"))}}function pg(t,e){1&t&&(m.Zb(0,"mat-header-cell",41),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.default")))}function ug(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Zb(1,"span",44),m.Sc(2),m.Yb(),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.sc("ngClass",m.Ac(2,bg,!t.default,t.default)),m.Eb(1),m.Tc(i.translate.instant(t.default?"lang.yes":"lang.no"))}}function hg(t,e){1&t&&(m.Zb(0,"mat-header-cell",41),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.status")))}function fg(t,e){1&t&&(m.Zb(0,"span",47),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.active")))}function gg(t,e){1&t&&(m.Zb(0,"span",48),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.inactive")))}function vg(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Qc(1,fg,3,3,"span",45),m.Qc(2,gg,3,3,"span",46),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",t.enabled),m.Eb(1),m.sc("ngIf",!t.enabled)}}function yg(t,e){1&t&&m.Ub(0,"mat-header-cell")}function Cg(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",54),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2);return e.stopPropagation(),a.disableIndexingModel(i)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",55),m.Yb()}if(2&t){const t=m.lc().$implicit;m.tc("matTooltip",m.nc(1,2,"lang.suspend")),m.sc("disabled",t.default)}}function Eg(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",56),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2);return e.stopPropagation(),a.enableIndexingModel(i)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",57),m.Yb()}2&t&&m.tc("matTooltip",m.nc(1,1,"lang.authorize"))}function Sg(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",49),m.Qc(1,Cg,3,4,"button",50),m.Qc(2,Eg,3,3,"button",51),m.Zb(3,"button",52),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.delete(a)})),m.mc(4,"translate"),m.Ub(5,"mat-icon",53),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf",t.enabled),m.Eb(1),m.sc("ngIf",!t.enabled),m.Eb(1),m.tc("matTooltip",m.nc(4,4,"lang.delete")),m.sc("disabled",t.default)}}function Mg(t,e){1&t&&m.Ub(0,"mat-header-row")}function Yg(t,e){1&t&&(m.Ub(0,"mat-row",58),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/indexingModels/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Zg(t,e){if(1&t&&(m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field"),m.Ub(4,"input",20),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",19),m.Ub(7,"mat-paginator",21,22),m.Yb(),m.Yb(),m.Zb(9,"mat-table",23,24),m.Xb(11,25),m.Qc(12,ng,3,3,"mat-header-cell",26),m.Qc(13,sg,2,1,"mat-cell",27),m.Wb(),m.Xb(14,28),m.Qc(15,cg,3,3,"mat-header-cell",26),m.Qc(16,og,3,3,"mat-cell",27),m.Wb(),m.Xb(17,29),m.Qc(18,rg,3,3,"mat-header-cell",30),m.Qc(19,lg,2,1,"mat-cell",31),m.Wb(),m.Xb(20,32),m.Qc(21,dg,3,3,"mat-header-cell",26),m.Qc(22,mg,3,5,"mat-cell",27),m.Wb(),m.Xb(23,33),m.Qc(24,pg,3,3,"mat-header-cell",26),m.Qc(25,ug,3,5,"mat-cell",27),m.Wb(),m.Xb(26,34),m.Qc(27,hg,3,3,"mat-header-cell",26),m.Qc(28,vg,3,2,"mat-cell",27),m.Wb(),m.Xb(29,35),m.Qc(30,yg,1,0,"mat-header-cell",36),m.Qc(31,Sg,6,6,"mat-cell",37),m.Wb(),m.Qc(32,Mg,1,0,"mat-header-row",38),m.Qc(33,Yg,2,4,"mat-row",39),m.Yb(),m.Zb(34,"div",40),m.Sc(35),m.mc(36,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(23),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.indexingModels.length," ",m.nc(36,12,"lang.indexingModels"),"")}}let xg=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.dialog=s,this.functions=c,this.adminService=o,this.viewContainerRef=r,this.search=null,this.indexingModels=[],this.loading=!1,this.displayedColumns=["id","category","label","private","default","enabled","actions"],this.filterColumns=["id","label"]}ngOnInit(){this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/indexingModels?showDisabled=true").pipe(Object(l.a)(t=>t.indexingModels.filter(t=>!1===t.private)),Object(d.a)(t=>{this.indexingModels=t,this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.indexingModels")),setTimeout(()=>{this.adminService.setDataSource("admin_indexing_models",this.indexingModels,this.sort,this.paginator,this.filterColumns)},0)}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}delete(t){0===t.used.length?(this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/indexingModels/"+t.id)),Object(d.a)(()=>{for(const e in this.indexingModels)this.indexingModels[e].id===t.id&&this.indexingModels.splice(Number(e),1);this.adminService.setDataSource("admin_indexing_models",this.indexingModels,this.sort,this.paginator,this.filterColumns),this.notify.success(this.translate.instant("lang.indexingModelDeleted"))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()):(this.dialogRef=this.dialog.open(tg,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction"),indexingModel:t}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(d.a)(()=>{for(const e in this.indexingModels)this.indexingModels[e].id===t.id&&this.indexingModels.splice(Number(e),1);this.adminService.setDataSource("admin_indexing_models",this.indexingModels,this.sort,this.paginator,this.filterColumns)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe())}disableIndexingModel(t){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.disable"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.request("PUT","../rest/indexingModels/"+t.id+"/disable")),Object(d.a)(e=>{for(const i in this.indexingModels)this.indexingModels[i].id===t.id&&(this.indexingModels[i].enabled=!1);this.notify.success(this.translate.instant("lang.indexingModelDisabled"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}enableIndexingModel(t){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.enable"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.request("PUT","../rest/indexingModels/"+t.id+"/enable")),Object(d.a)(e=>{for(let i in this.indexingModels)this.indexingModels[i].id===t.id&&(this.indexingModels[i].enabled=!0);this.notify.success(this.translate.instant("lang.indexingModelEnabled"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(eg,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/indexingModels/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSortDisableClear","","matSort","",3,"dataSource"],["table",""],["matColumnDef","id"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","category"],["matColumnDef","label"],["mat-sort-header","","style","flex:2",4,"matHeaderCellDef"],["style","flex:2",4,"matCellDef"],["matColumnDef","private"],["matColumnDef","default"],["matColumnDef","enabled"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],[1,"label",3,"ngClass"],["class","label dataLabelPrimary",4,"ngIf"],["class","label dataLabelWarn",4,"ngIf"],[1,"label","dataLabelPrimary"],[1,"label","dataLabelWarn"],[2,"justify-content","flex-end"],["mat-icon-button","","color","primary",3,"matTooltip","disabled","click",4,"ngIf"],["mat-icon-button","","color","accent",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","disabled","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],["mat-icon-button","","color","primary",3,"matTooltip","disabled","click"],["aria-hidden","true",1,"fa","fa-pause","fa-2x"],["mat-icon-button","","color","accent",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-check","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,ig,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,ag,2,0,"div",9),m.Qc(14,Zg,37,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,x.q,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],styles:[".dataLabelWarn[_ngcontent-%COMP%]{color:#8e3e52}.dataLabelPrimary[_ngcontent-%COMP%]{color:#135f7f}.label[_ngcontent-%COMP%]{font-size:75%;font-weight:700}"]}),t})();const _g=["listFilter"];function wg(t,e){1&t&&(m.Zb(0,"div",32),m.Ub(1,"mat-spinner"),m.Yb())}function Og(t,e){if(1&t&&(m.Zb(0,"mat-option",33),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function Tg(t,e){if(1&t&&(m.Zb(0,"mat-option",33),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function kg(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",34),m.Zb(1,"mat-form-field",5),m.Zb(2,"mat-label"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Zb(5,"mat-select",35),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().exportModel.delimiter=e})),m.mc(6,"translate"),m.Qc(7,Tg,2,2,"mat-option",7),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(3),m.Tc(m.nc(4,5,"lang.delimiter")),m.Eb(2),m.tc("placeholder",m.nc(6,7,"lang.delimiter")),m.sc("ngModel",t.exportModel.delimiter)("disabled","csv"!=t.exportModel.format),m.Eb(2),m.sc("ngForOf",t.delimiters)}}function Ig(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",36),m.Sc(1),m.Zb(2,"i",37),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().addData(i)})),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.tc("id",t.value),m.Eb(1),m.Uc("",t.label," ")}}function Dg(t,e){1&t&&(m.Zb(0,"div",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.noDataAvailable")))}function Ug(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",36),m.Sc(1),m.Zb(2,"i",39),m.hc("click",(function(){m.Hc(t);const i=e.index;return m.lc().removeData(i)})),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.tc("id",t.value),m.Eb(1),m.Uc("",t.label," ")}}function Pg(t,e){1&t&&(m.Zb(0,"div",38),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.noDataAvailable")))}const Fg=function(t){return[t]};let Lg=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.notify=i,this.data=a,this.sortPipe=n,this.localStorage=s,this.headerService=c,this.loading=!1,this.loadingExport=!1,this.delimiters=[";",",","TAB"],this.formats=["csv"],this.exportModel={delimiter:";",format:"csv",data:[]},this.dataAvailable=[{value:"id",label:this.translate.instant("lang.id")},{value:"externalId",label:"External Id"},{value:"enabled",label:this.translate.instant("lang.status")},{value:"communicationMeans",label:this.translate.instant("lang.communicationMean")}]}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){yield this.getContactFields(),this.setConfiguration()}))}getContactFields(){return new Promise((t,e)=>{this.http.get("../rest/contactsParameters").pipe(Object(l.a)(t=>{const e=/contactCustomField_[.]*/g;return t.contactsParameters=t.contactsParameters.filter(t=>null===t.identifier.match(e)).map(t=>({value:t.identifier,label:this.translate.instant("lang.contactsParameters_"+t.identifier)})),t.contactsParameters}),Object(d.a)(t=>{this.dataAvailable=this.dataAvailable.concat(t)}),Object(q.a)(()=>this.http.get("../rest/contactsCustomFields")),Object(l.a)(t=>(t.customFields=t.customFields.map(t=>({value:"contactCustomField_"+t.id,label:t.label})),t.customFields)),Object(d.a)(e=>{this.dataAvailable=this.dataAvailable.concat(e),this.dataAvailable=this.sortPipe.transform(this.dataAvailable,"label"),t(!0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}drop(t){if(t.previousContainer===t.container)Object(Ma.h)(t.container.data,t.previousIndex,t.currentIndex);else{let e=t.previousIndex;if("selectedElements"===t.container.id&&(e=0,void 0!==$(".available-data .columns")[t.previousIndex])){const i=$(".available-data .columns")[t.previousIndex].id;e=this.dataAvailable.map(t=>t.value).indexOf(i)}Object(Ma.i)(t.previousContainer.data,t.container.data,e,t.currentIndex);const i=this.listFilter.nativeElement.value;this.listFilter.nativeElement.value="",setTimeout(()=>{this.listFilter.nativeElement.value=i},10)}}exportData(){this.localStorage.save("exportContactFields_"+this.headerService.user.id,JSON.stringify(this.exportModel)),this.loadingExport=!0,this.http.put("../rest/contacts/export",this.exportModel,{responseType:"blob"}).pipe(Object(d.a)(t=>{if("text/html"!==t.type){const e=document.createElement("a");let i,a,n,s;e.href=window.URL.createObjectURL(t),i=new Date,a=i.getDate(),n=i.getMonth()+1,s=i.getFullYear(),a<10&&(a="0"+a),n<10&&(n="0"+n),i=a+"-"+n+"-"+s,e.setAttribute("download","export_contact_maarch_"+i+"."+this.exportModel.format.toLowerCase()),document.body.appendChild(e),e.click()}else alert(this.translate.instant("lang.tooMuchDatas"))}),Object(vt.a)(()=>this.loadingExport=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}addData(t){let e=0;this.dataAvailable.forEach((i,a)=>{i.value===t.value&&(e=a)}),Object(Ma.i)(this.dataAvailable,this.exportModel.data,e,this.exportModel.data.length);const i=this.listFilter.nativeElement.value;this.listFilter.nativeElement.value="",setTimeout(()=>{this.listFilter.nativeElement.value=i},10)}removeData(t){Object(Ma.i)(this.exportModel.data,this.dataAvailable,t,this.dataAvailable.length),this.sortPipe.transform(this.dataAvailable,"label")}removeAllData(){this.dataAvailable=this.dataAvailable.concat(this.exportModel.data),this.exportModel.data=[]}addAllData(){for(this.exportModel.data=this.exportModel.data.concat(this.dataAvailable);this.dataAvailable.length>0;)this.dataAvailable.pop();this.listFilter.nativeElement.value=""}setConfiguration(){null!==this.localStorage.get("exportContactFields_"+this.headerService.user.id)&&(JSON.parse(this.localStorage.get("exportContactFields_"+this.headerService.user.id)).data.forEach(t=>{this.addData(t)}),this.exportModel.delimiter=JSON.parse(this.localStorage.get("exportContactFields_"+this.headerService.user.id)).delimiter)}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.a),m.Tb(U.a),m.Tb(K.a),m.Tb(h.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(_g,!0),2&t&&m.Cc(i=m.ic())&&(e.listFilter=i.first)},features:[m.Db([U.a])],decls:63,vars:62,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["mat-dialog-content",""],["class","loader",4,"ngIf"],[1,"row"],["appearance","outline"],[3,"placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","col-md-9",4,"ngIf"],[3,"expanded"],[1,"col-md-12"],["appearance","outline",1,"listFilter"],["matInput","","cdkFocusInitial","",3,"placeholder"],["listFilter",""],[1,"row","exportList"],[1,"col-md-6","available-data"],[1,"title"],["color","primary",1,"fa","fa-plus-circle","removeAllDatas",3,"title","click"],["id","availableElements","cdkDropList","",1,"cdk-list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["dataAvailableList","cdkDropList"],["class","columns","cdkDrag","",3,"id",4,"ngFor","ngForOf"],["class","noData",4,"ngIf"],[2,"display","flex","align-items","center"],[1,"fas","fa-arrow-right"],[1,"col-md-6","active-data"],["color","warn",1,"fa","fa-minus-circle","removeAllDatas",3,"title","click"],["id","selectedElements","cdkDropList","",1,"cdk-list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["dataExportList","cdkDropList"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click"],["mat-raised-button","","mat-button","",3,"mat-dialog-close"],[1,"loader"],[3,"value"],[1,"col-md-9"],[3,"placeholder","ngModel","disabled","ngModelChange"],["cdkDrag","",1,"columns",3,"id"],["color","primary",1,"fa","fa-plus",2,"cursor","pointer",3,"click"],[1,"noData"],["color","warn",1,"fa","fa-minus",2,"cursor","pointer",3,"click"]],template:function(t,e){if(1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",2),m.Qc(5,wg,2,0,"div",3),m.Zb(6,"div",4),m.Zb(7,"div"),m.Zb(8,"mat-form-field",5),m.Zb(9,"mat-label"),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Zb(12,"mat-select",6),m.hc("ngModelChange",(function(t){return e.exportModel.format=t})),m.mc(13,"translate"),m.Qc(14,Og,2,2,"mat-option",7),m.Yb(),m.Yb(),m.Yb(),m.Qc(15,kg,8,9,"div",8),m.Yb(),m.Zb(16,"mat-accordion"),m.Zb(17,"mat-expansion-panel",9),m.Zb(18,"mat-expansion-panel-header"),m.Zb(19,"mat-panel-title"),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Yb(),m.Zb(22,"div",4),m.Zb(23,"div",10),m.Zb(24,"mat-form-field",11),m.Ub(25,"input",12,13),m.mc(27,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(28,"div",14),m.Zb(29,"div",15),m.Zb(30,"h2"),m.Zb(31,"span",16),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Zb(34,"i",17),m.hc("click",(function(){return e.addAllData()})),m.mc(35,"translate"),m.Yb(),m.Yb(),m.Zb(36,"div",18,19),m.hc("cdkDropListDropped",(function(t){return e.drop(t)})),m.Qc(38,Ig,3,2,"div",20),m.mc(39,"filterList"),m.mc(40,"sortBy"),m.Qc(41,Dg,3,3,"div",21),m.Yb(),m.Yb(),m.Zb(42,"div",22),m.Ub(43,"i",23),m.Yb(),m.Zb(44,"div",24),m.Zb(45,"h2"),m.Zb(46,"span",16),m.Sc(47),m.mc(48,"translate"),m.Yb(),m.Zb(49,"i",25),m.hc("click",(function(){return e.removeAllData()})),m.mc(50,"translate"),m.Yb(),m.Yb(),m.Zb(51,"div",26,27),m.hc("cdkDropListDropped",(function(t){return e.drop(t)})),m.Qc(53,Ug,3,2,"div",20),m.Qc(54,Pg,3,3,"div",21),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(55,"span",28),m.Zb(56,"div",29),m.Zb(57,"button",30),m.hc("click",(function(){return e.exportData()})),m.Sc(58),m.mc(59,"translate"),m.Yb(),m.Zb(60,"button",31),m.Sc(61),m.mc(62,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(26),i=m.Dc(37),a=m.Dc(52);m.Eb(2),m.Tc(m.nc(3,29,"lang.exportDatas")),m.Eb(3),m.sc("ngIf",e.loadingExport),m.Eb(2),m.Jb("col-md-12","csv"!=e.exportModel.format)("col-md-3","csv"==e.exportModel.format),m.Eb(3),m.Tc(m.nc(11,31,"lang.format")),m.Eb(2),m.tc("placeholder",m.nc(13,33,"lang.format")),m.sc("ngModel",e.exportModel.format),m.Eb(2),m.sc("ngForOf",e.formats),m.Eb(1),m.sc("ngIf","csv"==e.exportModel.format),m.Eb(2),m.sc("expanded",!0),m.Eb(3),m.Uc(" ",m.nc(21,35,"lang.datasToExport")," "),m.Eb(5),m.tc("placeholder",m.nc(27,37,"lang.searchDatas")),m.Eb(7),m.Tc(m.nc(33,39,"lang.availableDatas")),m.Eb(2),m.tc("title",m.nc(35,41,"lang.addAllData")),m.Eb(2),m.sc("cdkDropListData",e.dataAvailable)("cdkDropListConnectedTo",m.zc(58,Fg,a)),m.Eb(2),m.sc("ngForOf",m.pc(39,43,m.oc(40,47,e.dataAvailable,"label"),t.value,"label")),m.Eb(3),m.sc("ngIf",0==e.dataAvailable.length),m.Eb(6),m.Tc(m.nc(48,50,"lang.chosenDatas")),m.Eb(2),m.tc("title",m.nc(50,52,"lang.removeAllDatas")),m.Eb(2),m.sc("cdkDropListData",e.exportModel.data)("cdkDropListConnectedTo",m.zc(60,Fg,i)),m.Eb(2),m.sc("ngForOf",e.exportModel.data),m.Eb(1),m.sc("ngIf",0==e.exportModel.data.length),m.Eb(3),m.sc("disabled",0==e.exportModel.data.length),m.Eb(1),m.Tc(m.nc(59,54,"lang.toExport")),m.Eb(3),m.Tc(m.nc(62,56,"lang.cancel"))}},directives:[H.i,H.f,x.t,w.c,w.g,at.a,o.t,o.w,x.s,De.a,De.c,De.g,De.h,O.b,Ma.e,H.c,D.b,H.d,T.c,I.o,Ma.a],pipes:[p.d,Oa.a,U.a],styles:[".mat-dialog-container{position:relative}.mat-dialog-content[_ngcontent-%COMP%]{padding-bottom:10px;overflow-x:hidden} .mat-expansion-panel-body{padding-bottom:50px}.mat-expansion-panel-header[_ngcontent-%COMP%], .noData[_ngcontent-%COMP%]{opacity:.5}.noData[_ngcontent-%COMP%]{text-align:center}.removeAllDatas[_ngcontent-%COMP%]{float:right;font-size:14px;opacity:1;cursor:pointer;margin-right:10px}.listFilter[_ngcontent-%COMP%]{font-size:10px;margin-bottom:-20px}.exportList[_ngcontent-%COMP%]{display:flex}.exportList[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{float:left;height:20px;font-size:10px;font-weight:700;opacity:.5}.exportList[_ngcontent-%COMP%]   .cdk-list[_ngcontent-%COMP%]{height:100%}.cdk-list[_ngcontent-%COMP%]{max-width:100%;border:1px solid #ccc;display:block;border-radius:4px;max-height:310px;min-height:310px;overflow:auto}.cdk-list[_ngcontent-%COMP%], .columns[_ngcontent-%COMP%]{width:100%;background:#fff}.columns[_ngcontent-%COMP%]{height:50px;padding:20px 10px;border-bottom:1px solid #ccc;color:rgba(0,0,0,.87);display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.columns[_ngcontent-%COMP%]:last-child{border:none}.cdk-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.actions[_ngcontent-%COMP%], .loader[_ngcontent-%COMP%]{justify-content:center}.loader[_ngcontent-%COMP%]{position:absolute;display:flex;width:100%;left:0;top:0;height:100%;background:hsla(0,0%,100%,.6);z-index:1;align-items:center}"]}),t})();var jg=i("NpuA");let Rg=(()=>{let t=class{constructor(){this._papa=jg}parse(t,e){return this._papa.parse(t,e)}unparse(t,e){return this._papa.unparse(t,e)}setLocalChunkSize(t){this._papa.LocalChunkSize=t}setRemoteChunkSize(t){this._papa.RemoteChunkSize=t}setDefaultDelimiter(t){this._papa.DefaultDelimiter=t}get badDelimiters(){return this._papa.BAD_DELIMITERS}get recordSeparator(){return this._papa.RECORD_SEP}get unitSeparator(){return this._papa.UNIT_SEP}get workersSupported(){return this._papa.WORKERS_SUPPORTED}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(m.Pb)({factory:function(){return new t},token:t,providedIn:"root"}),t})();function Qg(t,e){1&t&&(m.Xb(0),m.Zb(1,"div",18),m.Ub(2,"mat-spinner"),m.Yb(),m.Wb())}function Ag(t,e){if(1&t&&(m.Zb(0,"mat-option",34),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ","\t"===t?"TAB":t," ")}}function Hg(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",30),m.hc("click",(function(){return m.Hc(t),m.lc(),m.Dc(1).click()}))("onFileDropped",(function(e){return m.Hc(t),m.lc(2).dndUploadFile(e)})),m.Zb(1,"div"),m.Sc(2),m.mc(3,"translate"),m.Zb(4,"mat-form-field",31),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.Zb(5,"mat-label"),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Zb(8,"mat-select",32),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc(2).currentDelimiter=e}))("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.Qc(9,Ag,2,2,"mat-option",33),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc(2);m.Eb(2),m.Uc(" ",m.nc(3,4,"lang.dndFileCsvDesc")," "),m.Eb(4),m.Tc(m.nc(7,6,"lang.delimiter")),m.Eb(2),m.sc("ngModel",t.currentDelimiter),m.Eb(1),m.sc("ngForOf",t.delimiters)}}function $g(t,e){if(1&t&&(m.Zb(0,"mat-option",34),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function zg(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-header-cell",43),m.Ub(1,"i",44),m.mc(2,"translate"),m.Sc(3,"\xa0"),m.Zb(4,"b",45),m.mc(5,"translate"),m.Sc(6),m.Yb(),m.Sc(7," \xa0"),m.Ub(8,"i",46),m.Sc(9,"\xa0 "),m.Ub(10,"i",47),m.mc(11,"translate"),m.Sc(12,"\xa0 "),m.Zb(13,"mat-form-field",48),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.mc(14,"translate"),m.Zb(15,"mat-select",49),m.hc("ngModelChange",(function(e){m.Hc(t);const i=m.lc().$implicit;return m.lc(3).associatedColmuns[i.id]=e}))("selectionChange",(function(e){m.Hc(t);const i=m.lc().$implicit;return m.lc(3).changeColumn(i,e.value)})),m.Ub(16,"mat-option",50),m.Qc(17,$g,2,2,"mat-option",33),m.Yb(),m.Yb(),m.Zb(18,"mat-checkbox",51),m.hc("change",(function(e){m.Hc(t);const i=m.lc().$implicit;return m.lc(3).toggleEmptyMode(i.id,e.checked)})),m.mc(19,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit,e=m.lc(3);m.Eb(1),m.sc("title",m.nc(2,8,"lang.dbColumn")),m.Eb(3),m.sc("title",m.nc(5,10,"lang.dbColumn")),m.Eb(2),m.Tc(t.label),m.Eb(4),m.sc("title",m.nc(11,12,"lang.csvColumn")),m.Eb(3),m.sc("title",m.nc(14,14,"lang.csvColumn")),m.Eb(2),m.sc("ngModel",e.associatedColmuns[t.id]),m.Eb(2),m.sc("ngForOf",e.csvColumns),m.Eb(1),m.sc("title",m.nc(19,16,"lang.toggleEmptyValues"))}}function Vg(t,e){1&t&&(m.Xb(0),m.Zb(1,"i",52),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Wb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,1,"lang.emptyValue")))}function Ng(t,e){if(1&t&&m.Sc(0),2&t){const t=m.lc().$implicit,e=m.lc().$implicit;m.Uc(" ",t[e.id]," ")}}function Jg(t,e){if(1&t&&(m.Zb(0,"mat-cell",43),m.Qc(1,Vg,4,3,"ng-container",12),m.Qc(2,Ng,1,1,"ng-template",null,13,m.Rc),m.Yb()),2&t){const t=e.$implicit,i=m.Dc(3),a=m.lc().$implicit,n=m.lc(3);m.Eb(1),m.sc("ngIf",a.emptyValueMode&&n.functionsService.empty(t[a.id]))("ngIfElse",i)}}function Gg(t,e){if(1&t&&(m.Xb(0),m.Xb(1,40),m.Qc(2,zg,20,18,"mat-header-cell",41),m.Qc(3,Jg,4,2,"mat-cell",42),m.Wb(),m.Wb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("matColumnDef",t.id)}}function Bg(t,e){1&t&&m.Ub(0,"mat-header-row")}function Wg(t,e){1&t&&m.Ub(0,"mat-row")}function qg(t,e){if(1&t&&(m.Zb(0,"mat-table",35,36),m.Qc(2,Gg,4,1,"ng-container",37),m.Qc(3,Bg,1,0,"mat-header-row",38),m.Qc(4,Wg,1,0,"mat-row",39),m.Yb()),2&t){const t=m.lc(2);m.Pc("width",300*t.contactColumns.length,"px"),m.sc("dataSource",t.dataSource),m.Eb(2),m.sc("ngForOf",t.contactColumns),m.Eb(1),m.sc("matHeaderRowDef",t.getcontactColumnsIds()),m.Eb(1),m.sc("matRowDefColumns",t.getcontactColumnsIds())}}function Xg(t,e){if(1&t){const t=m.ac();m.Zb(0,"input",19,20),m.hc("change",(function(e){return m.Hc(t),m.lc().uploadCsv(e)})),m.Yb(),m.Qc(2,Hg,10,8,"div",21),m.Zb(3,"div",22),m.Zb(4,"div",23),m.Ub(5,"mat-paginator",24,25),m.Yb(),m.Yb(),m.Zb(7,"div",26),m.Zb(8,"div",27),m.Qc(9,qg,5,6,"mat-table",28),m.Yb(),m.Yb(),m.Ub(10,"div",29),m.mc(11,"translate"),m.Ub(12,"div",29),m.mc(13,"translate")}if(2&t){const t=m.lc();m.Eb(2),m.sc("ngIf",0===t.csvData.length),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(4),m.sc("ngIf",t.csvData.length>0),m.Eb(1),m.sc("innerHTML",m.nc(11,7,"lang.infoImportcontacts"),m.Ic),m.Eb(2),m.sc("innerHTML",m.nc(13,9,"lang.infoImportcontacts2"),m.Ic)}}function Kg(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",53),m.hc("click",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}if(2&t){const t=m.lc();m.sc("disabled",t.loading),m.Eb(1),m.Tc(m.nc(2,2,"lang.validate"))}}let tv=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r,l){this.translate=t,this.http=e,this.notify=i,this.functionsService=a,this.localStorage=n,this.headerService=s,this.dialog=c,this.dialogRef=o,this.papa=r,this.data=l,this.loading=!1,this.contactColumns=[{id:"id",label:this.translate.instant("lang.id"),emptyValueMode:!1},{id:"company",label:this.translate.instant("lang.contactsParameters_company"),emptyValueMode:!1},{id:"civility",label:this.translate.instant("lang.contactsParameters_civility"),emptyValueMode:!1},{id:"firstname",label:this.translate.instant("lang.contactsParameters_firstname"),emptyValueMode:!1},{id:"lastname",label:this.translate.instant("lang.contactsParameters_lastname"),emptyValueMode:!1},{id:"function",label:this.translate.instant("lang.contactsParameters_function"),emptyValueMode:!1},{id:"department",label:this.translate.instant("lang.contactsParameters_department"),emptyValueMode:!1},{id:"email",label:this.translate.instant("lang.contactsParameters_email"),emptyValueMode:!1},{id:"phone",label:this.translate.instant("lang.contactsParameters_phone"),emptyValueMode:!1},{id:"addressAdditional1",label:this.translate.instant("lang.contactsParameters_addressAdditional1"),emptyValueMode:!1},{id:"addressNumber",label:this.translate.instant("lang.contactsParameters_addressNumber"),emptyValueMode:!1},{id:"addressStreet",label:this.translate.instant("lang.contactsParameters_addressStreet"),emptyValueMode:!1},{id:"addressAdditional2",label:this.translate.instant("lang.contactsParameters_addressAdditional2"),emptyValueMode:!1},{id:"addressPostcode",label:this.translate.instant("lang.contactsParameters_addressPostcode"),emptyValueMode:!1},{id:"addressTown",label:this.translate.instant("lang.contactsParameters_addressTown"),emptyValueMode:!1},{id:"addressCountry",label:this.translate.instant("lang.contactsParameters_addressCountry"),emptyValueMode:!1}],this.csvColumns=[],this.delimiters=[";",",","\t"],this.currentDelimiter=";",this.associatedColmuns={},this.dataSource=new G.o(null),this.hasHeader=!0,this.csvData=[],this.contactData=[],this.countAll=0,this.countAdd=0,this.countUp=0}ngOnInit(){this.setConfiguration(),this.initCustomFields()}getcontactColumnsIds(){return this.contactColumns.map(t=>t.id)}initCustomFields(){this.http.get("../rest/contactsCustomFields").pipe(Object(l.a)(t=>t.customFields.map(t=>({id:"contactCustomField_"+t.id,label:t.label,type:t.type}))),Object(d.a)(t=>{this.contactColumns=this.contactColumns.concat(t)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}toggleEmptyMode(t,e){this.contactColumns.filter(e=>e.id===t)[0].emptyValueMode=e}changeColumn(t,e){this.contactData=[];for(let i=this.hasHeader?1:0;i<this.csvData.length;i++){const a=this.csvData[i],n={};this.contactColumns.forEach(i=>{n[i.id]=t===i.id?a[this.csvColumns.filter(t=>t===e)[0]]:a[this.associatedColmuns[i.id]]}),this.contactData.push(n)}this.countAdd=this.csvData.filter((t,e)=>e>0&&this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>e>0&&!this.functionsService.empty(t[this.associatedColmuns.id])).length,setTimeout(()=>{this.dataSource=new G.o(this.contactData),this.dataSource.paginator=this.paginator},0)}uploadCsv(t){if(t.target.files&&t.target.files[0]&&("text/csv"===t.target.files[0].type||"application/vnd.ms-excel"===t.target.files[0].type)){this.loading=!0;let e=[];const i=new FileReader;i.readAsText(t.target.files[0]),i.onload=t=>{this.papa.parse(t.target.result,{complete:t=>{e=t.data,e=e.filter(t=>t.length===e[0].length);let i=[],a={};this.setCsvColumns(e[0]),this.countAll=this.hasHeader?e.length-1:e.length;for(let n=0;n<e.length;n++)a={},i=e[n],i.forEach((t,e)=>{a[this.csvColumns[e]]=t}),this.csvData.push(a);this.initData(),this.countAdd=this.csvData.filter((t,e)=>e>0&&this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>e>0&&!this.functionsService.empty(t[this.associatedColmuns.id])).length,this.localStorage.save("importContactFields_"+this.headerService.user.id,this.currentDelimiter),this.loading=!1}})}}else this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.notAllowedExtension")+" !",msg:this.translate.instant("lang.file")+" : <b>"+t.target.files[0].name+"</b>, "+this.translate.instant("lang.type")+" : <b>"+t.target.files[0].type+"</b><br/><br/><u>"+this.translate.instant("lang.allowedExtensions")+"</u> : <br/>text/csv"}})}setCsvColumns(t=null){this.csvColumns=t.filter(t=>this.functionsService.empty(t)).length>0?Object.keys(t).map((t,e)=>""+e):t}toggleHeader(){this.hasHeader=!this.hasHeader,this.countAll=this.hasHeader?this.csvData.length-1:this.csvData.length,this.hasHeader?(this.countAdd=this.csvData.filter((t,e)=>e>0&&this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>e>0&&!this.functionsService.empty(t[this.associatedColmuns.id])).length):(this.countAdd=this.csvData.filter((t,e)=>this.functionsService.empty(t[this.associatedColmuns.id])).length,this.countUp=this.csvData.filter((t,e)=>!this.functionsService.empty(t[this.associatedColmuns.id])).length),this.initData()}initData(){this.contactData=[];for(let t=this.hasHeader?1:0;t<this.csvData.length;t++){const e=this.csvData[t],i={};this.contactColumns.forEach((t,a)=>{const n=this.csvColumns.indexOf(t.label);this.associatedColmuns[t.id]=n>-1?this.csvColumns[n]:"",i[t.id]=n>-1?e[this.csvColumns[n]]:""}),this.contactData.push(i)}setTimeout(()=>{this.dataSource=new G.o(this.contactData),this.dataSource.paginator=this.paginator},0)}dndUploadFile(t){this.uploadCsv({target:{files:[t[0]]}})}onSubmit(){const t=[];let e="";this.translate.get("lang.confirmImportContacts",{0:this.countAll}).subscribe(t=>{e=t+" ?<br/><br/>",e+=`<ul><li><b>${this.countAdd}</b> ${this.translate.instant("lang.additions")}</li><li><b>${this.countUp}</b> ${this.translate.instant("lang.modifications")}</li></ul>`});let i=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.import"),msg:e}});i.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(d.a)(()=>{this.loading=!0,this.csvData.forEach((e,i)=>{if(this.hasHeader&&i>0||!this.hasHeader){const i={};this.contactColumns.forEach(t=>{i[t.id]=(!t.emptyValueMode||void 0!==e[this.associatedColmuns[t.id]]&&!this.functionsService.empty(e[this.associatedColmuns[t.id]]))&&(void 0===e[this.associatedColmuns[t.id]]?"":"checkbox"===t.type?this.functionsService.empty(e[this.associatedColmuns[t.id]])?[]:e[this.associatedColmuns[t.id]].split("\n"):e[this.associatedColmuns[t.id]])}),t.push(i)}})}),Object(q.a)(()=>this.http.put("../rest/contacts/import",{contacts:t})),Object(d.a)(t=>{let e="";t.errors.count>0&&(e+=`<br/>${t.errors.count} ${this.translate.instant("lang.withErrors")}  : <ul>`,t.errors.details.forEach(t=>{e+=`<li> ${this.translate.instant("lang."+t.lang,{0:t.langParam})} (${this.translate.instant("lang.line")} : ${this.hasHeader?t.index+2:t.index+1})</li>`}),e+="</ul>"),i=this.dialog.open(X.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.import"),msg:"<b>"+t.success+"</b> / <b>"+this.countAll+"</b> "+this.translate.instant("lang.importedContacts")+"."+e}})}),Object(q.a)(()=>i.afterClosed()),Object(d.a)(()=>{this.dialogRef.close("success")}),Object(b.a)(t=>(this.loading=!1,this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}setConfiguration(){null!==this.localStorage.get("importContactFields_"+this.headerService.user.id)&&(this.currentDelimiter=this.localStorage.get("importContactFields_"+this.headerService.user.id))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(C.a),m.Tb(K.a),m.Tb(h.a),m.Tb(H.b),m.Tb(H.h),m.Tb(Rg),m.Tb(H.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.ad(z.a,!0),2&t&&m.Cc(i=m.ic())&&(e.paginator=i.first)},decls:37,vars:28,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"import-tool"],[2,"flex","1"],["color","primary",3,"checked","change"],[2,"flex","1","text-align","center"],["color","primary",1,"fa","fa-users"],["color","primary"],["color","primary",1,"fa","fa-user-plus"],[2,"flex","1","text-align","right"],["color","primary",1,"fa","fa-user-edit"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","mat-button","",3,"disabled","mat-dialog-close"],[1,"loader"],["type","file","name","files[]","id","uploadFile","accept",".csv",2,"display","none",3,"change"],["uploadFile",""],["appUploadFileDragDrop","","class","dndFile",3,"click","onFileDropped",4,"ngIf"],[1,"row",2,"margin","0px"],[1,"col-md-12"],[3,"length","hidePageSize","pageSize"],["paginator",""],[2,"width","100%","box-shadow","inset 0px 0px 5px 0px rgba(0,0,0,0.75)","padding","10px"],[2,"overflow","auto"],[3,"dataSource","width",4,"ngIf"],[1,"alert-message","alert-message-info",2,"min-width","100%",3,"innerHTML"],["appUploadFileDragDrop","",1,"dndFile",3,"click","onFileDropped"],["appearance","outline",2,"font-size","14px",3,"click"],[3,"ngModel","ngModelChange","click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"dataSource"],["table",""],[4,"ngFor","ngForOf"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["style","padding-left: 5px;padding-right: 5px;",4,"matHeaderCellDef"],["style","padding-left: 5px;padding-right: 5px;",4,"matCellDef"],[2,"padding-left","5px","padding-right","5px"],["color","primary",1,"fas","fa-database",3,"title"],["color","primary",3,"title"],[1,"fas","fa-arrows-alt-h"],[1,"fas","fa-file-csv",3,"title"],[2,"width","80px !important",3,"title","click"],[3,"ngModel","ngModelChange","selectionChange"],["value",""],["color","primary",3,"title","change"],[2,"opacity","0.5"],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"div",2),m.Zb(5,"mat-toolbar",3),m.Zb(6,"span",4),m.Zb(7,"mat-slide-toggle",5),m.hc("change",(function(){return e.toggleHeader()})),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Zb(10,"span",6),m.Ub(11,"i",7),m.Sc(12),m.mc(13,"translate"),m.Zb(14,"b",8),m.Sc(15),m.Yb(),m.Yb(),m.Zb(16,"span",6),m.Ub(17,"i",9),m.Sc(18),m.mc(19,"translate"),m.Zb(20,"b",8),m.Sc(21),m.Yb(),m.Yb(),m.Zb(22,"span",10),m.Ub(23,"i",11),m.Sc(24),m.mc(25,"translate"),m.Zb(26,"b",8),m.Sc(27),m.Yb(),m.Yb(),m.Yb(),m.Qc(28,Qg,3,0,"ng-container",12),m.Qc(29,Xg,14,11,"ng-template",null,13,m.Rc),m.Yb(),m.Ub(31,"span",14),m.Zb(32,"div",15),m.Qc(33,Kg,3,4,"button",16),m.Zb(34,"button",17),m.Sc(35),m.mc(36,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(30);m.Eb(2),m.Tc(m.nc(3,16,"lang.importContacts")),m.Eb(3),m.Jb("hide",0===e.csvData.length||e.loading),m.Eb(2),m.sc("checked",e.hasHeader),m.Eb(1),m.Uc(" ",m.nc(9,18,"lang.csvHeader")," "),m.Eb(4),m.Uc("\xa0",m.nc(13,20,"lang.contactsOfFile")," : "),m.Eb(3),m.Tc(e.countAll),m.Eb(3),m.Uc("\xa0",m.nc(19,22,"lang.additions")," : "),m.Eb(3),m.Tc(e.countAdd),m.Eb(3),m.Uc("\xa0",m.nc(25,24,"lang.modifications")," : "),m.Eb(3),m.Tc(e.countUp),m.Eb(1),m.sc("ngIf",e.loading)("ngIfElse",t),m.Eb(5),m.sc("ngIf",e.csvData.length>0),m.Eb(1),m.sc("disabled",e.loading),m.Eb(1),m.Tc(m.nc(36,26,"lang.cancel"))}},directives:[H.i,H.f,tt.a,et.a,x.t,H.c,D.b,H.d,T.c,z.a,it.a,w.c,w.g,at.a,o.t,o.w,x.s,I.o,G.n,G.k,G.m,G.c,G.i,G.b,G.h,Pe.a,G.a,G.j,G.l],pipes:[p.d],styles:[".loader[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center;justify-content:center}.hide[_ngcontent-%COMP%]{display:none}.import-tool[_ngcontent-%COMP%]{font-size:14px}.dndFile[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;margin:0;justify-content:center;font-size:30px;opacity:.5!important;cursor:pointer}"]}),t})();const ev=["snav2"],iv=["adminMenuTemplate"],av=["tableContactListSort"];function nv(t,e){if(1&t&&(m.Zb(0,"a",47),m.Ub(1,"mat-icon",48),m.Zb(2,"p",42),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function sv(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",39),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",40),m.Ub(5,"mat-icon",41),m.Zb(6,"p",42),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Zb(9,"a",43),m.hc("click",(function(){return m.Hc(t),m.lc().openContactExport()})),m.Ub(10,"mat-icon",44),m.Zb(11,"p",42),m.Sc(12),m.mc(13,"translate"),m.Yb(),m.Yb(),m.Zb(14,"a",43),m.hc("click",(function(){return m.Hc(t),m.lc().openContactImportModal()})),m.Ub(15,"mat-icon",45),m.Zb(16,"p",42),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Ub(19,"mat-divider"),m.Zb(20,"mat-nav-list"),m.Qc(21,nv,4,6,"a",46),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,5,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,7,"lang.add")," "),m.Eb(5),m.Uc(" ",m.nc(13,9,"lang.exportContacts")," "),m.Eb(5),m.Uc(" ",m.nc(18,11,"lang.importContacts")," "),m.Eb(4),m.sc("ngForOf",t.subMenus)}}function cv(t,e){1&t&&m.Ub(0,"mat-spinner")}function ov(t,e){if(1&t&&(m.Zb(0,"div",49),m.Qc(1,cv,1,0,"mat-spinner",50),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngIf",t.isLoadingResults)}}function rv(t,e){if(1&t&&m.Ub(0,"mat-header-cell",51),2&t){const t=m.lc();m.Jb("hide-for-mobile",t.appService.getViewMode())}}function lv(t,e){if(1&t&&(m.Zb(0,"mat-cell",52),m.Ub(1,"i",53),m.Yb()),2&t){const t=e.$implicit,i=m.lc();m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Hb("fas fa-circle threshold_",t.filling.thresholdLevel,""),m.sc("title",i.translate.instant("lang.contactFilledTo")+" "+t.filling.rate+"%")}}function dv(t,e){1&t&&(m.Zb(0,"mat-header-cell",54),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.firstname")))}function bv(t,e){if(1&t&&(m.Zb(0,"mat-cell",55),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.firstname," ")}}function mv(t,e){1&t&&(m.Zb(0,"mat-header-cell",54),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.lastname")))}function pv(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.lastname," ")}}function uv(t,e){1&t&&(m.Zb(0,"mat-header-cell",54),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.contactsParameters_company")," "))}function hv(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.company," ")}}function fv(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",56),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc();m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Uc(" ",m.nc(2,3,"lang.address"),"")}}function gv(t,e){if(1&t&&(m.Zb(0,"mat-cell",56),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc();m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.formatedAddress," ")}}function vv(t,e){1&t&&m.Ub(0,"mat-header-cell")}function yv(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",62),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc();return e.stopPropagation(),a.toggleContact(i)})),m.Ub(1,"mat-icon",63),m.Yb()}if(2&t){const t=m.lc(2);m.sc("title",t.translate.instant("lang.suspend"))}}function Cv(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",64),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc();return e.stopPropagation(),a.toggleContact(i)})),m.Ub(1,"mat-icon",65),m.Yb()}if(2&t){const t=m.lc(2);m.sc("title",t.translate.instant("lang.authorize"))}}function Ev(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",57),m.Qc(1,yv,2,1,"button",58),m.Qc(2,Cv,2,1,"button",59),m.Zb(3,"button",60),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc();return i.stopPropagation(),n.deleteContact(a)})),m.Ub(4,"mat-icon",61),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc();m.Eb(1),m.sc("ngIf",t.enabled),m.Eb(1),m.sc("ngIf",!t.enabled),m.Eb(1),m.sc("title",i.translate.instant("lang.delete"))}}function Sv(t,e){1&t&&m.Ub(0,"mat-header-row")}function Mv(t,e){1&t&&m.Ub(0,"mat-row",66),2&t&&m.uc("routerLink","/administration/contacts/list/",e.$implicit.id,"")}const Yv=function(){return["/rest/autocomplete/contacts"]};function Zv(t,e){if(1&t){const t=m.ac();m.Zb(0,"plugin-autocomplete",14),m.hc("triggerEvent",(function(e){return m.Hc(t),m.lc().setRedirectUser(e)})),m.Yb()}if(2&t){const t=m.lc();m.sc("labelPlaceholder",t.translate.instant("lang.contactReplacement"))("labelList",t.translate.instant("lang.availableContacts"))("routeDatas",m.yc(4,Yv))("targetSearchKey","contact")}}function xv(t,e){1&t&&(m.Zb(0,"span"),m.Zb(1,"em"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,1,"lang.deleteContactInformations")))}function _v(t,e){1&t&&(m.Zb(0,"span"),m.Zb(1,"em"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,1,"lang.reaffectContactInformations")))}function wv(t,e){if(1&t&&(m.Zb(0,"div",15),m.Qc(1,xv,4,3,"span",16),m.Qc(2,_v,4,3,"span",16),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngIf","delete"==t.processMode),m.Eb(1),m.sc("ngIf","reaffect"==t.processMode)}}let Ov=(()=>{class t{constructor(t,e,i,a,n,s,c,r,l){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.dialog=s,this.functions=c,this.adminService=r,this.viewContainerRef=l,this.loading=!1,this.filtersChange=new m.o,this.displayedColumnsContact=["filling","firstname","lastname","company","formatedAddress","actions"],this.isLoadingResults=!0,this.routeUrl="../rest/contacts",this.resultsLength=0,this.searchContact=new o.h,this.search="",this.destroy$=new ub.a,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!0},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!1},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!1},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!1},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!1}]}ngOnInit(){this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.adminService.setAdminId("admin_contacts_list"),this.functions.empty(this.adminService.getFilter())&&this.adminService.saveDefaultFilter(),this.initContactList(),this.initAutocompleteContacts()}initContactList(){this.resultListDatabase=new Tv(this.http),this.paginator.pageIndex=this.adminService.getFilter("page"),this.sort.active=this.adminService.getFilter("sort"),this.sort.direction=this.adminService.getFilter("sortDirection"),this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),Object(hb.a)(this.sort.sortChange,this.paginator.page,this.filtersChange).pipe(Object(fb.a)(this.destroy$),Object(r.a)({}),Object(gb.a)(()=>(this.adminService.saveFilter({sort:this.sort.active,sortDirection:this.sort.direction,page:this.paginator.pageIndex,field:this.adminService.getFilter("field")}),this.search=this.adminService.getFilter("field"),this.isLoadingResults=!0,this.resultListDatabase.getRepoIssues(this.sort.active,this.sort.direction,this.paginator.pageIndex,this.routeUrl,this.search))),Object(l.a)(t=>(this.isLoadingResults=!1,t=this.processPostData(t),this.resultsLength=t.count,this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.contacts").toLowerCase(),"",""),t.contacts)),Object(b.a)(t=>(this.notify.handleErrors(t),this.isLoadingResults=!1,Object(c.a)([])))).subscribe(t=>this.data=t)}processPostData(t){return t.contacts.forEach(t=>{let e=[];e.push(t.addressNumber),e.push(t.addressStreet),e.push(t.addressPostcode),e.push(t.addressTown),e.push(t.addressCountry),t.formatedAddress=e.filter(t=>!this.isEmptyValue(t)).join(" ")}),this.displayedColumnsContact=this.functions.empty(t.contacts[0])||this.functions.empty(t.contacts[0].filling)?["firstname","lastname","company","formatedAddress","actions"]:["filling","firstname","lastname","company","formatedAddress","actions"],t}deleteContact(t){t.isUsed?(this.dialogRef=this.dialog.open(kv,{panelClass:"maarch-modal",autoFocus:!1}),this.dialogRef.afterClosed().subscribe(e=>{if(void 0!==e&&""!=e){var i="";"reaffect"==e.processMode&&(i="?redirect="+e.contactId),this.http.request("DELETE",`../rest/contacts/${t.id}${i}`).subscribe(()=>{this.refreshDao(),this.notify.success(this.translate.instant("lang.contactDeleted"))},t=>{this.notify.error(t.error.errors)})}this.dialogRef=null})):this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/contacts/"+t.id)),Object(d.a)(t=>{this.refreshDao(),this.notify.success(this.translate.instant("lang.contactDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(c.a)(!1)))).subscribe()}toggleContact(t){this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.suspend"),msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.put(`../rest/contacts/${t.id}/activation`,{enabled:!t.enabled})),Object(d.a)(e=>{this.refreshDao(),this.notify.success(this.translate.instant(1==!t.enabled?"lang.contactEnabled":"lang.contactDisabled"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(c.a)(!1)))).subscribe()}openContactExport(){this.dialog.open(Lg,{panelClass:"maarch-modal",width:"800px",autoFocus:!1})}openContactImportModal(){this.dialog.open(tv,{disableClose:!0,width:"99vw",maxWidth:"99vw",panelClass:"maarch-full-height-modal"}).afterClosed().pipe(Object(W.a)(t=>"success"===t),Object(d.a)(()=>{this.refreshDao()}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}refreshDao(){this.filtersChange.emit()}initAutocompleteContacts(){this.searchContact=new o.h(this.adminService.getFilter("field")),this.searchContact.valueChanges.pipe(Object(d.a)(t=>{this.adminService.setFilter("field",t),this.adminService.saveFilter(this.adminService.getFilter()),0===t.length&&(this.search="",this.paginator.pageIndex=0,this.refreshDao())}),Object(dl.a)(300),Object(W.a)(t=>t.length>2),Object(Tm.a)(),Object(d.a)(t=>{this.search=t,this.paginator.pageIndex=0,this.refreshDao()})).subscribe()}isEmptyValue(t){return null===t||(Array.isArray(t)?!(t.length>0):""===String(t))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["contact-list"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(ev,!0),m.Oc(iv,!0),m.Oc(z.a,!0),m.Oc(av,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:49,vars:19,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["class","example-loading-shade",4,"ngIf"],[1,"table-head"],[1,"table-head-result"],["floatLabel","never",2,"font-size","13px"],["type","text","matInput","","maxlength","128",3,"placeholder","formControl","click"],["autoCompleteInput",""],[1,"table-head-tool"],[1,"paginatorResultList",3,"length","hidePageSize","pageSize"],["paginatorContactList",""],[2,"height","90%","overflow","auto","position","absolute","width","100%"],["id","contact-list","matSort","","matSortDisableClear","",2,"width","100%",3,"dataSource"],["tableContactListSort","matSort"],["matColumnDef","filling"],["style","flex: initial;width: 60px;",3,"hide-for-mobile",4,"matHeaderCellDef"],["mat-cell","","style","flex: initial;width: 60px;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","firstname"],["mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","lastname"],[4,"matCellDef"],["matColumnDef","company"],["matColumnDef","formatedAddress"],["style","flex: 2;",3,"hide-for-mobile",4,"matHeaderCellDef"],["style","flex: 2;",3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor: pointer;",3,"routerLink",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/contacts/list/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"click"],["color","primary","mat-list-icon","",1,"fa","fa-file-export"],["color","primary","mat-list-icon","",1,"fas","fa-file-import"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],[1,"example-loading-shade"],[4,"ngIf"],[2,"flex","initial","width","60px"],["mat-cell","",2,"flex","initial","width","60px"],[3,"title"],["mat-sort-header",""],["mat-cell",""],[2,"flex","2"],[2,"justify-content","flex-end"],["mat-icon-button","","color","primary",3,"title","click",4,"ngIf"],["mat-icon-button","","color","accent",3,"title","click",4,"ngIf"],["mat-icon-button","","color","warn","data-toggle","modal","data-target","#changeDiffListDest",3,"title","click"],[1,"fa","fa-trash-alt","fa-2x"],["mat-icon-button","","color","primary",3,"title","click"],["aria-hidden","true",1,"fa","fa-pause","fa-2x"],["mat-icon-button","","color","accent",3,"title","click"],["aria-hidden","true",1,"fa","fa-check","fa-2x"],[2,"cursor","pointer",3,"routerLink"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,sv,22,13,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,ov,2,1,"div",9),m.Zb(14,"div",10),m.Zb(15,"div",11),m.Zb(16,"mat-form-field",12),m.Zb(17,"input",13,14),m.hc("click",(function(t){return t.stopPropagation()})),m.Yb(),m.Yb(),m.Yb(),m.Zb(19,"div",15),m.Ub(20,"mat-paginator",16,17),m.Yb(),m.Yb(),m.Zb(22,"div",18),m.Zb(23,"mat-table",19,20),m.Xb(25,21),m.Qc(26,rv,1,2,"mat-header-cell",22),m.Qc(27,lv,2,6,"mat-cell",23),m.Wb(),m.Xb(28,24),m.Qc(29,dv,3,3,"mat-header-cell",25),m.Qc(30,bv,2,1,"mat-cell",26),m.Wb(),m.Xb(31,27),m.Qc(32,mv,3,3,"mat-header-cell",25),m.Qc(33,pv,2,1,"mat-cell",28),m.Wb(),m.Xb(34,29),m.Qc(35,uv,3,3,"mat-header-cell",25),m.Qc(36,hv,2,1,"mat-cell",28),m.Wb(),m.Xb(37,30),m.Qc(38,fv,3,5,"mat-header-cell",31),m.Qc(39,gv,2,3,"mat-cell",32),m.Wb(),m.Xb(40,33),m.Qc(41,vv,1,0,"mat-header-cell",34),m.Qc(42,Ev,5,3,"mat-cell",35),m.Wb(),m.Qc(43,Sv,1,0,"mat-header-row",36),m.Qc(44,Mv,1,1,"mat-row",37),m.Yb(),m.Zb(45,"div",38),m.Sc(46),m.mc(47,"translate"),m.Yb(),m.Yb(),m.Ub(48,"div",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.isLoadingResults),m.Eb(4),m.sc("placeholder",e.translate.instant("lang.filterBy"))("formControl",e.searchContact),m.Eb(3),m.sc("length",e.resultsLength)("hidePageSize",!0)("pageSize",10),m.Eb(3),m.sc("dataSource",e.data),m.Eb(20),m.sc("matHeaderRowDef",e.displayedColumnsContact),m.Eb(1),m.sc("matRowDefColumns",e.displayedColumnsContact),m.Eb(2),m.Vc(" ",e.resultsLength," ",m.nc(47,17,"lang.contactsAlt"),""))},directives:[S.e,S.f,M.a,Z.a,x.t,w.c,O.b,o.c,o.o,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,_.a,x.s,T.c,G.h,G.a,V.b,D.b,G.j,G.l,s.d],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}.paginatorResultList[_ngcontent-%COMP%]    .mat-paginator-range-label{justify-content:flex-end;display:flex}.threshold_first[_ngcontent-%COMP%]{color:#e81c2b}.threshold_second[_ngcontent-%COMP%]{color:#f4891e}.threshold_third[_ngcontent-%COMP%]{color:#0aa34f}"]}),t})();class Tv{constructor(t){this.http=t}getRepoIssues(t,e,i,a,n){return this.http.get(`${a}?limit=10&offset=${10*i}&order=${e}&orderBy=${t}&search=${n}`)}}let kv=(()=>{class t{constructor(t,e,i,a,n){this.translate=t,this.http=e,this.data=i,this.dialogRef=a,this.notify=n,this.modalTitle=this.translate.instant("lang.confirmAction"),this.processMode="delete"}ngOnInit(){}setRedirectUser(t){this.redirectContact=t.id}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(H.a),m.Tb(H.h),m.Tb(y.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],decls:29,vars:22,consts:[[1,"mat-dialog-content-container"],["mat-dialog-title",""],["redirectConfForm","ngForm"],[1,"modal-body"],["role","alert",1,"alert-message","alert-message-danger"],[1,"input-group"],["id","processMode","name","processMode","color","primary","required","",2,"display","inline-flex","flex-direction","column",3,"ngModel","ngModelChange"],["value","delete","color","primary"],["value","reaffect","color","primary"],["singleMode","","required","",3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","triggerEvent",4,"ngIf"],["class","alert-message alert-message-info","role","alert",4,"ngIf"],[1,"divider-modal"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],["color","","mat-raised-button","",1,"actions",3,"click"],["singleMode","","required","",3,"labelPlaceholder","labelList","routeDatas","targetSearchKey","triggerEvent"],["role","alert",1,"alert-message","alert-message-info"],[4,"ngIf"]],template:function(t,e){if(1&t&&(m.Zb(0,"div",0),m.Zb(1,"h1",1),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"mat-dialog-content"),m.Zb(5,"form",null,2),m.Zb(7,"div",3),m.Zb(8,"div",4),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Zb(11,"div",5),m.Zb(12,"mat-radio-group",6),m.hc("ngModelChange",(function(t){return e.processMode=t})),m.Zb(13,"mat-radio-button",7),m.Sc(14),m.mc(15,"translate"),m.Yb(),m.Zb(16,"mat-radio-button",8),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Yb(),m.Qc(19,Zv,1,5,"plugin-autocomplete",9),m.Qc(20,wv,3,2,"div",10),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Ub(21,"span",11),m.Zb(22,"mat-dialog-actions"),m.Zb(23,"button",12),m.hc("click",(function(){return e.dialogRef.close({contactId:e.redirectContact,processMode:e.processMode})})),m.Sc(24),m.mc(25,"translate"),m.Yb(),m.Zb(26,"button",13),m.hc("click",(function(){return e.dialogRef.close("")})),m.Sc(27),m.mc(28,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.Dc(6);m.Eb(2),m.Tc(m.nc(3,10,"lang.contactsReassign")),m.Eb(7),m.Uc(" ",m.nc(10,12,"lang.contactLinkedToMails")," "),m.Eb(3),m.sc("ngModel",e.processMode),m.Eb(2),m.Uc(" ",m.nc(15,14,"lang.deleteContactwithtoutReassign")," "),m.Eb(3),m.Uc(" ",m.nc(18,16,"lang.reaffectContactRedirect")," "),m.Eb(2),m.sc("ngIf","reaffect"==e.processMode),m.Eb(1),m.sc("ngIf",e.processMode),m.Eb(3),m.sc("disabled",!t.form.valid||!e.redirectContact&&"reaffect"==e.processMode),m.Eb(1),m.Tc(m.nc(25,18,"lang.delete")),m.Eb(3),m.Tc(m.nc(28,20,"lang.cancel"))}},directives:[H.i,H.f,o.J,o.u,o.v,Qe.b,o.E,o.t,o.w,Qe.a,x.t,H.c,D.b,Dt.a],pipes:[p.d],encapsulation:2}),t})();const Iv=["snav2"],Dv=["adminMenuTemplate"];function Uv(t,e){if(1&t&&(m.Zb(0,"a",16),m.Ub(1,"mat-icon",17),m.Zb(2,"p",18),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function Pv(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,Uv,4,6,"a",15),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",t.subMenus)}}function Fv(t,e){if(1&t&&m.Ub(0,"div",19),2&t){const t=m.lc();m.sc("innerHTML",t.translate.instant("lang.noCustomFieldInfo"),m.Ic)}}function Lv(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",35),m.hc("click",(function(){m.Hc(t);const e=m.lc(2).$implicit;return m.lc().sortValues(e)})),m.Ub(1,"mat-icon",36),m.Yb()}if(2&t){const t=m.lc(3);m.sc("title",t.translate.instant("lang.orderValues"))}}function jv(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field",37),m.Zb(1,"input",38),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.label=i})),m.Yb(),m.Zb(2,"button",39),m.hc("click",(function(){m.Hc(t);const i=e.index,a=m.lc(2).$implicit;return m.lc().removeValue(a,i)})),m.Ub(3,"mat-icon",40),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(3);m.Eb(1),m.sc("ngModel",t.label)("placeholder",i.translate.instant("lang.newValue")),m.Eb(1),m.sc("title",i.translate.instant("lang.delete"))}}function Rv(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",21),m.Zb(1,"mat-expansion-panel",28),m.Zb(2,"mat-expansion-panel-header"),m.Zb(3,"mat-panel-title",29),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",30),m.Zb(7,"div",31),m.Zb(8,"button",32),m.hc("click",(function(){m.Hc(t);const e=m.lc().index;return m.lc().addValue(e)})),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Zb(11,"div"),m.Qc(12,Lv,2,1,"button",33),m.Yb(),m.Yb(),m.Zb(13,"div",21),m.Qc(14,jv,4,3,"mat-form-field",34),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc().$implicit;m.Eb(3),m.sc("matBadge",t.values.length),m.Eb(1),m.Uc(" ",m.nc(5,5,"lang.valuesList")," "),m.Eb(5),m.Uc(" ",m.nc(10,7,"lang.addValue"),""),m.Eb(3),m.sc("ngIf",t.values.length>0),m.Eb(2),m.sc("ngForOf",t.values)}}const Qv=function(){return["select","radio","checkbox"]};function Av(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-expansion-panel"),m.Zb(1,"mat-expansion-panel-header"),m.Zb(2,"mat-panel-title",20),m.Sc(3),m.Yb(),m.Zb(4,"mat-panel-description"),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Yb(),m.Zb(7,"div",21),m.Zb(8,"mat-form-field"),m.Zb(9,"input",22),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.id=i})),m.Yb(),m.Yb(),m.Zb(10,"mat-form-field"),m.Zb(11,"input",23),m.hc("ngModelChange",(function(i){return m.Hc(t),e.$implicit.label=i})),m.Yb(),m.Yb(),m.Yb(),m.Qc(12,Rv,15,9,"div",24),m.Zb(13,"div",25),m.Zb(14,"button",26),m.hc("click",(function(){m.Hc(t);const i=e.$implicit,a=e.index;return m.lc().updateCustomField(i,a)})),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Zb(17,"button",27),m.hc("click",(function(){m.Hc(t);const i=e.index;return m.lc().removeCustomField(i)})),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=e.index,a=m.lc();m.Eb(3),m.Uc(" ",t.label," "),m.Eb(2),m.Uc(" ",m.nc(6,12,"lang."+t.type+"Input")," "),m.Eb(4),m.sc("ngModel",t.id)("placeholder",a.translate.instant("lang.technicalId"))("value",t.id),m.Eb(2),m.sc("ngModel",t.label)("placeholder",a.translate.instant("lang.label"))("value",t.label),m.Eb(1),m.sc("ngIf",m.yc(18,Qv).indexOf(t.type)>-1),m.Eb(2),m.sc("disabled",a.isModified(t,i)),m.Eb(1),m.Tc(m.nc(16,14,"lang.update")),m.Eb(3),m.Tc(m.nc(19,16,"lang.delete"))}}function Hv(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-form-field",47),m.Ub(2,"textarea",48),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(2),m.sc("placeholder",e.translate.instant("lang."+t.type+"Input"))}}function $v(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-form-field",47),m.Ub(2,"input",49),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(2),m.sc("placeholder",e.translate.instant("lang."+t.type+"Input"))}}function zv(t,e){if(1&t&&(m.Zb(0,"mat-option",52),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Vc(" ",m.nc(2,3,"lang.choice")," ",t," ")}}function Vv(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-form-field",47),m.Zb(2,"mat-select",50),m.Qc(3,zv,3,5,"mat-option",51),m.Yb(),m.Yb(),m.Wb()),2&t){const t=m.lc().$implicit,e=m.lc();m.Eb(2),m.sc("placeholder",e.translate.instant("lang."+t.type+"Input")),m.Eb(1),m.sc("ngForOf",e.sampleIncrement)}}function Nv(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-form-field",47),m.Zb(2,"input",53),m.hc("click",(function(){return m.Hc(t),m.Dc(5).open()})),m.Yb(),m.Ub(3,"mat-datepicker-toggle",54),m.Ub(4,"mat-datepicker",null,55),m.Yb(),m.Wb()}if(2&t){const t=m.Dc(5),e=m.lc().$implicit,i=m.lc();m.Eb(2),m.sc("matDatepicker",t)("placeholder",i.translate.instant("lang."+e.type+"Input")),m.Eb(1),m.sc("for",t)}}function Jv(t,e){if(1&t&&(m.Zb(0,"mat-radio-button",52),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Vc(" ",m.nc(2,3,"lang.choice")," ",t," ")}}function Gv(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"mat-radio-group",56),m.Qc(2,Jv,3,5,"mat-radio-button",51),m.Yb(),m.Wb()),2&t){const t=m.lc(2);m.Eb(2),m.sc("ngForOf",t.sampleIncrement)}}function Bv(t,e){if(1&t&&(m.Zb(0,"mat-list-option",62),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Vc(" ",m.nc(2,3,"lang.choice")," ",t," ")}}function Wv(t,e){1&t&&(m.Zb(0,"mat-chip"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.selectedValue")," "))}function qv(t,e){if(1&t&&(m.Xb(0),m.Zb(1,"div",57),m.Zb(2,"mat-selection-list",58,59),m.Qc(4,Bv,3,5,"mat-list-option",60),m.Yb(),m.Yb(),m.Zb(5,"mat-chip-list",61),m.Qc(6,Wv,3,3,"mat-chip",11),m.Yb(),m.Wb()),2&t){const t=m.Dc(3),e=m.lc(2);m.Eb(4),m.sc("ngForOf",e.sampleIncrement),m.Eb(2),m.sc("ngForOf",t.selectedOptions.selected)}}function Xv(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",41),m.Zb(1,"div",42),m.Zb(2,"button",43),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().addCustomField(i)})),m.Ub(3,"mat-icon",44),m.Yb(),m.Yb(),m.Zb(4,"div",31),m.Zb(5,"div",45),m.Sc(6),m.Yb(),m.Qc(7,Hv,3,1,"ng-container",46),m.Qc(8,$v,3,1,"ng-container",46),m.Qc(9,Vv,4,2,"ng-container",46),m.Qc(10,Nv,6,3,"ng-container",46),m.Qc(11,Gv,3,1,"ng-container",46),m.Qc(12,qv,7,2,"ng-container",46),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc();m.Eb(2),m.sc("title",i.translate.instant("lang.add")),m.Eb(4),m.Uc("",t.label," :"),m.Eb(1),m.sc("ngIf","string"===t.type),m.Eb(1),m.sc("ngIf","integer"===t.type),m.Eb(1),m.sc("ngIf","select"===t.type),m.Eb(1),m.sc("ngIf","date"===t.type),m.Eb(1),m.sc("ngIf","radio"===t.type),m.Eb(1),m.sc("ngIf","checkbox"===t.type)}}let Kv=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.notify=i,this.dialog=a,this.headerService=n,this.appService=s,this.sortPipe=c,this.viewContainerRef=o,this.loading=!0,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!1},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!0},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!1},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!1},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!1}],this.customFieldsTypes=[{label:this.translate.instant("lang.stringInput"),type:"string"},{label:this.translate.instant("lang.integerInput"),type:"integer"},{label:this.translate.instant("lang.selectInput"),type:"select"},{label:this.translate.instant("lang.dateInput"),type:"date"},{label:this.translate.instant("lang.radioInput"),type:"radio"},{label:this.translate.instant("lang.checkboxInput"),type:"checkbox"}],this.customFields=[],this.customFieldsClone=[],this.incrementCreation=1,this.sampleIncrement=[1,2,3,4]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.customFields")+" "+this.translate.instant("lang.contacts")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.http.get("../rest/contactsCustomFields").pipe(Object(l.a)(t=>(t.customFields.forEach(t=>{t.values=t.values.map(t=>({label:t}))}),t)),Object(d.a)(t=>{this.customFields=t.customFields,this.customFieldsClone=JSON.parse(JSON.stringify(this.customFields))}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addCustomField(t){let e={};this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.add"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(d.a)(()=>{e={label:this.translate.instant("lang.newField")+" "+this.incrementCreation,type:t.type,values:[]}}),Object(q.a)(t=>this.http.post("../rest/contactsCustomFields",e)),Object(d.a)(t=>{e.id=t.id,this.customFields.push(e),this.notify.success(this.translate.instant("lang.customFieldAdded")),this.incrementCreation++}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}addValue(t){this.customFields[t].values.push({label:""})}removeValue(t,e){t.values.splice(e,1)}removeCustomField(t){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete")+' "'+this.customFields[t].label+'"',msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/contactsCustomFields/"+this.customFields[t].id)),Object(d.a)(()=>{this.customFields.splice(t,1),this.notify.success(this.translate.instant("lang.customFieldDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}updateCustomField(t,e){t.values=t.values.filter((t,e,i)=>i.map(t=>t.label).indexOf(t.label)===e);const i=Object.assign({},t);if(i.values=t.values.map(t=>t.label),this.customFields.filter(t=>t.label===i.label).length>1)return this.notify.handleErrors(this.translate.instant("lang.customFieldAlreadyExists")),Object(N.of)(!1);this.http.put("../rest/contactsCustomFields/"+t.id,i).pipe(Object(d.a)(()=>{this.customFieldsClone[e]=JSON.parse(JSON.stringify(t)),this.notify.success(this.translate.instant("lang.customFieldUpdated"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}sortValues(t){t.values=this.sortPipe.transform(t.values,"label")}isModified(t,e){return JSON.stringify(t)===JSON.stringify(this.customFieldsClone[e])||""===t.label}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.b),m.Tb(h.a),m.Tb(f.a),m.Tb(U.a),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Iv,!0),m.Oc(Dv,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first))},features:[m.Db([U.a])],decls:23,vars:13,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],[3,"label"],["class","alert-message alert-message-info","role","alert",3,"innerHTML",4,"ngIf"],[4,"ngFor","ngForOf"],["position","end","opened","",1,"col-md-4","col-sm-12","customFielsdPanel",3,"mode","fixedInViewport"],["snav2",""],["class","customFieldsTypesItem",4,"ngFor","ngForOf"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],["mat-line",""],["role","alert",1,"alert-message","alert-message-info",3,"innerHTML"],["color","primary"],[1,"col-md-12"],["matInput","","name","id","disabled","",3,"ngModel","placeholder","value","ngModelChange"],["matInput","","name","label",3,"ngModel","placeholder","value","ngModelChange"],["class","col-md-12",4,"ngIf"],[1,"col-md-12","text-center"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"],["opened","",1,"customFieldValues"],["matBadgeSize","small",3,"matBadge"],[1,"actionValuesCustom"],[2,"flex","1"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","default",3,"title","click",4,"ngIf"],["floatLabel","never",4,"ngFor","ngForOf"],["mat-mini-fab","","color","default",3,"title","click"],["color","primary",1,"fas","fa-sort-alpha-down",2,"height","auto"],["floatLabel","never"],["matInput","",3,"ngModel","placeholder","ngModelChange"],["color","warn","mat-icon-button","","matSuffix","",3,"title","click"],[1,"fa","fa-trash"],[1,"customFieldsTypesItem"],[1,"addCustomFieldTypeContainer"],["mat-icon-button","","color","primary",3,"title","click"],[1,"fas","fa-plus-circle","fa-2x"],[2,"color","rgba(0,0,0,0.54)"],[4,"ngIf"],["floatLabel","never",1,"input-form"],["matInput","","matTextareaAutosize","","matAutosizeMinRows","1","cdkAutosizeMaxRows","6","disabled","",3,"placeholder"],["type","number","matInput","","disabled","",3,"placeholder"],["disabled","",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matInput","","disabled","",3,"matDatepicker","placeholder","click"],["matSuffix","",3,"for"],["picker",""],["color","primary","disabled","",1,"radio-form"],[1,"input-form","checkbox-form"],["disabled","",1,"div-list"],["sampleList",""],["checkboxPosition","before",3,"value",4,"ngFor","ngForOf"],[1,"checkbox-selected-list"],["checkboxPosition","before",3,"value"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Pv,2,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Zb(13,"mat-tab-group"),m.Zb(14,"mat-tab",9),m.Qc(15,Fv,1,1,"div",10),m.Zb(16,"mat-accordion"),m.Qc(17,Av,20,19,"mat-expansion-panel",11),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(18,"mat-sidenav",12,13),m.Zb(20,"mat-tab-group"),m.Zb(21,"mat-tab",9),m.Qc(22,Xv,13,8,"div",14),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(3),m.sc("label",e.translate.instant("lang.usableFields")),m.Eb(1),m.sc("ngIf",0===e.customFields.length),m.Eb(2),m.sc("ngForOf",e.customFields),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode()),m.Eb(3),m.sc("label",e.translate.instant("lang.customFieldsTypesAvailable")),m.Eb(1),m.sc("ngForOf",e.customFieldsTypes))},directives:[S.e,S.f,M.a,Z.a,Ie.c,Ie.a,x.t,De.a,x.s,S.d,Ot.h,Ot.d,s.f,Tt.a,Ot.c,I.k,De.c,De.g,De.h,De.f,w.c,O.b,o.c,o.t,o.w,D.b,$n.a,w.j,O.d,at.a,I.o,je.f,je.h,je.d,Qe.b,Qe.a,Ot.i,An.d,Ot.f,An.a],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}.mat-divider[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.customFielsdPanel[_ngcontent-%COMP%], .customFielsdPanel[_ngcontent-%COMP%]    .mat-tab-body-wrapper{padding-left:0}.mat-expansion-panel-header-description[_ngcontent-%COMP%]{flex-direction:row-reverse}.customFieldValues[_ngcontent-%COMP%]{box-shadow:none;border:1px solid rgba(0,0,0,.12)}.mat-expansion-panel[_ngcontent-%COMP%]{margin:5px}.mat-accordion[_ngcontent-%COMP%]{padding:5px}.mat-tab-body-content[_ngcontent-%COMP%], .mat-tab-body-wrapper[_ngcontent-%COMP%], .mat-tab-group[_ngcontent-%COMP%]{height:100%}.actionsCustomFields[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.actionValuesCustom[_ngcontent-%COMP%]{display:flex}.alert-message-info[_ngcontent-%COMP%]{margin-top:30px;max-width:100%}.addCustomFieldTypeContainer[_ngcontent-%COMP%]{justify-content:center;display:flex;align-items:center;width:60px}.customFieldsTypesItem[_ngcontent-%COMP%]{display:flex;padding-top:10px;padding-bottom:10px}.mat-badge-content[_ngcontent-%COMP%]{top:2px!important}",".banner[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:30px;border-radius:20px;border:1px solid #ccc;position:relative;padding:20px;width:100%}.banner[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:20px;font-weight:700;letter-spacing:2px;position:absolute;top:-18px;left:20px;padding:0;margin:0;color:#135f7f}.banner[_ngcontent-%COMP%]   .title-divider[_ngcontent-%COMP%]{position:absolute;width:99%;z-index:-1;top:17px;background:#fff;height:1px}.banner[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:50%;padding-right:10px}.banner[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-size:16px}.fieldRow[_ngcontent-%COMP%]{display:flex;padding-top:10px;padding-bottom:10px}.fieldLabel[_ngcontent-%COMP%]{color:#4a4a4a}.fieldLabel[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]{margin-right:10px}.fieldState[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;width:40px;justify-content:center;align-items:normal!important;padding-top:15px}.fieldState[_ngcontent-%COMP%]   .fieldRequired[_ngcontent-%COMP%]{font-size:5px;color:#135f7f}.fieldState[_ngcontent-%COMP%]   .fieldError[_ngcontent-%COMP%]{font-size:15px;color:#f99830}.fieldState[_ngcontent-%COMP%]   .fieldFull[_ngcontent-%COMP%]{font-size:15px;color:green}.fieldInput[_ngcontent-%COMP%]{position:relative}.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:13px;flex:1}@media (max-width:768px){.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:1em}}.fieldInput[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%], .fieldState[_ngcontent-%COMP%]{align-items:center;display:flex}.input-form[_ngcontent-%COMP%]{font-size:13px;color:#666;width:500px}.input-form[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{color:#135f7f;padding-left:20px}.input-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.input-form[_ngcontent-%COMP%]    .mat-select-value-text{padding-left:20px;color:#135f7f}.input-form[_ngcontent-%COMP%]    .mat-form-field-label{top:15px;left:20px}.input-form[_ngcontent-%COMP%]    .mat-form-field-infix{display:flex;padding-top:0;padding-bottom:5px}.input-form[_ngcontent-%COMP%]    .mat-form-field-label-wrapper{top:-13px}.input-form[_ngcontent-%COMP%]    .mat-form-field-flex{background:#fff;height:40px;border-radius:10px;border:1px solid #135f7f}.input-form[_ngcontent-%COMP%]     .mat-form-field-underline{display:none}.input-form[_ngcontent-%COMP%]    .mat-form-field-suffix{margin-right:20px}.input-form[_ngcontent-%COMP%]    .mat-select-arrow-wrapper{padding-right:20px}.input-form[_ngcontent-%COMP%]    .mat-list-option{color:rgba(0,0,0,.54)}.input-form[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.input-form[_ngcontent-%COMP%]    .mat-datepicker-toggle-default-icon{height:auto}.input-form.search-select[_ngcontent-%COMP%]    .mat-form-field-label-wrapper{top:-15px}.input-form.input-date[_ngcontent-%COMP%]    .mat-form-field-infix{padding-top:5px}.input-form-filled[_ngcontent-%COMP%]{color:#fff;width:500px;transition:all .1s}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-form-field-flex, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-form-field-flex{background:#fff!important;border:1px solid #fff!important;color:#135f7f!important;transition:all .1s}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-form-field-label, .input-form-filled[_ngcontent-%COMP%]:hover    .mat-select-placeholder, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-form-field-label, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-select-placeholder{color:#135f7f!important}.input-form-filled[_ngcontent-%COMP%]:hover    .mat-select-arrow, .input-form-filled[aria-expanded=true][_ngcontent-%COMP%]    .mat-select-arrow{color:rgba(19,95,127,.54)}.input-form-filled[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{color:#135f7f;padding-left:20px}.input-form-filled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-value{text-align:left;font-weight:400}.input-form-filled[_ngcontent-%COMP%]    .mat-select-value-text{padding-left:20px;color:#fff}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-label{color:#fff;left:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-infix{padding-bottom:15px}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-flex{background:#135f7f;border-radius:30px;border:1px solid #fff}.input-form-filled[_ngcontent-%COMP%]     .mat-form-field-underline{display:none}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-suffix{margin-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-arrow-wrapper{padding-right:20px}.input-form-filled[_ngcontent-%COMP%]    .mat-select-arrow{color:hsla(0,0%,100%,.54)}.input-form-filled[_ngcontent-%COMP%]    .mat-select-placeholder{color:#fff}.input-form-filled[_ngcontent-%COMP%]    .mat-list-option{color:rgba(0,0,0,.54)}.input-form-filled[_ngcontent-%COMP%]    .mat-form-field-wrapper{padding:0}.input-form-filled[_ngcontent-%COMP%]   textarea.cdk-textarea-autosize-measuring[_ngcontent-%COMP%]{padding:4px 0!important}.input-form-filled[_ngcontent-%COMP%]    .mat-datepicker-toggle-default-icon{height:auto}.input-form.mat-form-field-disabled[_ngcontent-%COMP%]    .mat-input-element{cursor:not-allowed;padding-left:20px}.input-form.mat-form-field-disabled[_ngcontent-%COMP%]    .mat-form-field-flex{cursor:not-allowed;border:1px dashed #353232}.opt-group[_ngcontent-%COMP%]{font-weight:700}.smallInput[_ngcontent-%COMP%]{font-size:11px;padding-left:20px;padding-right:20px}.smallInput[_ngcontent-%COMP%]    .mat-form-field-infix{padding:0 0 5px}.button-form-primary[_ngcontent-%COMP%]{background:#fff;border:1px solid #135f7f;color:#135f7f;border-radius:30px;padding-left:20px;padding-right:20px;width:240px;height:45px;transition:all .1s}@media (max-width:768px){.button-form-primary[_ngcontent-%COMP%]{width:auto}}.button-form-primary[_ngcontent-%COMP%]:hover, .button-form-primary[aria-expanded=true][_ngcontent-%COMP%]{background:#135f7f!important;border:1px solid #fff!important;color:#fff!important;transition:all .1s}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.button-form-primary[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary-filled[_ngcontent-%COMP%]{background:#135f7f;border:1px solid #fff;color:#fff;border-radius:30px;padding-left:20px;padding-right:20px;width:240px;height:45px;transition:all .1s}@media (max-width:768px){.button-form-primary-filled[_ngcontent-%COMP%]{width:auto}}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.button-form-primary-filled[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary-alt[_ngcontent-%COMP%]{font-size:13px;background:#135f7f;border:1px solid #fff;color:#fff;border-radius:30px;padding:5px 20px;width:240px;transition:all .1s}@media (max-width:768px){.button-form-primary-alt[_ngcontent-%COMP%]{font-size:1em}}.button-form-primary-alt[_ngcontent-%COMP%]:hover, .button-form-primary-alt[aria-expanded=true][_ngcontent-%COMP%]{background:#fff!important;border:1px solid #fff!important;color:#135f7f!important;transition:all .1s}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;align-items:center;justify-content:center;width:100%}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper .menu-label{display:flex;flex:1}.button-form-primary-alt[_ngcontent-%COMP%]    .mat-button-wrapper .menu-icon{display:flex}.button-form-primary[aria-expanded=true][_ngcontent-%COMP%]{color:#135f7f;background:#fff;transition:all .1s;border:1px solid #135f7f}.button-form[_ngcontent-%COMP%]{background:#fff;color:#135f7f;border-radius:30px;padding:5px 20px;width:240px;transition:all .1s}.button-form[aria-expanded=true][_ngcontent-%COMP%]{transition:all .1s;border-bottom-left-radius:0;border-bottom-right-radius:0;border-top-left-radius:30px;border-top-right-radius:30px} .menuForm{width:240px;border-radius:30px;border:1px solid #fff;min-height:auto} .menuForm .mat-menu-content{padding-top:0;padding-bottom:0} .menuForm .mat-menu-content .mat-menu-item{transition:all .1s;font-size:13px;color:#666}@media (max-width:768px){ .menuForm .mat-menu-content .mat-menu-item{font-size:1em}} .menuForm .mat-menu-content .mat-menu-item:hover{transition:all .1s;color:#fff;background:#1a80ab} .parametersFieldsMenu{min-height:auto}.div-list[_ngcontent-%COMP%]{padding:0;max-height:150px;overflow:auto}.div-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{font-size:13px}@media (max-width:768px){.div-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{font-size:1em}}.checkbox-form[_ngcontent-%COMP%]{width:100%;padding:0;border:1px solid #135f7f;border-radius:30px;overflow:hidden}.checkbox-selected-list[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}.checkbox-selected-list[_ngcontent-%COMP%]    .mat-chip-list-wrapper{justify-content:center}.checkbox-selected-list[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{font-size:13px}@media (max-width:768px){.checkbox-selected-list[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{font-size:1em}}.radio-form[_ngcontent-%COMP%]{padding-left:20px;display:grid;grid-template-columns:repeat(2,1fr);width:100%}.radio-form[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]{flex:1}.radio-form[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]    .mat-radio-label-content{font-weight:400;color:rgba(0,0,0,.54)}.radio-form[_ngcontent-%COMP%]   .mat-radio-disabled[_ngcontent-%COMP%]{opacity:.5}.input-radio[_ngcontent-%COMP%]    .mat-form-field-infix{overflow:auto;padding-top:0}.input-radio[_ngcontent-%COMP%]    .mat-form-field-flex{height:auto}.input-radio[_ngcontent-%COMP%]    .mat-form-field-label{top:0;font-size:12px}.disabled[_ngcontent-%COMP%]{opacity:.2}.customFieldRow[_ngcontent-%COMP%]{display:flex;padding-top:20px;padding-bottom:20px}.customFieldDrag[_ngcontent-%COMP%]{cursor:move;width:50px;display:flex;align-items:center;justify-content:center}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{background:#fff;box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.indexingModelsCustomFieldsList.cdk-drop-list-dragging[_ngcontent-%COMP%]   .indexingModelsCustomFieldsList[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.advancedInput[_ngcontent-%COMP%]{flex-direction:column}.noMandatory[_ngcontent-%COMP%]{visibility:hidden}.checkboxInput[_ngcontent-%COMP%]{display:block}.categoryLabel[_ngcontent-%COMP%]{letter-spacing:1px;font-size:13px;color:#135f7f;font-weight:700}@media (max-width:768px){.categoryLabel[_ngcontent-%COMP%]{font-size:1em}}.textareaInput[_ngcontent-%COMP%]    .mat-form-field{line-height:normal}.textareaInput[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{padding:0;margin:0;color:#135f7f}.textareaInput[_ngcontent-%COMP%]    .mat-form-field-flex{padding-left:20px;height:auto!important;min-height:40px!important}.textareaInput[_ngcontent-%COMP%]    .mat-form-field-label{left:0}"]}),t})();var ty=i("Gon0");const ey=["adminMenuTemplate"];function iy(t,e){if(1&t&&(m.Zb(0,"a",11),m.Ub(1,"mat-icon",12),m.Zb(2,"p",13),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function ay(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,iy,4,6,"a",10),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",t.subMenus)}}function ny(t,e){if(1&t){const t=m.ac();m.Zb(0,"app-contact-form",14),m.hc("onSubmitEvent",(function(){return m.Hc(t),m.lc().goToList()})),m.Yb()}if(2&t){const t=m.lc();m.sc("creationMode",t.creationMode)("contactId",t.contactId)}}let sy=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.route=i,this.router=a,this.headerService=n,this.appService=s,this.dialog=c,this.viewContainerRef=o,this.loading=!1,this.creationMode=!0,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!1},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!1},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!1},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!1},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!1}],this.contactId=null}ngOnInit(){this.loading=!0,this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.route.params.subscribe(t=>{void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.contactCreation")),this.creationMode=!0,this.loading=!1):(this.headerService.setHeader(this.translate.instant("lang.contactModification")),this.creationMode=!1,this.contactId=t.id,this.loading=!1)})}goToList(){this.router.navigate(["/administration/contacts/list"])}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.Oc(ey,!0),2&t&&m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first)},decls:14,vars:7,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],[3,"creationMode","contactId","onSubmitEvent",4,"ngIf"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],["mat-line",""],[3,"creationMode","contactId","onSubmitEvent"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,ay,2,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,ny,1,2,"app-contact-form",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,x.s,Ot.d,s.f,Tt.a,Ot.c,I.k,ty.a],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}"]}),t})();const cy=["adminMenuTemplate"];function oy(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",29),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",30),m.Ub(5,"mat-icon",31),m.Zb(6,"p",32),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function ry(t,e){1&t&&(m.Zb(0,"mat-header-cell",33),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.label")))}function ly(t,e){if(1&t&&(m.Zb(0,"mat-cell",34),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label," ")}}function dy(t,e){1&t&&(m.Zb(0,"mat-header-cell",33),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.description")))}function by(t,e){if(1&t&&(m.Zb(0,"mat-cell",34),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.description," ")}}function my(t,e){1&t&&m.Ub(0,"mat-header-cell")}function py(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",35),m.Zb(1,"button",36),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc();return i.stopPropagation(),n.deleteTag(a)})),m.Ub(2,"mat-icon",37),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(1),m.sc("title",t.translate.instant("lang.delete"))}}function uy(t,e){1&t&&m.Ub(0,"mat-header-row")}function hy(t,e){1&t&&m.Ub(0,"mat-row",38),2&t&&m.uc("routerLink","/administration/tags/",e.$implicit.id,"")}let fy=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.dialog=s,this.functions=c,this.adminService=o,this.viewContainerRef=r,this.loading=!0,this.resultsLength=0,this.displayedColumns=["label","description","actions"],this.filterColumns=["label","description"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.tags")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loadList()}loadList(){this.loading=!0,this.http.get("../rest/tags").pipe(Object(d.a)(t=>{this.resultsLength=t.tags.length,setTimeout(()=>{this.adminService.setDataSource("admin_tag",t.tags,this.sort,this.paginator,this.filterColumns)},0)}),Object(vt.a)(()=>this.loading=!1)).subscribe()}deleteTag(t){this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:`${this.translate.instant("lang.delete")} "${t.label}"`,msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/tags/"+t.id)),Object(d.a)(()=>{this.loadList(),this.notify.success(this.translate.instant("lang.tagDeleted"))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(cy,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:38,vars:20,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],[1,"table-head"],[1,"table-head-result"],[2,"font-size","13px"],["matInput","",3,"formControl","placeholder"],[1,"table-head-tool"],[3,"length","hidePageSize","pageSize"],["paginator",""],[2,"height","90%","overflow","auto","position","absolute","width","100%"],["id","contact-list","matSort","","matSortDisableClear","",2,"width","100%",3,"dataSource"],["tableContactListSort","matSort"],["matColumnDef","label"],["mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor: pointer;",3,"routerLink",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","display","flex","justify-content","end","align-items","center","padding-left","20px"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/tags/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-sort-header",""],["mat-cell",""],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"title","click"],[1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,oy,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Zb(13,"div",9),m.Zb(14,"div",10),m.Zb(15,"mat-form-field",11),m.Ub(16,"input",12),m.mc(17,"translate"),m.Yb(),m.Yb(),m.Zb(18,"div",13),m.Ub(19,"mat-paginator",14,15),m.Yb(),m.Yb(),m.Zb(21,"div",16),m.Zb(22,"mat-table",17,18),m.Xb(24,19),m.Qc(25,ry,3,3,"mat-header-cell",20),m.Qc(26,ly,2,1,"mat-cell",21),m.Wb(),m.Xb(27,22),m.Qc(28,dy,3,3,"mat-header-cell",20),m.Qc(29,by,2,1,"mat-cell",21),m.Wb(),m.Xb(30,23),m.Qc(31,my,1,0,"mat-header-cell",24),m.Qc(32,py,3,1,"mat-cell",25),m.Wb(),m.Qc(33,uy,1,0,"mat-header-row",26),m.Qc(34,hy,1,1,"mat-row",27),m.Yb(),m.Zb(35,"div",28),m.Sc(36),m.mc(37,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(5),m.tc("placeholder",m.nc(17,16,"lang.filterBy")),m.sc("formControl",e.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(3),m.sc("dataSource",e.adminService.getDataSource()),m.Eb(11),m.sc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",e.displayedColumns),m.Eb(2),m.Vc(" ",e.resultsLength," ",m.nc(37,18,"lang.tags"),""))},directives:[S.e,S.f,M.a,Z.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,G.h,V.b,G.a,D.b,G.j,G.l,s.d],pipes:[p.d],encapsulation:2}),t})();const gy=["linkedTagInput"];function vy(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",31),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).remove(i)}))("removed",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).remove(i)})),m.Sc(1),m.Ub(2,"mat-icon",32),m.Yb()}if(2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.Uc(" ",i.getTagLabel(t)," ")}}function yy(t,e){if(1&t&&(m.Zb(0,"mat-option",33),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.sc("value",t)("disabled",i.isSelected(t)||t.id==i.id),m.Eb(1),m.Uc(" ",t.label," ")}}function Cy(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-form-field"),m.Zb(1,"mat-chip-list",null,24),m.Qc(3,vy,3,1,"mat-chip",25),m.Ub(4,"input",26,27),m.Yb(),m.Zb(6,"mat-autocomplete",28,29),m.hc("optionSelected",(function(e){return m.Hc(t),m.lc().selected(e)})),m.Qc(8,yy,2,3,"mat-option",30),m.mc(9,"async"),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.Dc(7),i=m.lc();m.Eb(3),m.sc("ngForOf",i.tag.links.value),m.Eb(1),m.sc("placeholder",i.translate.instant("lang.linkedTags"))("formControl",i.myControl)("matAutocomplete",e)("matChipInputFor",t),m.Eb(4),m.sc("ngForOf",m.nc(9,6,i.filteredOptions))}}function Ey(t,e){1&t&&(m.Zb(0,"div",34),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.cannotMergeTags")," "))}function Sy(t,e){if(1&t){const t=m.ac();m.Zb(0,"plugin-select-search",35),m.hc("afterOpened",(function(){return m.Hc(t),m.lc().getTags()}))("afterSelected",(function(e){return m.Hc(t),m.lc().mergeTag(e)})),m.Yb()}if(2&t){const t=m.lc();m.sc("label",t.translate.instant("lang.mergeTagWith"))("placeholderLabel",t.translate.instant("lang.mergeTagWith"))("formControlSelect",t.selectMergeTag)("datas",t.tags)}}let My=(()=>{class t{constructor(t,e,i,a,n,s,c,r,l){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.functions=r,this.dialog=l,this.loading=!1,this.loadingTags=!0,this.advancedMode=!1,this.tags=[],this.tag={label:new o.h({value:"",disabled:!1},[o.H.required]),description:new o.h({value:"",disabled:!1}),parentId:new o.h({value:"",disabled:!1}),links:new o.h({value:[],disabled:!1}),usage:new o.h({value:"",disabled:!1}),canMerge:new o.h({value:!0,disabled:!1}),countResources:new o.h({value:0,disabled:!1})},this.myControl=new o.h,this.selectMergeTag=new o.h({value:"",disabled:!1}),this.tagFormGroup=new o.k(this.tag),this.currTagChildren=[]}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){this.id=t.id,yield this.getTags(),void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.tagCreation")),this.creationMode=!0,this.loading=!1):(this.creationMode=!1,this.http.get("../rest/tags/"+this.id).pipe(Object(d.a)(t=>{Object.keys(this.tag).forEach(e=>{this.functions.empty(t[e])||this.tag[e].setValue(t[e])}),this.functions.empty(this.tag.parentId.value)||this.toggleAdvancedTag(),this.headerService.setHeader(this.translate.instant("lang.tagModification"),this.tag.label.value)}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleErrors(t),Object(c.a)(!1)))).subscribe())})))}onSubmit(){this.creationMode?this.createTag():this.updateTag()}formatTag(){const t={};return Object.keys(this.tag).forEach(e=>{t[e]=this.tag[e].value}),t}createTag(){this.http.post("../rest/tags",this.formatTag()).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.tagAdded")),this.router.navigate(["/administration/tags"])}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}updateTag(){this.http.put("../rest/tags/"+this.id,this.formatTag()).pipe(Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.tagUpdated")),this.router.navigate(["/administration/tags"])}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}getTags(){return new Promise(t=>{this.http.get("../rest/tags").pipe(Object(d.a)(e=>{this.tags=e.tags.map(t=>({id:t.id,label:t.label,parentId:t.parentId,countResources:t.countResources,disabled:t.id==this.id})),t(!0)}),Object(vt.a)(()=>this.loadingTags=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()})}mergeTag(t){this.selectMergeTag.reset();const e=this.tags.filter(e=>e.id===t)[0],i=`${this.translate.instant("lang.confirmAction")}<br/><br/>${this.translate.instant("lang.theTag")}<b> "${this.tag.label.value}" </b>${this.translate.instant("lang.willBeDeletedAndMerged")}<b> "${e.label}"</b><br/><br/>${this.translate.instant("lang.willBeTransferredToNewTag")}<b> "${e.label}"</b> : <b>${this.tag.countResources.value}</b>`;this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:`${this.translate.instant("lang.mergeWith")}  "${e.label}"`,msg:i}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.put("../rest/mergeTags",{idMaster:e.id,idMerge:this.id})),Object(d.a)(()=>{this.notify.success(this.translate.instant("lang.tagMerged")),this.router.navigate(["/administration/tags/"+e.id])}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(c.a)(!1)))).subscribe()}toggleAdvancedTag(){return Object(gt.a)(this,void 0,void 0,(function*(){this.advancedMode=!this.advancedMode,this.getTagsTree(),this.filteredOptions=this.myControl.valueChanges.pipe(Object(r.a)(null),Object(l.a)(t=>t?this._filter(t):this.tags.slice()))}))}_filter(t){let e=t;return"string"==typeof t&&(e=t.toLowerCase()),this.tags.filter(t=>t.label.toLowerCase().indexOf(e)>-1)}isSelected(t){return this.tag.links.value.filter(e=>e==t.id).length>0}remove(t){const e=this.tag.links.value.indexOf(t);e>=0&&this.tag.links.value.splice(e,1)}selected(t){const e=this.tag.links.value;e.push(t.option.value.id),this.tag.links.setValue(e),this.linkedTagInput.nativeElement.value="",this.myControl.setValue(null)}getTagsTree(){this.functions.empty(this.id)||this.getChildrens(this.id);const t=this.tags.map(t=>({id:t.id,text:t.label,parent:this.functions.empty(t.parentId)?"#":t.parentId,state:{opened:this.tag.parentId.value==t.id,selected:this.tag.parentId.value==t.id,disabled:this.currTagChildren.indexOf(t.id.toString())>-1}}));setTimeout(()=>{$("#jstree").on("select_node.jstree",(t,e)=>{this.tag.parentId.setValue(parseInt(e.node.id))}).on("deselect_node.jstree",(t,e)=>{this.tag.parentId.setValue(null)}).jstree({checkbox:{deselect_all:!0,three_state:!1},core:{force_text:!0,themes:{name:"proton",responsive:!0},multiple:!1,data:t},plugins:["checkbox","search","sort"]});let e=!1;$("#jstree_search").keyup((function(){e&&clearTimeout(e),e=setTimeout((function(){const t=$("#jstree_search").val();$("#jstree").jstree(!0).search(t)}),250)}))},0)}getChildrens(t){this.currTagChildren.push(t.toString()),this.tags.filter(e=>e.parentId==t).forEach(t=>{this.getChildrens(t.id)})}getTagLabel(t){return this.tags.filter(e=>e.id==t)[0].label}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(H.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&m.ad(gy,!0),2&t&&m.Cc(i=m.ic())&&(e.linkedTagInput=i.first)},decls:39,vars:29,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],[2,"height","90%","overflow","auto","position","absolute","width","100%"],[2,"padding","20px",3,"ngSubmit"],["matInput","","type","text","maxlength","128","required","",3,"formControl","placeholder"],["matInput","","type","text",3,"formControl","placeholder"],[4,"ngIf"],["class","alert-message alert-message-danger","style","min-width: 100%;",4,"ngIf"],["style","width:100%;",3,"label","placeholderLabel","formControlSelect","datas","afterOpened","afterSelected",4,"ngIf"],[1,"text-center"],["mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-raised-button","","color","default",3,"click"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","width","450px",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[2,"padding","10px"],["matInput","","id","jstree_search","name","jstree_search","type","text",3,"placeholder"],["id","jstree"],["chipList",""],["style","cursor: pointer;",3,"click","removed",4,"ngFor","ngForOf"],[3,"placeholder","formControl","matAutocomplete","matChipInputFor"],["linkedTagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],[2,"cursor","pointer",3,"click","removed"],["matChipRemove","",1,"fa","fa-times-circle"],[3,"value","disabled"],[1,"alert-message","alert-message-danger",2,"min-width","100%"],[2,"width","100%",3,"label","placeholderLabel","formControlSelect","datas","afterOpened","afterSelected"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Zb(11,"div",8),m.Zb(12,"form",9),m.hc("ngSubmit",(function(){return e.onSubmit()})),m.Zb(13,"mat-form-field"),m.Ub(14,"input",10),m.Yb(),m.Zb(15,"mat-form-field"),m.Ub(16,"textarea",11),m.Yb(),m.Zb(17,"mat-form-field"),m.Ub(18,"input",11),m.Yb(),m.Qc(19,Cy,10,8,"mat-form-field",12),m.Qc(20,Ey,3,3,"div",13),m.Qc(21,Sy,1,4,"plugin-select-search",14),m.Zb(22,"div",15),m.Zb(23,"button",16),m.Sc(24),m.mc(25,"translate"),m.Yb(),m.Zb(26,"button",17),m.hc("click",(function(){return e.toggleAdvancedTag()})),m.Sc(27),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(28,"mat-sidenav",18,19),m.Zb(30,"mat-list"),m.Zb(31,"h3",20),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Zb(34,"div",21),m.Zb(35,"mat-form-field"),m.Ub(36,"input",22),m.mc(37,"translate"),m.Yb(),m.Ub(38,"div",23),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(5),m.sc("formControl",e.tag.label)("placeholder",e.translate.instant("lang.label")),m.Eb(2),m.sc("formControl",e.tag.description)("placeholder",e.translate.instant("lang.description")),m.Eb(2),m.sc("formControl",e.tag.usage)("placeholder",e.translate.instant("lang.usage")),m.Eb(1),m.sc("ngIf",e.advancedMode),m.Eb(1),m.sc("ngIf",!e.creationMode&&!e.tag.canMerge.value),m.Eb(1),m.sc("ngIf",!e.loadingTags&&e.tag.canMerge.value),m.Eb(2),m.sc("disabled",!e.tagFormGroup.valid),m.Eb(1),m.Tc(m.nc(25,23,"lang.validate")),m.Eb(3),m.Uc(" ",e.translate.instant(e.advancedMode?"lang.defaultMode":"lang.advancedMode")," "),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",e.advancedMode),m.Eb(4),m.Uc("",m.nc(33,25,"lang.selectParentTag")," :"),m.Eb(4),m.tc("placeholder",m.nc(37,27,"lang.searchTag")))},directives:[S.e,S.f,M.a,Z.a,o.J,o.u,o.v,w.c,O.b,o.c,o.o,o.E,o.t,o.i,x.t,D.b,S.d,Ot.a,Ot.g,An.d,x.s,Hn.d,An.c,Hn.a,An.a,Tt.a,An.e,I.o,Nr.a],pipes:[p.d,x.b],encapsulation:2}),t})();var Yy=i("q3Kh");const Zy=["snav2"],xy=["maarchTree"];function _y(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}const wy=function(t){return[t]};function Oy(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",17),m.Zb(1,"form",18,19),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(3,"mat-form-field"),m.Zb(4,"input",20),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().alfresco.label=e})),m.mc(5,"translate"),m.mc(6,"translate"),m.Yb(),m.Yb(),m.Zb(7,"div",21),m.Zb(8,"div",22),m.Zb(9,"div",23),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Zb(12,"div",24),m.Zb(13,"mat-form-field"),m.Zb(14,"input",25),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().alfresco.account.id=e})),m.mc(15,"translate"),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Zb(17,"mat-form-field"),m.Zb(18,"input",26),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().alfresco.account.password=e})),m.Yb(),m.Zb(19,"mat-icon",27),m.hc("click",(function(){m.Hc(t);const e=m.lc();return e.hidePassword=!e.hidePassword})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(20,"div",28),m.Zb(21,"div",23),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Zb(24,"mat-form-field"),m.Zb(25,"input",29),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().alfresco.rootFolder=e})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(26,"div",30),m.Zb(27,"button",31),m.hc("click",(function(){return m.Hc(t),m.lc().checkAccount()})),m.Sc(28),m.mc(29,"translate"),m.Yb(),m.Zb(30,"button",32),m.Sc(31),m.mc(32,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(2),e=m.lc();m.Eb(4),m.tc("title",m.nc(5,20,"lang.label")),m.tc("placeholder",m.nc(6,22,"lang.label")),m.sc("ngModel",e.alfresco.label),m.Eb(6),m.Uc(" ",m.nc(11,24,"lang.alfrescoAccount")," "),m.Eb(4),m.tc("title",m.nc(15,26,"lang.id")),m.tc("placeholder",m.nc(16,28,"lang.id")),m.sc("ngModel",e.alfresco.account.id),m.Eb(4),m.sc("ngModel",e.alfresco.account.password)("required",e.creationMode)("title",e.translate.instant(e.creationMode?"lang.password":"lang.changePassword"))("type",e.hidePassword?"password":"text")("placeholder",e.translate.instant(e.creationMode?"lang.password":"lang.changePassword")),m.Eb(1),m.sc("ngClass",m.zc(36,wy,e.hidePassword?"fa-eye-slash":"fa-eye")),m.Eb(3),m.Uc(" ",m.nc(23,30,"lang.rootFolder")," "),m.Eb(3),m.sc("ngModel",e.alfresco.rootFolder)("title",e.translate.instant("lang.id")),m.Eb(2),m.sc("disabled",e.functionsService.empty(e.alfresco.account.id)||e.functionsService.empty(e.alfresco.account.password)&&e.creationMode),m.Eb(1),m.Tc(m.nc(29,32,"lang.test")),m.Eb(2),m.sc("disabled",!t.valid||!e.validAccount()),m.Eb(1),m.Tc(m.nc(32,34,"lang.validate"))}}let Ty=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this.functionsService=o,this.loading=!1,this.creationMode=!0,this.entities=[],this.availableEntities=[],this.alfresco={id:0,label:"",account:{id:"",password:""},rootFolder:null,linkedEntities:[]},this.hidePassword=!0,this.alfrescoTreeLoaded=!1}ngOnInit(){this.loading=!1,this.route.params.subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){void 0===t.id?(this.headerService.setHeader(this.translate.instant("lang.alfrescoCreation")),this.creationMode=!0):(this.headerService.setHeader(this.translate.instant("lang.alfrescoModification")),this.alfresco.id=t.id,this.creationMode=!1),yield this.getEntities(),yield this.getAvailableEntities(),yield this.initAccount(),this.loading=!1})))}onSubmit(){this.creationMode?this.createAccount():this.updateAccount()}createAccount(){this.http.post("../rest/alfresco/accounts",this.formatData()).pipe(Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.accountAdded")),this.router.navigate(["/administration/alfresco"])}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}updateAccount(){this.http.put("../rest/alfresco/accounts/"+this.alfresco.id,this.formatData()).pipe(Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.accountUpdated")),this.router.navigate(["/administration/alfresco"])}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}formatData(){const t={label:this.alfresco.label,login:this.alfresco.account.id,nodeId:this.alfresco.rootFolder,entities:this.maarchTree.getSelectedNodes().map(t=>t.id)};return this.functionsService.empty(this.alfresco.account.password)||(t.password=this.alfresco.account.password),t}getAvailableEntities(){return new Promise((t,e)=>{this.http.get("../rest/alfresco/availableEntities").pipe(Object(Zt.tap)(e=>{this.availableEntities=e.availableEntities,t(!0)}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}getEntities(){return new Promise((t,e)=>{this.http.get("../rest/entities").pipe(Object(Yy.map)(t=>(t.entities=t.entities.map(t=>({text:t.entity_label,icon:t.icon,parent_id:t.parentSerialId,id:t.serialId,state:{opened:!0}})),t.entities)),Object(Zt.tap)(e=>{this.entities=e,t(!0)}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}initAccount(){return new Promise((t,e)=>{this.creationMode?this.http.get("../rest/entities").pipe(Object(Yy.map)(t=>(t.entities=t.entities.map(t=>({text:t.entity_label,icon:t.icon,parent_id:t.parentSerialId,id:t.serialId,state:{opened:!0}})),t.entities)),Object(Zt.tap)(e=>{this.entities=e,this.entities.forEach(t=>{t.state.disabled=!(this.availableEntities.indexOf(+t.id)>-1)}),setTimeout(()=>{this.initEntitiesTree(this.entities)},0),t(!0)}),Object(J.catchError)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe():this.http.get("../rest/alfresco/accounts/"+this.alfresco.id).pipe(Object(Zt.tap)(e=>{this.alfresco={id:e.id,label:e.label,account:{id:e.login},rootFolder:e.nodeId,linkedEntities:e.entities},this.entities.forEach(t=>{t.state.disabled=!(this.availableEntities.indexOf(+t.id)>-1),this.alfresco.linkedEntities.indexOf(+t.id)>-1&&(t.state.disabled=!1,t.state.selected=!0)}),setTimeout(()=>{this.initEntitiesTree(this.entities)},0),t(!0)}),Object(J.catchError)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()})}initEntitiesTree(t){this.maarchTree.initData(t)}validAccount(){return!this.functionsService.empty(this.alfresco.rootFolder)&&0!==this.maarchTree.getSelectedNodes().length}checkAccount(){let t={};t=this.creationMode?{login:this.alfresco.account.id,password:this.alfresco.account.password,nodeId:this.alfresco.rootFolder}:{accountId:this.alfresco.id,login:this.alfresco.account.id,password:this.alfresco.account.password,nodeId:this.alfresco.rootFolder},this.http.post("../rest/alfresco/checkAccounts",t).pipe(Object(Zt.tap)(()=>{this.notify.success(this.translate.instant("lang.testSucceeded"))}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-alfresco"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Zy,!0),m.Oc(xy,!0)),2&t&&(m.Cc(i=m.ic())&&(e.sidenavRight=i.first),m.Cc(i=m.ic())&&(e.maarchTree=i.first))},decls:22,vars:14,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","width","400px",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[2,"padding","10px"],["maarchTree",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[3,"ngSubmit"],["alfrescoForm","ngForm"],["matInput","","required","","name","label","id","label","type","text","maxlength","64",3,"ngModel","title","placeholder","ngModelChange"],[1,"form-group",2,"flex-direction","row","flex-wrap","wrap"],[1,"formType","ratio-2","col-sm-12"],[1,"formType-title"],[2,"width","100%","text-align","center"],["matInput","","required","","name","accountId","id","accountId","type","text",3,"ngModel","title","placeholder","ngModelChange"],["matInput","","name","password","id","password",3,"ngModel","required","title","type","placeholder","ngModelChange"],["color","primary","matSuffix","",1,"fa","fa-2x",2,"cursor","pointer",3,"ngClass","click"],[1,"formType","ratio-1","col-sm-12"],["matInput","","required","","name","rootFolder","id","rootFolder","type","text","placeholder","D\xe9p\xf4t racine",3,"ngModel","title","ngModelChange"],[1,"col-sm-12","text-center",2,"padding","10px"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"],["mat-raised-button","","type","submit","color","primary",3,"disabled"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,_y,2,0,"div",8),m.Qc(12,Oy,33,38,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Zb(15,"mat-list"),m.Zb(16,"h3",12),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Zb(19,"div",13),m.Ub(20,"app-maarch-flat-tree",null,14),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()),m.Eb(4),m.Tc(m.nc(18,12,"lang.chooseEntityAssociationAccount")))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Ot.g,Ue.a,T.c,k.a,o.J,o.u,o.v,w.c,O.b,o.c,o.E,o.o,o.t,o.w,Tt.a,w.j,x.q,D.b],pipes:[p.d],styles:[".form-group[_ngcontent-%COMP%], .formType[_ngcontent-%COMP%]{display:flex}.formType[_ngcontent-%COMP%]{align-items:center;margin:10px;border-radius:4px;border:1px solid #ccc;position:relative;padding:10px}.formType-title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:10px;font-weight:700;background:#fff;position:absolute;top:-7px;left:10px;padding:0;margin:0;color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-slide-toggle-label{color:#666;font-weight:700}.formType[_ngcontent-%COMP%]    .mat-radio-button, .formType[_ngcontent-%COMP%]    .mat-slide-toggle{opacity:.5;color:#666;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.formType[_ngcontent-%COMP%]    .mat-checked, .formType[_ngcontent-%COMP%]    .mat-radio-checked{opacity:1;color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-checked .mat-slide-toggle-label{color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-form-field-suffix{color:#f99830;font-size:15px;top:0}.ratio-1[_ngcontent-%COMP%]{flex:1}.ratio-2[_ngcontent-%COMP%]{flex:1;align-items:baseline}"]}),t})();var ky=i("4ik+"),Iy=i("/JYr");const Dy=["adminMenuTemplate"];function Uy(t,e){1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,2,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,4,"lang.add")," "))}function Py(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function Fy(t,e){if(1&t&&(m.Zb(0,"mat-header-cell",40),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc(2);m.Jb("hide-for-mobile",t.appService.getViewMode()),m.Eb(1),m.Tc(m.nc(2,3,"lang.label"))}}function Ly(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Jb("hide-for-mobile",i.appService.getViewMode()),m.Eb(1),m.Uc(" ",t.label," ")}}function jy(t,e){1&t&&(m.Zb(0,"mat-header-cell",41),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.linkedEntities")))}function Ry(t,e){if(1&t&&(m.Zb(0,"span",44),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Tc(t)}}function Qy(t,e){if(1&t&&(m.Zb(0,"mat-cell",42),m.Zb(1,"div"),m.Qc(2,Ry,2,1,"span",43),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(2),m.sc("ngForOf",t.entitiesLabel)}}function Ay(t,e){1&t&&m.Ub(0,"mat-header-cell",45)}function Hy(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",46),m.Zb(1,"button",47),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.deleteAccount(a.id)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",48),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function $y(t,e){1&t&&m.Ub(0,"mat-header-row")}function zy(t,e){1&t&&(m.Ub(0,"mat-row",49),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/alfresco/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function Vy(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",17),m.Zb(1,"div",18),m.Zb(2,"div",19),m.Zb(3,"mat-form-field",20),m.Zb(4,"mat-label"),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Zb(7,"input",21),m.hc("ngModelChange",(function(e){return m.Hc(t),m.lc().alfrescoUrl=e}))("blur",(function(){return m.Hc(t),m.lc().saveUrl()})),m.Yb(),m.Yb(),m.Yb(),m.Zb(8,"div",22),m.Zb(9,"mat-form-field"),m.Ub(10,"input",23),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Zb(12,"div",22),m.Ub(13,"mat-paginator",24,25),m.Yb(),m.Yb(),m.Zb(15,"mat-table",26,27),m.Xb(17,28),m.Qc(18,Fy,3,5,"mat-header-cell",29),m.Qc(19,Ly,2,3,"mat-cell",30),m.Wb(),m.Xb(20,31),m.Qc(21,jy,3,3,"mat-header-cell",32),m.Qc(22,Qy,3,1,"mat-cell",33),m.Wb(),m.Xb(23,34),m.Qc(24,Ay,1,0,"mat-header-cell",35),m.Qc(25,Hy,4,3,"mat-cell",36),m.Wb(),m.Qc(26,$y,1,0,"mat-header-row",37),m.Qc(27,zy,2,4,"mat-row",38),m.Yb(),m.Zb(28,"div",39),m.Sc(29),m.mc(30,"translate"),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(5),m.Tc(m.nc(6,13,"lang.alfrescoAPI")),m.Eb(2),m.sc("ngModel",t.alfrescoUrl)("title",t.alfrescoUrl),m.Eb(3),m.tc("placeholder",m.nc(11,15,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(11),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.accounts.length," ",m.nc(30,17,"lang.accounts"),"")}}let Ny=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.dialog=s,this.functions=c,this.adminService=o,this.viewContainerRef=r,this.alfrescoUrl="",this.accounts=[],this.loading=!1,this.displayedColumns=["label","entitiesLabel","actions"],this.filterColumns=["label","entitiesLabel"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.alfresco")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!0,this.http.get("../rest/alfresco/configuration").pipe(Object(ky.filter)(t=>!this.functions.empty(t.configuration)),Object(Zt.tap)(t=>{this.alfrescoUrl=t.configuration.uri})).subscribe(),this.http.get("../rest/alfresco/accounts").subscribe(t=>{this.accounts=t.accounts,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_alfresco",this.accounts,this.sort,this.paginator,this.filterColumns)},0)})}deleteAccount(t){this.dialogRef=this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}),this.dialogRef.afterClosed().pipe(Object(ky.filter)(t=>"ok"===t),Object(Iy.exhaustMap)(()=>this.http.delete("../rest/alfresco/accounts/"+t)),Object(Zt.tap)(()=>{this.accounts=this.accounts.filter(e=>e.id!==t),setTimeout(()=>{this.adminService.setDataSource("admin_alfresco",this.accounts,this.sort,this.paginator,this.filterColumns)},0),this.notify.success(this.translate.instant("lang.accountDeleted"))}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}saveUrl(){this.http.put("../rest/alfresco/configuration",{uri:this.alfrescoUrl}).pipe(Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(C.a),m.Tb(wt),m.Tb(m.R))},t.\u0275cmp=m.Nb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(Dy,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/alfresco/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-12"],["appearance","outline"],["matInput","","required","","name","accountId","id","accountId","type","text","placeholder","https://alfresco/api/",3,"ngModel","title","ngModelChange","blur"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSortDisableClear","","matSort","",3,"dataSource"],["table",""],["matColumnDef","label"],["mat-sort-header","",3,"hide-for-mobile",4,"matHeaderCellDef"],[3,"hide-for-mobile",4,"matCellDef"],["matColumnDef","entitiesLabel"],["mat-sort-header","","style","flex: 2",4,"matHeaderCellDef"],["style","flex: 2",4,"matCellDef"],["matColumnDef","actions"],["style","flex:none",4,"matHeaderCellDef"],["style","flex:none;justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],["class","label",4,"ngFor","ngForOf"],[1,"label"],[2,"flex","none"],[2,"flex","none","justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,Uy,9,6,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,Py,2,0,"div",9),m.Qc(14,Vy,31,19,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,T.c,k.a,w.c,w.g,O.b,o.c,o.E,o.t,o.w,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,x.s,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],styles:[".label[_ngcontent-%COMP%]{white-space:break-spaces;background:#135f7f;margin:5px}"]}),t})();var Jy=i("OigG");const Gy=["appContactDetail"];function By(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",13),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit,i=m.lc();return i.toggleExcludeContact(e),i.mergeContact()})),m.Sc(1),m.mc(2,"translate"),m.Yb()}2&t&&(m.Eb(1),m.Tc(m.nc(2,1,"lang.exludeContact")))}function Wy(t,e){1&t&&m.Ub(0,"i",14)}function qy(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",15),m.hc("click",(function(){m.Hc(t);const e=m.lc().$implicit,i=m.lc();return i.toggleExcludeContact(e),i.mergeContact()})),m.Ub(1,"i",16),m.Sc(2),m.mc(3,"translate"),m.Yb()}2&t&&(m.Eb(2),m.Uc("\xa0",m.nc(3,1,"lang.contactExcluded"),""))}function Xy(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",7),m.Zb(1,"app-contact-detail",8,9),m.hc("afterSelectedEvent",(function(){m.Hc(t);const i=e.index;return m.lc().mergeContact(i)}))("afterDeselectedEvent",(function(i){m.Hc(t);const a=e.index;return m.lc().resetContact(i,a)})),m.Yb(),m.Qc(3,By,3,3,"button",10),m.Qc(4,Wy,1,0,"i",11),m.Qc(5,qy,4,3,"button",12),m.Yb()}if(2&t){const t=e.$implicit,i=e.index,a=m.lc();m.Eb(1),m.Jb("merged",a.contactSelected!==i&&null!==a.contactSelected&&-1===a.contactsExcluded.indexOf(t.id)),m.sc("contact",t)("selectable",a.contactSelected===i||null===a.contactSelected),m.Eb(2),m.sc("ngIf",a.contactSelected!==i&&null!==a.contactSelected&&-1===a.contactsExcluded.indexOf(t.id)),m.Eb(1),m.sc("ngIf",a.contactSelected!==i&&null!==a.contactSelected&&a.contactsExcluded.indexOf(t.id)>-1),m.Eb(1),m.sc("ngIf",a.contactSelected!==i&&null!==a.contactSelected&&a.contactsExcluded.indexOf(t.id)>-1)}}let Ky=(()=>{class t{constructor(t,e,i,a,n,s,c){this.translate=t,this.http=e,this.notify=i,this.data=a,this.dialogRef=n,this.headerService=s,this.functionsService=c,this.loading=!1,this.contactSelected=null,this.contactsExcluded=[]}ngOnInit(){}mergeContact(t=this.contactSelected){this.appContactDetail.toArray()[t].resetContact(),this.appContactDetail.toArray()[t].contact.selected=!0,this.functionsService.empty(t)||(this.contactSelected=t),this.data.duplicate.forEach((e,i)=>{-1===this.contactsExcluded.indexOf(this.appContactDetail.toArray()[i].getContactInfo().id)&&Object.keys(this.appContactDetail.toArray()[i].getContactInfo()).forEach(e=>{"customFields"!==e||this.functionsService.empty(this.appContactDetail.toArray()[i].getContactInfo()[e])?"civility"!==e||this.functionsService.empty(this.appContactDetail.toArray()[i].getContactInfo()[e].id)?this.functionsService.empty(this.appContactDetail.toArray()[t].getContactInfo()[e])&&this.appContactDetail.toArray()[t].getContactInfo()[e]!==this.appContactDetail.toArray()[i].getContactInfo()[e]&&this.appContactDetail.toArray()[t].setContactInfo(e,this.appContactDetail.toArray()[i].getContactInfo()[e]):this.appContactDetail.toArray()[t].setContactInfo(e,this.appContactDetail.toArray()[i].getContactInfo()[e]):this.appContactDetail.toArray()[i].getContactInfo()[e].forEach(i=>{0===this.appContactDetail.toArray()[t].getContactInfo()[e].filter(t=>t.label===i.label).length&&this.appContactDetail.toArray()[t].setContactInfo(e,i)})})})}toggleExcludeContact(t){const e=this.contactsExcluded.indexOf(t.id);-1===e?this.contactsExcluded.push(t.id):this.contactsExcluded.splice(e,1)}resetContact(t,e){this.contactSelected=null,this.appContactDetail.toArray()[e].resetContact()}onSubmit(){this.loading=!0;const t=this.data.duplicate.filter((t,e)=>e===this.contactSelected).map(t=>t.id)[0],e=this.data.duplicate.filter((t,e)=>e!==this.contactSelected).filter((t,e)=>-1===this.contactsExcluded.indexOf(t.id)).map(t=>t.id);this.http.put(`../rest/contacts/${t}/merge`,{duplicates:e}).pipe(Object(d.a)(()=>{this.dialogRef.close(e.length===this.data.duplicate.length-1?"removeAll":e)}),Object(vt.a)(()=>this.loading=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(H.a),m.Tb(H.h),m.Tb(h.a),m.Tb(C.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-manage-duplicate"]],viewQuery:function(t,e){var i;1&t&&m.ad(Gy,!0),2&t&&m.Cc(i=m.ic())&&(e.appContactDetail=i)},decls:11,vars:12,consts:[[1,"mat-dialog-content-container"],["mat-dialog-content","",1,"contact-list-container"],["style","position: relative;",4,"ngFor","ngForOf"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"disabled","click"],["mat-raised-button","","mat-button","",3,"mat-dialog-close"],[2,"position","relative"],[2,"height","100%",3,"contact","selectable","afterSelectedEvent","afterDeselectedEvent"],["appContactDetail",""],["mat-raised-button","","mat-button","","style","position: absolute;bottom: 0px;left: 50%;transform: translateX(-50%);",3,"click",4,"ngIf"],["class","fas fa-ban excludeLogo",4,"ngIf"],["mat-raised-button","","mat-button","","color","primary","style","position: absolute;bottom: 0px;left: 50%;transform: translateX(-50%);",3,"click",4,"ngIf"],["mat-raised-button","","mat-button","",2,"position","absolute","bottom","0px","left","50%","transform","translateX(-50%)",3,"click"],[1,"fas","fa-ban","excludeLogo"],["mat-raised-button","","mat-button","","color","primary",2,"position","absolute","bottom","0px","left","50%","transform","translateX(-50%)",3,"click"],[1,"fas","fa-ban"]],template:function(t,e){1&t&&(m.Zb(0,"div",0),m.Zb(1,"div",1),m.Qc(2,Xy,6,7,"div",2),m.Yb(),m.Ub(3,"span",3),m.Zb(4,"div",4),m.Zb(5,"button",5),m.hc("click",(function(){return e.onSubmit()})),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Zb(8,"button",6),m.Sc(9),m.mc(10,"translate"),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(1),m.Jb("contact-list-container-1",1==e.data.duplicate.length)("contact-list-container-2",2==e.data.duplicate.length),m.Eb(1),m.sc("ngForOf",e.data.duplicate),m.Eb(3),m.sc("disabled",null===e.contactSelected||e.loading||e.contactsExcluded.length===e.data.duplicate.length-1),m.Eb(1),m.Tc(m.nc(7,8,"lang.merge")),m.Eb(3),m.Tc(m.nc(10,10,"lang.cancel")))},directives:[H.f,x.s,H.c,D.b,H.d,Jy.a,x.t],pipes:[p.d],styles:[".merged[_ngcontent-%COMP%]{opacity:.5}.contact-list-container[_ngcontent-%COMP%]{padding:20px;display:grid;grid-template-columns:repeat(3,33%);grid-gap:10px}.contact-list-container-1[_ngcontent-%COMP%]{grid-template-columns:1fr}.contact-list-container-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.excludeLogo[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:80px;color:#8e3e52}"]}),t})();var tC=i("vxfF");const eC=["adminMenuTemplate"];function iC(t,e){if(1&t&&(m.Zb(0,"a",19),m.Ub(1,"mat-icon",20),m.Zb(2,"p",21),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function aC(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Qc(1,iC,4,6,"a",18),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.sc("ngForOf",t.subMenus)}}function nC(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-chip",31),m.hc("removed",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).removeCriteria(i)}))("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).removeCriteria(i)})),m.Sc(1),m.Ub(2,"mat-icon",32),m.Yb()}if(2&t){const t=e.$implicit;m.sc("removable",!0),m.Eb(1),m.Uc(" ",t.label," ")}}function sC(t,e){if(1&t){const t=m.ac();m.Zb(0,"div",22),m.Zb(1,"mat-accordion",23),m.Zb(2,"mat-expansion-panel",24),m.Zb(3,"mat-expansion-panel-header"),m.Zb(4,"mat-panel-title"),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Yb(),m.Zb(7,"plugin-select-search",25),m.hc("afterSelected",(function(e){return m.Hc(t),m.lc().addCriteria(e)})),m.Yb(),m.Ub(8,"mat-divider",26),m.Zb(9,"mat-chip-list",27),m.Qc(10,nC,3,2,"mat-chip",28),m.Yb(),m.Zb(11,"div",29),m.Zb(12,"button",30),m.hc("click",(function(){return m.Hc(t),m.lc().searchDuplicates()})),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(2),m.sc("expanded",t.openedSearchTool),m.Eb(3),m.Uc(" ",m.nc(6,9,"lang.criteriaSearch")," "),m.Eb(2),m.sc("label",t.translate.instant("lang.addCriteria"))("formControlSelect",t.addCriteriaSelect)("placeholderLabel",t.translate.instant("lang.addCriteria"))("datas",t.contactFields),m.Eb(3),m.sc("ngForOf",t.currentFieldsSearch),m.Eb(2),m.sc("disabled",0===t.currentFieldsSearch.length||t.isLoadingResults),m.Eb(1),m.Tc(m.nc(14,11,"lang.launchSearch"))}}function cC(t,e){1&t&&(m.Zb(0,"div",33),m.Zb(1,"em"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Eb(2),m.Tc(m.nc(3,1,"lang.noDuplicatesFound")))}const oC=function(t,e){return{value1:t,value2:e}};function rC(t,e){if(1&t&&(m.Zb(0,"div",34),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc();m.Eb(1),m.Uc(" ",m.oc(2,1,"lang.duplicatesContactDisplayed",m.Ac(4,oC,t.duplicatesContactsRealCount,t.duplicatesContactsCount))," ")}}function lC(t,e){if(1&t&&(m.Zb(0,"span",38),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc(2);m.Eb(1),m.Uc(" ",i.getLabel(t)," ")}}function dC(t,e){if(1&t&&(m.Zb(0,"mat-list",15),m.Zb(1,"mat-list-item",35),m.Zb(2,"p",36),m.Qc(3,lC,2,1,"span",37),m.Yb(),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.Hb("contact-list-container-",t.displayedColumns.length,""),m.Eb(1),m.sc("ngForOf",t.displayedColumns)}}function bC(t,e){if(1&t&&(m.Zb(0,"span",42),m.Sc(1),m.Yb()),2&t){const t=e.$implicit,i=m.lc().$implicit;m.Eb(1),m.Uc(" ",i[t]," ")}}function mC(t,e){if(1&t){const t=m.ac();m.Xb(0),m.Zb(1,"mat-list-item",39),m.hc("mouseover",(function(){m.Hc(t);const i=e.$implicit;return m.lc().selectDuplicates(i.duplicateId)}))("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc().manageDuplicate(i.duplicateId)})),m.Zb(2,"p",40),m.Qc(3,bC,2,1,"span",41),m.Yb(),m.Yb(),m.Wb()}if(2&t){const t=e.$implicit,i=e.index,a=m.lc();m.Eb(1),m.Jb("odd",void 0!==a.duplicatesContacts[i+1]&&t.odd!==a.duplicatesContacts[i+1].odd)("hovered",t.duplicateId===a.currentDuplicateId),m.Eb(1),m.Hb("contact-list-container-",a.displayedColumns.length,""),m.Eb(1),m.sc("ngForOf",a.displayedColumns)}}function pC(t,e){1&t&&(m.Zb(0,"div",43),m.Ub(1,"mat-spinner"),m.Yb())}let uC=(()=>{class t{constructor(t,e,i,a,n,s,c,r,l,d){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.dialog=s,this.functions=c,this.sortPipe=r,this.viewContainerRef=l,this.functionsService=d,this.loading=!0,this.subMenus=[{icon:"fa fa-book",route:"/administration/contacts/list",label:this.translate.instant("lang.contactsList"),current:!1},{icon:"fa fa-code",route:"/administration/contacts/contactsCustomFields",label:this.translate.instant("lang.customFieldsAdmin"),current:!1},{icon:"fa fa-cog",route:"/administration/contacts/contacts-parameters",label:this.translate.instant("lang.contactsParameters"),current:!1},{icon:"fa fa-users",route:"/administration/contacts/contacts-groups",label:this.translate.instant("lang.contactsGroups"),current:!1},{icon:"fas fa-magic",route:"/administration/contacts/duplicates",label:this.translate.instant("lang.duplicatesContactsAdmin"),current:!0}],this.contactFields=[],this.addCriteriaSelect=new o.h,this.currentFieldsSearch=[],this.currentDuplicateId=null,this.duplicatesContacts=[],this.duplicatesContactsCount=-1,this.duplicatesContactsRealCount=0,this.displayedColumns=["companyLastname","lastname","company"],this.isLoadingResults=!1,this.openedSearchTool=!0}ngOnInit(){return Object(gt.a)(this,void 0,void 0,(function*(){this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.headerService.setHeader(this.translate.instant("lang.contactsDuplicates"),"",""),yield this.getContactFields(),this.setDefaultSearchCriteria(),this.loading=!1}))}getContactFields(){return new Promise((t,e)=>{this.http.get("../rest/contactsParameters").pipe(Object(l.a)(t=>{const e=/contactCustomField_[.]*/g;return t.contactsParameters=t.contactsParameters.filter(t=>null===t.identifier.match(e)).map(t=>Object.assign(Object.assign({},t),{label:this.translate.instant("lang.contactsParameters_"+t.identifier)})),t.contactsParameters}),Object(d.a)(t=>{this.contactFields=t}),Object(q.a)(()=>this.http.get("../rest/contactsCustomFields")),Object(l.a)(t=>(t.customFields=t.customFields.map(t=>Object.assign(Object.assign({},t),{id:"contactCustomField_"+t.id,identifier:"contactCustomField_"+t.id})),t.customFields)),Object(d.a)(e=>{this.contactFields=this.contactFields.concat(e),this.contactFields=this.sortPipe.transform(this.contactFields,"label"),t(!0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}setDefaultSearchCriteria(t=["lastname","company"]){this.contactFields.filter(e=>t.indexOf(e.identifier)>-1).forEach(t=>{t.disabled=!0,this.currentFieldsSearch.push(t)})}addCriteria(t){this.contactFields.filter(e=>e.id===t).forEach(t=>{t.disabled=!0,this.currentFieldsSearch.push(t)}),this.addCriteriaSelect.reset()}removeCriteria(t){this.contactFields.forEach((e,i)=>{e.id===t.id&&(this.currentFieldsSearch=this.currentFieldsSearch.filter(e=>e.id!==t.id),e.disabled=!1)})}searchDuplicates(){this.duplicatesContacts=[],this.isLoadingResults=!0;const t="?criteria[]="+this.currentFieldsSearch.map(t=>t.identifier).join("&criteria[]=");this.http.get("../rest/duplicatedContacts"+t).pipe(Object(l.a)(t=>(this.duplicatesContactsRealCount=t.realCount,this.duplicatesContactsCount=t.returnedCount,t.contacts.forEach((e,i)=>{e.odd=0===i||(void 0!==t.contacts[i-1]&&t.contacts[i-1].duplicateId===e.duplicateId?t.contacts[i-1].odd:!t.contacts[i-1].odd);const a=[];a.push(e.company),a.push(e.lastname),e.companyLastname=a.filter(t=>!this.functions.empty(t)).join(" / "),this.functionsService.empty(e.customFields)||Object.keys(e.customFields).forEach(t=>{e[t]=e.customFields[t]})}),t.contacts)),Object(d.a)(t=>{this.duplicatesContacts=t,setTimeout(()=>{const t=/contactCustomField_[.]*/g;this.displayedColumns=this.currentFieldsSearch.filter(e=>null===e.identifier.match(t)).map(t=>t.identifier).concat(this.currentFieldsSearch.filter(e=>null!==e.identifier.match(t)).map(t=>t.identifier.replace("contactCustomField_",""))),this.displayedColumns.unshift("companyLastname"),this.openedSearchTool=!1},0)}),Object(vt.a)(()=>this.isLoadingResults=!1),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}selectDuplicates(t){this.currentDuplicateId=t}manageDuplicate(t){this.dialog.open(Ky,{panelClass:"maarch-modal",data:{duplicate:this.duplicatesContacts.filter(e=>e.duplicateId===t).map(t=>({id:t.id,type:"contact"}))}}).afterClosed().pipe(Object(W.a)(t=>!this.functionsService.empty(t)),Object(d.a)(e=>{this.notify.success(this.translate.instant("lang.contactsMerged")),this.duplicatesContactsCount--,this.duplicatesContactsRealCount--,this.duplicatesContacts=this.duplicatesContacts.filter("removeAll"!==e?t=>-1===e.indexOf(t.id):e=>e.duplicateId!==t)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}getLabel(t){return void 0!==this.translate.instant("lang.contactsParameters_"+t)?this.translate.instant("lang.contactsParameters_"+t):void 0!==this.translate.instant("lang."+t)?this.translate.instant("lang."+t):this.contactFields.filter(e=>e.id==="contactCustomField_"+t)[0].label}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(H.b),m.Tb(C.a),m.Tb(U.a),m.Tb(m.R),m.Tb(C.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-contact-duplicate"]],viewQuery:function(t,e){var i;1&t&&m.Oc(eC,!0),2&t&&m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first)},features:[m.Db([U.a])],decls:22,vars:12,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content",2,"display","flex","flex-direction","column","overflow","hidden"],["class","criteria-container",4,"ngIf"],["style","padding: 10px;text-align: center;color: rgba(0,0,0,0.54);",4,"ngIf"],["style","padding: 10px;text-align: right;color: rgba(0,0,0,0.54);",4,"ngIf"],["role","list",4,"ngIf"],[2,"position","relative","height","100%","overflow","auto"],["itemSize","48",1,"example-viewport"],["role","list"],[4,"cdkVirtualFor","cdkVirtualForOf"],["class","example-loading-shade",4,"ngIf"],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],["mat-line",""],[1,"criteria-container"],[2,"margin-bottom","10px"],[3,"expanded"],[3,"label","formControlSelect","placeholderLabel","datas","afterSelected"],[2,"margin-top","20px","margin-bottom","20px"],[1,"checkbox-selected-list"],["selected","",3,"removable","removed","click",4,"ngFor","ngForOf"],[1,"col-md-12","text-center"],["mat-raised-button","","color","primary","type","button",3,"disabled","click"],["selected","",3,"removable","removed","click"],["matChipRemove","",1,"fa","fa-times-circle"],[2,"padding","10px","text-align","center","color","rgba(0,0,0,0.54)"],[2,"padding","10px","text-align","right","color","rgba(0,0,0,0.54)"],["role","listitem"],["mat-line","",2,"font-size","80%","display","grid","grid-gap","10px"],["class","primary","style","overflow: hidden;text-overflow: ellipsis;",4,"ngFor","ngForOf"],[1,"primary",2,"overflow","hidden","text-overflow","ellipsis"],["role","listitem",2,"cursor","pointer","font-size","14px",3,"mouseover","click"],["mat-line","",2,"display","grid","grid-gap","10px","align-items","center"],["style","overflow: hidden;text-overflow: ellipsis;",4,"ngFor","ngForOf"],[2,"overflow","hidden","text-overflow","ellipsis"],[1,"example-loading-shade"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,aC,2,1,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,sC,15,13,"div",9),m.Qc(14,cC,4,3,"div",10),m.Qc(15,rC,3,7,"div",11),m.Qc(16,dC,4,4,"mat-list",12),m.Zb(17,"div",13),m.Zb(18,"cdk-virtual-scroll-viewport",14),m.Zb(19,"mat-list",15),m.Qc(20,mC,4,8,"ng-container",16),m.Yb(),m.Yb(),m.Qc(21,pC,2,0,"div",17),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("ngIf",0===e.duplicatesContactsCount),m.Eb(1),m.sc("ngIf",e.duplicatesContacts.length>0),m.Eb(1),m.sc("ngIf",e.duplicatesContacts.length>0),m.Eb(4),m.sc("cdkVirtualForOf",e.duplicatesContacts),m.Eb(1),m.sc("ngIf",e.isLoadingResults))},directives:[S.e,S.f,M.a,Z.a,x.t,tC.e,tC.a,Ot.a,tC.d,Ot.h,x.s,Ot.d,s.f,Tt.a,Ot.c,I.k,De.a,De.c,De.g,De.h,Nr.a,_.a,An.d,D.b,An.a,An.e,T.c],pipes:[p.d],styles:[".example-viewport[_ngcontent-%COMP%]{flex:1;width:100%;background:#fff;height:100%}.example-viewport[_ngcontent-%COMP%]    .cdk-virtual-scroll-content-wrapper{overflow:hidden;text-overflow:ellipsis;width:100%}.active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}.criteria-container[_ngcontent-%COMP%]{margin:20px}.hovered[_ngcontent-%COMP%]{background:rgba(0,0,0,.04)!important;transition:all .3s}.odd[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12)}.contact-list-container-1[_ngcontent-%COMP%]{grid-template-columns:1fr}.contact-list-container-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.contact-list-container-3[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}.contact-list-container-4[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}.contact-list-container-5[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr)}"]}),t})();const hC=["adminMenuTemplate"];function fC(t,e){if(1&t&&(m.Zb(0,"a",16),m.Ub(1,"mat-icon",17),m.Zb(2,"p",14),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function gC(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Ub(9,"mat-divider"),m.Zb(10,"mat-nav-list"),m.Qc(11,fC,4,6,"a",15),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,3,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,5,"lang.add")," "),m.Eb(4),m.sc("ngForOf",t.subMenus)}}function vC(t,e){1&t&&(m.Zb(0,"div",18),m.Ub(1,"mat-spinner",19),m.Yb())}function yC(t,e){1&t&&(m.Zb(0,"mat-header-cell",39),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc("",m.nc(2,1,"lang.coclicoNumber")," "))}function CC(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.accountNumber," ")}}function EC(t,e){1&t&&(m.Zb(0,"mat-header-cell",39),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.label")," "))}function SC(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label," ")}}function MC(t,e){1&t&&(m.Zb(0,"mat-header-cell",39),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.postOffice")," "))}function YC(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.postOfficeLabel," ")}}function ZC(t,e){1&t&&m.Ub(0,"mat-header-cell")}function xC(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",40),m.Zb(1,"button",41),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.delete(a)})),m.mc(2,"translate"),m.Ub(3,"mat-icon",42),m.Yb(),m.Yb()}2&t&&(m.Eb(1),m.tc("matTooltip",m.nc(2,1,"lang.delete")))}function _C(t,e){1&t&&m.Ub(0,"mat-header-row")}function wC(t,e){1&t&&(m.Ub(0,"mat-row",43),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/issuingSites/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function OC(t,e){if(1&t&&(m.Zb(0,"mat-card",20),m.Zb(1,"div",21),m.Zb(2,"div",22),m.Zb(3,"mat-form-field"),m.Ub(4,"input",23),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",22),m.Ub(7,"mat-paginator",24,25),m.Yb(),m.Yb(),m.Zb(9,"mat-table",26,27),m.Xb(11,28),m.Qc(12,yC,3,3,"mat-header-cell",29),m.Qc(13,CC,2,1,"mat-cell",30),m.Wb(),m.Xb(14,31),m.Qc(15,EC,3,3,"mat-header-cell",29),m.Qc(16,SC,2,1,"mat-cell",30),m.Wb(),m.Xb(17,32),m.Qc(18,MC,3,3,"mat-header-cell",29),m.Qc(19,YC,2,1,"mat-cell",30),m.Wb(),m.Xb(20,33),m.Qc(21,ZC,1,0,"mat-header-cell",34),m.Qc(22,xC,4,3,"mat-cell",35),m.Wb(),m.Qc(23,_C,1,0,"mat-header-row",36),m.Qc(24,wC,2,4,"mat-row",37),m.Yb(),m.Zb(25,"div",38),m.Sc(26),m.mc(27,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(14),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.data.length," ",m.nc(27,12,"lang.issuingSites"),"")}}let TC=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.dialog=r,this.subMenus=[{icon:"fas fa-dolly-flatbed",route:"/administration/registeredMails",label:this.translate.instant("lang.registeredMailNumberRanges"),current:!1},{icon:"fas fa-warehouse",route:"/administration/issuingSites",label:this.translate.instant("lang.issuingSites"),current:!0}],this.parameters={},this.loading=!0,this.data=[],this.displayedColumns=["accountNumber","label","postOfficeLabel","actions"],this.filterColumns=["accountNumber","label","postOfficeLabel"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.issuingSites")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!1,this.getData()}getData(){this.data=[],this.http.get("../rest/registeredMail/sites").pipe(Object(Zt.tap)(t=>{this.data=t.sites,this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_regitered_mail_issuing_site",this.data,this.sort,this.paginator,this.filterColumns)},0)}),Object(J.catchError)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}delete(t){this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/registeredMail/sites/"+t.id)),Object(Zt.tap)(()=>{this.data=this.data.filter(e=>e.id!==t.id),setTimeout(()=>{this.adminService.setDataSource("admin_regitered_mail_issuing_site",this.data,this.sort,this.paginator,this.filterColumns)},0),this.notify.success(this.translate.instant("lang.issuingSiteDeleted"))}),Object(J.catchError)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R),m.Tb(H.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-issuing-site-list"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(hC,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/issuingSites/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","accountNumber"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","label"],["matColumnDef","postOfficeLabel"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header",""],[2,"justify-content","flex-end"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,gC,12,7,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,vC,2,0,"div",9),m.Qc(14,OC,28,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,_.a,x.s,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}"]}),t})();const kC=["maarchTree"];function IC(t,e){1&t&&(m.Zb(0,"div",15),m.Ub(1,"mat-spinner",16),m.Yb())}function DC(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",49),m.hc("click",(function(){m.Hc(t);const i=e.$implicit;return m.lc(2).addressBANCurrentDepartment=i})),m.Sc(1),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Tc(t)}}function UC(t,e){if(1&t&&(m.Zb(0,"mat-option",50),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t.address," ")}}function PC(t,e){if(1&t&&(m.Xb(0),m.Qc(1,UC,2,2,"mat-option",46),m.mc(2,"async"),m.Wb()),2&t){const t=m.lc(2);m.Eb(1),m.sc("ngForOf",m.nc(2,1,t.addressBANFilteredResult))}}function FC(t,e){if(1&t&&m.Ub(0,"mat-option",51),2&t){const t=m.lc(2);m.sc("innerHTML",t.addressBANInfo,m.Ic)}}function LC(t,e){1&t&&(m.Zb(0,"mat-option",52),m.Ub(1,"mat-spinner",53),m.Yb())}function jC(t,e){if(1&t&&(m.Zb(0,"mat-option",50),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.sc("value",t),m.Eb(1),m.Uc(" ",t," ")}}function RC(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",17),m.Zb(1,"form",18),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(2,"div"),m.Zb(3,"mat-form-field"),m.Zb(4,"mat-label"),m.Sc(5),m.mc(6,"translate"),m.Yb(),m.Ub(7,"input",19),m.Yb(),m.Zb(8,"mat-form-field"),m.Zb(9,"mat-label"),m.Sc(10),m.mc(11,"translate"),m.Yb(),m.Ub(12,"input",20),m.Yb(),m.Zb(13,"mat-form-field"),m.Zb(14,"mat-label"),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Ub(17,"input",21),m.Yb(),m.Zb(18,"div",22),m.Zb(19,"div",23),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Zb(22,"mat-form-field",24),m.Zb(23,"button",25),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()})),m.Sc(24),m.Ub(25,"i",26),m.Yb(),m.Zb(26,"mat-menu",null,27),m.Qc(28,DC,2,1,"button",28),m.Yb(),m.Ub(29,"mat-icon",29),m.Zb(30,"input",30,31),m.hc("click",(function(e){return m.Hc(t),e.stopPropagation()}))("focus",(function(){return m.Hc(t),m.lc().resetAutocompleteAddressBan()})),m.Yb(),m.Zb(32,"mat-autocomplete",32,33),m.hc("optionSelected",(function(e){return m.Hc(t),m.lc().selectAddressBan(e)})),m.Qc(34,PC,3,3,"ng-container",34),m.Qc(35,FC,1,1,"mat-option",35),m.Qc(36,LC,2,0,"mat-option",36),m.Yb(),m.Yb(),m.Zb(37,"mat-form-field"),m.Zb(38,"mat-label"),m.Sc(39),m.mc(40,"translate"),m.Yb(),m.Ub(41,"input",37),m.Yb(),m.Zb(42,"mat-form-field"),m.Zb(43,"mat-label"),m.Sc(44),m.mc(45,"translate"),m.Yb(),m.Ub(46,"input",38),m.Yb(),m.Zb(47,"mat-form-field"),m.Zb(48,"mat-label"),m.Sc(49),m.mc(50,"translate"),m.Yb(),m.Ub(51,"input",39),m.Yb(),m.Zb(52,"mat-form-field"),m.Zb(53,"mat-label"),m.Sc(54),m.mc(55,"translate"),m.Yb(),m.Ub(56,"input",40),m.Yb(),m.Zb(57,"mat-form-field"),m.Zb(58,"mat-label"),m.Sc(59),m.mc(60,"translate"),m.Yb(),m.Ub(61,"input",41),m.Yb(),m.Zb(62,"mat-form-field"),m.Zb(63,"mat-label"),m.Sc(64),m.mc(65,"translate"),m.Yb(),m.Ub(66,"input",42),m.Yb(),m.Zb(67,"mat-form-field"),m.Zb(68,"mat-label"),m.Sc(69),m.mc(70,"translate"),m.Yb(),m.Ub(71,"input",43,31),m.Zb(73,"mat-autocomplete",44,45),m.hc("optionSelected",(function(e){return m.Hc(t),m.lc().adminFormGroup.controls.addressCountry.setValue(e.option.value)})),m.Qc(75,jC,2,2,"mat-option",46),m.mc(76,"async"),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(77,"div",47),m.Zb(78,"button",48),m.Sc(79),m.mc(80,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.Dc(27),e=m.Dc(33),i=m.Dc(74),a=m.lc();m.Eb(1),m.sc("formGroup",a.adminFormGroup),m.Eb(4),m.Tc(m.nc(6,26,"lang.siteName")),m.Eb(5),m.Tc(m.nc(11,28,"lang.coclicoNumber")),m.Eb(5),m.Tc(m.nc(16,30,"lang.postOffice")),m.Eb(5),m.Uc(" ",m.nc(21,32,"lang.address")," "),m.Eb(3),m.sc("matMenuTriggerFor",t)("title",a.translate.instant("lang.targetDepartment")),m.Eb(1),m.Uc(" ",a.addressBANCurrentDepartment,"\xa0"),m.Eb(4),m.sc("ngForOf",a.departmentList),m.Eb(2),m.sc("placeholder",a.translate.instant("lang.searchAddressBan"))("formControl",a.addressBANControl)("matAutocomplete",e),m.Eb(4),m.sc("ngIf",a.addressBANResult.length>0&&!a.addressBANLoading),m.Eb(1),m.sc("ngIf",0===a.addressBANResult.length&&!a.addressBANLoading),m.Eb(1),m.sc("ngIf",a.addressBANLoading),m.Eb(3),m.Tc(m.nc(40,34,"lang.contactsParameters_addressAdditional1")),m.Eb(5),m.Tc(m.nc(45,36,"lang.contactsParameters_addressNumber")),m.Eb(5),m.Tc(m.nc(50,38,"lang.contactsParameters_addressStreet")),m.Eb(5),m.Tc(m.nc(55,40,"lang.contactsParameters_addressAdditional2")),m.Eb(5),m.Tc(m.nc(60,42,"lang.contactsParameters_addressPostcode")),m.Eb(5),m.Tc(m.nc(65,44,"lang.contactsParameters_addressTown")),m.Eb(5),m.Tc(m.nc(70,46,"lang.contactsParameters_addressCountry")),m.Eb(2),m.sc("matAutocomplete",i),m.Eb(4),m.sc("ngForOf",m.nc(76,48,a.countriesFilteredResult)),m.Eb(3),m.sc("disabled",!a.adminFormGroup.valid),m.Eb(1),m.Tc(m.nc(80,50,"lang.save"))}}let QC=(()=>{class t{constructor(t,e,i,a,n,s,c,r,l){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this._formBuilder=r,this.latinisePipe=l,this.loading=!0,this.entities=[],this.countries=[],this.id=null,this.addressBANInfo="",this.addressBANMode=!0,this.addressBANControl=new o.h,this.addressBANLoading=!1,this.addressBANResult=[],this.addressBANCurrentDepartment="75",this.departmentList=[]}ngOnInit(){this.route.params.subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){void 0===t.id?(this.creationMode=!0,this.headerService.setHeader(this.translate.instant("lang.issuingSiteCreation")),this.initBanSearch(),this.initAutocompleteAddressBan(),this.adminFormGroup=this._formBuilder.group({id:[null],label:["",o.H.required],postOfficeLabel:["",o.H.required],accountNumber:["",o.H.required],addressNumber:["",o.H.required],addressStreet:["",o.H.required],addressAdditional1:[""],addressAdditional2:[""],addressPostcode:["",o.H.required],addressTown:["",o.H.required],addressCountry:[""]}),this.getCountries(),this.initAutocompleteCountries(),this.loading=!1,yield this.getEntities(),this.maarchTree.initData(this.entities)):(this.id=t.id,this.creationMode=!1,this.headerService.setHeader(this.translate.instant("lang.issuingSiteModification")),this.initBanSearch(),this.initAutocompleteAddressBan(),yield this.getEntities(),yield this.getData(),this.getCountries(),this.initAutocompleteCountries(),this.maarchTree.initData(this.entities))})))}getData(){return new Promise(t=>{this.http.get("../rest/registeredMail/sites/"+this.id).pipe(Object(d.a)(e=>{this.adminFormGroup=this._formBuilder.group({id:[this.id],label:[e.site.label,o.H.required],postOfficeLabel:[e.site.postOfficeLabel,o.H.required],accountNumber:[e.site.accountNumber,o.H.required],addressNumber:[e.site.addressNumber,o.H.required],addressStreet:[e.site.addressStreet,o.H.required],addressAdditional1:[e.site.addressAdditional1],addressAdditional2:[e.site.addressAdditional2],addressPostcode:[e.site.addressPostcode,o.H.required],addressTown:[e.site.addressTown,o.H.required],addressCountry:[e.site.addressCountry],entities:[e.site.entities]}),this.entities=this.entities.map(t=>Object.assign(Object.assign({},t),{state:{opened:!0,selected:e.site.entities.indexOf(t.id)>-1}})),t(!0),this.loading=!1}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}initBanSearch(){this.http.get("../rest/ban/availableDepartments").pipe(Object(d.a)(t=>{null!==t.default&&-1!==t.departments.indexOf(t.default.toString())&&(this.addressBANCurrentDepartment=t.default),this.departmentList=t.departments}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}initAutocompleteCountries(){this.countriesFilteredResult=this.adminFormGroup.controls.addressCountry.valueChanges.pipe(Object(r.a)(""),Object(l.a)(t=>this._filter(t)))}_filter(t){const e=t.toLowerCase();return this.countries.filter(t=>t.toLowerCase().includes(e))}initAutocompleteAddressBan(){this.addressBANInfo=this.translate.instant("lang.autocompleteInfo"),this.addressBANResult=[],this.addressBANControl.valueChanges.pipe(Object(dl.a)(300),Object(W.a)(t=>t.length>2),Object(Tm.a)(),Object(d.a)(()=>this.addressBANLoading=!0),Object(gb.a)(t=>this.http.get("../rest/autocomplete/banAddresses",{params:{address:t,department:this.addressBANCurrentDepartment}})),Object(d.a)(t=>{this.addressBANInfo=0===t.length?this.translate.instant("lang.noAvailableValue"):"",this.addressBANResult=t,this.addressBANFilteredResult=Object(N.of)(this.addressBANResult),this.addressBANLoading=!1})).subscribe()}resetAutocompleteAddressBan(){this.addressBANResult=[],this.addressBANInfo=this.translate.instant("lang.autocompleteInfo")}selectAddressBan(t){this.adminFormGroup.controls.addressNumber.setValue(t.option.value.number),this.adminFormGroup.controls.addressStreet.setValue(t.option.value.afnorName),this.adminFormGroup.controls.addressPostcode.setValue(t.option.value.postalCode),this.adminFormGroup.controls.addressTown.setValue(t.option.value.city),this.adminFormGroup.controls.addressCountry.setValue("FRANCE"),this.addressBANControl.setValue("")}getEntities(){return new Promise(t=>{this.http.get("../rest/entities").pipe(Object(l.a)(t=>(t.entities=t.entities.map(t=>({text:t.entity_label,icon:t.icon,parent_id:t.parentSerialId,id:t.serialId,state:{opened:!0}})),t.entities)),Object(d.a)(e=>{this.entities=e,t(!0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}getCountries(){this.http.get("../rest/registeredMail/countries").pipe(Object(d.a)(t=>{this.countries=t.countries.map(t=>this.latinisePipe.transform(t.toUpperCase()))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}onSubmit(){const t={};Object.keys(this.adminFormGroup.controls).forEach(e=>{t[e]=this.adminFormGroup.controls[e].value}),t.entities=this.maarchTree.getSelectedNodes().map(t=>t.id),this.creationMode?this.http.post("../rest/registeredMail/sites",t).subscribe(()=>{this.notify.success(this.translate.instant("lang.issuingSiteAdded")),this.router.navigate(["/administration/issuingSites"])},t=>{this.notify.handleSoftErrors(t)}):this.http.put("../rest/registeredMail/sites/"+this.id,t).subscribe(()=>{this.notify.success(this.translate.instant("lang.issuingSiteUpdated")),this.router.navigate(["/administration/issuingSites"])},t=>{this.notify.handleSoftErrors(t)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(o.g),m.Tb(v.c))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-issuing-site"]],viewQuery:function(t,e){var i;1&t&&m.Oc(kC,!0),2&t&&m.Cc(i=m.ic())&&(e.maarchTree=i.first)},decls:22,vars:14,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["fixedTopGap","56","position","end",2,"overflow-x","hidden","width","400px",3,"mode","fixedInViewport","opened"],["snav2",""],["mat-subheader",""],[2,"padding","10px"],["maarchTree",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[2,"display","contents",3,"formGroup","ngSubmit"],["matInput","","formControlName","label"],["type","text","pattern","[0-9]+","maxlength","10","matInput","","formControlName","accountNumber"],["matInput","","formControlName","postOfficeLabel"],[1,"formType","ratio-1","col-sm-12"],[1,"formType-title"],["appearance","outline",1,"smallInput"],["mat-button","","matSuffix","",3,"matMenuTriggerFor","title","click"],[1,"fa","fa-chevron-down"],["menuDep","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["color","primary","matPrefix","",1,"fa","fa-search",2,"font-size","15px"],["type","text","matInput","","maxlength","128",3,"placeholder","formControl","matAutocomplete","click","focus"],["autoCompleteInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[4,"ngIf"],["class","autoCompleteInfoResult smallInputInfo","disabled","",3,"innerHTML",4,"ngIf"],["disabled","",4,"ngIf"],["matInput","","formControlName","addressAdditional1"],["matInput","","formControlName","addressNumber"],["matInput","","formControlName","addressStreet"],["matInput","","formControlName","addressAdditional2"],["matInput","","formControlName","addressPostcode"],["matInput","","formControlName","addressTown"],["matInput","","formControlName","addressCountry",3,"matAutocomplete"],["isOpen","true",3,"optionSelected"],["matAutocompleteCountries","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[2,"text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-menu-item","",3,"click"],[3,"value"],["disabled","",1,"autoCompleteInfoResult","smallInputInfo",3,"innerHTML"],["disabled",""],["diameter","20"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,IC,2,0,"div",8),m.Qc(12,RC,81,52,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Zb(13,"mat-sidenav",10,11),m.Zb(15,"mat-list"),m.Zb(16,"h3",12),m.Sc(17),m.mc(18,"translate"),m.Yb(),m.Zb(19,"div",13),m.Ub(20,"app-maarch-flat-tree",null,14),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading),m.Eb(1),m.sc("mode",e.appService.getViewMode()?"over":"side")("fixedInViewport",e.appService.getViewMode())("opened",!e.appService.getViewMode()),m.Eb(4),m.Tc(m.nc(18,12,"lang.chooseEntityAssociationModel")))},directives:[S.e,S.f,M.a,Z.a,x.t,S.d,Ot.a,Ot.g,Ue.a,T.c,k.a,o.J,o.u,o.l,w.c,w.g,O.b,o.c,o.t,o.j,o.A,o.o,D.b,w.j,Fe.d,Fe.e,x.s,Tt.a,w.i,Hn.d,o.i,Hn.a,Fe.b,I.o],pipes:[p.d,x.b],styles:[".formType[_ngcontent-%COMP%]{align-items:center;display:flex;border-radius:4px;border:1px solid #ccc;position:relative;padding:10px 20px;flex-direction:column}.formType-title[_ngcontent-%COMP%]{white-space:pre;overflow:hidden;max-width:85%;text-overflow:ellipsis;z-index:1;font-size:10px;font-weight:700;background:#fff;position:absolute;top:-7px;left:10px;padding:0;margin:0;color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-slide-toggle-label{color:#666;font-weight:700}.formType[_ngcontent-%COMP%]    .mat-radio-button, .formType[_ngcontent-%COMP%]    .mat-slide-toggle{opacity:.5;color:#666;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.formType[_ngcontent-%COMP%]    .mat-checked, .formType[_ngcontent-%COMP%]    .mat-radio-checked{opacity:1;color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-checked .mat-slide-toggle-label{color:#135f7f}.formType[_ngcontent-%COMP%]    .mat-form-field-suffix{color:#f99830;font-size:15px;top:0}.ratio-1[_ngcontent-%COMP%], .ratio-2[_ngcontent-%COMP%]{flex:1}.smallInput[_ngcontent-%COMP%]{font-size:11px;padding-left:20px;padding-right:20px}.smallInput[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{width:30px;height:25px;color:#135f7f}.smallInput[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]    .mat-button-wrapper{display:flex;line-height:normal;align-items:center}.smallInput[_ngcontent-%COMP%]    .mat-form-field-infix{padding:0 0 5px}"]}),t})();const AC=["adminMenuTemplate"];function HC(t,e){if(1&t&&(m.Zb(0,"a",16),m.Ub(1,"mat-icon",17),m.Zb(2,"p",14),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Jb("active",t.current),m.sc("routerLink",t.route),m.Eb(1),m.Gb(t.icon),m.Eb(2),m.Uc(" ",t.label," ")}}function $C(t,e){if(1&t&&(m.Zb(0,"mat-nav-list"),m.Zb(1,"h3",11),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Zb(4,"a",12),m.Ub(5,"mat-icon",13),m.Zb(6,"p",14),m.Sc(7),m.mc(8,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Ub(9,"mat-divider"),m.Zb(10,"mat-nav-list"),m.Qc(11,HC,4,6,"a",15),m.Yb()),2&t){const t=m.lc();m.Eb(2),m.Tc(m.nc(3,3,"lang.actions")),m.Eb(5),m.Uc(" ",m.nc(8,5,"lang.add")," "),m.Eb(4),m.sc("ngForOf",t.subMenus)}}function zC(t,e){1&t&&(m.Zb(0,"div",18),m.Ub(1,"mat-spinner",19),m.Yb())}function VC(t,e){1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.issuingSite")," "))}function NC(t,e){if(1&t&&(m.Zb(0,"mat-cell",46),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.label," ")}}function JC(t,e){1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.trackerNumber")," "))}function GC(t,e){if(1&t&&(m.Zb(0,"mat-cell",46),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.trackerNumber," ")}}function BC(t,e){1&t&&(m.Zb(0,"mat-header-cell",45),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.type")," "))}function WC(t,e){if(1&t&&(m.Zb(0,"mat-cell",46),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.typeLabel," ")}}function qC(t,e){1&t&&(m.Zb(0,"mat-header-cell",47),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.rangeNumber")," "))}function XC(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.rangeNumber," ")}}function KC(t,e){1&t&&(m.Zb(0,"mat-header-cell",47),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.currentNumber")," "))}function tE(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Uc(" ",t.currentNumber," ")}}function eE(t,e){1&t&&(m.Zb(0,"mat-header-cell",47),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.status")," "))}const iE=function(){return["OK"]},aE=function(){return["SPD"]},nE=function(){return["END"]},sE=function(t,e,i){return{statusLabelPrimary:t,statusLabelWarn:e,statusLabelDanger:i}};function cE(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Zb(1,"span",48),m.Sc(2),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.sc("ngClass",m.Bc(5,sE,m.yc(2,iE).indexOf(t.status)>-1,m.yc(3,aE).indexOf(t.status)>-1,m.yc(4,nE).indexOf(t.status)>-1)),m.Eb(1),m.Tc(t.statusLabel)}}function oE(t,e){1&t&&(m.Zb(0,"mat-header-cell",47),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.fullness")," "))}function rE(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Zb(1,"div",49),m.Ub(2,"mat-progress-spinner",50),m.Zb(3,"div",51),m.Sc(4),m.Yb(),m.Yb(),m.Yb()),2&t){const t=e.$implicit;m.Eb(1),m.Jb("fullness-ok",t.fullness<50)("fullness-warning",t.fullness>=50&&t.fullness<80)("fullness-danger",t.fullness>=80),m.Eb(1),m.sc("value",t.fullness),m.Eb(2),m.Uc("",t.fullness,"%")}}function lE(t,e){1&t&&m.Ub(0,"mat-header-cell")}function dE(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",57),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2);return e.stopPropagation(),a.activate(i)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",58),m.Yb()}if(2&t){const t=m.lc().$implicit;m.tc("matTooltip",m.nc(1,2,"Activer la plage")),m.sc("disabled",100===t.fullness)}}function bE(t,e){if(1&t){const t=m.ac();m.Zb(0,"button",59),m.hc("click",(function(e){m.Hc(t);const i=m.lc().$implicit,a=m.lc(2);return e.stopPropagation(),a.stop(i)})),m.mc(1,"translate"),m.Ub(2,"mat-icon",60),m.Yb()}2&t&&m.tc("matTooltip",m.nc(1,1,"Cl\xf4turer la plage"))}function mE(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-cell",52),m.Qc(1,dE,3,4,"button",53),m.Qc(2,bE,3,3,"button",54),m.Zb(3,"button",55),m.hc("click",(function(i){m.Hc(t);const a=e.$implicit,n=m.lc(2);return i.stopPropagation(),n.delete(a)})),m.mc(4,"translate"),m.Ub(5,"mat-icon",56),m.Yb(),m.Yb()}if(2&t){const t=e.$implicit;m.Eb(1),m.sc("ngIf","SPD"===t.status),m.Eb(1),m.sc("ngIf","OK"===t.status),m.Eb(1),m.tc("matTooltip",m.nc(4,4,"lang.delete")),m.sc("disabled","OK"===t.status)}}function pE(t,e){1&t&&m.Ub(0,"mat-header-row")}function uE(t,e){1&t&&(m.Ub(0,"mat-row",61),m.mc(1,"translate")),2&t&&(m.uc("routerLink","/administration/registeredMails/",e.$implicit.id,""),m.tc("matTooltip",m.nc(1,2,"lang.view")))}function hE(t,e){if(1&t&&(m.Zb(0,"mat-card",20),m.Zb(1,"div",21),m.Zb(2,"div",22),m.Zb(3,"mat-form-field"),m.Ub(4,"input",23),m.mc(5,"translate"),m.Yb(),m.Yb(),m.Zb(6,"div",22),m.Ub(7,"mat-paginator",24,25),m.Yb(),m.Yb(),m.Zb(9,"mat-table",26,27),m.Xb(11,28),m.Qc(12,VC,3,3,"mat-header-cell",29),m.Qc(13,NC,2,1,"mat-cell",30),m.Wb(),m.Xb(14,31),m.Qc(15,JC,3,3,"mat-header-cell",29),m.Qc(16,GC,2,1,"mat-cell",30),m.Wb(),m.Xb(17,32),m.Qc(18,BC,3,3,"mat-header-cell",29),m.Qc(19,WC,2,1,"mat-cell",30),m.Wb(),m.Xb(20,33),m.Qc(21,qC,3,3,"mat-header-cell",34),m.Qc(22,XC,2,1,"mat-cell",35),m.Wb(),m.Xb(23,36),m.Qc(24,KC,3,3,"mat-header-cell",34),m.Qc(25,tE,2,1,"mat-cell",35),m.Wb(),m.Xb(26,37),m.Qc(27,eE,3,3,"mat-header-cell",34),m.Qc(28,cE,3,9,"mat-cell",35),m.Wb(),m.Xb(29,38),m.Qc(30,oE,3,3,"mat-header-cell",34),m.Qc(31,rE,5,8,"mat-cell",35),m.Wb(),m.Xb(32,39),m.Qc(33,lE,1,0,"mat-header-cell",40),m.Qc(34,mE,6,6,"mat-cell",41),m.Wb(),m.Qc(35,pE,1,0,"mat-header-row",42),m.Qc(36,uE,2,4,"mat-row",43),m.Yb(),m.Zb(37,"div",44),m.Sc(38),m.mc(39,"translate"),m.Yb(),m.Yb()),2&t){const t=m.lc();m.Eb(4),m.tc("placeholder",m.nc(5,10,"lang.filterBy")),m.sc("formControl",t.adminService.getFilterField()),m.Eb(3),m.sc("length",100)("hidePageSize",!0)("pageSize",10),m.Eb(2),m.sc("dataSource",t.adminService.getDataSource()),m.Eb(26),m.sc("matHeaderRowDef",t.displayedColumns),m.Eb(1),m.sc("matRowDefColumns",t.displayedColumns),m.Eb(2),m.Vc(" ",t.data.length," ",m.nc(39,12,"lang.registeredMailNumberRanges"),"")}}let fE=(()=>{class t{constructor(t,e,i,a,n,s,c,o,r){this.translate=t,this.http=e,this.notify=i,this.headerService=a,this.appService=n,this.functions=s,this.adminService=c,this.viewContainerRef=o,this.dialog=r,this.subMenus=[{icon:"fas fa-dolly-flatbed",route:"/administration/registeredMails",label:this.translate.instant("lang.registeredMailNumberRanges"),current:!0},{icon:"fas fa-warehouse",route:"/administration/issuingSites",label:this.translate.instant("lang.issuingSites"),current:!1}],this.parameters={},this.loading=!0,this.data=[],this.displayedColumns=["trackerNumber","label","typeLabel","rangeNumber","currentNumber","status","fullness","actions"],this.filterColumns=["label","trackerNumber","typeLabel","rangeNumber","currentNumber","fullness","statusLabel"]}ngOnInit(){this.headerService.setHeader(this.translate.instant("lang.administration")+" "+this.translate.instant("lang.registeredMailNumberRanges")),this.headerService.injectInSideBarLeft(this.adminMenuTemplate,this.viewContainerRef,"adminMenu"),this.loading=!1,this.getData()}getData(){this.data=[],this.http.get("../rest/registeredMail/ranges").pipe(Object(d.a)(t=>{this.data=t.ranges.map(t=>Object.assign(Object.assign({},t),{statusLabel:this.translate.instant("lang.registeredMail_"+t.status),typeLabel:this.translate.instant("lang.registeredMail_"+t.registeredMailType),rangeNumber:`${t.rangeStart} - ${t.rangeEnd}`})),this.loading=!1,setTimeout(()=>{this.adminService.setDataSource("admin_regitered_mail",this.data,this.sort,this.paginator,this.filterColumns)},0)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}activate(t){const e=JSON.parse(JSON.stringify(t));e.status="OK",this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.activate"),msg:"En activant cette plage, cela cl\xf4turera la plage actuelle utilis\xe9e pour ce type de recommand\xe9."}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.put("../rest/registeredMail/ranges/"+t.id,e)),Object(d.a)(()=>{this.data.forEach(e=>{"OK"===e.status&&e.registeredMailType===t.registeredMailType&&e.siteId===t.siteId?(e.status="END",e.currentNumber=null,e.statusLabel=this.translate.instant("lang.registeredMail_"+e.status)):e.id===t.id&&(e.status="OK",e.currentNumber=e.rangeStart,e.statusLabel=this.translate.instant("lang.registeredMail_"+e.status))}),setTimeout(()=>{this.adminService.setDataSource("admin_regitered_mail",this.data,this.sort,this.paginator,this.filterColumns)},0),this.notify.success(this.translate.instant("Plage activ\xe9e"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}stop(t){const e=JSON.parse(JSON.stringify(t));e.status="END",this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.suspend"),msg:"En cl\xf4turant la plage, vous ne pourrez plus utiliser de recommand\xe9 de ce type tant que vous n'en n'aurez pas activ\xe9 une autre."}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.put("../rest/registeredMail/ranges/"+t.id,e)),Object(d.a)(()=>{t.status="END",t.statusLabel=this.translate.instant("lang.registeredMail_"+t.status),setTimeout(()=>{this.adminService.setDataSource("admin_regitered_mail",this.data,this.sort,this.paginator,this.filterColumns)},0),this.notify.success(this.translate.instant("Plage clotur\xe9e"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}delete(t){this.dialog.open(B.a,{panelClass:"maarch-modal",autoFocus:!1,disableClose:!0,data:{title:this.translate.instant("lang.delete"),msg:this.translate.instant("lang.confirmAction")}}).afterClosed().pipe(Object(W.a)(t=>"ok"===t),Object(q.a)(()=>this.http.delete("../rest/registeredMail/ranges/"+t.id)),Object(d.a)(()=>{this.data=this.data.filter(e=>e.id!==t.id),setTimeout(()=>{this.adminService.setDataSource("admin_regitered_mail",this.data,this.sort,this.paginator,this.filterColumns)},0),this.notify.success(this.translate.instant("lang.issuingSiteDeleted"))}),Object(b.a)(t=>(this.notify.handleErrors(t),Object(N.of)(!1)))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(C.a),m.Tb(wt),m.Tb(m.R),m.Tb(H.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-registered-mail-list"]],viewQuery:function(t,e){var i;1&t&&(m.Oc(AC,!0),m.ad(z.a,!0),m.ad(V.a,!0)),2&t&&(m.Cc(i=m.ic())&&(e.adminMenuTemplate=i.first),m.Cc(i=m.ic())&&(e.paginator=i.first),m.Cc(i=m.ic())&&(e.sort=i.first))},decls:15,vars:8,consts:[["autosize","",1,"maarch-container"],["adminMenuTemplate",""],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],["mat-subheader",""],["mat-list-item","","routerLink","/administration/registeredMails/new"],["color","primary","mat-list-icon","",1,"fa","fa-plus"],["mat-line",""],["mat-list-item","",3,"active","routerLink",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink"],["color","primary","mat-list-icon",""],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],[1,"row"],[1,"col-md-6","col-xs-6"],["matInput","",3,"formControl","placeholder"],[3,"length","hidePageSize","pageSize"],["paginator",""],["matSort","","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","label"],["mat-sort-header","","style","flex:2",4,"matHeaderCellDef"],["style","flex:2",4,"matCellDef"],["matColumnDef","trackerNumber"],["matColumnDef","typeLabel"],["matColumnDef","rangeNumber"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","currentNumber"],["matColumnDef","status"],["matColumnDef","fullness"],["matColumnDef","actions"],[4,"matHeaderCellDef"],["style","justify-content: flex-end;",4,"matCellDef"],[4,"matHeaderRowDef"],["style","cursor:pointer;",3,"routerLink","matTooltip",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",2,"min-height","48px","min-height","48px","display","flex","justify-content","end","align-items","center","padding-right","20px"],["mat-sort-header","",2,"flex","2"],[2,"flex","2"],["mat-sort-header",""],[1,"label",3,"ngClass"],[1,"fullness","full"],["color","primay","mode","determinate","diameter","54",3,"value"],[1,"percent"],[2,"justify-content","flex-end"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","disabled","click"],["aria-hidden","true",1,"fa","fa-trash-alt","fa-2x"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click"],["aria-hidden","true",1,"fa","fas","fa-play","fa-2x"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["aria-hidden","true",1,"fa","fas","fa-stop-circle","fa-2x"],[2,"cursor","pointer",3,"routerLink","matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Qc(1,$C,12,7,"ng-template",null,1,m.Rc),m.Zb(3,"mat-sidenav-content"),m.Zb(4,"div",2),m.Zb(5,"div",3),m.Zb(6,"div",4),m.Ub(7,"header-left"),m.Yb(),m.Zb(8,"div",5),m.Ub(9,"header-right"),m.Yb(),m.Yb(),m.Ub(10,"div",6),m.Yb(),m.Zb(11,"div",7),m.Zb(12,"div",8),m.Qc(13,zC,2,0,"div",9),m.Qc(14,hE,40,14,"mat-card",10),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(5),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,Ot.h,Ot.g,Ot.d,s.f,Tt.a,Ot.c,I.k,_.a,x.s,T.c,k.a,w.c,O.b,o.c,o.t,o.i,z.a,G.n,V.a,G.c,G.i,G.b,G.k,G.m,G.h,V.b,G.a,x.q,T.a,D.b,It.b,G.j,G.l,s.d],pipes:[p.d],styles:[".active[_ngcontent-%COMP%], .active[_ngcontent-%COMP%]:active, .active[_ngcontent-%COMP%]:focus, .active[_ngcontent-%COMP%]:hover{color:#135f7f;border-left:5px solid #135f7f;background:rgba(19,95,127,.14)}.fullness[_ngcontent-%COMP%]{position:relative}.percent[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translate(-50%,-50%);left:50%;font-size:10px;font-weight:700;color:#888}.fullness-ok[_ngcontent-%COMP%]     .mat-progress-spinner circle, .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:green}.fullness-warning[_ngcontent-%COMP%]     .mat-progress-spinner circle, .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:orange}.fullness-danger[_ngcontent-%COMP%]     .mat-progress-spinner circle, .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:red}.statusLabelDanger[_ngcontent-%COMP%]{color:#8e3e52}.statusLabelWarn[_ngcontent-%COMP%]{color:#f99830}.statusLabelPrimary[_ngcontent-%COMP%]{color:#135f7f}"]}),t})();function gE(t,e){1&t&&(m.Zb(0,"div",10),m.Ub(1,"mat-spinner",11),m.Yb())}function vE(t,e){1&t&&(m.Ub(0,"div",24),m.mc(1,"translate")),2&t&&m.sc("innerHTML",m.nc(1,1,"lang.registeredMailNumberRangeModificationMsg"),m.Ic)}function yE(t,e){if(1&t&&m.Ub(0,"plugin-select-search",18),2&t){const t=m.lc(2);m.Gb(""),m.sc("showLabel",!0)("label",t.translate.instant("lang.issuingSite"))("placeholderLabel",t.translate.instant("lang.issuingSite"))("datas",t.customerAccountNumberList)("formControlSelect",t.adminFormGroup.controls.siteId)}}function CE(t,e){1&t&&(m.Zb(0,"div",25),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Eb(1),m.Uc(" ",m.nc(2,1,"lang.registeredMailNoIssuingSites")," "))}function EE(t,e){if(1&t){const t=m.ac();m.Zb(0,"mat-card",12),m.Qc(1,vE,2,3,"div",13),m.Zb(2,"form",14),m.hc("ngSubmit",(function(){return m.Hc(t),m.lc().onSubmit()})),m.Zb(3,"div"),m.Zb(4,"mat-form-field"),m.Zb(5,"mat-label"),m.Sc(6),m.mc(7,"translate"),m.Yb(),m.Ub(8,"input",15),m.Yb(),m.Qc(9,yE,1,7,"plugin-select-search",16),m.Qc(10,CE,3,3,"div",17),m.Ub(11,"plugin-select-search",18),m.Zb(12,"div",19),m.Zb(13,"mat-form-field"),m.Zb(14,"mat-label"),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Zb(17,"input",20),m.hc("keypress",(function(e){return m.Hc(t),m.lc().onlyNumbers(e)})),m.Yb(),m.Yb(),m.Zb(18,"mat-form-field"),m.Zb(19,"mat-label"),m.Sc(20),m.mc(21,"translate"),m.Yb(),m.Zb(22,"input",21),m.hc("keypress",(function(e){return m.Hc(t),m.lc().onlyNumbers(e)})),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(23,"div",22),m.Zb(24,"button",23),m.Sc(25),m.mc(26,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Eb(1),m.sc("ngIf","OK"===t.adminFormGroup.controls.status.value||"END"===t.adminFormGroup.controls.status.value),m.Eb(1),m.sc("formGroup",t.adminFormGroup),m.Eb(4),m.Tc(m.nc(7,18,"lang.trackerNumber")),m.Eb(3),m.sc("ngIf",t.customerAccountNumberList.length>0),m.Eb(1),m.sc("ngIf",0===t.customerAccountNumberList.length),m.Eb(1),m.Gb(""),m.sc("showLabel",!0)("label",t.translate.instant("lang.registeredMailType"))("placeholderLabel",t.translate.instant("lang.registeredMailType"))("datas",t.registeredMailType)("formControlSelect",t.adminFormGroup.controls.registeredMailType),m.Eb(4),m.Tc(m.nc(16,20,"lang.registeredMailStart")),m.Eb(2),m.sc("min",t.minRange),m.Eb(3),m.Tc(m.nc(21,22,"lang.registeredMailEnd")),m.Eb(2),m.sc("min",t.adminFormGroup.controls.rangeStart.value),m.Eb(2),m.sc("disabled",!t.adminFormGroup.valid),m.Eb(1),m.Tc(m.nc(26,24,"lang.save"))}}let SE=(()=>{class t{constructor(t,e,i,a,n,s,c,o){this.translate=t,this.http=e,this.route=i,this.router=a,this.notify=n,this.headerService=s,this.appService=c,this._formBuilder=o,this.loading=!0,this.id=null,this.minRange=1,this.customerAccountNumberList=[],this.registeredMailType=[{id:"2D",label:this.translate.instant("lang.registeredMail_2D")},{id:"2C",label:this.translate.instant("lang.registeredMail_2C")},{id:"RW",label:this.translate.instant("lang.registeredMail_RW")}]}ngOnInit(){this.route.params.subscribe(t=>Object(gt.a)(this,void 0,void 0,(function*(){this.getIssuingSites(),void 0===t.id?(this.creationMode=!0,this.headerService.setHeader(this.translate.instant("lang.registeredMailNumberRangeCreation")),this.adminFormGroup=this._formBuilder.group({id:[null],siteId:[null,o.H.required],trackerNumber:[null,o.H.required],registeredMailType:[null,o.H.required],rangeStart:[1,o.H.required],rangeEnd:[2,o.H.required],status:["SPD"]}),this.loading=!1):(this.headerService.setHeader(this.translate.instant("lang.registeredMailNumberRangeModification")),this.id=t.id,this.creationMode=!1,yield this.getData()),this.adminFormGroup.controls.registeredMailType.valueChanges.pipe(Object(d.a)(()=>{this.creationMode&&this.getMinRange()})).subscribe(),this.adminFormGroup.controls.rangeStart.valueChanges.pipe(Object(d.a)(t=>{t>this.adminFormGroup.controls.rangeEnd.value?this.adminFormGroup.controls.rangeStart.setErrors({rangeError:!0}):(this.adminFormGroup.controls.rangeStart.setErrors(null),this.adminFormGroup.controls.rangeEnd.setErrors(null))})).subscribe(),this.adminFormGroup.controls.rangeEnd.valueChanges.pipe(Object(d.a)(t=>{t<this.adminFormGroup.controls.rangeStart.value?this.adminFormGroup.controls.rangeEnd.setErrors({rangeError:!0}):(this.adminFormGroup.controls.rangeStart.setErrors(null),this.adminFormGroup.controls.rangeEnd.setErrors(null))})).subscribe()})))}getIssuingSites(){this.http.get("../rest/registeredMail/sites").pipe(Object(d.a)(t=>{this.customerAccountNumberList=t.sites.map(t=>({id:t.id,label:`${t.label} (${t.accountNumber})`}))}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}getData(){return new Promise(t=>{this.http.get("../rest/registeredMail/ranges/"+this.id).pipe(Object(d.a)(e=>{this.adminFormGroup=this._formBuilder.group({id:[this.id],siteId:[e.range.siteId],trackerNumber:[e.range.trackerNumber],registeredMailType:[e.range.registeredMailType],rangeStart:[e.range.rangeStart],rangeEnd:[e.range.rangeEnd],status:[e.range.status]}),"OK"!==e.range.status&&"END"!==e.range.status||this.adminFormGroup.disable(),t(!0),this.loading=!1}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()})}onlyNumbers(t){let e;return e=t.charCode,(null!==this.adminFormGroup.controls.rangeStart.value||48!==e)&&e>=48&&e<=57}getMinRange(){this.http.get(`../rest/registeredMail/ranges/type/${this.adminFormGroup.controls.registeredMailType.value}/last`).pipe(Object(d.a)(t=>{this.minRange=1===t.lastNumber?t.lastNumber:t.lastNumber+1,this.adminFormGroup.controls.rangeStart.setValue(this.minRange),this.adminFormGroup.controls.rangeEnd.value<this.adminFormGroup.controls.rangeStart.value&&this.adminFormGroup.controls.rangeEnd.setValue(this.adminFormGroup.controls.rangeStart.value+1)}),Object(b.a)(t=>(this.notify.handleSoftErrors(t),Object(N.of)(!1)))).subscribe()}onSubmit(){const t={};Object.keys(this.adminFormGroup.controls).forEach(e=>{t[e]=this.adminFormGroup.controls[e].value}),this.creationMode?this.http.post("../rest/registeredMail/ranges",t).subscribe(()=>{this.notify.success(this.translate.instant("lang.registeredMailNumberRangesAdded")),this.router.navigate(["/administration/registeredMails"])},t=>{this.notify.handleSoftErrors(t)}):this.http.put("../rest/registeredMail/ranges/"+this.id,t).subscribe(()=>{this.notify.success(this.translate.instant("lang.registeredMailNumberRangesUpdated")),this.router.navigate(["/administration/registeredMails"])},t=>{this.notify.handleSoftErrors(t)})}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(p.e),m.Tb(u.b),m.Tb(s.a),m.Tb(s.c),m.Tb(y.a),m.Tb(h.a),m.Tb(f.a),m.Tb(o.g))},t.\u0275cmp=m.Nb({type:t,selectors:[["app-registered-mail"]],decls:13,vars:8,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-title"],[1,"bg-head-title-label"],[1,"bg-head-title-tool"],[1,"bg-head-content"],[1,"container"],[1,"container-content"],["style","display:flex;height:100%;",4,"ngIf"],["class","card-app-content",4,"ngIf"],[2,"display","flex","height","100%"],[2,"margin","auto"],[1,"card-app-content"],["class","alert-message alert-message-danger","style","min-width: 100%;",3,"innerHTML",4,"ngIf"],[2,"display","contents",3,"formGroup","ngSubmit"],["matInput","","formControlName","trackerNumber"],[3,"showLabel","label","placeholderLabel","datas","class","formControlSelect",4,"ngIf"],["class","alert-message alert-message-danger",4,"ngIf"],[3,"showLabel","label","placeholderLabel","datas","formControlSelect"],[2,"display","grid","grid-template-columns","1fr 1fr","grid-gap","20px"],["matInput","","type","number","formControlName","rangeStart",3,"min","keypress"],["matInput","","type","number","formControlName","rangeEnd",3,"min","keypress"],[2,"text-align","center"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"alert-message","alert-message-danger",2,"min-width","100%",3,"innerHTML"],[1,"alert-message","alert-message-danger"]],template:function(t,e){1&t&&(m.Zb(0,"mat-sidenav-container",0),m.Zb(1,"mat-sidenav-content"),m.Zb(2,"div",1),m.Zb(3,"div",2),m.Zb(4,"div",3),m.Ub(5,"header-left"),m.Yb(),m.Zb(6,"div",4),m.Ub(7,"header-right"),m.Yb(),m.Yb(),m.Ub(8,"div",5),m.Yb(),m.Zb(9,"div",6),m.Zb(10,"div",7),m.Qc(11,gE,2,0,"div",8),m.Qc(12,EE,27,26,"mat-card",9),m.Yb(),m.Yb(),m.Yb(),m.Yb()),2&t&&(m.Eb(3),m.Jb("customContainerRight",e.appService.getViewMode()),m.Eb(5),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(1),m.Jb("fullContainer",e.appService.getViewMode()),m.Eb(2),m.sc("ngIf",e.loading),m.Eb(1),m.sc("ngIf",!e.loading))},directives:[S.e,S.f,M.a,Z.a,x.t,T.c,k.a,o.J,o.u,o.l,w.c,w.g,O.b,o.c,o.t,o.j,Nr.a,o.z,D.b],pipes:[p.d],styles:[""]}),t})(),ME=(()=>{class t{}return t.\u0275mod=m.Rb({type:t}),t.\u0275inj=m.Qb({factory:function(e){return new(e||t)},imports:[[s.g.forChild([{path:"",canActivate:[jf.b],component:A},{path:"users",canActivate:[jf.b],component:Me},{path:"users/new",canActivate:[jf.b],component:na},{path:"users/:id",canActivate:[jf.b],component:na},{path:"groups",canActivate:[jf.b],component:Ea},{path:"groups/new",canActivate:[jf.b],component:Sn},{path:"groups/:id",canActivate:[jf.b],component:Sn},{path:"baskets",canActivate:[jf.b],component:Qn},{path:"baskets/new",canActivate:[jf.b],component:Vs},{path:"baskets/:id",canActivate:[jf.b],component:Vs},{path:"doctypes",canActivate:[jf.b],component:hc},{path:"diffusionModels",canActivate:[jf.b],component:kc},{path:"diffusionModels/new",canActivate:[jf.b],component:$c},{path:"diffusionModels/:id",canActivate:[jf.b],component:$c},{path:"entities",canActivate:[jf.b],component:er},{path:"statuses",canActivate:[jf.b],component:yr},{path:"statuses/new",canActivate:[jf.b],component:_r},{path:"statuses/:identifier",canActivate:[jf.b],component:_r},{path:"parameters",canActivate:[jf.b],component:Tl},{path:"parameters/new",canActivate:[jf.b],component:ll},{path:"parameters/:id",canActivate:[jf.b],component:ll},{path:"priorities",canActivate:[jf.b],component:Gl},{path:"priorities/new",canActivate:[jf.b],component:ql},{path:"priorities/:id",canActivate:[jf.b],component:ql},{path:"actions",canActivate:[jf.b],component:Vr},{path:"actions/new",canActivate:[jf.b],component:al},{path:"actions/:id",canActivate:[jf.b],component:al},{path:"notifications",canActivate:[jf.b],component:Md},{path:"notifications/new",canActivate:[jf.b],component:ab},{path:"notifications/:identifier",canActivate:[jf.b],component:ab},{path:"history",canActivate:[jf.b],component:pb},{path:"history-batch",canActivate:[jf.b],component:Xb},{path:"update-status",canActivate:[jf.b],component:nm},{path:"contacts",canActivate:[jf.b],component:Ov},{path:"contacts/duplicates",canActivate:[jf.b],component:uC},{path:"contacts/list",redirectTo:"contacts",pathMatch:"full"},{path:"contacts/list/new",canActivate:[jf.b],component:sy},{path:"contacts/list/:id",canActivate:[jf.b],component:sy},{path:"contacts/contactsCustomFields",canActivate:[jf.b],component:Kv},{path:"contacts/contacts-groups",canActivate:[jf.b],component:Om},{path:"contacts/contacts-groups/new",canActivate:[jf.b],component:rp},{path:"contacts/contacts-groups/:id",canActivate:[jf.b],component:rp},{path:"contacts/contacts-parameters",canActivate:[jf.b],component:Dp},{path:"versions-update",canActivate:[jf.b],component:$p},{path:"docservers",canActivate:[jf.b],component:tu},{path:"docservers/new",canActivate:[jf.b],component:nu},{path:"templates",canActivate:[jf.b],component:Mu},{path:"templates/new",canActivate:[jf.b],component:uh},{path:"templates/:id",canActivate:[jf.b],component:uh},{path:"securities",canActivate:[jf.b],component:vh},{path:"sendmail",canActivate:[jf.b],component:Ih},{path:"shippings",canActivate:[jf.b],component:Jh},{path:"shippings/new",canActivate:[jf.b],component:nf},{path:"shippings/:id",canActivate:[jf.b],component:nf},{path:"customFields",canActivate:[jf.b],component:Lf},{path:"indexingModels",canActivate:[jf.b],component:xg},{path:"indexingModels/new",canActivate:[jf.b],component:Gf},{path:"indexingModels/:id",canActivate:[jf.b],component:Gf},{path:"tags",canActivate:[jf.b],component:fy},{path:"tags/new",canActivate:[jf.b],component:My},{path:"tags/:id",canActivate:[jf.b],component:My},{path:"alfresco",canActivate:[jf.b],component:Ny},{path:"alfresco/new",canActivate:[jf.b],component:Ty},{path:"alfresco/:id",canActivate:[jf.b],component:Ty},{path:"registeredMails",canActivate:[jf.b],component:fE},{path:"registeredMails/new",canActivate:[jf.b],component:SE},{path:"registeredMails/:id",canActivate:[jf.b],component:SE},{path:"issuingSites",canActivate:[jf.b],component:TC},{path:"issuingSites/new",canActivate:[jf.b],component:QC},{path:"issuingSites/:id",canActivate:[jf.b],component:QC}])],s.g]}),t})();var YE=i("U+qY"),ZE=i("L6pT");let xE=(()=>{class t{constructor(t){t.setDefaultLang("fr")}}return t.\u0275mod=m.Rb({type:t}),t.\u0275inj=m.Qb({factory:function(e){return new(e||t)(m.dc(p.e))},providers:[wt],imports:[[a.a,n.a,Y.b.forChild(),ZE.a,ME,YE.a]]}),t})()}}]);